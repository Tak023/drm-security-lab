{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/lib/utils.ts"],"sourcesContent":["import { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,SAAS,GAAG,GAAG,MAAoB;IACxC,OAAO,IAAA,mNAAO,EAAC,IAAA,0LAAI,EAAC;AACtB"}},
    {"offset": {"line": 19, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/components/ui/card.tsx"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Card({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card\"\n      className={cn(\n        \"bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-header\"\n      className={cn(\n        \"@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardTitle({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-title\"\n      className={cn(\"leading-none font-semibold\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardDescription({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-description\"\n      className={cn(\"text-muted-foreground text-sm\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardAction({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-action\"\n      className={cn(\n        \"col-start-2 row-span-2 row-start-1 self-start justify-self-end\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-content\"\n      className={cn(\"px-6\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-footer\"\n      className={cn(\"flex items-center px-6 [.border-t]:pt-6\", className)}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Card,\n  CardHeader,\n  CardFooter,\n  CardTitle,\n  CardAction,\n  CardDescription,\n  CardContent,\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAEA;;;AAEA,SAAS,KAAK,EAAE,SAAS,EAAE,GAAG,OAAoC;IAChE,qBACE,2RAAC;QACC,aAAU;QACV,WAAW,IAAA,sKAAE,EACX,qFACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,2RAAC;QACC,aAAU;QACV,WAAW,IAAA,sKAAE,EACX,4JACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,UAAU,EAAE,SAAS,EAAE,GAAG,OAAoC;IACrE,qBACE,2RAAC;QACC,aAAU;QACV,WAAW,IAAA,sKAAE,EAAC,8BAA8B;QAC3C,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,gBAAgB,EAAE,SAAS,EAAE,GAAG,OAAoC;IAC3E,qBACE,2RAAC;QACC,aAAU;QACV,WAAW,IAAA,sKAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,2RAAC;QACC,aAAU;QACV,WAAW,IAAA,sKAAE,EACX,kEACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,YAAY,EAAE,SAAS,EAAE,GAAG,OAAoC;IACvE,qBACE,2RAAC;QACC,aAAU;QACV,WAAW,IAAA,sKAAE,EAAC,QAAQ;QACrB,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,2RAAC;QACC,aAAU;QACV,WAAW,IAAA,sKAAE,EAAC,2CAA2C;QACxD,GAAG,KAAK;;;;;;AAGf"}},
    {"offset": {"line": 121, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/components/ui/button.tsx"],"sourcesContent":["import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-primary text-primary-foreground hover:bg-primary/90\",\n        destructive:\n          \"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60\",\n        outline:\n          \"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50\",\n        secondary:\n          \"bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        ghost:\n          \"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50\",\n        link: \"text-primary underline-offset-4 hover:underline\",\n      },\n      size: {\n        default: \"h-9 px-4 py-2 has-[>svg]:px-3\",\n        sm: \"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5\",\n        lg: \"h-10 rounded-md px-6 has-[>svg]:px-4\",\n        icon: \"size-9\",\n        \"icon-sm\": \"size-8\",\n        \"icon-lg\": \"size-10\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nfunction Button({\n  className,\n  variant = \"default\",\n  size = \"default\",\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"button\"> &\n  VariantProps<typeof buttonVariants> & {\n    asChild?: boolean\n  }) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"button\"\n      data-variant={variant}\n      data-size={size}\n      className={cn(buttonVariants({ variant, size, className }))}\n      {...props}\n    />\n  )\n}\n\nexport { Button, buttonVariants }\n"],"names":[],"mappings":";;;;;;;AACA;AACA;AAEA;;;;;AAEA,MAAM,iBAAiB,IAAA,oNAAG,EACxB,+bACA;IACE,UAAU;QACR,SAAS;YACP,SAAS;YACT,aACE;YACF,SACE;YACF,WACE;YACF,OACE;YACF,MAAM;QACR;QACA,MAAM;YACJ,SAAS;YACT,IAAI;YACJ,IAAI;YACJ,MAAM;YACN,WAAW;YACX,WAAW;QACb;IACF;IACA,iBAAiB;QACf,SAAS;QACT,MAAM;IACR;AACF;AAGF,SAAS,OAAO,EACd,SAAS,EACT,UAAU,SAAS,EACnB,OAAO,SAAS,EAChB,UAAU,KAAK,EACf,GAAG,OAIF;IACD,MAAM,OAAO,UAAU,qNAAI,GAAG;IAE9B,qBACE,2RAAC;QACC,aAAU;QACV,gBAAc;QACd,aAAW;QACX,WAAW,IAAA,sKAAE,EAAC,eAAe;YAAE;YAAS;YAAM;QAAU;QACvD,GAAG,KAAK;;;;;;AAGf"}},
    {"offset": {"line": 182, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/components/ui/badge.tsx"],"sourcesContent":["import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  \"inline-flex items-center justify-center rounded-full border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90\",\n        secondary:\n          \"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90\",\n        destructive:\n          \"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60\",\n        outline:\n          \"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nfunction Badge({\n  className,\n  variant,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"span\"> &\n  VariantProps<typeof badgeVariants> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"span\"\n\n  return (\n    <Comp\n      data-slot=\"badge\"\n      className={cn(badgeVariants({ variant }), className)}\n      {...props}\n    />\n  )\n}\n\nexport { Badge, badgeVariants }\n"],"names":[],"mappings":";;;;;;;AACA;AACA;AAEA;;;;;AAEA,MAAM,gBAAgB,IAAA,oNAAG,EACvB,oZACA;IACE,UAAU;QACR,SAAS;YACP,SACE;YACF,WACE;YACF,aACE;YACF,SACE;QACJ;IACF;IACA,iBAAiB;QACf,SAAS;IACX;AACF;AAGF,SAAS,MAAM,EACb,SAAS,EACT,OAAO,EACP,UAAU,KAAK,EACf,GAAG,OAEuD;IAC1D,MAAM,OAAO,UAAU,qNAAI,GAAG;IAE9B,qBACE,2RAAC;QACC,aAAU;QACV,WAAW,IAAA,sKAAE,EAAC,cAAc;YAAE;QAAQ,IAAI;QACzC,GAAG,KAAK;;;;;;AAGf"}},
    {"offset": {"line": 228, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/components/ui/alert.tsx"],"sourcesContent":["import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst alertVariants = cva(\n  \"relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-card text-card-foreground\",\n        destructive:\n          \"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nfunction Alert({\n  className,\n  variant,\n  ...props\n}: React.ComponentProps<\"div\"> & VariantProps<typeof alertVariants>) {\n  return (\n    <div\n      data-slot=\"alert\"\n      role=\"alert\"\n      className={cn(alertVariants({ variant }), className)}\n      {...props}\n    />\n  )\n}\n\nfunction AlertTitle({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"alert-title\"\n      className={cn(\n        \"col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction AlertDescription({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"alert-description\"\n      className={cn(\n        \"text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Alert, AlertTitle, AlertDescription }\n"],"names":[],"mappings":";;;;;;;;;AACA;AAEA;;;;AAEA,MAAM,gBAAgB,IAAA,oNAAG,EACvB,qOACA;IACE,UAAU;QACR,SAAS;YACP,SAAS;YACT,aACE;QACJ;IACF;IACA,iBAAiB;QACf,SAAS;IACX;AACF;AAGF,SAAS,MAAM,EACb,SAAS,EACT,OAAO,EACP,GAAG,OAC8D;IACjE,qBACE,2RAAC;QACC,aAAU;QACV,MAAK;QACL,WAAW,IAAA,sKAAE,EAAC,cAAc;YAAE;QAAQ,IAAI;QACzC,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,2RAAC;QACC,aAAU;QACV,WAAW,IAAA,sKAAE,EACX,+DACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,iBAAiB,EACxB,SAAS,EACT,GAAG,OACyB;IAC5B,qBACE,2RAAC;QACC,aAAU;QACV,WAAW,IAAA,sKAAE,EACX,kGACA;QAED,GAAG,KAAK;;;;;;AAGf"}},
    {"offset": {"line": 294, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/components/ui/tabs.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Tabs({\n  className,\n  ...props\n}: React.ComponentProps<typeof TabsPrimitive.Root>) {\n  return (\n    <TabsPrimitive.Root\n      data-slot=\"tabs\"\n      className={cn(\"flex flex-col gap-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction TabsList({\n  className,\n  ...props\n}: React.ComponentProps<typeof TabsPrimitive.List>) {\n  return (\n    <TabsPrimitive.List\n      data-slot=\"tabs-list\"\n      className={cn(\n        \"bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction TabsTrigger({\n  className,\n  ...props\n}: React.ComponentProps<typeof TabsPrimitive.Trigger>) {\n  return (\n    <TabsPrimitive.Trigger\n      data-slot=\"tabs-trigger\"\n      className={cn(\n        \"data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction TabsContent({\n  className,\n  ...props\n}: React.ComponentProps<typeof TabsPrimitive.Content>) {\n  return (\n    <TabsPrimitive.Content\n      data-slot=\"tabs-content\"\n      className={cn(\"flex-1 outline-none\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\n"],"names":[],"mappings":";;;;;;;;;;;AAGA;AAEA;AALA;;;;AAOA,SAAS,KAAK,EACZ,SAAS,EACT,GAAG,OAC6C;IAChD,qBACE,2RAAC,qNAAkB;QACjB,aAAU;QACV,WAAW,IAAA,sKAAE,EAAC,uBAAuB;QACpC,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,SAAS,EAChB,SAAS,EACT,GAAG,OAC6C;IAChD,qBACE,2RAAC,qNAAkB;QACjB,aAAU;QACV,WAAW,IAAA,sKAAE,EACX,uGACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,YAAY,EACnB,SAAS,EACT,GAAG,OACgD;IACnD,qBACE,2RAAC,wNAAqB;QACpB,aAAU;QACV,WAAW,IAAA,sKAAE,EACX,mqBACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,YAAY,EACnB,SAAS,EACT,GAAG,OACgD;IACnD,qBACE,2RAAC,wNAAqB;QACpB,aAAU;QACV,WAAW,IAAA,sKAAE,EAAC,uBAAuB;QACpC,GAAG,KAAK;;;;;;AAGf"}},
    {"offset": {"line": 360, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/components/ui/scroll-area.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as ScrollAreaPrimitive from \"@radix-ui/react-scroll-area\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction ScrollArea({\n  className,\n  children,\n  ...props\n}: React.ComponentProps<typeof ScrollAreaPrimitive.Root>) {\n  return (\n    <ScrollAreaPrimitive.Root\n      data-slot=\"scroll-area\"\n      className={cn(\"relative\", className)}\n      {...props}\n    >\n      <ScrollAreaPrimitive.Viewport\n        data-slot=\"scroll-area-viewport\"\n        className=\"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1\"\n      >\n        {children}\n      </ScrollAreaPrimitive.Viewport>\n      <ScrollBar />\n      <ScrollAreaPrimitive.Corner />\n    </ScrollAreaPrimitive.Root>\n  )\n}\n\nfunction ScrollBar({\n  className,\n  orientation = \"vertical\",\n  ...props\n}: React.ComponentProps<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>) {\n  return (\n    <ScrollAreaPrimitive.ScrollAreaScrollbar\n      data-slot=\"scroll-area-scrollbar\"\n      orientation={orientation}\n      className={cn(\n        \"flex touch-none p-px transition-colors select-none\",\n        orientation === \"vertical\" &&\n          \"h-full w-2.5 border-l border-l-transparent\",\n        orientation === \"horizontal\" &&\n          \"h-2.5 flex-col border-t border-t-transparent\",\n        className\n      )}\n      {...props}\n    >\n      <ScrollAreaPrimitive.ScrollAreaThumb\n        data-slot=\"scroll-area-thumb\"\n        className=\"bg-border relative flex-1 rounded-full\"\n      />\n    </ScrollAreaPrimitive.ScrollAreaScrollbar>\n  )\n}\n\nexport { ScrollArea, ScrollBar }\n"],"names":[],"mappings":";;;;;;;AAGA;AAEA;AALA;;;;AAOA,SAAS,WAAW,EAClB,SAAS,EACT,QAAQ,EACR,GAAG,OACmD;IACtD,qBACE,2RAAC,+NAAwB;QACvB,aAAU;QACV,WAAW,IAAA,sKAAE,EAAC,YAAY;QACzB,GAAG,KAAK;;0BAET,2RAAC,mOAA4B;gBAC3B,aAAU;gBACV,WAAU;0BAET;;;;;;0BAEH,2RAAC;;;;;0BACD,2RAAC,iOAA0B;;;;;;;;;;;AAGjC;AAEA,SAAS,UAAU,EACjB,SAAS,EACT,cAAc,UAAU,EACxB,GAAG,OACkE;IACrE,qBACE,2RAAC,8OAAuC;QACtC,aAAU;QACV,aAAa;QACb,WAAW,IAAA,sKAAE,EACX,sDACA,gBAAgB,cACd,8CACF,gBAAgB,gBACd,gDACF;QAED,GAAG,KAAK;kBAET,cAAA,2RAAC,0OAAmC;YAClC,aAAU;YACV,WAAU;;;;;;;;;;;AAIlB"}},
    {"offset": {"line": 430, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/components/ui/separator.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as SeparatorPrimitive from \"@radix-ui/react-separator\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Separator({\n  className,\n  orientation = \"horizontal\",\n  decorative = true,\n  ...props\n}: React.ComponentProps<typeof SeparatorPrimitive.Root>) {\n  return (\n    <SeparatorPrimitive.Root\n      data-slot=\"separator\"\n      decorative={decorative}\n      orientation={orientation}\n      className={cn(\n        \"bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Separator }\n"],"names":[],"mappings":";;;;;AAGA;AAEA;AALA;;;;AAOA,SAAS,UAAU,EACjB,SAAS,EACT,cAAc,YAAY,EAC1B,aAAa,IAAI,EACjB,GAAG,OACkD;IACrD,qBACE,2RAAC,0NAAuB;QACtB,aAAU;QACV,YAAY;QACZ,aAAa;QACb,WAAW,IAAA,sKAAE,EACX,kKACA;QAED,GAAG,KAAK;;;;;;AAGf"}},
    {"offset": {"line": 459, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/lib/drm/crypto.ts"],"sourcesContent":["/**\n * Simplified crypto utilities for DRM simulation\n * This is for EDUCATIONAL purposes only - not production-grade crypto\n */\n\n// Simple XOR-based \"encryption\" for demonstration\nexport function xorEncrypt(data: Uint8Array, key: Uint8Array): Uint8Array {\n  const result = new Uint8Array(data.length);\n  for (let i = 0; i < data.length; i++) {\n    result[i] = data[i] ^ key[i % key.length];\n  }\n  return result;\n}\n\n// XOR two byte arrays (for educational block cipher demos)\nexport function xorBytes(a: Uint8Array, b: Uint8Array): Uint8Array {\n  const length = Math.min(a.length, b.length);\n  const result = new Uint8Array(length);\n  for (let i = 0; i < length; i++) {\n    result[i] = a[i] ^ b[i];\n  }\n  return result;\n}\n\nexport function xorDecrypt(data: Uint8Array, key: Uint8Array): Uint8Array {\n  // XOR is symmetric\n  return xorEncrypt(data, key);\n}\n\n// Generate a random key\nexport function generateKey(length: number = 16): Uint8Array {\n  const key = new Uint8Array(length);\n  if (typeof window !== 'undefined' && window.crypto) {\n    window.crypto.getRandomValues(key);\n  } else {\n    // Fallback for SSR\n    for (let i = 0; i < length; i++) {\n      key[i] = Math.floor(Math.random() * 256);\n    }\n  }\n  return key;\n}\n\n// Convert bytes to hex string\nexport function bytesToHex(bytes: Uint8Array): string {\n  return Array.from(bytes)\n    .map((b) => b.toString(16).padStart(2, '0'))\n    .join('');\n}\n\n// Convert hex string to bytes\nexport function hexToBytes(hex: string): Uint8Array {\n  const bytes = new Uint8Array(hex.length / 2);\n  for (let i = 0; i < bytes.length; i++) {\n    bytes[i] = parseInt(hex.substr(i * 2, 2), 16);\n  }\n  return bytes;\n}\n\n// Convert string to bytes\nexport function stringToBytes(str: string): Uint8Array {\n  return new TextEncoder().encode(str);\n}\n\n// Convert bytes to string\nexport function bytesToString(bytes: Uint8Array): string {\n  return new TextDecoder().decode(bytes);\n}\n\n// Base64 encode\nexport function base64Encode(bytes: Uint8Array): string {\n  if (typeof window !== 'undefined') {\n    return btoa(String.fromCharCode(...bytes));\n  }\n  return Buffer.from(bytes).toString('base64');\n}\n\n// Base64 decode\nexport function base64Decode(str: string): Uint8Array {\n  if (typeof window !== 'undefined') {\n    return Uint8Array.from(atob(str), (c) => c.charCodeAt(0));\n  }\n  return new Uint8Array(Buffer.from(str, 'base64'));\n}\n\n// Simple hash function (not cryptographically secure, for demo only)\nexport function simpleHash(data: Uint8Array): string {\n  let hash = 0;\n  for (let i = 0; i < data.length; i++) {\n    hash = ((hash << 5) - hash + data[i]) | 0;\n  }\n  return Math.abs(hash).toString(16).padStart(8, '0');\n}\n\n// Generate a key ID (UUID-like)\nexport function generateKeyId(): string {\n  const bytes = generateKey(16);\n  const hex = bytesToHex(bytes);\n  return `${hex.slice(0, 8)}-${hex.slice(8, 12)}-${hex.slice(12, 16)}-${hex.slice(16, 20)}-${hex.slice(20, 32)}`;\n}\n\n// AES-like block cipher simulation (simplified for education)\nexport class SimpleCipher {\n  private key: Uint8Array;\n  private iv: Uint8Array;\n\n  constructor(key: Uint8Array, iv?: Uint8Array) {\n    this.key = key;\n    this.iv = iv || generateKey(16);\n  }\n\n  // Simulated CTR mode encryption\n  encryptCTR(plaintext: Uint8Array): { ciphertext: Uint8Array; iv: Uint8Array } {\n    const ciphertext = new Uint8Array(plaintext.length);\n    const blockSize = 16;\n\n    for (let i = 0; i < plaintext.length; i += blockSize) {\n      // Create counter block\n      const counter = new Uint8Array(blockSize);\n      counter.set(this.iv.slice(0, 8), 0);\n      const blockNum = Math.floor(i / blockSize);\n      for (let j = 0; j < 8; j++) {\n        counter[8 + j] = (blockNum >> (8 * (7 - j))) & 0xff;\n      }\n\n      // \"Encrypt\" counter with key (simplified - just XOR in real AES this is block cipher)\n      const keystream = xorEncrypt(counter, this.key);\n\n      // XOR plaintext with keystream\n      const blockEnd = Math.min(i + blockSize, plaintext.length);\n      for (let j = i; j < blockEnd; j++) {\n        ciphertext[j] = plaintext[j] ^ keystream[j - i];\n      }\n    }\n\n    return { ciphertext, iv: this.iv };\n  }\n\n  decryptCTR(ciphertext: Uint8Array): Uint8Array {\n    // CTR mode is symmetric\n    return this.encryptCTR(ciphertext).ciphertext;\n  }\n\n  getIV(): Uint8Array {\n    return this.iv;\n  }\n}\n\n// Simulated RSA-like asymmetric operations (NOT SECURE - for demo only)\nexport class SimpleAsymmetric {\n  private privateKey: number;\n  private publicKey: number;\n  private modulus: number;\n\n  constructor() {\n    // Use small primes for demonstration (real RSA uses 2048+ bit primes)\n    const p = 61;\n    const q = 53;\n    this.modulus = p * q; // 3233\n    const phi = (p - 1) * (q - 1); // 3120\n    this.publicKey = 17; // Common choice\n    this.privateKey = this.modInverse(this.publicKey, phi); // 2753\n  }\n\n  private modInverse(a: number, m: number): number {\n    let [old_r, r] = [a, m];\n    let [old_s, s] = [1, 0];\n\n    while (r !== 0) {\n      const q = Math.floor(old_r / r);\n      [old_r, r] = [r, old_r - q * r];\n      [old_s, s] = [s, old_s - q * s];\n    }\n\n    return ((old_s % m) + m) % m;\n  }\n\n  private modPow(base: number, exp: number, mod: number): number {\n    let result = 1;\n    base = base % mod;\n    while (exp > 0) {\n      if (exp % 2 === 1) {\n        result = (result * base) % mod;\n      }\n      exp = Math.floor(exp / 2);\n      base = (base * base) % mod;\n    }\n    return result;\n  }\n\n  // Encrypt a single byte (demo only - real RSA encrypts blocks)\n  encrypt(byte: number): number {\n    return this.modPow(byte, this.publicKey, this.modulus);\n  }\n\n  // Decrypt a single value\n  decrypt(encrypted: number): number {\n    return this.modPow(encrypted, this.privateKey, this.modulus);\n  }\n\n  // Encrypt bytes (very simplified)\n  encryptBytes(data: Uint8Array): number[] {\n    return Array.from(data).map((b) => this.encrypt(b));\n  }\n\n  // Decrypt to bytes\n  decryptBytes(encrypted: number[]): Uint8Array {\n    return new Uint8Array(encrypted.map((e) => this.decrypt(e)));\n  }\n\n  getPublicKey(): { e: number; n: number } {\n    return { e: this.publicKey, n: this.modulus };\n  }\n\n  // Sign data (hash and encrypt with private key)\n  sign(data: Uint8Array): string {\n    const hash = simpleHash(data);\n    const hashBytes = stringToBytes(hash);\n    const signature = Array.from(hashBytes).map((b) =>\n      this.modPow(b, this.privateKey, this.modulus)\n    );\n    return signature.join(',');\n  }\n\n  // Verify signature\n  verify(data: Uint8Array, signature: string): boolean {\n    const hash = simpleHash(data);\n    const sigParts = signature.split(',').map(Number);\n    const decrypted = sigParts.map((s) =>\n      this.modPow(s, this.publicKey, this.modulus)\n    );\n    const recovered = bytesToString(new Uint8Array(decrypted));\n    return recovered === hash;\n  }\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 691, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/lib/drm/mock-cdm.ts"],"sourcesContent":["/**\n * Mock Content Decryption Module (CDM)\n * Simulates the behavior of Widevine/FairPlay/PlayReady CDM\n * FOR EDUCATIONAL PURPOSES ONLY\n */\n\nimport {\n  generateKey,\n  generateKeyId,\n  bytesToHex,\n  hexToBytes,\n  base64Encode,\n  base64Decode,\n  stringToBytes,\n  bytesToString,\n  SimpleCipher,\n  SimpleAsymmetric,\n  simpleHash,\n} from './crypto';\n\nexport type SecurityLevel = 'L1' | 'L2' | 'L3';\n\nexport interface DeviceCertificate {\n  deviceId: string;\n  securityLevel: SecurityLevel;\n  publicKey: { e: number; n: number };\n  manufacturer: string;\n  model: string;\n  timestamp: number;\n  signature: string;\n}\n\nexport interface LicenseChallenge {\n  version: number;\n  deviceCertificate: DeviceCertificate;\n  keyIds: string[];\n  sessionId: string;\n  nonce: string;\n  timestamp: number;\n  signature: string;\n}\n\nexport interface ContentKey {\n  keyId: string;\n  key: string; // Base64 encoded\n  iv: string; // Base64 encoded\n  type: 'CONTENT' | 'SIGNING';\n}\n\nexport interface LicenseResponse {\n  version: number;\n  sessionId: string;\n  keys: ContentKey[];\n  policy: {\n    canPlay: boolean;\n    canPersist: boolean;\n    licenseDuration: number;\n    playbackDuration: number;\n    renewalDelay: number;\n  };\n  serverNonce: string;\n  timestamp: number;\n  signature: string;\n}\n\nexport interface CDMSession {\n  sessionId: string;\n  keyIds: string[];\n  keys: Map<string, Uint8Array>;\n  state: 'created' | 'pending' | 'active' | 'expired' | 'closed';\n  createdAt: number;\n  expiresAt: number | null;\n}\n\nexport interface CDMEvents {\n  onSessionCreated?: (session: CDMSession) => void;\n  onSessionUpdated?: (session: CDMSession) => void;\n  onSessionClosed?: (sessionId: string) => void;\n  onKeyAdded?: (sessionId: string, keyId: string) => void;\n  onError?: (error: Error) => void;\n  onLog?: (message: string, data?: unknown) => void;\n}\n\n/**\n * Mock CDM implementation\n * Simulates L1/L2/L3 security levels with educational visibility\n */\nexport class MockCDM {\n  private deviceId: string;\n  private securityLevel: SecurityLevel;\n  private asymmetric: SimpleAsymmetric;\n  private sessions: Map<string, CDMSession>;\n  private events: CDMEvents;\n  private manufacturer: string;\n  private model: string;\n\n  constructor(\n    securityLevel: SecurityLevel = 'L3',\n    events: CDMEvents = {},\n    options?: { manufacturer?: string; model?: string }\n  ) {\n    this.securityLevel = securityLevel;\n    this.deviceId = generateKeyId();\n    this.asymmetric = new SimpleAsymmetric();\n    this.sessions = new Map();\n    this.events = events;\n    this.manufacturer = options?.manufacturer || 'Mock Devices Inc';\n    this.model = options?.model || `MockCDM-${securityLevel}`;\n\n    this.log(`CDM initialized with security level ${securityLevel}`);\n  }\n\n  private log(message: string, data?: unknown) {\n    this.events.onLog?.(`[CDM] ${message}`, data);\n  }\n\n  /**\n   * Get device certificate for license requests\n   */\n  getDeviceCertificate(): DeviceCertificate {\n    const certData = {\n      deviceId: this.deviceId,\n      securityLevel: this.securityLevel,\n      publicKey: this.asymmetric.getPublicKey(),\n      manufacturer: this.manufacturer,\n      model: this.model,\n      timestamp: Date.now(),\n    };\n\n    // Sign certificate\n    const signature = this.asymmetric.sign(\n      stringToBytes(JSON.stringify(certData))\n    );\n\n    return {\n      ...certData,\n      signature,\n    };\n  }\n\n  /**\n   * Create a new session for license acquisition\n   */\n  createSession(keyIds: string[]): CDMSession {\n    const sessionId = generateKeyId();\n    const session: CDMSession = {\n      sessionId,\n      keyIds,\n      keys: new Map(),\n      state: 'created',\n      createdAt: Date.now(),\n      expiresAt: null,\n    };\n\n    this.sessions.set(sessionId, session);\n    this.log(`Session created: ${sessionId}`, { keyIds });\n    this.events.onSessionCreated?.(session);\n\n    return session;\n  }\n\n  /**\n   * Generate license challenge (request)\n   */\n  generateLicenseChallenge(sessionId: string): LicenseChallenge {\n    const session = this.sessions.get(sessionId);\n    if (!session) {\n      throw new Error(`Session not found: ${sessionId}`);\n    }\n\n    session.state = 'pending';\n    this.events.onSessionUpdated?.(session);\n\n    const challenge: Omit<LicenseChallenge, 'signature'> = {\n      version: 1,\n      deviceCertificate: this.getDeviceCertificate(),\n      keyIds: session.keyIds,\n      sessionId,\n      nonce: bytesToHex(generateKey(16)),\n      timestamp: Date.now(),\n    };\n\n    // Sign the challenge\n    const signature = this.asymmetric.sign(\n      stringToBytes(JSON.stringify(challenge))\n    );\n\n    const signedChallenge: LicenseChallenge = {\n      ...challenge,\n      signature,\n    };\n\n    this.log('License challenge generated', { sessionId, keyIds: session.keyIds });\n    return signedChallenge;\n  }\n\n  /**\n   * Process license response and extract keys\n   */\n  processLicenseResponse(response: LicenseResponse): void {\n    const session = this.sessions.get(response.sessionId);\n    if (!session) {\n      throw new Error(`Session not found: ${response.sessionId}`);\n    }\n\n    this.log('Processing license response', { sessionId: response.sessionId });\n\n    // In a real CDM, keys would be encrypted with device public key\n    // Here we simulate extracting the keys\n    for (const keyData of response.keys) {\n      if (keyData.type === 'CONTENT') {\n        const key = base64Decode(keyData.key);\n        session.keys.set(keyData.keyId, key);\n        this.log(`Key added: ${keyData.keyId}`, {\n          keyLength: key.length,\n          // In L3, keys are visible in memory\n          keyHex: this.securityLevel === 'L3' ? bytesToHex(key) : '[PROTECTED]',\n        });\n        this.events.onKeyAdded?.(session.sessionId, keyData.keyId);\n      }\n    }\n\n    // Update session state\n    session.state = 'active';\n    if (response.policy.licenseDuration > 0) {\n      session.expiresAt = Date.now() + response.policy.licenseDuration * 1000;\n    }\n\n    this.events.onSessionUpdated?.(session);\n    this.log('Session activated', { sessionId: session.sessionId, keyCount: session.keys.size });\n  }\n\n  /**\n   * Decrypt content using stored keys\n   */\n  decrypt(sessionId: string, keyId: string, ciphertext: Uint8Array, iv: Uint8Array): Uint8Array {\n    const session = this.sessions.get(sessionId);\n    if (!session) {\n      throw new Error(`Session not found: ${sessionId}`);\n    }\n\n    if (session.state !== 'active') {\n      throw new Error(`Session not active: ${session.state}`);\n    }\n\n    const key = session.keys.get(keyId);\n    if (!key) {\n      throw new Error(`Key not found: ${keyId}`);\n    }\n\n    this.log('Decrypting content', {\n      sessionId,\n      keyId,\n      ciphertextLength: ciphertext.length,\n    });\n\n    // Decrypt using CTR mode\n    const cipher = new SimpleCipher(key, iv);\n    const plaintext = cipher.decryptCTR(ciphertext);\n\n    // Security level simulation\n    if (this.securityLevel === 'L1') {\n      this.log('L1: Decryption in hardware TEE - content protected');\n    } else if (this.securityLevel === 'L2') {\n      this.log('L2: Keys in hardware, decryption in software - partially protected');\n    } else {\n      this.log('L3: Full software decryption - content accessible in memory');\n    }\n\n    return plaintext;\n  }\n\n  /**\n   * Get session info\n   */\n  getSession(sessionId: string): CDMSession | undefined {\n    return this.sessions.get(sessionId);\n  }\n\n  /**\n   * Close a session\n   */\n  closeSession(sessionId: string): void {\n    const session = this.sessions.get(sessionId);\n    if (session) {\n      session.state = 'closed';\n      session.keys.clear();\n      this.sessions.delete(sessionId);\n      this.log('Session closed', { sessionId });\n      this.events.onSessionClosed?.(sessionId);\n    }\n  }\n\n  /**\n   * Get all active sessions\n   */\n  getSessions(): CDMSession[] {\n    return Array.from(this.sessions.values());\n  }\n\n  /**\n   * Get security level\n   */\n  getSecurityLevel(): SecurityLevel {\n    return this.securityLevel;\n  }\n\n  /**\n   * Get device ID\n   */\n  getDeviceId(): string {\n    return this.deviceId;\n  }\n\n  /**\n   * Simulate memory dump attack (only works on L3)\n   * Returns extracted keys if security level allows\n   */\n  simulateMemoryDump(): Map<string, string> | null {\n    if (this.securityLevel === 'L1') {\n      this.log('Memory dump blocked - L1 hardware protection');\n      return null;\n    }\n\n    if (this.securityLevel === 'L2') {\n      this.log('Memory dump partial - keys in hardware, but decrypted content accessible');\n      return null;\n    }\n\n    // L3 - keys are in software memory\n    this.log('VULNERABILITY: L3 memory dump successful - keys extracted!');\n    const extractedKeys = new Map<string, string>();\n\n    for (const session of this.sessions.values()) {\n      for (const [keyId, key] of session.keys) {\n        extractedKeys.set(keyId, bytesToHex(key));\n      }\n    }\n\n    return extractedKeys;\n  }\n}\n\nexport default MockCDM;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 919, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/lib/drm/mock-license-server.ts"],"sourcesContent":["/**\n * Mock License Server\n * Simulates DRM license server behavior for Widevine/FairPlay/PlayReady\n * FOR EDUCATIONAL PURPOSES ONLY\n */\n\nimport {\n  generateKey,\n  generateKeyId,\n  bytesToHex,\n  base64Encode,\n  base64Decode,\n  stringToBytes,\n  SimpleAsymmetric,\n} from './crypto';\nimport type {\n  DeviceCertificate,\n  LicenseChallenge,\n  LicenseResponse,\n  ContentKey,\n  SecurityLevel,\n} from './mock-cdm';\n\nexport interface ContentInfo {\n  contentId: string;\n  title: string;\n  keyId: string;\n  key: Uint8Array;\n  iv: Uint8Array;\n  requiredSecurityLevel: SecurityLevel;\n  policy: {\n    canPlay: boolean;\n    canPersist: boolean;\n    licenseDuration: number;\n    playbackDuration: number;\n    renewalDelay: number;\n  };\n}\n\nexport interface ServerEvents {\n  onLicenseRequest?: (challenge: LicenseChallenge) => void;\n  onLicenseIssued?: (response: LicenseResponse, contentInfo: ContentInfo) => void;\n  onLicenseDenied?: (reason: string, challenge: LicenseChallenge) => void;\n  onDeviceRevoked?: (deviceId: string) => void;\n  onLog?: (message: string, data?: unknown) => void;\n}\n\nexport interface LicenseServerConfig {\n  serverName: string;\n  enableSecurityCheck: boolean;\n  enableDeviceRevocation: boolean;\n  defaultPolicy: {\n    canPlay: boolean;\n    canPersist: boolean;\n    licenseDuration: number;\n    playbackDuration: number;\n    renewalDelay: number;\n  };\n}\n\nconst defaultConfig: LicenseServerConfig = {\n  serverName: 'Mock DRM License Server',\n  enableSecurityCheck: true,\n  enableDeviceRevocation: true,\n  defaultPolicy: {\n    canPlay: true,\n    canPersist: false,\n    licenseDuration: 86400, // 24 hours\n    playbackDuration: 14400, // 4 hours\n    renewalDelay: 3600, // 1 hour before expiry\n  },\n};\n\n/**\n * Mock License Server implementation\n */\nexport class MockLicenseServer {\n  private config: LicenseServerConfig;\n  private content: Map<string, ContentInfo>;\n  private revokedDevices: Set<string>;\n  private issuedLicenses: Map<string, { challenge: LicenseChallenge; response: LicenseResponse; timestamp: number }>;\n  private asymmetric: SimpleAsymmetric;\n  private events: ServerEvents;\n\n  constructor(config: Partial<LicenseServerConfig> = {}, events: ServerEvents = {}) {\n    this.config = { ...defaultConfig, ...config };\n    this.content = new Map();\n    this.revokedDevices = new Set();\n    this.issuedLicenses = new Map();\n    this.asymmetric = new SimpleAsymmetric();\n    this.events = events;\n\n    this.log('License server initialized', { serverName: this.config.serverName });\n  }\n\n  private log(message: string, data?: unknown) {\n    this.events.onLog?.(`[Server] ${message}`, data);\n  }\n\n  /**\n   * Register content for licensing\n   */\n  registerContent(\n    contentId: string,\n    title: string,\n    requiredSecurityLevel: SecurityLevel = 'L3',\n    customPolicy?: Partial<ContentInfo['policy']>\n  ): ContentInfo {\n    const keyId = generateKeyId();\n    const key = generateKey(16);\n    const iv = generateKey(16);\n\n    const contentInfo: ContentInfo = {\n      contentId,\n      title,\n      keyId,\n      key,\n      iv,\n      requiredSecurityLevel,\n      policy: {\n        ...this.config.defaultPolicy,\n        ...customPolicy,\n      },\n    };\n\n    this.content.set(contentId, contentInfo);\n    this.log('Content registered', {\n      contentId,\n      title,\n      keyId,\n      requiredSecurityLevel,\n    });\n\n    return contentInfo;\n  }\n\n  /**\n   * Get content info (without revealing key)\n   */\n  getContentInfo(contentId: string): Omit<ContentInfo, 'key'> | null {\n    const content = this.content.get(contentId);\n    if (!content) return null;\n\n    const { key, ...info } = content;\n    return info;\n  }\n\n  /**\n   * Get content key ID for a content\n   */\n  getKeyId(contentId: string): string | null {\n    return this.content.get(contentId)?.keyId || null;\n  }\n\n  /**\n   * Revoke a device\n   */\n  revokeDevice(deviceId: string): void {\n    this.revokedDevices.add(deviceId);\n    this.log('Device revoked', { deviceId });\n    this.events.onDeviceRevoked?.(deviceId);\n  }\n\n  /**\n   * Check if device is revoked\n   */\n  isDeviceRevoked(deviceId: string): boolean {\n    return this.revokedDevices.has(deviceId);\n  }\n\n  /**\n   * Validate license challenge\n   */\n  private validateChallenge(challenge: LicenseChallenge): { valid: boolean; reason?: string } {\n    // Check timestamp (allow 5 minute window)\n    const timeDiff = Math.abs(Date.now() - challenge.timestamp);\n    if (timeDiff > 5 * 60 * 1000) {\n      return { valid: false, reason: 'Challenge expired' };\n    }\n\n    // Check device certificate\n    const cert = challenge.deviceCertificate;\n    if (!cert.deviceId || !cert.securityLevel) {\n      return { valid: false, reason: 'Invalid device certificate' };\n    }\n\n    // Check if device is revoked\n    if (this.config.enableDeviceRevocation && this.isDeviceRevoked(cert.deviceId)) {\n      return { valid: false, reason: 'Device revoked' };\n    }\n\n    // Check key IDs\n    if (!challenge.keyIds || challenge.keyIds.length === 0) {\n      return { valid: false, reason: 'No key IDs requested' };\n    }\n\n    return { valid: true };\n  }\n\n  /**\n   * Check security level requirements\n   */\n  private checkSecurityLevel(\n    deviceLevel: SecurityLevel,\n    requiredLevel: SecurityLevel\n  ): boolean {\n    const levels: Record<SecurityLevel, number> = { L1: 3, L2: 2, L3: 1 };\n    return levels[deviceLevel] >= levels[requiredLevel];\n  }\n\n  /**\n   * Process license request and generate response\n   */\n  processLicenseRequest(\n    challenge: LicenseChallenge,\n    contentId: string\n  ): LicenseResponse | { error: string } {\n    this.log('Processing license request', {\n      sessionId: challenge.sessionId,\n      contentId,\n      deviceId: challenge.deviceCertificate.deviceId,\n      securityLevel: challenge.deviceCertificate.securityLevel,\n    });\n\n    this.events.onLicenseRequest?.(challenge);\n\n    // Validate challenge\n    const validation = this.validateChallenge(challenge);\n    if (!validation.valid) {\n      this.log('License request denied', { reason: validation.reason });\n      this.events.onLicenseDenied?.(validation.reason!, challenge);\n      return { error: validation.reason! };\n    }\n\n    // Get content\n    const content = this.content.get(contentId);\n    if (!content) {\n      const reason = 'Content not found';\n      this.log('License request denied', { reason });\n      this.events.onLicenseDenied?.(reason, challenge);\n      return { error: reason };\n    }\n\n    // Check security level\n    if (this.config.enableSecurityCheck) {\n      if (!this.checkSecurityLevel(challenge.deviceCertificate.securityLevel, content.requiredSecurityLevel)) {\n        const reason = `Security level too low. Required: ${content.requiredSecurityLevel}, Device: ${challenge.deviceCertificate.securityLevel}`;\n        this.log('License request denied', { reason });\n        this.events.onLicenseDenied?.(reason, challenge);\n        return { error: reason };\n      }\n    }\n\n    // Generate license response\n    const keys: ContentKey[] = [\n      {\n        keyId: content.keyId,\n        key: base64Encode(content.key),\n        iv: base64Encode(content.iv),\n        type: 'CONTENT',\n      },\n    ];\n\n    const responseData: Omit<LicenseResponse, 'signature'> = {\n      version: 1,\n      sessionId: challenge.sessionId,\n      keys,\n      policy: content.policy,\n      serverNonce: bytesToHex(generateKey(16)),\n      timestamp: Date.now(),\n    };\n\n    // Sign response\n    const signature = this.asymmetric.sign(stringToBytes(JSON.stringify(responseData)));\n\n    const response: LicenseResponse = {\n      ...responseData,\n      signature,\n    };\n\n    // Store issued license\n    this.issuedLicenses.set(challenge.sessionId, {\n      challenge,\n      response,\n      timestamp: Date.now(),\n    });\n\n    this.log('License issued', {\n      sessionId: challenge.sessionId,\n      contentId,\n      keyId: content.keyId,\n    });\n    this.events.onLicenseIssued?.(response, content);\n\n    return response;\n  }\n\n  /**\n   * Get issued license by session ID\n   */\n  getIssuedLicense(sessionId: string) {\n    return this.issuedLicenses.get(sessionId);\n  }\n\n  /**\n   * Get all registered content\n   */\n  getAllContent(): Map<string, Omit<ContentInfo, 'key'>> {\n    const result = new Map<string, Omit<ContentInfo, 'key'>>();\n    for (const [id, content] of this.content) {\n      const { key, ...info } = content;\n      result.set(id, info);\n    }\n    return result;\n  }\n\n  /**\n   * Get content with key (for simulation/attack demos)\n   */\n  getContentWithKey(contentId: string): ContentInfo | null {\n    return this.content.get(contentId) || null;\n  }\n\n  /**\n   * Get server stats\n   */\n  getStats() {\n    return {\n      serverName: this.config.serverName,\n      registeredContent: this.content.size,\n      issuedLicenses: this.issuedLicenses.size,\n      revokedDevices: this.revokedDevices.size,\n    };\n  }\n}\n\nexport default MockLicenseServer;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1187, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/components/labs/attacks/CDMExtractionLab.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useCallback } from 'react';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Alert, AlertDescription, AlertTitle } from '@/components/ui/alert';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { ScrollArea } from '@/components/ui/scroll-area';\nimport { Separator } from '@/components/ui/separator';\nimport {\n  Play,\n  AlertTriangle,\n  Shield,\n  Sword,\n  Cpu,\n  HardDrive,\n  Key,\n  Lock,\n  Unlock,\n  CheckCircle2,\n  XCircle,\n  Terminal,\n  Bug,\n} from 'lucide-react';\nimport { usePerspective } from '@/providers/PerspectiveProvider';\nimport { MockCDM, type SecurityLevel } from '@/lib/drm/mock-cdm';\nimport { MockLicenseServer } from '@/lib/drm/mock-license-server';\nimport { bytesToHex } from '@/lib/drm/crypto';\n\ninterface AttackStep {\n  id: string;\n  title: string;\n  description: string;\n  status: 'pending' | 'running' | 'success' | 'failed' | 'blocked';\n  details?: string;\n}\n\ninterface AttackLog {\n  timestamp: number;\n  type: 'info' | 'warning' | 'success' | 'error' | 'attack';\n  message: string;\n  data?: unknown;\n}\n\nexport function CDMExtractionLab() {\n  const { perspective } = usePerspective();\n  const [targetLevel, setTargetLevel] = useState<SecurityLevel>('L3');\n  const [attackSteps, setAttackSteps] = useState<AttackStep[]>([\n    { id: 'identify', title: 'Identify CDM Type', description: 'Detect Widevine CDM version and security level', status: 'pending' },\n    { id: 'locate', title: 'Locate CDM Binary', description: 'Find CDM library in browser/device memory', status: 'pending' },\n    { id: 'attach', title: 'Attach Debugger', description: 'Attach to process and set breakpoints', status: 'pending' },\n    { id: 'intercept', title: 'Intercept License', description: 'Capture license response before processing', status: 'pending' },\n    { id: 'extract', title: 'Extract Keys', description: 'Dump decryption keys from memory', status: 'pending' },\n    { id: 'verify', title: 'Verify Keys', description: 'Test extracted keys against encrypted content', status: 'pending' },\n  ]);\n  const [logs, setLogs] = useState<AttackLog[]>([]);\n  const [isRunning, setIsRunning] = useState(false);\n  const [extractedKeys, setExtractedKeys] = useState<Map<string, string> | null>(null);\n\n  const addLog = useCallback((type: AttackLog['type'], message: string, data?: unknown) => {\n    setLogs(prev => [...prev, { timestamp: Date.now(), type, message, data }]);\n  }, []);\n\n  const updateStep = useCallback((stepId: string, status: AttackStep['status'], details?: string) => {\n    setAttackSteps(prev => prev.map(step =>\n      step.id === stepId ? { ...step, status, details } : step\n    ));\n  }, []);\n\n  const delay = (ms: number) => new Promise(resolve => setTimeout(resolve, ms));\n\n  const runAttack = async () => {\n    setIsRunning(true);\n    setExtractedKeys(null);\n    setAttackSteps(prev => prev.map(s => ({ ...s, status: 'pending', details: undefined })));\n    setLogs([]);\n\n    addLog('info', `Starting CDM extraction attack against ${targetLevel} device...`);\n    addLog('warning', 'This is a simulation for educational purposes only');\n\n    // Create mock CDM and license server\n    const cdm = new MockCDM(targetLevel, {\n      onLog: (msg, data) => addLog('info', msg, data),\n    });\n    const server = new MockLicenseServer({}, {\n      onLog: (msg, data) => addLog('info', msg, data),\n    });\n\n    // Register test content\n    const content = server.registerContent('test-movie', 'Test Movie', targetLevel);\n    addLog('info', `Target content: ${content.title} (KeyID: ${content.keyId})`);\n\n    // Step 1: Identify CDM\n    updateStep('identify', 'running');\n    await delay(1000);\n    addLog('attack', `Detected CDM: Widevine ${targetLevel}`);\n    addLog('info', `Device ID: ${cdm.getDeviceId()}`);\n    updateStep('identify', 'success', `Widevine ${targetLevel} detected`);\n\n    // Step 2: Locate CDM Binary\n    updateStep('locate', 'running');\n    await delay(1200);\n    if (targetLevel === 'L1') {\n      addLog('error', 'CDM binary protected by hardware TEE - cannot locate in memory');\n      updateStep('locate', 'blocked', 'Hardware TEE protection active');\n      addLog('warning', 'Attack blocked: L1 hardware protection prevents memory access');\n      setIsRunning(false);\n      return;\n    }\n    addLog('attack', 'Located libwidevinecdm.so in process memory');\n    addLog('info', 'Base address: 0x7f4a8c000000');\n    updateStep('locate', 'success', 'CDM library located at 0x7f4a8c000000');\n\n    // Step 3: Attach Debugger\n    updateStep('attach', 'running');\n    await delay(800);\n    if (targetLevel === 'L2') {\n      addLog('warning', 'L2 protection: Keys stored in hardware, but decryption in software');\n      addLog('info', 'Can intercept decrypted content, but not extract raw keys');\n    }\n    addLog('attack', 'Debugger attached to CDM process');\n    addLog('info', 'Set breakpoint at Cdm_Decrypt function');\n    updateStep('attach', 'success', 'Debugger attached, breakpoints set');\n\n    // Step 4: Intercept License\n    updateStep('intercept', 'running');\n    await delay(1500);\n\n    // Perform actual license acquisition\n    const session = cdm.createSession([content.keyId]);\n    const challenge = cdm.generateLicenseChallenge(session.sessionId);\n    addLog('attack', 'Intercepted license challenge');\n\n    const response = server.processLicenseRequest(challenge, content.contentId);\n    if ('error' in response) {\n      addLog('error', `License request failed: ${response.error}`);\n      updateStep('intercept', 'failed', response.error);\n      setIsRunning(false);\n      return;\n    }\n\n    cdm.processLicenseResponse(response);\n    addLog('attack', 'Intercepted license response with encrypted keys');\n    addLog('info', `Session ID: ${session.sessionId}`);\n    updateStep('intercept', 'success', 'License response captured');\n\n    // Step 5: Extract Keys\n    updateStep('extract', 'running');\n    await delay(1000);\n\n    const keys = cdm.simulateMemoryDump();\n    if (!keys) {\n      addLog('error', 'Memory dump blocked by hardware protection');\n      updateStep('extract', 'blocked', 'Hardware protection active');\n      if (targetLevel === 'L2') {\n        addLog('warning', 'L2: Keys protected in hardware security module');\n        addLog('info', 'Alternative: Intercept decrypted frames instead of keys');\n      }\n      setIsRunning(false);\n      return;\n    }\n\n    addLog('attack', `VULNERABILITY EXPLOITED: ${keys.size} key(s) extracted from memory!`);\n    keys.forEach((key, keyId) => {\n      addLog('success', `Key ID: ${keyId}`);\n      addLog('success', `Key: ${key}`);\n    });\n    setExtractedKeys(keys);\n    updateStep('extract', 'success', `${keys.size} key(s) extracted`);\n\n    // Step 6: Verify Keys\n    updateStep('verify', 'running');\n    await delay(800);\n    addLog('attack', 'Testing extracted keys against encrypted content...');\n    addLog('success', 'Keys verified - content can be decrypted!');\n    updateStep('verify', 'success', 'Keys working');\n\n    addLog('success', 'Attack completed successfully');\n    addLog('warning', 'This demonstrates why L3 devices are vulnerable to key extraction');\n    setIsRunning(false);\n  };\n\n  const getStepIcon = (status: AttackStep['status']) => {\n    switch (status) {\n      case 'pending': return <div className=\"w-4 h-4 rounded-full border-2 border-muted-foreground\" />;\n      case 'running': return <div className=\"w-4 h-4 rounded-full border-2 border-primary animate-pulse bg-primary/20\" />;\n      case 'success': return <CheckCircle2 className=\"w-4 h-4 text-green-500\" />;\n      case 'failed': return <XCircle className=\"w-4 h-4 text-red-500\" />;\n      case 'blocked': return <Shield className=\"w-4 h-4 text-blue-500\" />;\n    }\n  };\n\n  const getLogIcon = (type: AttackLog['type']) => {\n    switch (type) {\n      case 'info': return <Terminal className=\"w-3 h-3 text-muted-foreground\" />;\n      case 'warning': return <AlertTriangle className=\"w-3 h-3 text-yellow-500\" />;\n      case 'success': return <CheckCircle2 className=\"w-3 h-3 text-green-500\" />;\n      case 'error': return <XCircle className=\"w-3 h-3 text-red-500\" />;\n      case 'attack': return <Bug className=\"w-3 h-3 text-red-400\" />;\n    }\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-2xl font-bold flex items-center gap-2\">\n            <Cpu className=\"w-6 h-6 text-red-500\" />\n            CDM Extraction Attack\n          </h1>\n          <p className=\"text-muted-foreground mt-1\">\n            Simulate Content Decryption Module key extraction attack\n          </p>\n        </div>\n        <Badge variant={perspective === 'red-team' ? 'destructive' : 'default'}>\n          {perspective === 'red-team' ? 'Attack Mode' : 'Defense Analysis'}\n        </Badge>\n      </div>\n\n      <Alert variant=\"destructive\">\n        <AlertTriangle className=\"h-4 w-4\" />\n        <AlertTitle>Educational Simulation Only</AlertTitle>\n        <AlertDescription>\n          This simulates a CDM memory dump attack for educational purposes.\n          Actual attacks against production DRM systems are illegal.\n        </AlertDescription>\n      </Alert>\n\n      <Tabs defaultValue=\"attack\" className=\"space-y-4\">\n        <TabsList>\n          <TabsTrigger value=\"attack\" className=\"gap-2\">\n            <Sword className=\"w-4 h-4\" />\n            Attack Simulation\n          </TabsTrigger>\n          <TabsTrigger value=\"defense\" className=\"gap-2\">\n            <Shield className=\"w-4 h-4\" />\n            Defense Analysis\n          </TabsTrigger>\n          <TabsTrigger value=\"technical\" className=\"gap-2\">\n            <Terminal className=\"w-4 h-4\" />\n            Technical Details\n          </TabsTrigger>\n        </TabsList>\n\n        <TabsContent value=\"attack\" className=\"space-y-4\">\n          <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-4\">\n            {/* Attack Configuration */}\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"text-lg\">Target Configuration</CardTitle>\n                <CardDescription>Select target device security level</CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"space-y-2\">\n                  <label className=\"text-sm font-medium\">Security Level</label>\n                  <div className=\"flex gap-2\">\n                    {(['L1', 'L2', 'L3'] as SecurityLevel[]).map((level) => (\n                      <Button\n                        key={level}\n                        variant={targetLevel === level ? 'default' : 'outline'}\n                        size=\"sm\"\n                        onClick={() => setTargetLevel(level)}\n                        disabled={isRunning}\n                        className=\"flex-1\"\n                      >\n                        {level}\n                      </Button>\n                    ))}\n                  </div>\n                </div>\n\n                <div className=\"rounded-lg border p-3 bg-muted/50\">\n                  <div className=\"flex items-center gap-2 mb-2\">\n                    {targetLevel === 'L1' && <Lock className=\"w-4 h-4 text-green-500\" />}\n                    {targetLevel === 'L2' && <Key className=\"w-4 h-4 text-yellow-500\" />}\n                    {targetLevel === 'L3' && <Unlock className=\"w-4 h-4 text-red-500\" />}\n                    <span className=\"font-medium\">{targetLevel} Protection</span>\n                  </div>\n                  <p className=\"text-xs text-muted-foreground\">\n                    {targetLevel === 'L1' && 'Hardware TEE protection - keys never exposed'}\n                    {targetLevel === 'L2' && 'Keys in hardware, decryption in software'}\n                    {targetLevel === 'L3' && 'Full software - vulnerable to memory attacks'}\n                  </p>\n                </div>\n\n                <Button\n                  onClick={runAttack}\n                  disabled={isRunning}\n                  className=\"w-full gap-2\"\n                  variant=\"destructive\"\n                >\n                  <Play className=\"w-4 h-4\" />\n                  {isRunning ? 'Attack Running...' : 'Launch Attack'}\n                </Button>\n              </CardContent>\n            </Card>\n\n            {/* Attack Steps */}\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"text-lg\">Attack Progress</CardTitle>\n                <CardDescription>Step-by-step extraction process</CardDescription>\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-3\">\n                  {attackSteps.map((step, index) => (\n                    <div key={step.id} className=\"flex items-start gap-3\">\n                      <div className=\"mt-0.5\">{getStepIcon(step.status)}</div>\n                      <div className=\"flex-1 min-w-0\">\n                        <div className=\"flex items-center gap-2\">\n                          <span className=\"text-xs text-muted-foreground\">{index + 1}.</span>\n                          <span className=\"font-medium text-sm\">{step.title}</span>\n                        </div>\n                        <p className=\"text-xs text-muted-foreground\">{step.description}</p>\n                        {step.details && (\n                          <p className=\"text-xs mt-1 text-primary\">{step.details}</p>\n                        )}\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              </CardContent>\n            </Card>\n\n            {/* Results */}\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"text-lg\">Extracted Keys</CardTitle>\n                <CardDescription>Keys recovered from memory</CardDescription>\n              </CardHeader>\n              <CardContent>\n                {extractedKeys ? (\n                  <div className=\"space-y-3\">\n                    {Array.from(extractedKeys.entries()).map(([keyId, key]) => (\n                      <div key={keyId} className=\"rounded-lg border border-red-500/50 bg-red-500/10 p-3\">\n                        <div className=\"flex items-center gap-2 mb-2\">\n                          <Key className=\"w-4 h-4 text-red-500\" />\n                          <span className=\"text-sm font-medium text-red-400\">Key Extracted</span>\n                        </div>\n                        <div className=\"space-y-1\">\n                          <div className=\"text-xs\">\n                            <span className=\"text-muted-foreground\">Key ID: </span>\n                            <code className=\"text-xs bg-background px-1 rounded\">{keyId}</code>\n                          </div>\n                          <div className=\"text-xs\">\n                            <span className=\"text-muted-foreground\">Key: </span>\n                            <code className=\"text-xs bg-background px-1 rounded break-all\">{key}</code>\n                          </div>\n                        </div>\n                      </div>\n                    ))}\n                    <Alert variant=\"destructive\" className=\"mt-4\">\n                      <AlertTriangle className=\"h-4 w-4\" />\n                      <AlertDescription className=\"text-xs\">\n                        In a real attack, these keys could decrypt all protected content.\n                      </AlertDescription>\n                    </Alert>\n                  </div>\n                ) : (\n                  <div className=\"text-center py-8 text-muted-foreground\">\n                    <HardDrive className=\"w-8 h-8 mx-auto mb-2 opacity-50\" />\n                    <p className=\"text-sm\">No keys extracted yet</p>\n                    <p className=\"text-xs\">Run the attack to attempt extraction</p>\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n          </div>\n\n          {/* Attack Log */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"text-lg\">Attack Log</CardTitle>\n              <CardDescription>Real-time attack output</CardDescription>\n            </CardHeader>\n            <CardContent>\n              <ScrollArea className=\"h-[200px] rounded-lg border bg-zinc-950 p-3\">\n                {logs.length === 0 ? (\n                  <div className=\"text-center text-muted-foreground text-sm py-8\">\n                    Launch attack to see output...\n                  </div>\n                ) : (\n                  <div className=\"space-y-1 font-mono text-xs\">\n                    {logs.map((log, i) => (\n                      <div key={i} className=\"flex items-start gap-2\">\n                        <span className=\"text-muted-foreground\">\n                          {new Date(log.timestamp).toLocaleTimeString()}\n                        </span>\n                        {getLogIcon(log.type)}\n                        <span className={\n                          log.type === 'error' ? 'text-red-400' :\n                          log.type === 'warning' ? 'text-yellow-400' :\n                          log.type === 'success' ? 'text-green-400' :\n                          log.type === 'attack' ? 'text-red-400' :\n                          'text-muted-foreground'\n                        }>\n                          {log.message}\n                        </span>\n                      </div>\n                    ))}\n                  </div>\n                )}\n              </ScrollArea>\n            </CardContent>\n          </Card>\n        </TabsContent>\n\n        <TabsContent value=\"defense\" className=\"space-y-4\">\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Shield className=\"w-5 h-5 text-blue-500\" />\n                  Prevention Strategies\n                </CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"space-y-3\">\n                  <div className=\"p-3 rounded-lg border bg-green-500/10 border-green-500/30\">\n                    <h4 className=\"font-medium text-green-400 mb-1\">Use L1 Security Level</h4>\n                    <p className=\"text-xs text-muted-foreground\">\n                      Hardware TEE protection prevents any software-based key extraction.\n                      Keys never exist in accessible memory.\n                    </p>\n                  </div>\n                  <div className=\"p-3 rounded-lg border bg-blue-500/10 border-blue-500/30\">\n                    <h4 className=\"font-medium text-blue-400 mb-1\">Anti-Debugging Measures</h4>\n                    <p className=\"text-xs text-muted-foreground\">\n                      Implement ptrace detection, timing checks, and integrity verification\n                      to detect and prevent debugger attachment.\n                    </p>\n                  </div>\n                  <div className=\"p-3 rounded-lg border bg-purple-500/10 border-purple-500/30\">\n                    <h4 className=\"font-medium text-purple-400 mb-1\">Code Obfuscation</h4>\n                    <p className=\"text-xs text-muted-foreground\">\n                      Obfuscate CDM code paths and key handling routines to make\n                      reverse engineering more difficult.\n                    </p>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <AlertTriangle className=\"w-5 h-5 text-yellow-500\" />\n                  Detection Methods\n                </CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"space-y-3\">\n                  <div className=\"p-3 rounded-lg border\">\n                    <h4 className=\"font-medium mb-1\">Device Attestation</h4>\n                    <p className=\"text-xs text-muted-foreground\">\n                      Verify device integrity before issuing licenses. Detect rooted/jailbroken\n                      devices that may have compromised CDMs.\n                    </p>\n                  </div>\n                  <div className=\"p-3 rounded-lg border\">\n                    <h4 className=\"font-medium mb-1\">Anomaly Detection</h4>\n                    <p className=\"text-xs text-muted-foreground\">\n                      Monitor for unusual patterns: same device ID requesting many different\n                      content licenses, impossible playback speeds, etc.\n                    </p>\n                  </div>\n                  <div className=\"p-3 rounded-lg border\">\n                    <h4 className=\"font-medium mb-1\">Forensic Watermarking</h4>\n                    <p className=\"text-xs text-muted-foreground\">\n                      Embed unique identifiers in content that survive re-encoding,\n                      enabling leak source identification.\n                    </p>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n        </TabsContent>\n\n        <TabsContent value=\"technical\" className=\"space-y-4\">\n          <Card>\n            <CardHeader>\n              <CardTitle>Technical Background</CardTitle>\n              <CardDescription>How CDM extraction attacks work</CardDescription>\n            </CardHeader>\n            <CardContent className=\"prose prose-invert max-w-none\">\n              <div className=\"space-y-4 text-sm\">\n                <div>\n                  <h4 className=\"font-medium mb-2\">Attack Vector</h4>\n                  <p className=\"text-muted-foreground\">\n                    CDM extraction attacks target the Content Decryption Module, which is responsible\n                    for receiving encrypted keys from a license server and using them to decrypt\n                    protected content. In L3 (software-only) implementations, these keys exist\n                    unprotected in process memory during playback.\n                  </p>\n                </div>\n\n                <Separator />\n\n                <div>\n                  <h4 className=\"font-medium mb-2\">Tools Used (in real attacks)</h4>\n                  <ul className=\"list-disc pl-4 text-muted-foreground space-y-1\">\n                    <li>Frida - Dynamic instrumentation toolkit</li>\n                    <li>IDA Pro / Ghidra - Disassemblers for CDM binary analysis</li>\n                    <li>WideVine L3 Decryptor scripts</li>\n                    <li>Custom key extraction scripts</li>\n                  </ul>\n                </div>\n\n                <Separator />\n\n                <div>\n                  <h4 className=\"font-medium mb-2\">Why L1 is Secure</h4>\n                  <p className=\"text-muted-foreground\">\n                    L1 devices use a hardware Trusted Execution Environment (TEE) like ARM TrustZone\n                    or Intel SGX. The keys are decrypted inside the TEE and never exposed to the\n                    main processor or operating system. Even with root access, the keys cannot be\n                    extracted through software means.\n                  </p>\n                </div>\n\n                <Separator />\n\n                <div>\n                  <h4 className=\"font-medium mb-2\">Impact of Compromise</h4>\n                  <p className=\"text-muted-foreground\">\n                    When an L3 CDM is compromised, attackers can extract keys for any content\n                    licensed to that device. These keys can then be shared or used to create\n                    pirated copies of protected content. This is why premium 4K content is\n                    typically restricted to L1 devices only.\n                  </p>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        </TabsContent>\n      </Tabs>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}