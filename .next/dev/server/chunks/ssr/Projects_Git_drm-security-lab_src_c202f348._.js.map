{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/lib/utils.ts"],"sourcesContent":["import { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,SAAS,GAAG,GAAG,MAAoB;IACxC,OAAO,IAAA,mNAAO,EAAC,IAAA,0LAAI,EAAC;AACtB"}},
    {"offset": {"line": 19, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/components/ui/card.tsx"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Card({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card\"\n      className={cn(\n        \"bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-header\"\n      className={cn(\n        \"@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardTitle({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-title\"\n      className={cn(\"leading-none font-semibold\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardDescription({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-description\"\n      className={cn(\"text-muted-foreground text-sm\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardAction({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-action\"\n      className={cn(\n        \"col-start-2 row-span-2 row-start-1 self-start justify-self-end\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-content\"\n      className={cn(\"px-6\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-footer\"\n      className={cn(\"flex items-center px-6 [.border-t]:pt-6\", className)}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Card,\n  CardHeader,\n  CardFooter,\n  CardTitle,\n  CardAction,\n  CardDescription,\n  CardContent,\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAEA;;;AAEA,SAAS,KAAK,EAAE,SAAS,EAAE,GAAG,OAAoC;IAChE,qBACE,2RAAC;QACC,aAAU;QACV,WAAW,IAAA,sKAAE,EACX,qFACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,2RAAC;QACC,aAAU;QACV,WAAW,IAAA,sKAAE,EACX,4JACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,UAAU,EAAE,SAAS,EAAE,GAAG,OAAoC;IACrE,qBACE,2RAAC;QACC,aAAU;QACV,WAAW,IAAA,sKAAE,EAAC,8BAA8B;QAC3C,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,gBAAgB,EAAE,SAAS,EAAE,GAAG,OAAoC;IAC3E,qBACE,2RAAC;QACC,aAAU;QACV,WAAW,IAAA,sKAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,2RAAC;QACC,aAAU;QACV,WAAW,IAAA,sKAAE,EACX,kEACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,YAAY,EAAE,SAAS,EAAE,GAAG,OAAoC;IACvE,qBACE,2RAAC;QACC,aAAU;QACV,WAAW,IAAA,sKAAE,EAAC,QAAQ;QACrB,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,2RAAC;QACC,aAAU;QACV,WAAW,IAAA,sKAAE,EAAC,2CAA2C;QACxD,GAAG,KAAK;;;;;;AAGf"}},
    {"offset": {"line": 121, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/components/ui/button.tsx"],"sourcesContent":["import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-primary text-primary-foreground hover:bg-primary/90\",\n        destructive:\n          \"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60\",\n        outline:\n          \"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50\",\n        secondary:\n          \"bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        ghost:\n          \"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50\",\n        link: \"text-primary underline-offset-4 hover:underline\",\n      },\n      size: {\n        default: \"h-9 px-4 py-2 has-[>svg]:px-3\",\n        sm: \"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5\",\n        lg: \"h-10 rounded-md px-6 has-[>svg]:px-4\",\n        icon: \"size-9\",\n        \"icon-sm\": \"size-8\",\n        \"icon-lg\": \"size-10\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nfunction Button({\n  className,\n  variant = \"default\",\n  size = \"default\",\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"button\"> &\n  VariantProps<typeof buttonVariants> & {\n    asChild?: boolean\n  }) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"button\"\n      data-variant={variant}\n      data-size={size}\n      className={cn(buttonVariants({ variant, size, className }))}\n      {...props}\n    />\n  )\n}\n\nexport { Button, buttonVariants }\n"],"names":[],"mappings":";;;;;;;AACA;AACA;AAEA;;;;;AAEA,MAAM,iBAAiB,IAAA,oNAAG,EACxB,+bACA;IACE,UAAU;QACR,SAAS;YACP,SAAS;YACT,aACE;YACF,SACE;YACF,WACE;YACF,OACE;YACF,MAAM;QACR;QACA,MAAM;YACJ,SAAS;YACT,IAAI;YACJ,IAAI;YACJ,MAAM;YACN,WAAW;YACX,WAAW;QACb;IACF;IACA,iBAAiB;QACf,SAAS;QACT,MAAM;IACR;AACF;AAGF,SAAS,OAAO,EACd,SAAS,EACT,UAAU,SAAS,EACnB,OAAO,SAAS,EAChB,UAAU,KAAK,EACf,GAAG,OAIF;IACD,MAAM,OAAO,UAAU,qNAAI,GAAG;IAE9B,qBACE,2RAAC;QACC,aAAU;QACV,gBAAc;QACd,aAAW;QACX,WAAW,IAAA,sKAAE,EAAC,eAAe;YAAE;YAAS;YAAM;QAAU;QACvD,GAAG,KAAK;;;;;;AAGf"}},
    {"offset": {"line": 182, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/components/ui/badge.tsx"],"sourcesContent":["import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  \"inline-flex items-center justify-center rounded-full border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90\",\n        secondary:\n          \"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90\",\n        destructive:\n          \"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60\",\n        outline:\n          \"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nfunction Badge({\n  className,\n  variant,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"span\"> &\n  VariantProps<typeof badgeVariants> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"span\"\n\n  return (\n    <Comp\n      data-slot=\"badge\"\n      className={cn(badgeVariants({ variant }), className)}\n      {...props}\n    />\n  )\n}\n\nexport { Badge, badgeVariants }\n"],"names":[],"mappings":";;;;;;;AACA;AACA;AAEA;;;;;AAEA,MAAM,gBAAgB,IAAA,oNAAG,EACvB,oZACA;IACE,UAAU;QACR,SAAS;YACP,SACE;YACF,WACE;YACF,aACE;YACF,SACE;QACJ;IACF;IACA,iBAAiB;QACf,SAAS;IACX;AACF;AAGF,SAAS,MAAM,EACb,SAAS,EACT,OAAO,EACP,UAAU,KAAK,EACf,GAAG,OAEuD;IAC1D,MAAM,OAAO,UAAU,qNAAI,GAAG;IAE9B,qBACE,2RAAC;QACC,aAAU;QACV,WAAW,IAAA,sKAAE,EAAC,cAAc;YAAE;QAAQ,IAAI;QACzC,GAAG,KAAK;;;;;;AAGf"}},
    {"offset": {"line": 228, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/components/ui/alert.tsx"],"sourcesContent":["import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst alertVariants = cva(\n  \"relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-card text-card-foreground\",\n        destructive:\n          \"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nfunction Alert({\n  className,\n  variant,\n  ...props\n}: React.ComponentProps<\"div\"> & VariantProps<typeof alertVariants>) {\n  return (\n    <div\n      data-slot=\"alert\"\n      role=\"alert\"\n      className={cn(alertVariants({ variant }), className)}\n      {...props}\n    />\n  )\n}\n\nfunction AlertTitle({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"alert-title\"\n      className={cn(\n        \"col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction AlertDescription({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"alert-description\"\n      className={cn(\n        \"text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Alert, AlertTitle, AlertDescription }\n"],"names":[],"mappings":";;;;;;;;;AACA;AAEA;;;;AAEA,MAAM,gBAAgB,IAAA,oNAAG,EACvB,qOACA;IACE,UAAU;QACR,SAAS;YACP,SAAS;YACT,aACE;QACJ;IACF;IACA,iBAAiB;QACf,SAAS;IACX;AACF;AAGF,SAAS,MAAM,EACb,SAAS,EACT,OAAO,EACP,GAAG,OAC8D;IACjE,qBACE,2RAAC;QACC,aAAU;QACV,MAAK;QACL,WAAW,IAAA,sKAAE,EAAC,cAAc;YAAE;QAAQ,IAAI;QACzC,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,2RAAC;QACC,aAAU;QACV,WAAW,IAAA,sKAAE,EACX,+DACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,iBAAiB,EACxB,SAAS,EACT,GAAG,OACyB;IAC5B,qBACE,2RAAC;QACC,aAAU;QACV,WAAW,IAAA,sKAAE,EACX,kGACA;QAED,GAAG,KAAK;;;;;;AAGf"}},
    {"offset": {"line": 294, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/components/ui/progress.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as ProgressPrimitive from \"@radix-ui/react-progress\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Progress({\n  className,\n  value,\n  ...props\n}: React.ComponentProps<typeof ProgressPrimitive.Root>) {\n  return (\n    <ProgressPrimitive.Root\n      data-slot=\"progress\"\n      className={cn(\n        \"bg-primary/20 relative h-2 w-full overflow-hidden rounded-full\",\n        className\n      )}\n      {...props}\n    >\n      <ProgressPrimitive.Indicator\n        data-slot=\"progress-indicator\"\n        className=\"bg-primary h-full w-full flex-1 transition-all\"\n        style={{ transform: `translateX(-${100 - (value || 0)}%)` }}\n      />\n    </ProgressPrimitive.Root>\n  )\n}\n\nexport { Progress }\n"],"names":[],"mappings":";;;;;AAGA;AAEA;AALA;;;;AAOA,SAAS,SAAS,EAChB,SAAS,EACT,KAAK,EACL,GAAG,OACiD;IACpD,qBACE,2RAAC,yNAAsB;QACrB,aAAU;QACV,WAAW,IAAA,sKAAE,EACX,kEACA;QAED,GAAG,KAAK;kBAET,cAAA,2RAAC,8NAA2B;YAC1B,aAAU;YACV,WAAU;YACV,OAAO;gBAAE,WAAW,CAAC,YAAY,EAAE,MAAM,CAAC,SAAS,CAAC,EAAE,EAAE,CAAC;YAAC;;;;;;;;;;;AAIlE"}},
    {"offset": {"line": 332, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/components/ui/scroll-area.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as ScrollAreaPrimitive from \"@radix-ui/react-scroll-area\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction ScrollArea({\n  className,\n  children,\n  ...props\n}: React.ComponentProps<typeof ScrollAreaPrimitive.Root>) {\n  return (\n    <ScrollAreaPrimitive.Root\n      data-slot=\"scroll-area\"\n      className={cn(\"relative\", className)}\n      {...props}\n    >\n      <ScrollAreaPrimitive.Viewport\n        data-slot=\"scroll-area-viewport\"\n        className=\"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1\"\n      >\n        {children}\n      </ScrollAreaPrimitive.Viewport>\n      <ScrollBar />\n      <ScrollAreaPrimitive.Corner />\n    </ScrollAreaPrimitive.Root>\n  )\n}\n\nfunction ScrollBar({\n  className,\n  orientation = \"vertical\",\n  ...props\n}: React.ComponentProps<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>) {\n  return (\n    <ScrollAreaPrimitive.ScrollAreaScrollbar\n      data-slot=\"scroll-area-scrollbar\"\n      orientation={orientation}\n      className={cn(\n        \"flex touch-none p-px transition-colors select-none\",\n        orientation === \"vertical\" &&\n          \"h-full w-2.5 border-l border-l-transparent\",\n        orientation === \"horizontal\" &&\n          \"h-2.5 flex-col border-t border-t-transparent\",\n        className\n      )}\n      {...props}\n    >\n      <ScrollAreaPrimitive.ScrollAreaThumb\n        data-slot=\"scroll-area-thumb\"\n        className=\"bg-border relative flex-1 rounded-full\"\n      />\n    </ScrollAreaPrimitive.ScrollAreaScrollbar>\n  )\n}\n\nexport { ScrollArea, ScrollBar }\n"],"names":[],"mappings":";;;;;;;AAGA;AAEA;AALA;;;;AAOA,SAAS,WAAW,EAClB,SAAS,EACT,QAAQ,EACR,GAAG,OACmD;IACtD,qBACE,2RAAC,+NAAwB;QACvB,aAAU;QACV,WAAW,IAAA,sKAAE,EAAC,YAAY;QACzB,GAAG,KAAK;;0BAET,2RAAC,mOAA4B;gBAC3B,aAAU;gBACV,WAAU;0BAET;;;;;;0BAEH,2RAAC;;;;;0BACD,2RAAC,iOAA0B;;;;;;;;;;;AAGjC;AAEA,SAAS,UAAU,EACjB,SAAS,EACT,cAAc,UAAU,EACxB,GAAG,OACkE;IACrE,qBACE,2RAAC,8OAAuC;QACtC,aAAU;QACV,aAAa;QACb,WAAW,IAAA,sKAAE,EACX,sDACA,gBAAgB,cACd,8CACF,gBAAgB,gBACd,gDACF;QAED,GAAG,KAAK;kBAET,cAAA,2RAAC,0OAAmC;YAClC,aAAU;YACV,WAAU;;;;;;;;;;;AAIlB"}},
    {"offset": {"line": 402, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/components/ui/separator.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as SeparatorPrimitive from \"@radix-ui/react-separator\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Separator({\n  className,\n  orientation = \"horizontal\",\n  decorative = true,\n  ...props\n}: React.ComponentProps<typeof SeparatorPrimitive.Root>) {\n  return (\n    <SeparatorPrimitive.Root\n      data-slot=\"separator\"\n      decorative={decorative}\n      orientation={orientation}\n      className={cn(\n        \"bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Separator }\n"],"names":[],"mappings":";;;;;AAGA;AAEA;AALA;;;;AAOA,SAAS,UAAU,EACjB,SAAS,EACT,cAAc,YAAY,EAC1B,aAAa,IAAI,EACjB,GAAG,OACkD;IACrD,qBACE,2RAAC,0NAAuB;QACtB,aAAU;QACV,YAAY;QACZ,aAAa;QACb,WAAW,IAAA,sKAAE,EACX,kKACA;QAED,GAAG,KAAK;;;;;;AAGf"}},
    {"offset": {"line": 431, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/components/ui/switch.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as SwitchPrimitive from \"@radix-ui/react-switch\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Switch({\n  className,\n  ...props\n}: React.ComponentProps<typeof SwitchPrimitive.Root>) {\n  return (\n    <SwitchPrimitive.Root\n      data-slot=\"switch\"\n      className={cn(\n        \"peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    >\n      <SwitchPrimitive.Thumb\n        data-slot=\"switch-thumb\"\n        className={cn(\n          \"bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0\"\n        )}\n      />\n    </SwitchPrimitive.Root>\n  )\n}\n\nexport { Switch }\n"],"names":[],"mappings":";;;;;AAGA;AAEA;AALA;;;;AAOA,SAAS,OAAO,EACd,SAAS,EACT,GAAG,OAC+C;IAClD,qBACE,2RAAC,uNAAoB;QACnB,aAAU;QACV,WAAW,IAAA,sKAAE,EACX,6WACA;QAED,GAAG,KAAK;kBAET,cAAA,2RAAC,wNAAqB;YACpB,aAAU;YACV,WAAW,IAAA,sKAAE,EACX;;;;;;;;;;;AAKV"}},
    {"offset": {"line": 466, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/components/ui/label.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Label({\n  className,\n  ...props\n}: React.ComponentProps<typeof LabelPrimitive.Root>) {\n  return (\n    <LabelPrimitive.Root\n      data-slot=\"label\"\n      className={cn(\n        \"flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Label }\n"],"names":[],"mappings":";;;;;AAGA;AAEA;AALA;;;;AAOA,SAAS,MAAM,EACb,SAAS,EACT,GAAG,OAC8C;IACjD,qBACE,2RAAC,sNAAmB;QAClB,aAAU;QACV,WAAW,IAAA,sKAAE,EACX,uNACA;QAED,GAAG,KAAK;;;;;;AAGf"}},
    {"offset": {"line": 493, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/lib/drm/crypto.ts"],"sourcesContent":["/**\n * Simplified crypto utilities for DRM simulation\n * This is for EDUCATIONAL purposes only - not production-grade crypto\n */\n\n// Simple XOR-based \"encryption\" for demonstration\nexport function xorEncrypt(data: Uint8Array, key: Uint8Array): Uint8Array {\n  const result = new Uint8Array(data.length);\n  for (let i = 0; i < data.length; i++) {\n    result[i] = data[i] ^ key[i % key.length];\n  }\n  return result;\n}\n\n// XOR two byte arrays (for educational block cipher demos)\nexport function xorBytes(a: Uint8Array, b: Uint8Array): Uint8Array {\n  const length = Math.min(a.length, b.length);\n  const result = new Uint8Array(length);\n  for (let i = 0; i < length; i++) {\n    result[i] = a[i] ^ b[i];\n  }\n  return result;\n}\n\nexport function xorDecrypt(data: Uint8Array, key: Uint8Array): Uint8Array {\n  // XOR is symmetric\n  return xorEncrypt(data, key);\n}\n\n// Generate a random key\nexport function generateKey(length: number = 16): Uint8Array {\n  const key = new Uint8Array(length);\n  if (typeof window !== 'undefined' && window.crypto) {\n    window.crypto.getRandomValues(key);\n  } else {\n    // Fallback for SSR\n    for (let i = 0; i < length; i++) {\n      key[i] = Math.floor(Math.random() * 256);\n    }\n  }\n  return key;\n}\n\n// Convert bytes to hex string\nexport function bytesToHex(bytes: Uint8Array): string {\n  return Array.from(bytes)\n    .map((b) => b.toString(16).padStart(2, '0'))\n    .join('');\n}\n\n// Convert hex string to bytes\nexport function hexToBytes(hex: string): Uint8Array {\n  const bytes = new Uint8Array(hex.length / 2);\n  for (let i = 0; i < bytes.length; i++) {\n    bytes[i] = parseInt(hex.substr(i * 2, 2), 16);\n  }\n  return bytes;\n}\n\n// Convert string to bytes\nexport function stringToBytes(str: string): Uint8Array {\n  return new TextEncoder().encode(str);\n}\n\n// Convert bytes to string\nexport function bytesToString(bytes: Uint8Array): string {\n  return new TextDecoder().decode(bytes);\n}\n\n// Base64 encode\nexport function base64Encode(bytes: Uint8Array): string {\n  if (typeof window !== 'undefined') {\n    return btoa(String.fromCharCode(...bytes));\n  }\n  return Buffer.from(bytes).toString('base64');\n}\n\n// Base64 decode\nexport function base64Decode(str: string): Uint8Array {\n  if (typeof window !== 'undefined') {\n    return Uint8Array.from(atob(str), (c) => c.charCodeAt(0));\n  }\n  return new Uint8Array(Buffer.from(str, 'base64'));\n}\n\n// Simple hash function (not cryptographically secure, for demo only)\nexport function simpleHash(data: Uint8Array): string {\n  let hash = 0;\n  for (let i = 0; i < data.length; i++) {\n    hash = ((hash << 5) - hash + data[i]) | 0;\n  }\n  return Math.abs(hash).toString(16).padStart(8, '0');\n}\n\n// Generate a key ID (UUID-like)\nexport function generateKeyId(): string {\n  const bytes = generateKey(16);\n  const hex = bytesToHex(bytes);\n  return `${hex.slice(0, 8)}-${hex.slice(8, 12)}-${hex.slice(12, 16)}-${hex.slice(16, 20)}-${hex.slice(20, 32)}`;\n}\n\n// AES-like block cipher simulation (simplified for education)\nexport class SimpleCipher {\n  private key: Uint8Array;\n  private iv: Uint8Array;\n\n  constructor(key: Uint8Array, iv?: Uint8Array) {\n    this.key = key;\n    this.iv = iv || generateKey(16);\n  }\n\n  // Simulated CTR mode encryption\n  encryptCTR(plaintext: Uint8Array): { ciphertext: Uint8Array; iv: Uint8Array } {\n    const ciphertext = new Uint8Array(plaintext.length);\n    const blockSize = 16;\n\n    for (let i = 0; i < plaintext.length; i += blockSize) {\n      // Create counter block\n      const counter = new Uint8Array(blockSize);\n      counter.set(this.iv.slice(0, 8), 0);\n      const blockNum = Math.floor(i / blockSize);\n      for (let j = 0; j < 8; j++) {\n        counter[8 + j] = (blockNum >> (8 * (7 - j))) & 0xff;\n      }\n\n      // \"Encrypt\" counter with key (simplified - just XOR in real AES this is block cipher)\n      const keystream = xorEncrypt(counter, this.key);\n\n      // XOR plaintext with keystream\n      const blockEnd = Math.min(i + blockSize, plaintext.length);\n      for (let j = i; j < blockEnd; j++) {\n        ciphertext[j] = plaintext[j] ^ keystream[j - i];\n      }\n    }\n\n    return { ciphertext, iv: this.iv };\n  }\n\n  decryptCTR(ciphertext: Uint8Array): Uint8Array {\n    // CTR mode is symmetric\n    return this.encryptCTR(ciphertext).ciphertext;\n  }\n\n  getIV(): Uint8Array {\n    return this.iv;\n  }\n}\n\n// Simulated RSA-like asymmetric operations (NOT SECURE - for demo only)\nexport class SimpleAsymmetric {\n  private privateKey: number;\n  private publicKey: number;\n  private modulus: number;\n\n  constructor() {\n    // Use small primes for demonstration (real RSA uses 2048+ bit primes)\n    const p = 61;\n    const q = 53;\n    this.modulus = p * q; // 3233\n    const phi = (p - 1) * (q - 1); // 3120\n    this.publicKey = 17; // Common choice\n    this.privateKey = this.modInverse(this.publicKey, phi); // 2753\n  }\n\n  private modInverse(a: number, m: number): number {\n    let [old_r, r] = [a, m];\n    let [old_s, s] = [1, 0];\n\n    while (r !== 0) {\n      const q = Math.floor(old_r / r);\n      [old_r, r] = [r, old_r - q * r];\n      [old_s, s] = [s, old_s - q * s];\n    }\n\n    return ((old_s % m) + m) % m;\n  }\n\n  private modPow(base: number, exp: number, mod: number): number {\n    let result = 1;\n    base = base % mod;\n    while (exp > 0) {\n      if (exp % 2 === 1) {\n        result = (result * base) % mod;\n      }\n      exp = Math.floor(exp / 2);\n      base = (base * base) % mod;\n    }\n    return result;\n  }\n\n  // Encrypt a single byte (demo only - real RSA encrypts blocks)\n  encrypt(byte: number): number {\n    return this.modPow(byte, this.publicKey, this.modulus);\n  }\n\n  // Decrypt a single value\n  decrypt(encrypted: number): number {\n    return this.modPow(encrypted, this.privateKey, this.modulus);\n  }\n\n  // Encrypt bytes (very simplified)\n  encryptBytes(data: Uint8Array): number[] {\n    return Array.from(data).map((b) => this.encrypt(b));\n  }\n\n  // Decrypt to bytes\n  decryptBytes(encrypted: number[]): Uint8Array {\n    return new Uint8Array(encrypted.map((e) => this.decrypt(e)));\n  }\n\n  getPublicKey(): { e: number; n: number } {\n    return { e: this.publicKey, n: this.modulus };\n  }\n\n  // Sign data (hash and encrypt with private key)\n  sign(data: Uint8Array): string {\n    const hash = simpleHash(data);\n    const hashBytes = stringToBytes(hash);\n    const signature = Array.from(hashBytes).map((b) =>\n      this.modPow(b, this.privateKey, this.modulus)\n    );\n    return signature.join(',');\n  }\n\n  // Verify signature\n  verify(data: Uint8Array, signature: string): boolean {\n    const hash = simpleHash(data);\n    const sigParts = signature.split(',').map(Number);\n    const decrypted = sigParts.map((s) =>\n      this.modPow(s, this.publicKey, this.modulus)\n    );\n    const recovered = bytesToString(new Uint8Array(decrypted));\n    return recovered === hash;\n  }\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 725, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/lib/drm/mock-cdm.ts"],"sourcesContent":["/**\n * Mock Content Decryption Module (CDM)\n * Simulates the behavior of Widevine/FairPlay/PlayReady CDM\n * FOR EDUCATIONAL PURPOSES ONLY\n */\n\nimport {\n  generateKey,\n  generateKeyId,\n  bytesToHex,\n  hexToBytes,\n  base64Encode,\n  base64Decode,\n  stringToBytes,\n  bytesToString,\n  SimpleCipher,\n  SimpleAsymmetric,\n  simpleHash,\n} from './crypto';\n\nexport type SecurityLevel = 'L1' | 'L2' | 'L3';\n\nexport interface DeviceCertificate {\n  deviceId: string;\n  securityLevel: SecurityLevel;\n  publicKey: { e: number; n: number };\n  manufacturer: string;\n  model: string;\n  timestamp: number;\n  signature: string;\n}\n\nexport interface LicenseChallenge {\n  version: number;\n  deviceCertificate: DeviceCertificate;\n  keyIds: string[];\n  sessionId: string;\n  nonce: string;\n  timestamp: number;\n  signature: string;\n}\n\nexport interface ContentKey {\n  keyId: string;\n  key: string; // Base64 encoded\n  iv: string; // Base64 encoded\n  type: 'CONTENT' | 'SIGNING';\n}\n\nexport interface LicenseResponse {\n  version: number;\n  sessionId: string;\n  keys: ContentKey[];\n  policy: {\n    canPlay: boolean;\n    canPersist: boolean;\n    licenseDuration: number;\n    playbackDuration: number;\n    renewalDelay: number;\n  };\n  serverNonce: string;\n  timestamp: number;\n  signature: string;\n}\n\nexport interface CDMSession {\n  sessionId: string;\n  keyIds: string[];\n  keys: Map<string, Uint8Array>;\n  state: 'created' | 'pending' | 'active' | 'expired' | 'closed';\n  createdAt: number;\n  expiresAt: number | null;\n}\n\nexport interface CDMEvents {\n  onSessionCreated?: (session: CDMSession) => void;\n  onSessionUpdated?: (session: CDMSession) => void;\n  onSessionClosed?: (sessionId: string) => void;\n  onKeyAdded?: (sessionId: string, keyId: string) => void;\n  onError?: (error: Error) => void;\n  onLog?: (message: string, data?: unknown) => void;\n}\n\n/**\n * Mock CDM implementation\n * Simulates L1/L2/L3 security levels with educational visibility\n */\nexport class MockCDM {\n  private deviceId: string;\n  private securityLevel: SecurityLevel;\n  private asymmetric: SimpleAsymmetric;\n  private sessions: Map<string, CDMSession>;\n  private events: CDMEvents;\n  private manufacturer: string;\n  private model: string;\n\n  constructor(\n    securityLevel: SecurityLevel = 'L3',\n    events: CDMEvents = {},\n    options?: { manufacturer?: string; model?: string }\n  ) {\n    this.securityLevel = securityLevel;\n    this.deviceId = generateKeyId();\n    this.asymmetric = new SimpleAsymmetric();\n    this.sessions = new Map();\n    this.events = events;\n    this.manufacturer = options?.manufacturer || 'Mock Devices Inc';\n    this.model = options?.model || `MockCDM-${securityLevel}`;\n\n    this.log(`CDM initialized with security level ${securityLevel}`);\n  }\n\n  private log(message: string, data?: unknown) {\n    this.events.onLog?.(`[CDM] ${message}`, data);\n  }\n\n  /**\n   * Get device certificate for license requests\n   */\n  getDeviceCertificate(): DeviceCertificate {\n    const certData = {\n      deviceId: this.deviceId,\n      securityLevel: this.securityLevel,\n      publicKey: this.asymmetric.getPublicKey(),\n      manufacturer: this.manufacturer,\n      model: this.model,\n      timestamp: Date.now(),\n    };\n\n    // Sign certificate\n    const signature = this.asymmetric.sign(\n      stringToBytes(JSON.stringify(certData))\n    );\n\n    return {\n      ...certData,\n      signature,\n    };\n  }\n\n  /**\n   * Create a new session for license acquisition\n   */\n  createSession(keyIds: string[]): CDMSession {\n    const sessionId = generateKeyId();\n    const session: CDMSession = {\n      sessionId,\n      keyIds,\n      keys: new Map(),\n      state: 'created',\n      createdAt: Date.now(),\n      expiresAt: null,\n    };\n\n    this.sessions.set(sessionId, session);\n    this.log(`Session created: ${sessionId}`, { keyIds });\n    this.events.onSessionCreated?.(session);\n\n    return session;\n  }\n\n  /**\n   * Generate license challenge (request)\n   */\n  generateLicenseChallenge(sessionId: string): LicenseChallenge {\n    const session = this.sessions.get(sessionId);\n    if (!session) {\n      throw new Error(`Session not found: ${sessionId}`);\n    }\n\n    session.state = 'pending';\n    this.events.onSessionUpdated?.(session);\n\n    const challenge: Omit<LicenseChallenge, 'signature'> = {\n      version: 1,\n      deviceCertificate: this.getDeviceCertificate(),\n      keyIds: session.keyIds,\n      sessionId,\n      nonce: bytesToHex(generateKey(16)),\n      timestamp: Date.now(),\n    };\n\n    // Sign the challenge\n    const signature = this.asymmetric.sign(\n      stringToBytes(JSON.stringify(challenge))\n    );\n\n    const signedChallenge: LicenseChallenge = {\n      ...challenge,\n      signature,\n    };\n\n    this.log('License challenge generated', { sessionId, keyIds: session.keyIds });\n    return signedChallenge;\n  }\n\n  /**\n   * Process license response and extract keys\n   */\n  processLicenseResponse(response: LicenseResponse): void {\n    const session = this.sessions.get(response.sessionId);\n    if (!session) {\n      throw new Error(`Session not found: ${response.sessionId}`);\n    }\n\n    this.log('Processing license response', { sessionId: response.sessionId });\n\n    // In a real CDM, keys would be encrypted with device public key\n    // Here we simulate extracting the keys\n    for (const keyData of response.keys) {\n      if (keyData.type === 'CONTENT') {\n        const key = base64Decode(keyData.key);\n        session.keys.set(keyData.keyId, key);\n        this.log(`Key added: ${keyData.keyId}`, {\n          keyLength: key.length,\n          // In L3, keys are visible in memory\n          keyHex: this.securityLevel === 'L3' ? bytesToHex(key) : '[PROTECTED]',\n        });\n        this.events.onKeyAdded?.(session.sessionId, keyData.keyId);\n      }\n    }\n\n    // Update session state\n    session.state = 'active';\n    if (response.policy.licenseDuration > 0) {\n      session.expiresAt = Date.now() + response.policy.licenseDuration * 1000;\n    }\n\n    this.events.onSessionUpdated?.(session);\n    this.log('Session activated', { sessionId: session.sessionId, keyCount: session.keys.size });\n  }\n\n  /**\n   * Decrypt content using stored keys\n   */\n  decrypt(sessionId: string, keyId: string, ciphertext: Uint8Array, iv: Uint8Array): Uint8Array {\n    const session = this.sessions.get(sessionId);\n    if (!session) {\n      throw new Error(`Session not found: ${sessionId}`);\n    }\n\n    if (session.state !== 'active') {\n      throw new Error(`Session not active: ${session.state}`);\n    }\n\n    const key = session.keys.get(keyId);\n    if (!key) {\n      throw new Error(`Key not found: ${keyId}`);\n    }\n\n    this.log('Decrypting content', {\n      sessionId,\n      keyId,\n      ciphertextLength: ciphertext.length,\n    });\n\n    // Decrypt using CTR mode\n    const cipher = new SimpleCipher(key, iv);\n    const plaintext = cipher.decryptCTR(ciphertext);\n\n    // Security level simulation\n    if (this.securityLevel === 'L1') {\n      this.log('L1: Decryption in hardware TEE - content protected');\n    } else if (this.securityLevel === 'L2') {\n      this.log('L2: Keys in hardware, decryption in software - partially protected');\n    } else {\n      this.log('L3: Full software decryption - content accessible in memory');\n    }\n\n    return plaintext;\n  }\n\n  /**\n   * Get session info\n   */\n  getSession(sessionId: string): CDMSession | undefined {\n    return this.sessions.get(sessionId);\n  }\n\n  /**\n   * Close a session\n   */\n  closeSession(sessionId: string): void {\n    const session = this.sessions.get(sessionId);\n    if (session) {\n      session.state = 'closed';\n      session.keys.clear();\n      this.sessions.delete(sessionId);\n      this.log('Session closed', { sessionId });\n      this.events.onSessionClosed?.(sessionId);\n    }\n  }\n\n  /**\n   * Get all active sessions\n   */\n  getSessions(): CDMSession[] {\n    return Array.from(this.sessions.values());\n  }\n\n  /**\n   * Get security level\n   */\n  getSecurityLevel(): SecurityLevel {\n    return this.securityLevel;\n  }\n\n  /**\n   * Get device ID\n   */\n  getDeviceId(): string {\n    return this.deviceId;\n  }\n\n  /**\n   * Simulate memory dump attack (only works on L3)\n   * Returns extracted keys if security level allows\n   */\n  simulateMemoryDump(): Map<string, string> | null {\n    if (this.securityLevel === 'L1') {\n      this.log('Memory dump blocked - L1 hardware protection');\n      return null;\n    }\n\n    if (this.securityLevel === 'L2') {\n      this.log('Memory dump partial - keys in hardware, but decrypted content accessible');\n      return null;\n    }\n\n    // L3 - keys are in software memory\n    this.log('VULNERABILITY: L3 memory dump successful - keys extracted!');\n    const extractedKeys = new Map<string, string>();\n\n    for (const session of this.sessions.values()) {\n      for (const [keyId, key] of session.keys) {\n        extractedKeys.set(keyId, bytesToHex(key));\n      }\n    }\n\n    return extractedKeys;\n  }\n}\n\nexport default MockCDM;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 953, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/lib/drm/mock-license-server.ts"],"sourcesContent":["/**\n * Mock License Server\n * Simulates DRM license server behavior for Widevine/FairPlay/PlayReady\n * FOR EDUCATIONAL PURPOSES ONLY\n */\n\nimport {\n  generateKey,\n  generateKeyId,\n  bytesToHex,\n  base64Encode,\n  base64Decode,\n  stringToBytes,\n  SimpleAsymmetric,\n} from './crypto';\nimport type {\n  DeviceCertificate,\n  LicenseChallenge,\n  LicenseResponse,\n  ContentKey,\n  SecurityLevel,\n} from './mock-cdm';\n\nexport interface ContentInfo {\n  contentId: string;\n  title: string;\n  keyId: string;\n  key: Uint8Array;\n  iv: Uint8Array;\n  requiredSecurityLevel: SecurityLevel;\n  policy: {\n    canPlay: boolean;\n    canPersist: boolean;\n    licenseDuration: number;\n    playbackDuration: number;\n    renewalDelay: number;\n  };\n}\n\nexport interface ServerEvents {\n  onLicenseRequest?: (challenge: LicenseChallenge) => void;\n  onLicenseIssued?: (response: LicenseResponse, contentInfo: ContentInfo) => void;\n  onLicenseDenied?: (reason: string, challenge: LicenseChallenge) => void;\n  onDeviceRevoked?: (deviceId: string) => void;\n  onLog?: (message: string, data?: unknown) => void;\n}\n\nexport interface LicenseServerConfig {\n  serverName: string;\n  enableSecurityCheck: boolean;\n  enableDeviceRevocation: boolean;\n  defaultPolicy: {\n    canPlay: boolean;\n    canPersist: boolean;\n    licenseDuration: number;\n    playbackDuration: number;\n    renewalDelay: number;\n  };\n}\n\nconst defaultConfig: LicenseServerConfig = {\n  serverName: 'Mock DRM License Server',\n  enableSecurityCheck: true,\n  enableDeviceRevocation: true,\n  defaultPolicy: {\n    canPlay: true,\n    canPersist: false,\n    licenseDuration: 86400, // 24 hours\n    playbackDuration: 14400, // 4 hours\n    renewalDelay: 3600, // 1 hour before expiry\n  },\n};\n\n/**\n * Mock License Server implementation\n */\nexport class MockLicenseServer {\n  private config: LicenseServerConfig;\n  private content: Map<string, ContentInfo>;\n  private revokedDevices: Set<string>;\n  private issuedLicenses: Map<string, { challenge: LicenseChallenge; response: LicenseResponse; timestamp: number }>;\n  private asymmetric: SimpleAsymmetric;\n  private events: ServerEvents;\n\n  constructor(config: Partial<LicenseServerConfig> = {}, events: ServerEvents = {}) {\n    this.config = { ...defaultConfig, ...config };\n    this.content = new Map();\n    this.revokedDevices = new Set();\n    this.issuedLicenses = new Map();\n    this.asymmetric = new SimpleAsymmetric();\n    this.events = events;\n\n    this.log('License server initialized', { serverName: this.config.serverName });\n  }\n\n  private log(message: string, data?: unknown) {\n    this.events.onLog?.(`[Server] ${message}`, data);\n  }\n\n  /**\n   * Register content for licensing\n   */\n  registerContent(\n    contentId: string,\n    title: string,\n    requiredSecurityLevel: SecurityLevel = 'L3',\n    customPolicy?: Partial<ContentInfo['policy']>\n  ): ContentInfo {\n    const keyId = generateKeyId();\n    const key = generateKey(16);\n    const iv = generateKey(16);\n\n    const contentInfo: ContentInfo = {\n      contentId,\n      title,\n      keyId,\n      key,\n      iv,\n      requiredSecurityLevel,\n      policy: {\n        ...this.config.defaultPolicy,\n        ...customPolicy,\n      },\n    };\n\n    this.content.set(contentId, contentInfo);\n    this.log('Content registered', {\n      contentId,\n      title,\n      keyId,\n      requiredSecurityLevel,\n    });\n\n    return contentInfo;\n  }\n\n  /**\n   * Get content info (without revealing key)\n   */\n  getContentInfo(contentId: string): Omit<ContentInfo, 'key'> | null {\n    const content = this.content.get(contentId);\n    if (!content) return null;\n\n    const { key, ...info } = content;\n    return info;\n  }\n\n  /**\n   * Get content key ID for a content\n   */\n  getKeyId(contentId: string): string | null {\n    return this.content.get(contentId)?.keyId || null;\n  }\n\n  /**\n   * Revoke a device\n   */\n  revokeDevice(deviceId: string): void {\n    this.revokedDevices.add(deviceId);\n    this.log('Device revoked', { deviceId });\n    this.events.onDeviceRevoked?.(deviceId);\n  }\n\n  /**\n   * Check if device is revoked\n   */\n  isDeviceRevoked(deviceId: string): boolean {\n    return this.revokedDevices.has(deviceId);\n  }\n\n  /**\n   * Validate license challenge\n   */\n  private validateChallenge(challenge: LicenseChallenge): { valid: boolean; reason?: string } {\n    // Check timestamp (allow 5 minute window)\n    const timeDiff = Math.abs(Date.now() - challenge.timestamp);\n    if (timeDiff > 5 * 60 * 1000) {\n      return { valid: false, reason: 'Challenge expired' };\n    }\n\n    // Check device certificate\n    const cert = challenge.deviceCertificate;\n    if (!cert.deviceId || !cert.securityLevel) {\n      return { valid: false, reason: 'Invalid device certificate' };\n    }\n\n    // Check if device is revoked\n    if (this.config.enableDeviceRevocation && this.isDeviceRevoked(cert.deviceId)) {\n      return { valid: false, reason: 'Device revoked' };\n    }\n\n    // Check key IDs\n    if (!challenge.keyIds || challenge.keyIds.length === 0) {\n      return { valid: false, reason: 'No key IDs requested' };\n    }\n\n    return { valid: true };\n  }\n\n  /**\n   * Check security level requirements\n   */\n  private checkSecurityLevel(\n    deviceLevel: SecurityLevel,\n    requiredLevel: SecurityLevel\n  ): boolean {\n    const levels: Record<SecurityLevel, number> = { L1: 3, L2: 2, L3: 1 };\n    return levels[deviceLevel] >= levels[requiredLevel];\n  }\n\n  /**\n   * Process license request and generate response\n   */\n  processLicenseRequest(\n    challenge: LicenseChallenge,\n    contentId: string\n  ): LicenseResponse | { error: string } {\n    this.log('Processing license request', {\n      sessionId: challenge.sessionId,\n      contentId,\n      deviceId: challenge.deviceCertificate.deviceId,\n      securityLevel: challenge.deviceCertificate.securityLevel,\n    });\n\n    this.events.onLicenseRequest?.(challenge);\n\n    // Validate challenge\n    const validation = this.validateChallenge(challenge);\n    if (!validation.valid) {\n      this.log('License request denied', { reason: validation.reason });\n      this.events.onLicenseDenied?.(validation.reason!, challenge);\n      return { error: validation.reason! };\n    }\n\n    // Get content\n    const content = this.content.get(contentId);\n    if (!content) {\n      const reason = 'Content not found';\n      this.log('License request denied', { reason });\n      this.events.onLicenseDenied?.(reason, challenge);\n      return { error: reason };\n    }\n\n    // Check security level\n    if (this.config.enableSecurityCheck) {\n      if (!this.checkSecurityLevel(challenge.deviceCertificate.securityLevel, content.requiredSecurityLevel)) {\n        const reason = `Security level too low. Required: ${content.requiredSecurityLevel}, Device: ${challenge.deviceCertificate.securityLevel}`;\n        this.log('License request denied', { reason });\n        this.events.onLicenseDenied?.(reason, challenge);\n        return { error: reason };\n      }\n    }\n\n    // Generate license response\n    const keys: ContentKey[] = [\n      {\n        keyId: content.keyId,\n        key: base64Encode(content.key),\n        iv: base64Encode(content.iv),\n        type: 'CONTENT',\n      },\n    ];\n\n    const responseData: Omit<LicenseResponse, 'signature'> = {\n      version: 1,\n      sessionId: challenge.sessionId,\n      keys,\n      policy: content.policy,\n      serverNonce: bytesToHex(generateKey(16)),\n      timestamp: Date.now(),\n    };\n\n    // Sign response\n    const signature = this.asymmetric.sign(stringToBytes(JSON.stringify(responseData)));\n\n    const response: LicenseResponse = {\n      ...responseData,\n      signature,\n    };\n\n    // Store issued license\n    this.issuedLicenses.set(challenge.sessionId, {\n      challenge,\n      response,\n      timestamp: Date.now(),\n    });\n\n    this.log('License issued', {\n      sessionId: challenge.sessionId,\n      contentId,\n      keyId: content.keyId,\n    });\n    this.events.onLicenseIssued?.(response, content);\n\n    return response;\n  }\n\n  /**\n   * Get issued license by session ID\n   */\n  getIssuedLicense(sessionId: string) {\n    return this.issuedLicenses.get(sessionId);\n  }\n\n  /**\n   * Get all registered content\n   */\n  getAllContent(): Map<string, Omit<ContentInfo, 'key'>> {\n    const result = new Map<string, Omit<ContentInfo, 'key'>>();\n    for (const [id, content] of this.content) {\n      const { key, ...info } = content;\n      result.set(id, info);\n    }\n    return result;\n  }\n\n  /**\n   * Get content with key (for simulation/attack demos)\n   */\n  getContentWithKey(contentId: string): ContentInfo | null {\n    return this.content.get(contentId) || null;\n  }\n\n  /**\n   * Get server stats\n   */\n  getStats() {\n    return {\n      serverName: this.config.serverName,\n      registeredContent: this.content.size,\n      issuedLicenses: this.issuedLicenses.size,\n      revokedDevices: this.revokedDevices.size,\n    };\n  }\n}\n\nexport default MockLicenseServer;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1221, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/app/labs/cdm-simulator/page.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useEffect } from 'react';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Alert, AlertDescription, AlertTitle } from '@/components/ui/alert';\nimport { Progress } from '@/components/ui/progress';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { ScrollArea } from '@/components/ui/scroll-area';\nimport { Separator } from '@/components/ui/separator';\nimport { Switch } from '@/components/ui/switch';\nimport { Label } from '@/components/ui/label';\nimport {\n  Shield,\n  Play,\n  RotateCcw,\n  Key,\n  Server,\n  Smartphone,\n  Monitor,\n  Cpu,\n  CheckCircle2,\n  XCircle,\n  AlertTriangle,\n  ArrowRight,\n  Eye,\n  EyeOff,\n} from 'lucide-react';\nimport { MockCDM, type SecurityLevel } from '@/lib/drm/mock-cdm';\nimport { MockLicenseServer } from '@/lib/drm/mock-license-server';\nimport { bytesToHex } from '@/lib/drm/crypto';\n\ntype CDMState = 'uninitialized' | 'initialized' | 'session-created' | 'licensed' | 'ready' | 'error';\n\ninterface CDMEvent {\n  id: string;\n  timestamp: Date;\n  type: 'info' | 'success' | 'warning' | 'error';\n  source: 'cdm' | 'server' | 'system';\n  message: string;\n  details?: string;\n}\n\nconst securityLevelInfo: Record<SecurityLevel, { icon: typeof Shield; description: string; color: string }> = {\n  L1: {\n    icon: Shield,\n    description: 'Hardware TEE - Keys never exposed to software',\n    color: 'text-green-500',\n  },\n  L2: {\n    icon: Cpu,\n    description: 'Hardware crypto, software CDM - Hybrid protection',\n    color: 'text-yellow-500',\n  },\n  L3: {\n    icon: Monitor,\n    description: 'Software only - Vulnerable to extraction',\n    color: 'text-red-500',\n  },\n};\n\nexport default function CDMSimulatorPage() {\n  const [cdm, setCdm] = useState<MockCDM | null>(null);\n  const [licenseServer] = useState(() => new MockLicenseServer());\n  const [securityLevel, setSecurityLevel] = useState<SecurityLevel>('L1');\n  const [cdmState, setCdmState] = useState<CDMState>('uninitialized');\n  const [events, setEvents] = useState<CDMEvent[]>([]);\n  const [currentStep, setCurrentStep] = useState(0);\n  const [isPlaying, setIsPlaying] = useState(false);\n  const [showKeys, setShowKeys] = useState(false);\n  const [contentKey, setContentKey] = useState<string | null>(null);\n  const [sessionId, setSessionId] = useState<string | null>(null);\n\n  const addEvent = (\n    type: CDMEvent['type'],\n    source: CDMEvent['source'],\n    message: string,\n    details?: string\n  ) => {\n    const event: CDMEvent = {\n      id: Math.random().toString(36).substr(2, 9),\n      timestamp: new Date(),\n      type,\n      source,\n      message,\n      details,\n    };\n    setEvents(prev => [...prev, event]);\n  };\n\n  const resetSimulation = () => {\n    setCdm(null);\n    setCdmState('uninitialized');\n    setEvents([]);\n    setCurrentStep(0);\n    setIsPlaying(false);\n    setContentKey(null);\n    setSessionId(null);\n  };\n\n  const delay = (ms: number) => new Promise(resolve => setTimeout(resolve, ms));\n\n  const runSimulation = async () => {\n    setIsPlaying(true);\n    resetSimulation();\n    await delay(500);\n\n    // Step 1: Initialize CDM\n    setCurrentStep(1);\n    addEvent('info', 'system', 'Initializing Content Decryption Module...', `Security Level: ${securityLevel}`);\n    await delay(800);\n\n    const newCdm = new MockCDM(securityLevel);\n    setCdm(newCdm);\n    setCdmState('initialized');\n    addEvent('success', 'cdm', 'CDM initialized successfully', `Device ID: ${newCdm.getDeviceId()}`);\n    await delay(600);\n\n    // Register demo content on license server\n    const contentId = 'demo-content-001';\n    const content = licenseServer.registerContent(contentId, 'Demo Video', 'L3');\n\n    // Step 2: Create Session\n    setCurrentStep(2);\n    addEvent('info', 'cdm', 'Creating license session...');\n    await delay(500);\n\n    const session = newCdm.createSession([content.keyId]);\n    setSessionId(session.sessionId);\n    setCdmState('session-created');\n    addEvent('success', 'cdm', 'Session created', `Session ID: ${session.sessionId}`);\n    await delay(600);\n\n    // Step 3: Generate License Request\n    setCurrentStep(3);\n    addEvent('info', 'cdm', 'Generating license request...');\n    await delay(500);\n\n    const licenseChallenge = newCdm.generateLicenseChallenge(session.sessionId);\n    addEvent('info', 'cdm', 'License challenge generated', `Key IDs: ${licenseChallenge.keyIds.join(', ')}`);\n    await delay(600);\n\n    // Step 4: Send to License Server\n    setCurrentStep(4);\n    addEvent('info', 'system', 'Sending license request to server...');\n    await delay(800);\n\n    addEvent('info', 'server', 'License request received', `Validating device certificate...`);\n    await delay(500);\n\n    // Check device certificate\n    const deviceCert = licenseChallenge.deviceCertificate;\n    addEvent('success', 'server', 'Device certificate validated', `Security Level: ${deviceCert.securityLevel}`);\n    await delay(500);\n\n    // Step 5: Process License Response\n    setCurrentStep(5);\n    const licenseResponse = licenseServer.processLicenseRequest(licenseChallenge, contentId);\n\n    if ('error' in licenseResponse) {\n      addEvent('error', 'server', 'License request denied', licenseResponse.error);\n      setCdmState('error');\n      setIsPlaying(false);\n      return;\n    }\n\n    addEvent('success', 'server', 'License generated', `Keys: ${licenseResponse.keys.length}, Duration: ${licenseResponse.policy.licenseDuration}s`);\n    await delay(600);\n\n    addEvent('info', 'system', 'Sending license response to CDM...');\n    await delay(500);\n\n    // Step 6: Process License in CDM\n    setCurrentStep(6);\n    addEvent('info', 'cdm', 'Processing license response...');\n    await delay(500);\n\n    try {\n      newCdm.processLicenseResponse(licenseResponse);\n      setCdmState('licensed');\n      addEvent('success', 'cdm', 'License processed successfully');\n\n      // Simulate key extraction based on security level\n      if (securityLevel === 'L3') {\n        const extractedKeys = newCdm.simulateMemoryDump();\n        if (extractedKeys && extractedKeys.size > 0) {\n          const firstKey = extractedKeys.values().next().value;\n          setContentKey(firstKey || null);\n          addEvent('warning', 'cdm', 'Key extracted from memory',\n            'L3 software CDM - keys accessible in memory'\n          );\n        }\n      } else if (securityLevel === 'L2') {\n        setContentKey('[PARTIAL PROTECTION]');\n        addEvent('info', 'cdm', 'Keys in hardware crypto engine',\n          'L2 hybrid - keys protected but decrypted content accessible'\n        );\n      } else {\n        setContentKey('[PROTECTED IN TEE]');\n        addEvent('success', 'cdm', 'Keys stored in hardware TEE',\n          'L1 hardware - keys never leave secure enclave'\n        );\n      }\n    } catch (error) {\n      addEvent('error', 'cdm', 'Failed to process license', String(error));\n      setCdmState('error');\n      setIsPlaying(false);\n      return;\n    }\n    await delay(600);\n\n    // Step 7: Ready for Decryption\n    setCurrentStep(7);\n    setCdmState('ready');\n    addEvent('success', 'system', 'CDM ready for content decryption',\n      `Security Level ${securityLevel}: ${securityLevelInfo[securityLevel].description}`\n    );\n\n    setIsPlaying(false);\n  };\n\n  const getEventIcon = (type: CDMEvent['type']) => {\n    switch (type) {\n      case 'success': return <CheckCircle2 className=\"w-4 h-4 text-green-500\" />;\n      case 'warning': return <AlertTriangle className=\"w-4 h-4 text-yellow-500\" />;\n      case 'error': return <XCircle className=\"w-4 h-4 text-red-500\" />;\n      default: return <ArrowRight className=\"w-4 h-4 text-blue-500\" />;\n    }\n  };\n\n  const getSourceBadge = (source: CDMEvent['source']) => {\n    switch (source) {\n      case 'cdm': return <Badge variant=\"outline\" className=\"text-xs\">CDM</Badge>;\n      case 'server': return <Badge variant=\"outline\" className=\"text-xs text-purple-400\">Server</Badge>;\n      default: return <Badge variant=\"outline\" className=\"text-xs text-blue-400\">System</Badge>;\n    }\n  };\n\n  const LevelIcon = securityLevelInfo[securityLevel].icon;\n\n  return (\n    <div className=\"container max-w-6xl py-8\">\n      <div className=\"mb-8\">\n        <h1 className=\"text-2xl font-bold flex items-center gap-2\">\n          <Cpu className=\"w-6 h-6 text-primary\" />\n          CDM Simulator\n        </h1>\n        <p className=\"text-muted-foreground mt-1\">\n          Simulate Content Decryption Module behavior at different security levels\n        </p>\n      </div>\n\n      <Alert className=\"mb-6\">\n        <Shield className=\"h-4 w-4\" />\n        <AlertTitle>Understanding CDM Security Levels</AlertTitle>\n        <AlertDescription>\n          The CDM (Content Decryption Module) is the core component that handles license\n          acquisition and content decryption. Security levels determine how well protected\n          the decryption keys are from extraction.\n        </AlertDescription>\n      </Alert>\n\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n        {/* Control Panel */}\n        <div className=\"space-y-4\">\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"text-lg\">Security Level</CardTitle>\n              <CardDescription>Select CDM protection level</CardDescription>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              {(['L1', 'L2', 'L3'] as SecurityLevel[]).map((level) => {\n                const info = securityLevelInfo[level];\n                const Icon = info.icon;\n                return (\n                  <Button\n                    key={level}\n                    variant={securityLevel === level ? 'default' : 'outline'}\n                    className=\"w-full justify-start h-auto py-3\"\n                    onClick={() => {\n                      setSecurityLevel(level);\n                      resetSimulation();\n                    }}\n                    disabled={isPlaying}\n                  >\n                    <Icon className={`w-5 h-5 mr-3 ${info.color}`} />\n                    <div className=\"text-left\">\n                      <div className=\"font-medium\">Level {level.charAt(1)}</div>\n                      <div className=\"text-xs text-muted-foreground font-normal\">\n                        {info.description}\n                      </div>\n                    </div>\n                  </Button>\n                );\n              })}\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"text-lg\">Simulation Controls</CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <Button\n                onClick={runSimulation}\n                disabled={isPlaying}\n                className=\"w-full gap-2\"\n              >\n                <Play className=\"w-4 h-4\" />\n                Run Simulation\n              </Button>\n\n              <Button\n                variant=\"outline\"\n                onClick={resetSimulation}\n                disabled={isPlaying}\n                className=\"w-full gap-2\"\n              >\n                <RotateCcw className=\"w-4 h-4\" />\n                Reset\n              </Button>\n\n              <Separator />\n\n              <div className=\"flex items-center justify-between\">\n                <Label className=\"text-sm flex items-center gap-2\">\n                  {showKeys ? <Eye className=\"w-4 h-4\" /> : <EyeOff className=\"w-4 h-4\" />}\n                  Show Keys\n                </Label>\n                <Switch checked={showKeys} onCheckedChange={setShowKeys} />\n              </div>\n\n              {securityLevel === 'L3' && showKeys && (\n                <Alert variant=\"destructive\" className=\"text-xs\">\n                  <AlertTriangle className=\"h-3 w-3\" />\n                  <AlertDescription>\n                    L3 keys are vulnerable to memory extraction!\n                  </AlertDescription>\n                </Alert>\n              )}\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"text-lg\">CDM State</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"space-y-3\">\n                <div className=\"flex items-center justify-between\">\n                  <span className=\"text-sm text-muted-foreground\">State</span>\n                  <Badge variant={cdmState === 'ready' ? 'default' : 'outline'}>\n                    {cdmState}\n                  </Badge>\n                </div>\n\n                {sessionId && (\n                  <div>\n                    <span className=\"text-sm text-muted-foreground\">Session</span>\n                    <code className=\"block text-xs bg-zinc-950 p-2 rounded mt-1 truncate\">\n                      {sessionId}\n                    </code>\n                  </div>\n                )}\n\n                {contentKey && showKeys && (\n                  <div>\n                    <span className=\"text-sm text-muted-foreground flex items-center gap-1\">\n                      <Key className=\"w-3 h-3\" />\n                      Content Key\n                    </span>\n                    <code className={`block text-xs p-2 rounded mt-1 truncate ${\n                      securityLevel === 'L1'\n                        ? 'bg-green-500/10 text-green-400'\n                        : securityLevel === 'L2'\n                          ? 'bg-yellow-500/10 text-yellow-400'\n                          : 'bg-red-500/10 text-red-400'\n                    }`}>\n                      {securityLevel === 'L1' ? '[PROTECTED IN TEE]' : contentKey}\n                    </code>\n                  </div>\n                )}\n\n                <Progress value={(currentStep / 7) * 100} className=\"mt-4\" />\n                <div className=\"text-xs text-center text-muted-foreground\">\n                  Step {currentStep} of 7\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Main Visualization */}\n        <Card className=\"lg:col-span-2\">\n          <CardHeader>\n            <CardTitle className=\"text-lg\">License Acquisition Flow</CardTitle>\n            <CardDescription>\n              Watch the complete DRM handshake process\n            </CardDescription>\n          </CardHeader>\n          <CardContent>\n            {/* Flow Diagram */}\n            <div className=\"mb-6 p-4 rounded-lg border bg-zinc-950\">\n              <div className=\"flex items-center justify-between\">\n                <div className=\"text-center\">\n                  <div className={`p-3 rounded-lg mx-auto mb-2 w-fit ${\n                    currentStep >= 1 ? 'bg-primary/20' : 'bg-muted'\n                  }`}>\n                    <Smartphone className=\"w-6 h-6\" />\n                  </div>\n                  <div className=\"text-xs font-medium\">Client</div>\n                  <div className=\"text-xs text-muted-foreground\">CDM</div>\n                </div>\n\n                <div className=\"flex-1 flex items-center justify-center gap-1\">\n                  <ArrowRight className={`w-4 h-4 ${currentStep >= 3 ? 'text-primary' : 'text-muted'}`} />\n                  <ArrowRight className={`w-4 h-4 ${currentStep >= 3 ? 'text-primary' : 'text-muted'}`} />\n                  <Badge variant=\"outline\" className=\"text-xs\">\n                    License Request\n                  </Badge>\n                  <ArrowRight className={`w-4 h-4 ${currentStep >= 3 ? 'text-primary' : 'text-muted'}`} />\n                  <ArrowRight className={`w-4 h-4 ${currentStep >= 3 ? 'text-primary' : 'text-muted'}`} />\n                </div>\n\n                <div className=\"text-center\">\n                  <div className={`p-3 rounded-lg mx-auto mb-2 w-fit ${\n                    currentStep >= 4 ? 'bg-purple-500/20' : 'bg-muted'\n                  }`}>\n                    <Server className=\"w-6 h-6\" />\n                  </div>\n                  <div className=\"text-xs font-medium\">License Server</div>\n                  <div className=\"text-xs text-muted-foreground\">DRM</div>\n                </div>\n              </div>\n\n              <div className=\"flex items-center justify-center gap-1 mt-4\">\n                <ArrowRight className={`w-4 h-4 rotate-180 ${currentStep >= 5 ? 'text-green-500' : 'text-muted'}`} />\n                <ArrowRight className={`w-4 h-4 rotate-180 ${currentStep >= 5 ? 'text-green-500' : 'text-muted'}`} />\n                <Badge variant=\"outline\" className=\"text-xs bg-green-500/10\">\n                  License Response\n                </Badge>\n                <ArrowRight className={`w-4 h-4 rotate-180 ${currentStep >= 5 ? 'text-green-500' : 'text-muted'}`} />\n                <ArrowRight className={`w-4 h-4 rotate-180 ${currentStep >= 5 ? 'text-green-500' : 'text-muted'}`} />\n              </div>\n            </div>\n\n            {/* Event Log */}\n            <ScrollArea className=\"h-[350px] pr-4\">\n              {events.length === 0 ? (\n                <div className=\"text-center py-16 text-muted-foreground\">\n                  <Cpu className=\"w-12 h-12 mx-auto mb-4 opacity-50\" />\n                  <p>Click &quot;Run Simulation&quot; to start</p>\n                </div>\n              ) : (\n                <div className=\"space-y-2\">\n                  {events.map((event) => (\n                    <div\n                      key={event.id}\n                      className={`p-3 rounded-lg border ${\n                        event.type === 'error' ? 'border-red-500/30 bg-red-500/5' :\n                        event.type === 'success' ? 'border-green-500/30 bg-green-500/5' :\n                        event.type === 'warning' ? 'border-yellow-500/30 bg-yellow-500/5' :\n                        'border-muted bg-muted/30'\n                      }`}\n                    >\n                      <div className=\"flex items-start gap-2\">\n                        {getEventIcon(event.type)}\n                        <div className=\"flex-1 min-w-0\">\n                          <div className=\"flex items-center gap-2 mb-1\">\n                            {getSourceBadge(event.source)}\n                            <span className=\"text-xs text-muted-foreground\">\n                              {event.timestamp.toLocaleTimeString()}\n                            </span>\n                          </div>\n                          <p className=\"text-sm\">{event.message}</p>\n                          {event.details && (\n                            <p className=\"text-xs text-muted-foreground mt-1\">\n                              {event.details}\n                            </p>\n                          )}\n                        </div>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              )}\n            </ScrollArea>\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Security Level Comparison */}\n      <Card className=\"mt-6\">\n        <CardHeader>\n          <CardTitle className=\"text-lg\">Security Level Comparison</CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"overflow-x-auto\">\n            <table className=\"w-full text-sm\">\n              <thead>\n                <tr className=\"border-b\">\n                  <th className=\"text-left py-2 px-4\">Feature</th>\n                  <th className=\"text-center py-2 px-4\">L1 (Hardware TEE)</th>\n                  <th className=\"text-center py-2 px-4\">L2 (Hybrid)</th>\n                  <th className=\"text-center py-2 px-4\">L3 (Software)</th>\n                </tr>\n              </thead>\n              <tbody>\n                <tr className=\"border-b\">\n                  <td className=\"py-2 px-4\">Key Storage</td>\n                  <td className=\"text-center py-2 px-4\"><CheckCircle2 className=\"w-4 h-4 text-green-500 mx-auto\" /></td>\n                  <td className=\"text-center py-2 px-4\"><AlertTriangle className=\"w-4 h-4 text-yellow-500 mx-auto\" /></td>\n                  <td className=\"text-center py-2 px-4\"><XCircle className=\"w-4 h-4 text-red-500 mx-auto\" /></td>\n                </tr>\n                <tr className=\"border-b\">\n                  <td className=\"py-2 px-4\">Decryption Location</td>\n                  <td className=\"text-center py-2 px-4 text-xs text-muted-foreground\">Hardware TEE</td>\n                  <td className=\"text-center py-2 px-4 text-xs text-muted-foreground\">Hardware Engine</td>\n                  <td className=\"text-center py-2 px-4 text-xs text-muted-foreground\">Software/Memory</td>\n                </tr>\n                <tr className=\"border-b\">\n                  <td className=\"py-2 px-4\">Max Resolution</td>\n                  <td className=\"text-center py-2 px-4 text-xs\">4K HDR</td>\n                  <td className=\"text-center py-2 px-4 text-xs\">1080p</td>\n                  <td className=\"text-center py-2 px-4 text-xs\">480p</td>\n                </tr>\n                <tr className=\"border-b\">\n                  <td className=\"py-2 px-4\">Extraction Risk</td>\n                  <td className=\"text-center py-2 px-4 text-xs text-green-400\">Very Low</td>\n                  <td className=\"text-center py-2 px-4 text-xs text-yellow-400\">Medium</td>\n                  <td className=\"text-center py-2 px-4 text-xs text-red-400\">High</td>\n                </tr>\n                <tr>\n                  <td className=\"py-2 px-4\">Typical Devices</td>\n                  <td className=\"text-center py-2 px-4 text-xs text-muted-foreground\">Smart TVs, Set-top boxes</td>\n                  <td className=\"text-center py-2 px-4 text-xs text-muted-foreground\">Some Android devices</td>\n                  <td className=\"text-center py-2 px-4 text-xs text-muted-foreground\">Desktop browsers</td>\n                </tr>\n              </tbody>\n            </table>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}