{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 22, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/lib/utils.ts"],"sourcesContent":["import { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,SAAS,GAAG,GAAG,MAAoB;IACxC,OAAO,IAAA,mNAAO,EAAC,IAAA,0LAAI,EAAC;AACtB"}},
    {"offset": {"line": 37, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/components/ui/button.tsx"],"sourcesContent":["import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-primary text-primary-foreground hover:bg-primary/90\",\n        destructive:\n          \"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60\",\n        outline:\n          \"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50\",\n        secondary:\n          \"bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        ghost:\n          \"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50\",\n        link: \"text-primary underline-offset-4 hover:underline\",\n      },\n      size: {\n        default: \"h-9 px-4 py-2 has-[>svg]:px-3\",\n        sm: \"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5\",\n        lg: \"h-10 rounded-md px-6 has-[>svg]:px-4\",\n        icon: \"size-9\",\n        \"icon-sm\": \"size-8\",\n        \"icon-lg\": \"size-10\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nfunction Button({\n  className,\n  variant = \"default\",\n  size = \"default\",\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"button\"> &\n  VariantProps<typeof buttonVariants> & {\n    asChild?: boolean\n  }) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"button\"\n      data-variant={variant}\n      data-size={size}\n      className={cn(buttonVariants({ variant, size, className }))}\n      {...props}\n    />\n  )\n}\n\nexport { Button, buttonVariants }\n"],"names":[],"mappings":";;;;;;;AACA;AACA;AAEA;;;;;AAEA,MAAM,iBAAiB,IAAA,oNAAG,EACxB,+bACA;IACE,UAAU;QACR,SAAS;YACP,SAAS;YACT,aACE;YACF,SACE;YACF,WACE;YACF,OACE;YACF,MAAM;QACR;QACA,MAAM;YACJ,SAAS;YACT,IAAI;YACJ,IAAI;YACJ,MAAM;YACN,WAAW;YACX,WAAW;QACb;IACF;IACA,iBAAiB;QACf,SAAS;QACT,MAAM;IACR;AACF;AAGF,SAAS,OAAO,EACd,SAAS,EACT,UAAU,SAAS,EACnB,OAAO,SAAS,EAChB,UAAU,KAAK,EACf,GAAG,OAIF;IACD,MAAM,OAAO,UAAU,qNAAI,GAAG;IAE9B,qBACE,2RAAC;QACC,aAAU;QACV,gBAAc;QACd,aAAW;QACX,WAAW,IAAA,sKAAE,EAAC,eAAe;YAAE;YAAS;YAAM;QAAU;QACvD,GAAG,KAAK;;;;;;AAGf"}},
    {"offset": {"line": 98, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/components/layout/PerspectiveToggle.tsx"],"sourcesContent":["'use client';\n\nimport { usePerspective } from '@/providers/PerspectiveProvider';\nimport { Button } from '@/components/ui/button';\nimport { Shield, Sword, Eye } from 'lucide-react';\nimport type { Perspective } from '@/types';\n\ninterface PerspectiveToggleProps {\n  size?: 'sm' | 'default' | 'lg';\n  showLabel?: boolean;\n  className?: string;\n}\n\nexport function PerspectiveToggle({\n  size = 'default',\n  showLabel = true,\n  className = '',\n}: PerspectiveToggleProps) {\n  const { perspective, setPerspective } = usePerspective();\n\n  const perspectives: { value: Perspective; icon: typeof Shield; label: string; color: string }[] = [\n    {\n      value: 'red-team',\n      icon: Sword,\n      label: 'Red Team',\n      color: 'text-red-team hover:bg-red-team/10 data-[active=true]:bg-red-team/20 data-[active=true]:text-red-team',\n    },\n    {\n      value: 'neutral',\n      icon: Eye,\n      label: 'Neutral',\n      color: 'text-muted-foreground hover:bg-accent data-[active=true]:bg-accent data-[active=true]:text-foreground',\n    },\n    {\n      value: 'blue-team',\n      icon: Shield,\n      label: 'Blue Team',\n      color: 'text-blue-team hover:bg-blue-team/10 data-[active=true]:bg-blue-team/20 data-[active=true]:text-blue-team',\n    },\n  ];\n\n  const iconSize = size === 'sm' ? 'h-3.5 w-3.5' : size === 'lg' ? 'h-5 w-5' : 'h-4 w-4';\n  const buttonSize = size === 'sm' ? 'h-8 px-2' : size === 'lg' ? 'h-11 px-4' : 'h-9 px-3';\n\n  return (\n    <div className={`flex items-center gap-1 rounded-lg border border-border bg-card p-1 ${className}`}>\n      {perspectives.map(({ value, icon: Icon, label, color }) => (\n        <Button\n          key={value}\n          variant=\"ghost\"\n          size=\"sm\"\n          data-active={perspective === value}\n          className={`${buttonSize} ${color} transition-all`}\n          onClick={() => setPerspective(value)}\n        >\n          <Icon className={iconSize} />\n          {showLabel && <span className=\"ml-1.5 text-xs font-medium\">{label}</span>}\n        </Button>\n      ))}\n    </div>\n  );\n}\n\n/**\n * Simple perspective indicator badge\n */\nexport function PerspectiveIndicator({ className = '' }: { className?: string }) {\n  const { perspective, perspectiveLabel } = usePerspective();\n\n  const colorClasses =\n    perspective === 'red-team'\n      ? 'bg-red-team/10 text-red-team border-red-team/30'\n      : perspective === 'blue-team'\n        ? 'bg-blue-team/10 text-blue-team border-blue-team/30'\n        : 'bg-muted text-muted-foreground border-border';\n\n  const Icon = perspective === 'red-team' ? Sword : perspective === 'blue-team' ? Shield : Eye;\n\n  return (\n    <div\n      className={`inline-flex items-center gap-1.5 rounded-full border px-2.5 py-1 text-xs font-medium ${colorClasses} ${className}`}\n    >\n      <Icon className=\"h-3 w-3\" />\n      {perspectiveLabel}\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;;;AAEA;AACA;AACA;AAAA;AAAA;AAJA;;;;;AAaO,SAAS,kBAAkB,EAChC,OAAO,SAAS,EAChB,YAAY,IAAI,EAChB,YAAY,EAAE,EACS;IACvB,MAAM,EAAE,WAAW,EAAE,cAAc,EAAE,GAAG,IAAA,uMAAc;IAEtD,MAAM,eAA4F;QAChG;YACE,OAAO;YACP,MAAM,0PAAK;YACX,OAAO;YACP,OAAO;QACT;QACA;YACE,OAAO;YACP,MAAM,oPAAG;YACT,OAAO;YACP,OAAO;QACT;QACA;YACE,OAAO;YACP,MAAM,6PAAM;YACZ,OAAO;YACP,OAAO;QACT;KACD;IAED,MAAM,WAAW,SAAS,OAAO,gBAAgB,SAAS,OAAO,YAAY;IAC7E,MAAM,aAAa,SAAS,OAAO,aAAa,SAAS,OAAO,cAAc;IAE9E,qBACE,2RAAC;QAAI,WAAW,CAAC,oEAAoE,EAAE,WAAW;kBAC/F,aAAa,GAAG,CAAC,CAAC,EAAE,KAAK,EAAE,MAAM,IAAI,EAAE,KAAK,EAAE,KAAK,EAAE,iBACpD,2RAAC,yLAAM;gBAEL,SAAQ;gBACR,MAAK;gBACL,eAAa,gBAAgB;gBAC7B,WAAW,GAAG,WAAW,CAAC,EAAE,MAAM,eAAe,CAAC;gBAClD,SAAS,IAAM,eAAe;;kCAE9B,2RAAC;wBAAK,WAAW;;;;;;oBAChB,2BAAa,2RAAC;wBAAK,WAAU;kCAA8B;;;;;;;eARvD;;;;;;;;;;AAaf;AAKO,SAAS,qBAAqB,EAAE,YAAY,EAAE,EAA0B;IAC7E,MAAM,EAAE,WAAW,EAAE,gBAAgB,EAAE,GAAG,IAAA,uMAAc;IAExD,MAAM,eACJ,gBAAgB,aACZ,oDACA,gBAAgB,cACd,uDACA;IAER,MAAM,OAAO,gBAAgB,aAAa,0PAAK,GAAG,gBAAgB,cAAc,6PAAM,GAAG,oPAAG;IAE5F,qBACE,2RAAC;QACC,WAAW,CAAC,qFAAqF,EAAE,aAAa,CAAC,EAAE,WAAW;;0BAE9H,2RAAC;gBAAK,WAAU;;;;;;YACf;;;;;;;AAGP"}},
    {"offset": {"line": 201, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/stores/progressStore.ts"],"sourcesContent":["/**\n * Progress Store - Zustand store for user learning progress\n */\n\nimport { create } from 'zustand';\nimport { persist } from 'zustand/middleware';\nimport type { UserProgress, Achievement } from '@/types';\n\ninterface ProgressState extends UserProgress {\n  // Article progress\n  markArticleRead: (articleId: string) => void;\n  isArticleRead: (articleId: string) => boolean;\n\n  // Lab progress\n  markLabCompleted: (labId: string) => void;\n  isLabCompleted: (labId: string) => boolean;\n\n  // Challenge progress\n  markChallengeCompleted: (challengeId: string, points: number) => void;\n  isChallengeCompleted: (challengeId: string) => boolean;\n\n  // Points\n  addPoints: (points: number) => void;\n\n  // Achievements\n  unlockAchievement: (achievement: Achievement) => void;\n  hasAchievement: (achievementId: string) => boolean;\n\n  // Reset\n  resetProgress: () => void;\n}\n\nconst initialProgress: UserProgress = {\n  articlesRead: [],\n  labsCompleted: [],\n  challengesCompleted: [],\n  totalPoints: 0,\n  currentPerspective: 'neutral',\n  lastActivityAt: new Date().toISOString(),\n  streakDays: 0,\n  achievements: [],\n};\n\nexport const useProgressStore = create<ProgressState>()(\n  persist(\n    (set, get) => ({\n      ...initialProgress,\n\n      markArticleRead: (articleId: string) =>\n        set((state) => ({\n          articlesRead: state.articlesRead.includes(articleId)\n            ? state.articlesRead\n            : [...state.articlesRead, articleId],\n          lastActivityAt: new Date().toISOString(),\n        })),\n\n      isArticleRead: (articleId: string) =>\n        get().articlesRead.includes(articleId),\n\n      markLabCompleted: (labId: string) =>\n        set((state) => ({\n          labsCompleted: state.labsCompleted.includes(labId)\n            ? state.labsCompleted\n            : [...state.labsCompleted, labId],\n          lastActivityAt: new Date().toISOString(),\n        })),\n\n      isLabCompleted: (labId: string) =>\n        get().labsCompleted.includes(labId),\n\n      markChallengeCompleted: (challengeId: string, points: number) =>\n        set((state) => ({\n          challengesCompleted: state.challengesCompleted.includes(challengeId)\n            ? state.challengesCompleted\n            : [...state.challengesCompleted, challengeId],\n          totalPoints: state.challengesCompleted.includes(challengeId)\n            ? state.totalPoints\n            : state.totalPoints + points,\n          lastActivityAt: new Date().toISOString(),\n        })),\n\n      isChallengeCompleted: (challengeId: string) =>\n        get().challengesCompleted.includes(challengeId),\n\n      addPoints: (points: number) =>\n        set((state) => ({\n          totalPoints: state.totalPoints + points,\n        })),\n\n      unlockAchievement: (achievement: Achievement) =>\n        set((state) => ({\n          achievements: state.achievements.some((a) => a.id === achievement.id)\n            ? state.achievements\n            : [\n                ...state.achievements,\n                { ...achievement, unlockedAt: new Date().toISOString() },\n              ],\n        })),\n\n      hasAchievement: (achievementId: string) =>\n        get().achievements.some((a) => a.id === achievementId),\n\n      resetProgress: () => set(initialProgress),\n    }),\n    {\n      name: 'drm-lab-progress',\n    }\n  )\n);\n"],"names":[],"mappings":";;;;AAAA;;CAEC,GAED;AACA;;;AA2BA,MAAM,kBAAgC;IACpC,cAAc,EAAE;IAChB,eAAe,EAAE;IACjB,qBAAqB,EAAE;IACvB,aAAa;IACb,oBAAoB;IACpB,gBAAgB,IAAI,OAAO,WAAW;IACtC,YAAY;IACZ,cAAc,EAAE;AAClB;AAEO,MAAM,mBAAmB,IAAA,+LAAM,IACpC,IAAA,qMAAO,EACL,CAAC,KAAK,MAAQ,CAAC;QACb,GAAG,eAAe;QAElB,iBAAiB,CAAC,YAChB,IAAI,CAAC,QAAU,CAAC;oBACd,cAAc,MAAM,YAAY,CAAC,QAAQ,CAAC,aACtC,MAAM,YAAY,GAClB;2BAAI,MAAM,YAAY;wBAAE;qBAAU;oBACtC,gBAAgB,IAAI,OAAO,WAAW;gBACxC,CAAC;QAEH,eAAe,CAAC,YACd,MAAM,YAAY,CAAC,QAAQ,CAAC;QAE9B,kBAAkB,CAAC,QACjB,IAAI,CAAC,QAAU,CAAC;oBACd,eAAe,MAAM,aAAa,CAAC,QAAQ,CAAC,SACxC,MAAM,aAAa,GACnB;2BAAI,MAAM,aAAa;wBAAE;qBAAM;oBACnC,gBAAgB,IAAI,OAAO,WAAW;gBACxC,CAAC;QAEH,gBAAgB,CAAC,QACf,MAAM,aAAa,CAAC,QAAQ,CAAC;QAE/B,wBAAwB,CAAC,aAAqB,SAC5C,IAAI,CAAC,QAAU,CAAC;oBACd,qBAAqB,MAAM,mBAAmB,CAAC,QAAQ,CAAC,eACpD,MAAM,mBAAmB,GACzB;2BAAI,MAAM,mBAAmB;wBAAE;qBAAY;oBAC/C,aAAa,MAAM,mBAAmB,CAAC,QAAQ,CAAC,eAC5C,MAAM,WAAW,GACjB,MAAM,WAAW,GAAG;oBACxB,gBAAgB,IAAI,OAAO,WAAW;gBACxC,CAAC;QAEH,sBAAsB,CAAC,cACrB,MAAM,mBAAmB,CAAC,QAAQ,CAAC;QAErC,WAAW,CAAC,SACV,IAAI,CAAC,QAAU,CAAC;oBACd,aAAa,MAAM,WAAW,GAAG;gBACnC,CAAC;QAEH,mBAAmB,CAAC,cAClB,IAAI,CAAC,QAAU,CAAC;oBACd,cAAc,MAAM,YAAY,CAAC,IAAI,CAAC,CAAC,IAAM,EAAE,EAAE,KAAK,YAAY,EAAE,IAChE,MAAM,YAAY,GAClB;2BACK,MAAM,YAAY;wBACrB;4BAAE,GAAG,WAAW;4BAAE,YAAY,IAAI,OAAO,WAAW;wBAAG;qBACxD;gBACP,CAAC;QAEH,gBAAgB,CAAC,gBACf,MAAM,YAAY,CAAC,IAAI,CAAC,CAAC,IAAM,EAAE,EAAE,KAAK;QAE1C,eAAe,IAAM,IAAI;IAC3B,CAAC,GACD;IACE,MAAM;AACR"}},
    {"offset": {"line": 269, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/components/layout/Header.tsx"],"sourcesContent":["'use client';\n\nimport Link from 'next/link';\nimport { usePathname } from 'next/navigation';\nimport { Button } from '@/components/ui/button';\nimport { PerspectiveToggle } from './PerspectiveToggle';\nimport { useProgressStore } from '@/stores/progressStore';\nimport {\n  Shield,\n  BookOpen,\n  FlaskConical,\n  Trophy,\n  Menu,\n  X,\n} from 'lucide-react';\nimport { useState } from 'react';\n\ninterface NavItem {\n  label: string;\n  href: string;\n  icon: typeof Shield;\n}\n\nconst navItems: NavItem[] = [\n  { label: 'Knowledge Base', href: '/knowledge-base', icon: BookOpen },\n  { label: 'Labs', href: '/labs', icon: FlaskConical },\n  { label: 'Challenges', href: '/challenges', icon: Trophy },\n];\n\nexport function Header() {\n  const pathname = usePathname();\n  const [mobileMenuOpen, setMobileMenuOpen] = useState(false);\n  const { totalPoints, challengesCompleted } = useProgressStore();\n\n  return (\n    <header className=\"sticky top-0 z-40 border-b border-border bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60\">\n      <div className=\"mx-auto flex h-16 max-w-7xl items-center justify-between px-4 sm:px-6 lg:px-8\">\n        {/* Logo */}\n        <Link href=\"/\" className=\"flex items-center gap-2\">\n          <div className=\"flex h-8 w-8 items-center justify-center rounded-lg bg-primary/10\">\n            <Shield className=\"h-5 w-5 text-primary\" />\n          </div>\n          <div className=\"hidden sm:block\">\n            <span className=\"font-bold text-foreground\">DRM Security</span>\n            <span className=\"ml-1 text-muted-foreground\">Lab</span>\n          </div>\n        </Link>\n\n        {/* Desktop Navigation */}\n        <nav className=\"hidden items-center gap-1 md:flex\">\n          {navItems.map((item) => {\n            const isActive =\n              pathname === item.href || pathname.startsWith(`${item.href}/`);\n            return (\n              <Link key={item.href} href={item.href}>\n                <Button\n                  variant={isActive ? 'secondary' : 'ghost'}\n                  size=\"sm\"\n                  className=\"gap-2\"\n                >\n                  <item.icon className=\"h-4 w-4\" />\n                  {item.label}\n                </Button>\n              </Link>\n            );\n          })}\n        </nav>\n\n        {/* Right section */}\n        <div className=\"flex items-center gap-4\">\n          {/* Progress indicator */}\n          <div className=\"hidden items-center gap-3 text-sm sm:flex\">\n            <div className=\"flex items-center gap-1.5 text-muted-foreground\">\n              <Trophy className=\"h-4 w-4 text-warning\" />\n              <span className=\"font-medium text-foreground\">{totalPoints}</span>\n              <span>pts</span>\n            </div>\n            <div className=\"h-4 w-px bg-border\" />\n            <div className=\"text-muted-foreground\">\n              <span className=\"font-medium text-foreground\">\n                {challengesCompleted.length}\n              </span>{' '}\n              solved\n            </div>\n          </div>\n\n          {/* Perspective Toggle */}\n          <PerspectiveToggle showLabel={false} size=\"sm\" className=\"hidden lg:flex\" />\n\n          {/* Mobile menu button */}\n          <Button\n            variant=\"ghost\"\n            size=\"sm\"\n            className=\"md:hidden\"\n            onClick={() => setMobileMenuOpen(!mobileMenuOpen)}\n          >\n            {mobileMenuOpen ? (\n              <X className=\"h-5 w-5\" />\n            ) : (\n              <Menu className=\"h-5 w-5\" />\n            )}\n          </Button>\n        </div>\n      </div>\n\n      {/* Mobile menu */}\n      {mobileMenuOpen && (\n        <div className=\"border-t border-border bg-background md:hidden\">\n          <nav className=\"flex flex-col gap-1 p-4\">\n            {navItems.map((item) => {\n              const isActive =\n                pathname === item.href || pathname.startsWith(`${item.href}/`);\n              return (\n                <Link\n                  key={item.href}\n                  href={item.href}\n                  onClick={() => setMobileMenuOpen(false)}\n                >\n                  <Button\n                    variant={isActive ? 'secondary' : 'ghost'}\n                    className=\"w-full justify-start gap-2\"\n                  >\n                    <item.icon className=\"h-4 w-4\" />\n                    {item.label}\n                  </Button>\n                </Link>\n              );\n            })}\n            <div className=\"my-2 border-t border-border\" />\n            <div className=\"px-2\">\n              <p className=\"mb-2 text-xs font-medium text-muted-foreground\">\n                Perspective\n              </p>\n              <PerspectiveToggle showLabel size=\"sm\" />\n            </div>\n          </nav>\n        </div>\n      )}\n    </header>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAQA;AAfA;;;;;;;;;AAuBA,MAAM,WAAsB;IAC1B;QAAE,OAAO;QAAkB,MAAM;QAAmB,MAAM,uQAAQ;IAAC;IACnE;QAAE,OAAO;QAAQ,MAAM;QAAS,MAAM,mRAAY;IAAC;IACnD;QAAE,OAAO;QAAc,MAAM;QAAe,MAAM,6PAAM;IAAC;CAC1D;AAEM,SAAS;IACd,MAAM,WAAW,IAAA,8LAAW;IAC5B,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,IAAA,8PAAQ,EAAC;IACrD,MAAM,EAAE,WAAW,EAAE,mBAAmB,EAAE,GAAG,IAAA,+LAAgB;IAE7D,qBACE,2RAAC;QAAO,WAAU;;0BAChB,2RAAC;gBAAI,WAAU;;kCAEb,2RAAC,oNAAI;wBAAC,MAAK;wBAAI,WAAU;;0CACvB,2RAAC;gCAAI,WAAU;0CACb,cAAA,2RAAC,6PAAM;oCAAC,WAAU;;;;;;;;;;;0CAEpB,2RAAC;gCAAI,WAAU;;kDACb,2RAAC;wCAAK,WAAU;kDAA4B;;;;;;kDAC5C,2RAAC;wCAAK,WAAU;kDAA6B;;;;;;;;;;;;;;;;;;kCAKjD,2RAAC;wBAAI,WAAU;kCACZ,SAAS,GAAG,CAAC,CAAC;4BACb,MAAM,WACJ,aAAa,KAAK,IAAI,IAAI,SAAS,UAAU,CAAC,GAAG,KAAK,IAAI,CAAC,CAAC,CAAC;4BAC/D,qBACE,2RAAC,oNAAI;gCAAiB,MAAM,KAAK,IAAI;0CACnC,cAAA,2RAAC,yLAAM;oCACL,SAAS,WAAW,cAAc;oCAClC,MAAK;oCACL,WAAU;;sDAEV,2RAAC,KAAK,IAAI;4CAAC,WAAU;;;;;;wCACpB,KAAK,KAAK;;;;;;;+BAPJ,KAAK,IAAI;;;;;wBAWxB;;;;;;kCAIF,2RAAC;wBAAI,WAAU;;0CAEb,2RAAC;gCAAI,WAAU;;kDACb,2RAAC;wCAAI,WAAU;;0DACb,2RAAC,6PAAM;gDAAC,WAAU;;;;;;0DAClB,2RAAC;gDAAK,WAAU;0DAA+B;;;;;;0DAC/C,2RAAC;0DAAK;;;;;;;;;;;;kDAER,2RAAC;wCAAI,WAAU;;;;;;kDACf,2RAAC;wCAAI,WAAU;;0DACb,2RAAC;gDAAK,WAAU;0DACb,oBAAoB,MAAM;;;;;;4CACrB;4CAAI;;;;;;;;;;;;;0CAMhB,2RAAC,mNAAiB;gCAAC,WAAW;gCAAO,MAAK;gCAAK,WAAU;;;;;;0CAGzD,2RAAC,yLAAM;gCACL,SAAQ;gCACR,MAAK;gCACL,WAAU;gCACV,SAAS,IAAM,kBAAkB,CAAC;0CAEjC,+BACC,2RAAC,8OAAC;oCAAC,WAAU;;;;;yDAEb,2RAAC,uPAAI;oCAAC,WAAU;;;;;;;;;;;;;;;;;;;;;;;YAOvB,gCACC,2RAAC;gBAAI,WAAU;0BACb,cAAA,2RAAC;oBAAI,WAAU;;wBACZ,SAAS,GAAG,CAAC,CAAC;4BACb,MAAM,WACJ,aAAa,KAAK,IAAI,IAAI,SAAS,UAAU,CAAC,GAAG,KAAK,IAAI,CAAC,CAAC,CAAC;4BAC/D,qBACE,2RAAC,oNAAI;gCAEH,MAAM,KAAK,IAAI;gCACf,SAAS,IAAM,kBAAkB;0CAEjC,cAAA,2RAAC,yLAAM;oCACL,SAAS,WAAW,cAAc;oCAClC,WAAU;;sDAEV,2RAAC,KAAK,IAAI;4CAAC,WAAU;;;;;;wCACpB,KAAK,KAAK;;;;;;;+BATR,KAAK,IAAI;;;;;wBAapB;sCACA,2RAAC;4BAAI,WAAU;;;;;;sCACf,2RAAC;4BAAI,WAAU;;8CACb,2RAAC;oCAAE,WAAU;8CAAiD;;;;;;8CAG9D,2RAAC,mNAAiB;oCAAC,SAAS;oCAAC,MAAK;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAOhD"}},
    {"offset": {"line": 608, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/components/ui/scroll-area.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as ScrollAreaPrimitive from \"@radix-ui/react-scroll-area\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction ScrollArea({\n  className,\n  children,\n  ...props\n}: React.ComponentProps<typeof ScrollAreaPrimitive.Root>) {\n  return (\n    <ScrollAreaPrimitive.Root\n      data-slot=\"scroll-area\"\n      className={cn(\"relative\", className)}\n      {...props}\n    >\n      <ScrollAreaPrimitive.Viewport\n        data-slot=\"scroll-area-viewport\"\n        className=\"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1\"\n      >\n        {children}\n      </ScrollAreaPrimitive.Viewport>\n      <ScrollBar />\n      <ScrollAreaPrimitive.Corner />\n    </ScrollAreaPrimitive.Root>\n  )\n}\n\nfunction ScrollBar({\n  className,\n  orientation = \"vertical\",\n  ...props\n}: React.ComponentProps<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>) {\n  return (\n    <ScrollAreaPrimitive.ScrollAreaScrollbar\n      data-slot=\"scroll-area-scrollbar\"\n      orientation={orientation}\n      className={cn(\n        \"flex touch-none p-px transition-colors select-none\",\n        orientation === \"vertical\" &&\n          \"h-full w-2.5 border-l border-l-transparent\",\n        orientation === \"horizontal\" &&\n          \"h-2.5 flex-col border-t border-t-transparent\",\n        className\n      )}\n      {...props}\n    >\n      <ScrollAreaPrimitive.ScrollAreaThumb\n        data-slot=\"scroll-area-thumb\"\n        className=\"bg-border relative flex-1 rounded-full\"\n      />\n    </ScrollAreaPrimitive.ScrollAreaScrollbar>\n  )\n}\n\nexport { ScrollArea, ScrollBar }\n"],"names":[],"mappings":";;;;;;;AAGA;AAEA;AALA;;;;AAOA,SAAS,WAAW,EAClB,SAAS,EACT,QAAQ,EACR,GAAG,OACmD;IACtD,qBACE,2RAAC,+NAAwB;QACvB,aAAU;QACV,WAAW,IAAA,sKAAE,EAAC,YAAY;QACzB,GAAG,KAAK;;0BAET,2RAAC,mOAA4B;gBAC3B,aAAU;gBACV,WAAU;0BAET;;;;;;0BAEH,2RAAC;;;;;0BACD,2RAAC,iOAA0B;;;;;;;;;;;AAGjC;AAEA,SAAS,UAAU,EACjB,SAAS,EACT,cAAc,UAAU,EACxB,GAAG,OACkE;IACrE,qBACE,2RAAC,8OAAuC;QACtC,aAAU;QACV,aAAa;QACb,WAAW,IAAA,sKAAE,EACX,sDACA,gBAAgB,cACd,8CACF,gBAAgB,gBACd,gDACF;QAED,GAAG,KAAK;kBAET,cAAA,2RAAC,0OAAmC;YAClC,aAAU;YACV,WAAU;;;;;;;;;;;AAIlB"}},
    {"offset": {"line": 678, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/components/ui/badge.tsx"],"sourcesContent":["import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  \"inline-flex items-center justify-center rounded-full border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90\",\n        secondary:\n          \"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90\",\n        destructive:\n          \"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60\",\n        outline:\n          \"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nfunction Badge({\n  className,\n  variant,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"span\"> &\n  VariantProps<typeof badgeVariants> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"span\"\n\n  return (\n    <Comp\n      data-slot=\"badge\"\n      className={cn(badgeVariants({ variant }), className)}\n      {...props}\n    />\n  )\n}\n\nexport { Badge, badgeVariants }\n"],"names":[],"mappings":";;;;;;;AACA;AACA;AAEA;;;;;AAEA,MAAM,gBAAgB,IAAA,oNAAG,EACvB,oZACA;IACE,UAAU;QACR,SAAS;YACP,SACE;YACF,WACE;YACF,aACE;YACF,SACE;QACJ;IACF;IACA,iBAAiB;QACf,SAAS;IACX;AACF;AAGF,SAAS,MAAM,EACb,SAAS,EACT,OAAO,EACP,UAAU,KAAK,EACf,GAAG,OAEuD;IAC1D,MAAM,OAAO,UAAU,qNAAI,GAAG;IAE9B,qBACE,2RAAC;QACC,aAAU;QACV,WAAW,IAAA,sKAAE,EAAC,cAAc;YAAE;QAAQ,IAAI;QACzC,GAAG,KAAK;;;;;;AAGf"}},
    {"offset": {"line": 724, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/components/ui/separator.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as SeparatorPrimitive from \"@radix-ui/react-separator\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Separator({\n  className,\n  orientation = \"horizontal\",\n  decorative = true,\n  ...props\n}: React.ComponentProps<typeof SeparatorPrimitive.Root>) {\n  return (\n    <SeparatorPrimitive.Root\n      data-slot=\"separator\"\n      decorative={decorative}\n      orientation={orientation}\n      className={cn(\n        \"bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Separator }\n"],"names":[],"mappings":";;;;;AAGA;AAEA;AALA;;;;AAOA,SAAS,UAAU,EACjB,SAAS,EACT,cAAc,YAAY,EAC1B,aAAa,IAAI,EACjB,GAAG,OACkD;IACrD,qBACE,2RAAC,0NAAuB;QACtB,aAAU;QACV,YAAY;QACZ,aAAa;QACb,WAAW,IAAA,sKAAE,EACX,kKACA;QAED,GAAG,KAAK;;;;;;AAGf"}},
    {"offset": {"line": 753, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/components/layout/Sidebar.tsx"],"sourcesContent":["'use client';\n\nimport Link from 'next/link';\nimport { usePathname } from 'next/navigation';\nimport { Button } from '@/components/ui/button';\nimport { ScrollArea } from '@/components/ui/scroll-area';\nimport { Badge } from '@/components/ui/badge';\nimport { Separator } from '@/components/ui/separator';\nimport { PerspectiveIndicator } from './PerspectiveToggle';\nimport {\n  BookOpen,\n  FlaskConical,\n  Trophy,\n  Shield,\n  Sword,\n  Network,\n  Lock,\n  Key,\n  Eye,\n  FileText,\n  Fingerprint,\n  AlertTriangle,\n  ChevronRight,\n  GitBranch,\n} from 'lucide-react';\nimport type { NavigationItem } from '@/types';\n\ninterface SidebarProps {\n  className?: string;\n}\n\nconst knowledgeBaseItems: NavigationItem[] = [\n  { id: 'overview', label: 'DRM Overview', href: '/knowledge-base/overview', icon: 'BookOpen' },\n  { id: 'widevine', label: 'Widevine', href: '/knowledge-base/widevine', icon: 'Shield' },\n  { id: 'fairplay', label: 'FairPlay', href: '/knowledge-base/fairplay', icon: 'Shield' },\n  { id: 'playready', label: 'PlayReady', href: '/knowledge-base/playready', icon: 'Shield' },\n  { id: 'encryption', label: 'Encryption Basics', href: '/knowledge-base/encryption', icon: 'Lock' },\n  { id: 'protocols', label: 'License Protocols', href: '/knowledge-base/protocols', icon: 'Network' },\n];\n\nconst labItems: NavigationItem[] = [\n  { id: 'license-server', label: 'License Server', href: '/labs/license-server', icon: 'Network' },\n  { id: 'key-exchange', label: 'Key Exchange', href: '/labs/key-exchange', icon: 'Key' },\n  { id: 'encryption', label: 'Encryption Lab', href: '/labs/encryption', icon: 'Lock' },\n  { id: 'cdm-simulator', label: 'CDM Simulator', href: '/labs/cdm-simulator', icon: 'Shield' },\n];\n\nconst attackItems: NavigationItem[] = [\n  { id: 'cdm-extraction', label: 'CDM Extraction', href: '/labs/attacks/cdm-extraction', icon: 'Sword' },\n  { id: 'key-sharing', label: 'Key Sharing', href: '/labs/attacks/key-sharing', icon: 'Key' },\n  { id: 'mitm', label: 'MITM Attack', href: '/labs/attacks/mitm', icon: 'Network' },\n  { id: 'hdcp-bypass', label: 'HDCP Bypass', href: '/labs/attacks/hdcp-bypass', icon: 'Eye' },\n];\n\nconst defenseItems: NavigationItem[] = [\n  { id: 'attestation', label: 'Device Attestation', href: '/labs/defense/attestation', icon: 'Fingerprint' },\n  { id: 'watermarking', label: 'Watermarking', href: '/labs/defense/watermarking', icon: 'FileText' },\n  { id: 'anomaly', label: 'Anomaly Detection', href: '/labs/defense/anomaly', icon: 'AlertTriangle' },\n];\n\nconst iconMap: Record<string, typeof Shield> = {\n  BookOpen,\n  Shield,\n  Lock,\n  Network,\n  Key,\n  Sword,\n  Eye,\n  FileText,\n  Fingerprint,\n  AlertTriangle,\n  GitBranch,\n  FlaskConical,\n  Trophy,\n};\n\ninterface NavSectionProps {\n  title: string;\n  items: NavigationItem[];\n  basePath?: string;\n  badge?: string | number;\n  badgeVariant?: 'default' | 'secondary' | 'destructive' | 'outline';\n}\n\nfunction NavSection({ title, items, badge, badgeVariant = 'secondary' }: NavSectionProps) {\n  const pathname = usePathname();\n\n  return (\n    <div className=\"py-2\">\n      <div className=\"mb-1 flex items-center justify-between px-3\">\n        <h3 className=\"text-xs font-semibold uppercase tracking-wider text-muted-foreground\">\n          {title}\n        </h3>\n        {badge !== undefined && (\n          <Badge variant={badgeVariant} className=\"text-xs\">\n            {badge}\n          </Badge>\n        )}\n      </div>\n      <div className=\"space-y-0.5\">\n        {items.map((item) => {\n          const Icon = iconMap[item.icon || 'BookOpen'] || BookOpen;\n          const isActive = pathname === item.href;\n\n          return (\n            <Link key={item.id} href={item.href}>\n              <Button\n                variant={isActive ? 'secondary' : 'ghost'}\n                size=\"sm\"\n                className=\"w-full justify-start gap-2 px-3 font-normal\"\n                disabled={item.disabled}\n              >\n                <Icon className=\"h-4 w-4\" />\n                <span className=\"flex-1 truncate text-left\">{item.label}</span>\n                {item.badge && (\n                  <Badge variant=\"outline\" className=\"ml-auto text-xs\">\n                    {item.badge}\n                  </Badge>\n                )}\n                {isActive && <ChevronRight className=\"h-3 w-3 text-muted-foreground\" />}\n              </Button>\n            </Link>\n          );\n        })}\n      </div>\n    </div>\n  );\n}\n\nexport function Sidebar({ className = '' }: SidebarProps) {\n  const pathname = usePathname();\n\n  // Determine which section we're in\n  const isKnowledgeBase = pathname.startsWith('/knowledge-base');\n  const isLabs = pathname.startsWith('/labs');\n  const isChallenges = pathname.startsWith('/challenges');\n\n  return (\n    <aside\n      className={`flex w-64 flex-col border-r border-border bg-sidebar ${className}`}\n    >\n      <div className=\"p-4\">\n        <PerspectiveIndicator className=\"w-full justify-center\" />\n      </div>\n\n      <Separator />\n\n      <ScrollArea className=\"flex-1\">\n        <div className=\"p-2\">\n          {/* Always show main navigation */}\n          <NavSection\n            title=\"Learn\"\n            items={[\n              { id: 'kb', label: 'Knowledge Base', href: '/knowledge-base', icon: 'BookOpen' },\n              { id: 'diagrams', label: 'Diagrams', href: '/diagrams', icon: 'GitBranch' },\n              { id: 'labs', label: 'Labs', href: '/labs', icon: 'FlaskConical' },\n              { id: 'challenges', label: 'Challenges', href: '/challenges', icon: 'Trophy' },\n            ]}\n          />\n\n          <Separator className=\"my-2\" />\n\n          {/* Context-sensitive navigation */}\n          {isKnowledgeBase && (\n            <NavSection title=\"Topics\" items={knowledgeBaseItems} />\n          )}\n\n          {isLabs && (\n            <>\n              <NavSection title=\"Simulations\" items={labItems} />\n              <Separator className=\"my-2\" />\n              <NavSection\n                title=\"Attack Scenarios\"\n                items={attackItems}\n                badge=\"Red\"\n                badgeVariant=\"destructive\"\n              />\n              <Separator className=\"my-2\" />\n              <NavSection\n                title=\"Defense Lab\"\n                items={defenseItems}\n                badge=\"Blue\"\n              />\n            </>\n          )}\n\n          {isChallenges && (\n            <NavSection\n              title=\"Categories\"\n              items={[\n                { id: 'all', label: 'All Challenges', href: '/challenges', icon: 'Trophy' },\n                { id: 'encryption', label: 'Encryption', href: '/challenges?category=encryption', icon: 'Lock' },\n                { id: 'protocols', label: 'Protocols', href: '/challenges?category=protocols', icon: 'Network' },\n                { id: 'forensics', label: 'Forensics', href: '/challenges?category=forensics', icon: 'Eye' },\n              ]}\n            />\n          )}\n        </div>\n      </ScrollArea>\n\n      <Separator />\n\n      <div className=\"p-4\">\n        <div className=\"rounded-lg border border-border bg-card p-3\">\n          <div className=\"flex items-center gap-2 text-sm\">\n            <FlaskConical className=\"h-4 w-4 text-primary\" />\n            <span className=\"font-medium\">Quick Start</span>\n          </div>\n          <p className=\"mt-1 text-xs text-muted-foreground\">\n            New here? Start with the DRM Overview to understand the basics.\n          </p>\n          <Link href=\"/knowledge-base/overview\">\n            <Button size=\"sm\" variant=\"secondary\" className=\"mt-2 w-full\">\n              Get Started\n            </Button>\n          </Link>\n        </div>\n      </div>\n    </aside>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1264, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/components/layout/Footer.tsx"],"sourcesContent":["'use client';\n\nimport Link from 'next/link';\nimport { Shield, Github, BookOpen, Scale } from 'lucide-react';\n\nexport function Footer() {\n  return (\n    <footer className=\"border-t border-border bg-background\">\n      <div className=\"mx-auto max-w-7xl px-4 py-8 sm:px-6 lg:px-8\">\n        <div className=\"grid gap-8 md:grid-cols-3\">\n          {/* About */}\n          <div>\n            <div className=\"flex items-center gap-2\">\n              <div className=\"flex h-8 w-8 items-center justify-center rounded-lg bg-primary/10\">\n                <Shield className=\"h-5 w-5 text-primary\" />\n              </div>\n              <span className=\"font-bold text-foreground\">DRM Security Lab</span>\n            </div>\n            <p className=\"mt-3 text-sm text-muted-foreground\">\n              An educational platform for understanding Digital Rights Management\n              security concepts, attack vectors, and defense mechanisms.\n            </p>\n          </div>\n\n          {/* Quick Links */}\n          <div>\n            <h3 className=\"font-semibold text-foreground\">Quick Links</h3>\n            <ul className=\"mt-3 space-y-2 text-sm\">\n              <li>\n                <Link\n                  href=\"/knowledge-base\"\n                  className=\"text-muted-foreground hover:text-foreground transition-colors\"\n                >\n                  Knowledge Base\n                </Link>\n              </li>\n              <li>\n                <Link\n                  href=\"/labs\"\n                  className=\"text-muted-foreground hover:text-foreground transition-colors\"\n                >\n                  Interactive Labs\n                </Link>\n              </li>\n              <li>\n                <Link\n                  href=\"/challenges\"\n                  className=\"text-muted-foreground hover:text-foreground transition-colors\"\n                >\n                  CTF Challenges\n                </Link>\n              </li>\n              <li>\n                <Link\n                  href=\"/knowledge-base/overview\"\n                  className=\"text-muted-foreground hover:text-foreground transition-colors\"\n                >\n                  Getting Started\n                </Link>\n              </li>\n            </ul>\n          </div>\n\n          {/* Legal */}\n          <div>\n            <h3 className=\"font-semibold text-foreground\">Legal & Ethics</h3>\n            <ul className=\"mt-3 space-y-2 text-sm\">\n              <li className=\"flex items-center gap-2 text-muted-foreground\">\n                <Scale className=\"h-4 w-4\" />\n                <span>Educational use only</span>\n              </li>\n              <li className=\"flex items-center gap-2 text-muted-foreground\">\n                <BookOpen className=\"h-4 w-4\" />\n                <span>Not for circumvention</span>\n              </li>\n            </ul>\n            <p className=\"mt-4 text-xs text-muted-foreground\">\n              This platform does not provide tools or instructions for\n              circumventing actual DRM systems. All demonstrations use mock\n              systems created for educational purposes.\n            </p>\n          </div>\n        </div>\n\n        <div className=\"mt-8 flex flex-col items-center justify-between gap-4 border-t border-border pt-8 sm:flex-row\">\n          <p className=\"text-xs text-muted-foreground\">\n            &copy; {new Date().getFullYear()} DRM Security Lab. For educational\n            purposes only.\n          </p>\n          <div className=\"flex items-center gap-4\">\n            <Link\n              href=\"https://github.com\"\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n              className=\"text-muted-foreground hover:text-foreground transition-colors\"\n            >\n              <Github className=\"h-5 w-5\" />\n              <span className=\"sr-only\">GitHub</span>\n            </Link>\n          </div>\n        </div>\n      </div>\n    </footer>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAAA;AAAA;AAAA;AAHA;;;;AAKO,SAAS;IACd,qBACE,2RAAC;QAAO,WAAU;kBAChB,cAAA,2RAAC;YAAI,WAAU;;8BACb,2RAAC;oBAAI,WAAU;;sCAEb,2RAAC;;8CACC,2RAAC;oCAAI,WAAU;;sDACb,2RAAC;4CAAI,WAAU;sDACb,cAAA,2RAAC,6PAAM;gDAAC,WAAU;;;;;;;;;;;sDAEpB,2RAAC;4CAAK,WAAU;sDAA4B;;;;;;;;;;;;8CAE9C,2RAAC;oCAAE,WAAU;8CAAqC;;;;;;;;;;;;sCAOpD,2RAAC;;8CACC,2RAAC;oCAAG,WAAU;8CAAgC;;;;;;8CAC9C,2RAAC;oCAAG,WAAU;;sDACZ,2RAAC;sDACC,cAAA,2RAAC,oNAAI;gDACH,MAAK;gDACL,WAAU;0DACX;;;;;;;;;;;sDAIH,2RAAC;sDACC,cAAA,2RAAC,oNAAI;gDACH,MAAK;gDACL,WAAU;0DACX;;;;;;;;;;;sDAIH,2RAAC;sDACC,cAAA,2RAAC,oNAAI;gDACH,MAAK;gDACL,WAAU;0DACX;;;;;;;;;;;sDAIH,2RAAC;sDACC,cAAA,2RAAC,oNAAI;gDACH,MAAK;gDACL,WAAU;0DACX;;;;;;;;;;;;;;;;;;;;;;;sCAQP,2RAAC;;8CACC,2RAAC;oCAAG,WAAU;8CAAgC;;;;;;8CAC9C,2RAAC;oCAAG,WAAU;;sDACZ,2RAAC;4CAAG,WAAU;;8DACZ,2RAAC,0PAAK;oDAAC,WAAU;;;;;;8DACjB,2RAAC;8DAAK;;;;;;;;;;;;sDAER,2RAAC;4CAAG,WAAU;;8DACZ,2RAAC,uQAAQ;oDAAC,WAAU;;;;;;8DACpB,2RAAC;8DAAK;;;;;;;;;;;;;;;;;;8CAGV,2RAAC;oCAAE,WAAU;8CAAqC;;;;;;;;;;;;;;;;;;8BAQtD,2RAAC;oBAAI,WAAU;;sCACb,2RAAC;4BAAE,WAAU;;gCAAgC;gCACnC,IAAI,OAAO,WAAW;gCAAG;;;;;;;sCAGnC,2RAAC;4BAAI,WAAU;sCACb,cAAA,2RAAC,oNAAI;gCACH,MAAK;gCACL,QAAO;gCACP,KAAI;gCACJ,WAAU;;kDAEV,2RAAC,6PAAM;wCAAC,WAAU;;;;;;kDAClB,2RAAC;wCAAK,WAAU;kDAAU;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAOxC"}},
    {"offset": {"line": 1575, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/components/diagrams/FlowDiagram.tsx"],"sourcesContent":["'use client';\n\nimport { useCallback, useState } from 'react';\nimport {\n  ReactFlow,\n  Node,\n  Edge,\n  Controls,\n  Background,\n  MiniMap,\n  useNodesState,\n  useEdgesState,\n  BackgroundVariant,\n  NodeTypes,\n  MarkerType,\n  Panel,\n} from '@xyflow/react';\nimport '@xyflow/react/dist/style.css';\nimport { cn } from '@/lib/utils';\n\n// Custom node component for DRM entities\ninterface DRMNodeData {\n  label: string;\n  description?: string;\n  type?: 'client' | 'server' | 'cdn' | 'attacker' | 'defense' | 'key' | 'content';\n  icon?: React.ReactNode;\n}\n\nfunction DRMNode({ data, selected }: { data: DRMNodeData; selected: boolean }) {\n  const typeStyles: Record<string, string> = {\n    client: 'bg-blue-500/20 border-blue-500 text-blue-400',\n    server: 'bg-purple-500/20 border-purple-500 text-purple-400',\n    cdn: 'bg-green-500/20 border-green-500 text-green-400',\n    attacker: 'bg-red-500/20 border-red-500 text-red-400',\n    defense: 'bg-cyan-500/20 border-cyan-500 text-cyan-400',\n    key: 'bg-yellow-500/20 border-yellow-500 text-yellow-400',\n    content: 'bg-orange-500/20 border-orange-500 text-orange-400',\n  };\n\n  const style = typeStyles[data.type || 'client'] || typeStyles.client;\n\n  return (\n    <div\n      className={cn(\n        'px-4 py-3 rounded-lg border-2 min-w-[120px] text-center transition-all',\n        style,\n        selected && 'ring-2 ring-primary ring-offset-2 ring-offset-background'\n      )}\n    >\n      {data.icon && <div className=\"mb-1 flex justify-center\">{data.icon}</div>}\n      <div className=\"font-semibold text-sm\">{data.label}</div>\n      {data.description && (\n        <div className=\"text-xs opacity-70 mt-1\">{data.description}</div>\n      )}\n    </div>\n  );\n}\n\n// Custom edge label component\nfunction EdgeLabel({ label }: { label: string }) {\n  return (\n    <div className=\"px-2 py-1 bg-background/90 border border-border rounded text-xs text-muted-foreground\">\n      {label}\n    </div>\n  );\n}\n\nconst nodeTypes: NodeTypes = {\n  drm: DRMNode,\n};\n\ninterface FlowDiagramProps {\n  nodes: Node[];\n  edges: Edge[];\n  title?: string;\n  description?: string;\n  className?: string;\n  interactive?: boolean;\n  showMiniMap?: boolean;\n  showControls?: boolean;\n  fitView?: boolean;\n  animatedEdges?: boolean;\n  onNodeClick?: (node: Node) => void;\n}\n\nexport function FlowDiagram({\n  nodes: initialNodes,\n  edges: initialEdges,\n  title,\n  description,\n  className,\n  interactive = true,\n  showMiniMap = false,\n  showControls = true,\n  fitView = true,\n  animatedEdges = true,\n  onNodeClick,\n}: FlowDiagramProps) {\n  const [nodes, setNodes, onNodesChange] = useNodesState(initialNodes);\n  const [edges, setEdges, onEdgesChange] = useEdgesState(\n    animatedEdges\n      ? initialEdges.map((edge) => ({ ...edge, animated: true }))\n      : initialEdges\n  );\n  const [selectedNode, setSelectedNode] = useState<Node | null>(null);\n\n  const handleNodeClick = useCallback(\n    (_: React.MouseEvent, node: Node) => {\n      setSelectedNode(node);\n      onNodeClick?.(node);\n    },\n    [onNodeClick]\n  );\n\n  return (\n    <div className={cn('w-full h-[500px] rounded-lg border border-border bg-zinc-950', className)}>\n      <ReactFlow\n        nodes={nodes}\n        edges={edges}\n        onNodesChange={interactive ? onNodesChange : undefined}\n        onEdgesChange={interactive ? onEdgesChange : undefined}\n        onNodeClick={handleNodeClick}\n        nodeTypes={nodeTypes}\n        fitView={fitView}\n        proOptions={{ hideAttribution: true }}\n        className=\"bg-zinc-950\"\n        defaultEdgeOptions={{\n          type: 'smoothstep',\n          markerEnd: {\n            type: MarkerType.ArrowClosed,\n            width: 20,\n            height: 20,\n          },\n          style: {\n            strokeWidth: 2,\n            stroke: 'hsl(var(--muted-foreground))',\n          },\n        }}\n      >\n        {showControls && <Controls className=\"bg-background border-border\" />}\n        <Background variant={BackgroundVariant.Dots} gap={16} size={1} color=\"hsl(var(--muted-foreground) / 0.2)\" />\n        {showMiniMap && (\n          <MiniMap\n            nodeColor={(node) => {\n              const data = node.data as unknown as DRMNodeData | undefined;\n              const type = data?.type || 'client';\n              const colors: Record<string, string> = {\n                client: '#3b82f6',\n                server: '#a855f7',\n                cdn: '#22c55e',\n                attacker: '#ef4444',\n                defense: '#06b6d4',\n                key: '#eab308',\n                content: '#f97316',\n              };\n              return colors[type] || '#3b82f6';\n            }}\n            className=\"bg-background/80\"\n          />\n        )}\n        {(title || description) && (\n          <Panel position=\"top-left\" className=\"bg-background/80 p-3 rounded-lg border border-border\">\n            {title && <h3 className=\"font-semibold text-foreground\">{title}</h3>}\n            {description && <p className=\"text-sm text-muted-foreground mt-1\">{description}</p>}\n          </Panel>\n        )}\n        {selectedNode && (\n          <Panel position=\"bottom-left\" className=\"bg-background/90 p-3 rounded-lg border border-border max-w-xs\">\n            <h4 className=\"font-semibold text-foreground\">{(selectedNode.data as unknown as DRMNodeData).label}</h4>\n            {(selectedNode.data as unknown as DRMNodeData).description && (\n              <p className=\"text-sm text-muted-foreground mt-1\">\n                {(selectedNode.data as unknown as DRMNodeData).description}\n              </p>\n            )}\n          </Panel>\n        )}\n      </ReactFlow>\n    </div>\n  );\n}\n\nexport type { DRMNodeData };\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1795, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/components/ui/card.tsx"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Card({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card\"\n      className={cn(\n        \"bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-header\"\n      className={cn(\n        \"@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardTitle({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-title\"\n      className={cn(\"leading-none font-semibold\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardDescription({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-description\"\n      className={cn(\"text-muted-foreground text-sm\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardAction({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-action\"\n      className={cn(\n        \"col-start-2 row-span-2 row-start-1 self-start justify-self-end\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-content\"\n      className={cn(\"px-6\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-footer\"\n      className={cn(\"flex items-center px-6 [.border-t]:pt-6\", className)}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Card,\n  CardHeader,\n  CardFooter,\n  CardTitle,\n  CardAction,\n  CardDescription,\n  CardContent,\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAEA;;;AAEA,SAAS,KAAK,EAAE,SAAS,EAAE,GAAG,OAAoC;IAChE,qBACE,2RAAC;QACC,aAAU;QACV,WAAW,IAAA,sKAAE,EACX,qFACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,2RAAC;QACC,aAAU;QACV,WAAW,IAAA,sKAAE,EACX,4JACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,UAAU,EAAE,SAAS,EAAE,GAAG,OAAoC;IACrE,qBACE,2RAAC;QACC,aAAU;QACV,WAAW,IAAA,sKAAE,EAAC,8BAA8B;QAC3C,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,gBAAgB,EAAE,SAAS,EAAE,GAAG,OAAoC;IAC3E,qBACE,2RAAC;QACC,aAAU;QACV,WAAW,IAAA,sKAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,2RAAC;QACC,aAAU;QACV,WAAW,IAAA,sKAAE,EACX,kEACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,YAAY,EAAE,SAAS,EAAE,GAAG,OAAoC;IACvE,qBACE,2RAAC;QACC,aAAU;QACV,WAAW,IAAA,sKAAE,EAAC,QAAQ;QACrB,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,2RAAC;QACC,aAAU;QACV,WAAW,IAAA,sKAAE,EAAC,2CAA2C;QACxD,GAAG,KAAK;;;;;;AAGf"}},
    {"offset": {"line": 1897, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/components/diagrams/LicenseFlowDiagram.tsx"],"sourcesContent":["'use client';\n\nimport { useState } from 'react';\nimport { Node, Edge, MarkerType } from '@xyflow/react';\nimport { FlowDiagram } from './FlowDiagram';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Play, Pause, RotateCcw, ChevronRight } from 'lucide-react';\n\nconst baseNodes: Node[] = [\n  {\n    id: 'client',\n    type: 'drm',\n    position: { x: 50, y: 200 },\n    data: {\n      label: 'Client App',\n      description: 'Video player with CDM',\n      type: 'client',\n    },\n  },\n  {\n    id: 'cdm',\n    type: 'drm',\n    position: { x: 250, y: 200 },\n    data: {\n      label: 'CDM',\n      description: 'Content Decryption Module',\n      type: 'key',\n    },\n  },\n  {\n    id: 'proxy',\n    type: 'drm',\n    position: { x: 450, y: 200 },\n    data: {\n      label: 'Proxy Server',\n      description: 'Your backend',\n      type: 'server',\n    },\n  },\n  {\n    id: 'license',\n    type: 'drm',\n    position: { x: 650, y: 200 },\n    data: {\n      label: 'License Server',\n      description: 'DRM vendor (Google/Apple/MS)',\n      type: 'server',\n    },\n  },\n  {\n    id: 'cdn',\n    type: 'drm',\n    position: { x: 250, y: 350 },\n    data: {\n      label: 'CDN',\n      description: 'Encrypted content delivery',\n      type: 'cdn',\n    },\n  },\n  {\n    id: 'content',\n    type: 'drm',\n    position: { x: 50, y: 350 },\n    data: {\n      label: 'Decrypted Video',\n      description: 'Protected in TEE/Secure memory',\n      type: 'content',\n    },\n  },\n];\n\ninterface FlowStep {\n  id: number;\n  title: string;\n  description: string;\n  activeEdges: string[];\n  highlightNodes: string[];\n}\n\nconst flowSteps: FlowStep[] = [\n  {\n    id: 0,\n    title: 'Initial State',\n    description: 'User wants to play protected content. The client app initiates the playback process.',\n    activeEdges: [],\n    highlightNodes: ['client'],\n  },\n  {\n    id: 1,\n    title: 'Parse PSSH',\n    description: 'Client parses the manifest (DASH/HLS) and extracts PSSH box containing Key IDs.',\n    activeEdges: [],\n    highlightNodes: ['client', 'cdm'],\n  },\n  {\n    id: 2,\n    title: 'Generate Challenge',\n    description: 'CDM generates an encrypted license request (challenge) containing device info and key IDs.',\n    activeEdges: ['client-cdm'],\n    highlightNodes: ['cdm'],\n  },\n  {\n    id: 3,\n    title: 'Forward to Proxy',\n    description: 'Challenge is sent to your proxy server for authentication and entitlement checks.',\n    activeEdges: ['cdm-proxy'],\n    highlightNodes: ['proxy'],\n  },\n  {\n    id: 4,\n    title: 'License Request',\n    description: 'Proxy forwards the challenge to the DRM license server with authentication tokens.',\n    activeEdges: ['proxy-license'],\n    highlightNodes: ['license'],\n  },\n  {\n    id: 5,\n    title: 'License Response',\n    description: 'License server validates device, checks entitlements, returns encrypted content keys.',\n    activeEdges: ['license-proxy'],\n    highlightNodes: ['license', 'proxy'],\n  },\n  {\n    id: 6,\n    title: 'Deliver License',\n    description: 'Proxy forwards the license response back to the client CDM.',\n    activeEdges: ['proxy-cdm'],\n    highlightNodes: ['cdm'],\n  },\n  {\n    id: 7,\n    title: 'Decrypt Keys',\n    description: 'CDM decrypts the license using its private key, storing content keys securely.',\n    activeEdges: [],\n    highlightNodes: ['cdm'],\n  },\n  {\n    id: 8,\n    title: 'Fetch Content',\n    description: 'Client requests encrypted video segments from the CDN.',\n    activeEdges: ['client-cdn'],\n    highlightNodes: ['cdn'],\n  },\n  {\n    id: 9,\n    title: 'Decrypt & Play',\n    description: 'CDM decrypts segments in protected memory. Video is rendered to screen with output protection.',\n    activeEdges: ['cdn-content', 'content-client'],\n    highlightNodes: ['content', 'client'],\n  },\n];\n\nconst allEdges: Edge[] = [\n  {\n    id: 'client-cdm',\n    source: 'client',\n    target: 'cdm',\n    label: '1. Request license',\n    animated: false,\n    style: { stroke: '#3b82f6', strokeWidth: 2 },\n    markerEnd: { type: MarkerType.ArrowClosed, color: '#3b82f6' },\n  },\n  {\n    id: 'cdm-proxy',\n    source: 'cdm',\n    target: 'proxy',\n    label: '2. Challenge',\n    animated: false,\n    style: { stroke: '#a855f7', strokeWidth: 2 },\n    markerEnd: { type: MarkerType.ArrowClosed, color: '#a855f7' },\n  },\n  {\n    id: 'proxy-license',\n    source: 'proxy',\n    target: 'license',\n    label: '3. Forward + Auth',\n    animated: false,\n    style: { stroke: '#a855f7', strokeWidth: 2 },\n    markerEnd: { type: MarkerType.ArrowClosed, color: '#a855f7' },\n  },\n  {\n    id: 'license-proxy',\n    source: 'license',\n    target: 'proxy',\n    label: '4. License',\n    animated: false,\n    style: { stroke: '#22c55e', strokeWidth: 2 },\n    markerEnd: { type: MarkerType.ArrowClosed, color: '#22c55e' },\n    sourceHandle: 'bottom',\n    targetHandle: 'bottom',\n  },\n  {\n    id: 'proxy-cdm',\n    source: 'proxy',\n    target: 'cdm',\n    label: '5. License',\n    animated: false,\n    style: { stroke: '#22c55e', strokeWidth: 2 },\n    markerEnd: { type: MarkerType.ArrowClosed, color: '#22c55e' },\n  },\n  {\n    id: 'client-cdn',\n    source: 'client',\n    target: 'cdn',\n    label: '6. Request segments',\n    animated: false,\n    style: { stroke: '#f97316', strokeWidth: 2 },\n    markerEnd: { type: MarkerType.ArrowClosed, color: '#f97316' },\n  },\n  {\n    id: 'cdn-content',\n    source: 'cdn',\n    target: 'content',\n    label: '7. Encrypted data',\n    animated: false,\n    style: { stroke: '#f97316', strokeWidth: 2 },\n    markerEnd: { type: MarkerType.ArrowClosed, color: '#f97316' },\n  },\n  {\n    id: 'content-client',\n    source: 'content',\n    target: 'client',\n    label: '8. Decrypted video',\n    animated: false,\n    style: { stroke: '#06b6d4', strokeWidth: 2 },\n    markerEnd: { type: MarkerType.ArrowClosed, color: '#06b6d4' },\n  },\n];\n\nexport function LicenseFlowDiagram() {\n  const [currentStep, setCurrentStep] = useState(0);\n  const [isPlaying, setIsPlaying] = useState(false);\n\n  const step = flowSteps[currentStep];\n\n  // Update nodes based on current step\n  const nodes = baseNodes.map((node) => ({\n    ...node,\n    style: step.highlightNodes.includes(node.id)\n      ? { opacity: 1, filter: 'drop-shadow(0 0 8px hsl(var(--primary)))' }\n      : { opacity: 0.5 },\n  }));\n\n  // Update edges based on current step\n  const edges = allEdges.map((edge) => ({\n    ...edge,\n    animated: step.activeEdges.includes(edge.id),\n    style: {\n      ...edge.style,\n      opacity: step.activeEdges.includes(edge.id) ? 1 : 0.3,\n    },\n  }));\n\n  const nextStep = () => {\n    setCurrentStep((prev) => (prev < flowSteps.length - 1 ? prev + 1 : prev));\n  };\n\n  const prevStep = () => {\n    setCurrentStep((prev) => (prev > 0 ? prev - 1 : prev));\n  };\n\n  const reset = () => {\n    setCurrentStep(0);\n    setIsPlaying(false);\n  };\n\n  // Auto-play functionality\n  const togglePlay = () => {\n    if (isPlaying) {\n      setIsPlaying(false);\n    } else {\n      setIsPlaying(true);\n      const interval = setInterval(() => {\n        setCurrentStep((prev) => {\n          if (prev >= flowSteps.length - 1) {\n            setIsPlaying(false);\n            clearInterval(interval);\n            return prev;\n          }\n          return prev + 1;\n        });\n      }, 2000);\n    }\n  };\n\n  return (\n    <div className=\"space-y-4\">\n      <Card>\n        <CardHeader className=\"pb-3\">\n          <div className=\"flex items-center justify-between\">\n            <CardTitle className=\"text-lg\">DRM License Acquisition Flow</CardTitle>\n            <Badge variant=\"outline\">\n              Step {currentStep + 1} of {flowSteps.length}\n            </Badge>\n          </div>\n        </CardHeader>\n        <CardContent>\n          <div className=\"mb-4 p-4 bg-muted/50 rounded-lg\">\n            <h4 className=\"font-semibold text-foreground\">{step.title}</h4>\n            <p className=\"text-sm text-muted-foreground mt-1\">{step.description}</p>\n          </div>\n\n          <FlowDiagram\n            nodes={nodes}\n            edges={edges}\n            interactive={false}\n            showControls={false}\n            showMiniMap={false}\n            animatedEdges={false}\n            className=\"h-[400px]\"\n          />\n\n          <div className=\"flex items-center justify-between mt-4\">\n            <div className=\"flex gap-2\">\n              <Button variant=\"outline\" size=\"sm\" onClick={reset}>\n                <RotateCcw className=\"h-4 w-4 mr-1\" />\n                Reset\n              </Button>\n              <Button variant=\"outline\" size=\"sm\" onClick={togglePlay}>\n                {isPlaying ? (\n                  <>\n                    <Pause className=\"h-4 w-4 mr-1\" />\n                    Pause\n                  </>\n                ) : (\n                  <>\n                    <Play className=\"h-4 w-4 mr-1\" />\n                    Auto Play\n                  </>\n                )}\n              </Button>\n            </div>\n            <div className=\"flex gap-2\">\n              <Button\n                variant=\"outline\"\n                size=\"sm\"\n                onClick={prevStep}\n                disabled={currentStep === 0}\n              >\n                Previous\n              </Button>\n              <Button\n                size=\"sm\"\n                onClick={nextStep}\n                disabled={currentStep === flowSteps.length - 1}\n              >\n                Next\n                <ChevronRight className=\"h-4 w-4 ml-1\" />\n              </Button>\n            </div>\n          </div>\n\n          {/* Step indicators */}\n          <div className=\"flex justify-center gap-1 mt-4\">\n            {flowSteps.map((_, index) => (\n              <button\n                key={index}\n                onClick={() => setCurrentStep(index)}\n                className={`w-2 h-2 rounded-full transition-all ${\n                  index === currentStep\n                    ? 'bg-primary w-4'\n                    : index < currentStep\n                    ? 'bg-primary/50'\n                    : 'bg-muted'\n                }`}\n              />\n            ))}\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AARA;;;;;;;;;AAUA,MAAM,YAAoB;IACxB;QACE,IAAI;QACJ,MAAM;QACN,UAAU;YAAE,GAAG;YAAI,GAAG;QAAI;QAC1B,MAAM;YACJ,OAAO;YACP,aAAa;YACb,MAAM;QACR;IACF;IACA;QACE,IAAI;QACJ,MAAM;QACN,UAAU;YAAE,GAAG;YAAK,GAAG;QAAI;QAC3B,MAAM;YACJ,OAAO;YACP,aAAa;YACb,MAAM;QACR;IACF;IACA;QACE,IAAI;QACJ,MAAM;QACN,UAAU;YAAE,GAAG;YAAK,GAAG;QAAI;QAC3B,MAAM;YACJ,OAAO;YACP,aAAa;YACb,MAAM;QACR;IACF;IACA;QACE,IAAI;QACJ,MAAM;QACN,UAAU;YAAE,GAAG;YAAK,GAAG;QAAI;QAC3B,MAAM;YACJ,OAAO;YACP,aAAa;YACb,MAAM;QACR;IACF;IACA;QACE,IAAI;QACJ,MAAM;QACN,UAAU;YAAE,GAAG;YAAK,GAAG;QAAI;QAC3B,MAAM;YACJ,OAAO;YACP,aAAa;YACb,MAAM;QACR;IACF;IACA;QACE,IAAI;QACJ,MAAM;QACN,UAAU;YAAE,GAAG;YAAI,GAAG;QAAI;QAC1B,MAAM;YACJ,OAAO;YACP,aAAa;YACb,MAAM;QACR;IACF;CACD;AAUD,MAAM,YAAwB;IAC5B;QACE,IAAI;QACJ,OAAO;QACP,aAAa;QACb,aAAa,EAAE;QACf,gBAAgB;YAAC;SAAS;IAC5B;IACA;QACE,IAAI;QACJ,OAAO;QACP,aAAa;QACb,aAAa,EAAE;QACf,gBAAgB;YAAC;YAAU;SAAM;IACnC;IACA;QACE,IAAI;QACJ,OAAO;QACP,aAAa;QACb,aAAa;YAAC;SAAa;QAC3B,gBAAgB;YAAC;SAAM;IACzB;IACA;QACE,IAAI;QACJ,OAAO;QACP,aAAa;QACb,aAAa;YAAC;SAAY;QAC1B,gBAAgB;YAAC;SAAQ;IAC3B;IACA;QACE,IAAI;QACJ,OAAO;QACP,aAAa;QACb,aAAa;YAAC;SAAgB;QAC9B,gBAAgB;YAAC;SAAU;IAC7B;IACA;QACE,IAAI;QACJ,OAAO;QACP,aAAa;QACb,aAAa;YAAC;SAAgB;QAC9B,gBAAgB;YAAC;YAAW;SAAQ;IACtC;IACA;QACE,IAAI;QACJ,OAAO;QACP,aAAa;QACb,aAAa;YAAC;SAAY;QAC1B,gBAAgB;YAAC;SAAM;IACzB;IACA;QACE,IAAI;QACJ,OAAO;QACP,aAAa;QACb,aAAa,EAAE;QACf,gBAAgB;YAAC;SAAM;IACzB;IACA;QACE,IAAI;QACJ,OAAO;QACP,aAAa;QACb,aAAa;YAAC;SAAa;QAC3B,gBAAgB;YAAC;SAAM;IACzB;IACA;QACE,IAAI;QACJ,OAAO;QACP,aAAa;QACb,aAAa;YAAC;YAAe;SAAiB;QAC9C,gBAAgB;YAAC;YAAW;SAAS;IACvC;CACD;AAED,MAAM,WAAmB;IACvB;QACE,IAAI;QACJ,QAAQ;QACR,QAAQ;QACR,OAAO;QACP,UAAU;QACV,OAAO;YAAE,QAAQ;YAAW,aAAa;QAAE;QAC3C,WAAW;YAAE,MAAM,qNAAU,CAAC,WAAW;YAAE,OAAO;QAAU;IAC9D;IACA;QACE,IAAI;QACJ,QAAQ;QACR,QAAQ;QACR,OAAO;QACP,UAAU;QACV,OAAO;YAAE,QAAQ;YAAW,aAAa;QAAE;QAC3C,WAAW;YAAE,MAAM,qNAAU,CAAC,WAAW;YAAE,OAAO;QAAU;IAC9D;IACA;QACE,IAAI;QACJ,QAAQ;QACR,QAAQ;QACR,OAAO;QACP,UAAU;QACV,OAAO;YAAE,QAAQ;YAAW,aAAa;QAAE;QAC3C,WAAW;YAAE,MAAM,qNAAU,CAAC,WAAW;YAAE,OAAO;QAAU;IAC9D;IACA;QACE,IAAI;QACJ,QAAQ;QACR,QAAQ;QACR,OAAO;QACP,UAAU;QACV,OAAO;YAAE,QAAQ;YAAW,aAAa;QAAE;QAC3C,WAAW;YAAE,MAAM,qNAAU,CAAC,WAAW;YAAE,OAAO;QAAU;QAC5D,cAAc;QACd,cAAc;IAChB;IACA;QACE,IAAI;QACJ,QAAQ;QACR,QAAQ;QACR,OAAO;QACP,UAAU;QACV,OAAO;YAAE,QAAQ;YAAW,aAAa;QAAE;QAC3C,WAAW;YAAE,MAAM,qNAAU,CAAC,WAAW;YAAE,OAAO;QAAU;IAC9D;IACA;QACE,IAAI;QACJ,QAAQ;QACR,QAAQ;QACR,OAAO;QACP,UAAU;QACV,OAAO;YAAE,QAAQ;YAAW,aAAa;QAAE;QAC3C,WAAW;YAAE,MAAM,qNAAU,CAAC,WAAW;YAAE,OAAO;QAAU;IAC9D;IACA;QACE,IAAI;QACJ,QAAQ;QACR,QAAQ;QACR,OAAO;QACP,UAAU;QACV,OAAO;YAAE,QAAQ;YAAW,aAAa;QAAE;QAC3C,WAAW;YAAE,MAAM,qNAAU,CAAC,WAAW;YAAE,OAAO;QAAU;IAC9D;IACA;QACE,IAAI;QACJ,QAAQ;QACR,QAAQ;QACR,OAAO;QACP,UAAU;QACV,OAAO;YAAE,QAAQ;YAAW,aAAa;QAAE;QAC3C,WAAW;YAAE,MAAM,qNAAU,CAAC,WAAW;YAAE,OAAO;QAAU;IAC9D;CACD;AAEM,SAAS;IACd,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,8PAAQ,EAAC;IAC/C,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,8PAAQ,EAAC;IAE3C,MAAM,OAAO,SAAS,CAAC,YAAY;IAEnC,qCAAqC;IACrC,MAAM,QAAQ,UAAU,GAAG,CAAC,CAAC,OAAS,CAAC;YACrC,GAAG,IAAI;YACP,OAAO,KAAK,cAAc,CAAC,QAAQ,CAAC,KAAK,EAAE,IACvC;gBAAE,SAAS;gBAAG,QAAQ;YAA2C,IACjE;gBAAE,SAAS;YAAI;QACrB,CAAC;IAED,qCAAqC;IACrC,MAAM,QAAQ,SAAS,GAAG,CAAC,CAAC,OAAS,CAAC;YACpC,GAAG,IAAI;YACP,UAAU,KAAK,WAAW,CAAC,QAAQ,CAAC,KAAK,EAAE;YAC3C,OAAO;gBACL,GAAG,KAAK,KAAK;gBACb,SAAS,KAAK,WAAW,CAAC,QAAQ,CAAC,KAAK,EAAE,IAAI,IAAI;YACpD;QACF,CAAC;IAED,MAAM,WAAW;QACf,eAAe,CAAC,OAAU,OAAO,UAAU,MAAM,GAAG,IAAI,OAAO,IAAI;IACrE;IAEA,MAAM,WAAW;QACf,eAAe,CAAC,OAAU,OAAO,IAAI,OAAO,IAAI;IAClD;IAEA,MAAM,QAAQ;QACZ,eAAe;QACf,aAAa;IACf;IAEA,0BAA0B;IAC1B,MAAM,aAAa;QACjB,IAAI,WAAW;YACb,aAAa;QACf,OAAO;YACL,aAAa;YACb,MAAM,WAAW,YAAY;gBAC3B,eAAe,CAAC;oBACd,IAAI,QAAQ,UAAU,MAAM,GAAG,GAAG;wBAChC,aAAa;wBACb,cAAc;wBACd,OAAO;oBACT;oBACA,OAAO,OAAO;gBAChB;YACF,GAAG;QACL;IACF;IAEA,qBACE,2RAAC;QAAI,WAAU;kBACb,cAAA,2RAAC,qLAAI;;8BACH,2RAAC,2LAAU;oBAAC,WAAU;8BACpB,cAAA,2RAAC;wBAAI,WAAU;;0CACb,2RAAC,0LAAS;gCAAC,WAAU;0CAAU;;;;;;0CAC/B,2RAAC,uLAAK;gCAAC,SAAQ;;oCAAU;oCACjB,cAAc;oCAAE;oCAAK,UAAU,MAAM;;;;;;;;;;;;;;;;;;8BAIjD,2RAAC,4LAAW;;sCACV,2RAAC;4BAAI,WAAU;;8CACb,2RAAC;oCAAG,WAAU;8CAAiC,KAAK,KAAK;;;;;;8CACzD,2RAAC;oCAAE,WAAU;8CAAsC,KAAK,WAAW;;;;;;;;;;;;sCAGrE,2RAAC,yMAAW;4BACV,OAAO;4BACP,OAAO;4BACP,aAAa;4BACb,cAAc;4BACd,aAAa;4BACb,eAAe;4BACf,WAAU;;;;;;sCAGZ,2RAAC;4BAAI,WAAU;;8CACb,2RAAC;oCAAI,WAAU;;sDACb,2RAAC,yLAAM;4CAAC,SAAQ;4CAAU,MAAK;4CAAK,SAAS;;8DAC3C,2RAAC,0QAAS;oDAAC,WAAU;;;;;;gDAAiB;;;;;;;sDAGxC,2RAAC,yLAAM;4CAAC,SAAQ;4CAAU,MAAK;4CAAK,SAAS;sDAC1C,0BACC;;kEACE,2RAAC,0PAAK;wDAAC,WAAU;;;;;;oDAAiB;;6EAIpC;;kEACE,2RAAC,uPAAI;wDAAC,WAAU;;;;;;oDAAiB;;;;;;;;;;;;;;8CAMzC,2RAAC;oCAAI,WAAU;;sDACb,2RAAC,yLAAM;4CACL,SAAQ;4CACR,MAAK;4CACL,SAAS;4CACT,UAAU,gBAAgB;sDAC3B;;;;;;sDAGD,2RAAC,yLAAM;4CACL,MAAK;4CACL,SAAS;4CACT,UAAU,gBAAgB,UAAU,MAAM,GAAG;;gDAC9C;8DAEC,2RAAC,mRAAY;oDAAC,WAAU;;;;;;;;;;;;;;;;;;;;;;;;sCAM9B,2RAAC;4BAAI,WAAU;sCACZ,UAAU,GAAG,CAAC,CAAC,GAAG,sBACjB,2RAAC;oCAEC,SAAS,IAAM,eAAe;oCAC9B,WAAW,CAAC,oCAAoC,EAC9C,UAAU,cACN,mBACA,QAAQ,cACR,kBACA,YACJ;mCARG;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgBrB"}},
    {"offset": {"line": 2512, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/components/ui/tabs.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Tabs({\n  className,\n  ...props\n}: React.ComponentProps<typeof TabsPrimitive.Root>) {\n  return (\n    <TabsPrimitive.Root\n      data-slot=\"tabs\"\n      className={cn(\"flex flex-col gap-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction TabsList({\n  className,\n  ...props\n}: React.ComponentProps<typeof TabsPrimitive.List>) {\n  return (\n    <TabsPrimitive.List\n      data-slot=\"tabs-list\"\n      className={cn(\n        \"bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction TabsTrigger({\n  className,\n  ...props\n}: React.ComponentProps<typeof TabsPrimitive.Trigger>) {\n  return (\n    <TabsPrimitive.Trigger\n      data-slot=\"tabs-trigger\"\n      className={cn(\n        \"data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction TabsContent({\n  className,\n  ...props\n}: React.ComponentProps<typeof TabsPrimitive.Content>) {\n  return (\n    <TabsPrimitive.Content\n      data-slot=\"tabs-content\"\n      className={cn(\"flex-1 outline-none\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\n"],"names":[],"mappings":";;;;;;;;;;;AAGA;AAEA;AALA;;;;AAOA,SAAS,KAAK,EACZ,SAAS,EACT,GAAG,OAC6C;IAChD,qBACE,2RAAC,qNAAkB;QACjB,aAAU;QACV,WAAW,IAAA,sKAAE,EAAC,uBAAuB;QACpC,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,SAAS,EAChB,SAAS,EACT,GAAG,OAC6C;IAChD,qBACE,2RAAC,qNAAkB;QACjB,aAAU;QACV,WAAW,IAAA,sKAAE,EACX,uGACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,YAAY,EACnB,SAAS,EACT,GAAG,OACgD;IACnD,qBACE,2RAAC,wNAAqB;QACpB,aAAU;QACV,WAAW,IAAA,sKAAE,EACX,mqBACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,YAAY,EACnB,SAAS,EACT,GAAG,OACgD;IACnD,qBACE,2RAAC,wNAAqB;QACpB,aAAU;QACV,WAAW,IAAA,sKAAE,EAAC,uBAAuB;QACpC,GAAG,KAAK;;;;;;AAGf"}},
    {"offset": {"line": 2578, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/components/diagrams/SecurityLevelsDiagram.tsx"],"sourcesContent":["'use client';\n\nimport { useState } from 'react';\nimport { Node, Edge, MarkerType } from '@xyflow/react';\nimport { FlowDiagram } from './FlowDiagram';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { Shield, ShieldAlert, ShieldX } from 'lucide-react';\n\ninterface SecurityLevelConfig {\n  id: string;\n  label: string;\n  description: string;\n  color: string;\n  icon: React.ReactNode;\n  features: string[];\n  vulnerabilities: string[];\n  nodes: Node[];\n  edges: Edge[];\n}\n\nconst securityLevels: SecurityLevelConfig[] = [\n  {\n    id: 'l1',\n    label: 'L1 - Hardware TEE',\n    description: 'Highest security with hardware-based trusted execution environment',\n    color: 'green',\n    icon: <Shield className=\"h-5 w-5 text-green-500\" />,\n    features: [\n      'Hardware-isolated secure enclave',\n      'Encrypted key storage in silicon',\n      'Secure video path to display',\n      'Hardware attestation',\n      '4K/HDR content allowed',\n    ],\n    vulnerabilities: [\n      'Physical hardware attacks (costly)',\n      'Side-channel attacks (rare)',\n      'Zero-day in TEE firmware',\n    ],\n    nodes: [\n      {\n        id: 'app',\n        type: 'drm',\n        position: { x: 50, y: 150 },\n        data: { label: 'Application', description: 'Untrusted user space', type: 'client' },\n      },\n      {\n        id: 'os',\n        type: 'drm',\n        position: { x: 250, y: 150 },\n        data: { label: 'OS Kernel', description: 'Normal world', type: 'client' },\n      },\n      {\n        id: 'tee',\n        type: 'drm',\n        position: { x: 450, y: 150 },\n        data: { label: 'TEE', description: 'TrustZone / SGX', type: 'defense' },\n      },\n      {\n        id: 'cdm',\n        type: 'drm',\n        position: { x: 450, y: 280 },\n        data: { label: 'CDM', description: 'Runs inside TEE', type: 'key' },\n      },\n      {\n        id: 'keys',\n        type: 'drm',\n        position: { x: 650, y: 280 },\n        data: { label: 'Key Store', description: 'Hardware-protected', type: 'key' },\n      },\n      {\n        id: 'decoder',\n        type: 'drm',\n        position: { x: 250, y: 280 },\n        data: { label: 'Secure Decoder', description: 'Protected video path', type: 'defense' },\n      },\n      {\n        id: 'display',\n        type: 'drm',\n        position: { x: 50, y: 280 },\n        data: { label: 'Display', description: 'HDCP protected', type: 'content' },\n      },\n    ],\n    edges: [\n      { id: 'app-os', source: 'app', target: 'os', label: 'System call' },\n      { id: 'os-tee', source: 'os', target: 'tee', label: 'Secure monitor' },\n      { id: 'tee-cdm', source: 'tee', target: 'cdm', label: 'Isolated execution' },\n      { id: 'cdm-keys', source: 'cdm', target: 'keys', label: 'Hardware access' },\n      { id: 'cdm-decoder', source: 'cdm', target: 'decoder', label: 'Encrypted stream' },\n      { id: 'decoder-display', source: 'decoder', target: 'display', label: 'Protected path' },\n    ],\n  },\n  {\n    id: 'l2',\n    label: 'L2 - Software TEE',\n    description: 'Software-based secure execution with hardware key storage',\n    color: 'yellow',\n    icon: <ShieldAlert className=\"h-5 w-5 text-yellow-500\" />,\n    features: [\n      'Software-based secure environment',\n      'Hardware key storage only',\n      'Decryption in software',\n      'Limited to 720p/1080p typically',\n    ],\n    vulnerabilities: [\n      'Memory dumping attacks',\n      'Debugger-based extraction',\n      'Software CDM reverse engineering',\n      'Rooted/jailbroken devices',\n    ],\n    nodes: [\n      {\n        id: 'app',\n        type: 'drm',\n        position: { x: 50, y: 150 },\n        data: { label: 'Application', description: 'User space', type: 'client' },\n      },\n      {\n        id: 'cdm',\n        type: 'drm',\n        position: { x: 250, y: 150 },\n        data: { label: 'CDM', description: 'Software (obfuscated)', type: 'key' },\n      },\n      {\n        id: 'keybox',\n        type: 'drm',\n        position: { x: 450, y: 150 },\n        data: { label: 'Hardware Keybox', description: 'Device keys in HW', type: 'defense' },\n      },\n      {\n        id: 'memory',\n        type: 'drm',\n        position: { x: 250, y: 280 },\n        data: { label: 'RAM', description: 'Decrypted content (vulnerable)', type: 'content' },\n      },\n      {\n        id: 'attacker',\n        type: 'drm',\n        position: { x: 450, y: 280 },\n        data: { label: 'Attack Surface', description: 'Memory dump possible', type: 'attacker' },\n      },\n      {\n        id: 'display',\n        type: 'drm',\n        position: { x: 50, y: 280 },\n        data: { label: 'Display', description: 'HDCP (if available)', type: 'content' },\n      },\n    ],\n    edges: [\n      { id: 'app-cdm', source: 'app', target: 'cdm', label: 'API call' },\n      { id: 'cdm-keybox', source: 'cdm', target: 'keybox', label: 'Key retrieval' },\n      { id: 'cdm-memory', source: 'cdm', target: 'memory', label: 'Decrypt to RAM', style: { stroke: '#ef4444' } },\n      { id: 'memory-attacker', source: 'memory', target: 'attacker', label: 'Vulnerable!', style: { stroke: '#ef4444' } },\n      { id: 'memory-display', source: 'memory', target: 'display', label: 'Unprotected' },\n    ],\n  },\n  {\n    id: 'l3',\n    label: 'L3 - Software Only',\n    description: 'Fully software-based with no hardware protection',\n    color: 'red',\n    icon: <ShieldX className=\"h-5 w-5 text-red-500\" />,\n    features: [\n      'Runs entirely in software',\n      'Keys stored in software',\n      'Easy to deploy/update',\n      'Limited to SD content',\n    ],\n    vulnerabilities: [\n      'Full CDM reverse engineering',\n      'Key extraction trivial',\n      'No hardware binding',\n      'Emulator/VM attacks',\n      'Tools like pywidevine exploit this',\n    ],\n    nodes: [\n      {\n        id: 'app',\n        type: 'drm',\n        position: { x: 50, y: 150 },\n        data: { label: 'Application', description: 'Browser/App', type: 'client' },\n      },\n      {\n        id: 'cdm',\n        type: 'drm',\n        position: { x: 250, y: 150 },\n        data: { label: 'Software CDM', description: 'No protection', type: 'attacker' },\n      },\n      {\n        id: 'keys',\n        type: 'drm',\n        position: { x: 450, y: 150 },\n        data: { label: 'Software Keys', description: 'Extractable', type: 'attacker' },\n      },\n      {\n        id: 'pywidevine',\n        type: 'drm',\n        position: { x: 450, y: 280 },\n        data: { label: 'pywidevine', description: 'Extraction tool', type: 'attacker' },\n      },\n      {\n        id: 'content',\n        type: 'drm',\n        position: { x: 250, y: 280 },\n        data: { label: 'Decrypted Content', description: 'Fully exposed', type: 'attacker' },\n      },\n      {\n        id: 'redistribution',\n        type: 'drm',\n        position: { x: 50, y: 280 },\n        data: { label: 'Piracy', description: 'Content leaked', type: 'attacker' },\n      },\n    ],\n    edges: [\n      { id: 'app-cdm', source: 'app', target: 'cdm', label: 'No isolation' },\n      { id: 'cdm-keys', source: 'cdm', target: 'keys', label: 'SW storage', style: { stroke: '#ef4444' } },\n      { id: 'keys-pywidevine', source: 'keys', target: 'pywidevine', label: 'Extract', style: { stroke: '#ef4444' } },\n      { id: 'pywidevine-content', source: 'pywidevine', target: 'content', label: 'Decrypt', style: { stroke: '#ef4444' } },\n      { id: 'content-redistribution', source: 'content', target: 'redistribution', label: 'Share', style: { stroke: '#ef4444' } },\n    ],\n  },\n];\n\nexport function SecurityLevelsDiagram() {\n  const [activeLevel, setActiveLevel] = useState('l1');\n  const level = securityLevels.find((l) => l.id === activeLevel)!;\n\n  const colorClasses = {\n    green: 'border-green-500/50 bg-green-500/5',\n    yellow: 'border-yellow-500/50 bg-yellow-500/5',\n    red: 'border-red-500/50 bg-red-500/5',\n  };\n\n  return (\n    <Card>\n      <CardHeader>\n        <CardTitle className=\"flex items-center gap-2\">\n          Widevine Security Levels\n          <Badge variant=\"outline\" className=\"ml-auto\">\n            Interactive\n          </Badge>\n        </CardTitle>\n      </CardHeader>\n      <CardContent>\n        <Tabs value={activeLevel} onValueChange={setActiveLevel}>\n          <TabsList className=\"grid w-full grid-cols-3\">\n            <TabsTrigger value=\"l1\" className=\"gap-2\">\n              <Shield className=\"h-4 w-4 text-green-500\" />\n              L1\n            </TabsTrigger>\n            <TabsTrigger value=\"l2\" className=\"gap-2\">\n              <ShieldAlert className=\"h-4 w-4 text-yellow-500\" />\n              L2\n            </TabsTrigger>\n            <TabsTrigger value=\"l3\" className=\"gap-2\">\n              <ShieldX className=\"h-4 w-4 text-red-500\" />\n              L3\n            </TabsTrigger>\n          </TabsList>\n\n          {securityLevels.map((config) => (\n            <TabsContent key={config.id} value={config.id} className=\"space-y-4\">\n              <div className={`p-4 rounded-lg border ${colorClasses[config.color as keyof typeof colorClasses]}`}>\n                <div className=\"flex items-center gap-2 mb-2\">\n                  {config.icon}\n                  <h3 className=\"font-semibold\">{config.label}</h3>\n                </div>\n                <p className=\"text-sm text-muted-foreground\">{config.description}</p>\n              </div>\n\n              <FlowDiagram\n                nodes={config.nodes}\n                edges={config.edges}\n                interactive={false}\n                showControls={false}\n                className=\"h-[350px]\"\n              />\n\n              <div className=\"grid md:grid-cols-2 gap-4\">\n                <div className=\"p-4 rounded-lg border border-green-500/30 bg-green-500/5\">\n                  <h4 className=\"font-semibold text-green-500 mb-2\">Security Features</h4>\n                  <ul className=\"text-sm space-y-1\">\n                    {config.features.map((feature, i) => (\n                      <li key={i} className=\"flex items-start gap-2\">\n                        <span className=\"text-green-500\">+</span>\n                        <span className=\"text-muted-foreground\">{feature}</span>\n                      </li>\n                    ))}\n                  </ul>\n                </div>\n                <div className=\"p-4 rounded-lg border border-red-500/30 bg-red-500/5\">\n                  <h4 className=\"font-semibold text-red-500 mb-2\">Vulnerabilities</h4>\n                  <ul className=\"text-sm space-y-1\">\n                    {config.vulnerabilities.map((vuln, i) => (\n                      <li key={i} className=\"flex items-start gap-2\">\n                        <span className=\"text-red-500\">!</span>\n                        <span className=\"text-muted-foreground\">{vuln}</span>\n                      </li>\n                    ))}\n                  </ul>\n                </div>\n              </div>\n            </TabsContent>\n          ))}\n        </Tabs>\n      </CardContent>\n    </Card>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3338, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/components/diagrams/AttackVectorsDiagram.tsx"],"sourcesContent":["'use client';\n\nimport { useState } from 'react';\nimport { Node, Edge } from '@xyflow/react';\nimport { FlowDiagram } from './FlowDiagram';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Button } from '@/components/ui/button';\nimport { usePerspective } from '@/providers/PerspectiveProvider';\nimport { Sword, Shield, Eye } from 'lucide-react';\n\ninterface AttackVector {\n  id: string;\n  name: string;\n  difficulty: 'easy' | 'medium' | 'hard' | 'expert';\n  redTeamDescription: string;\n  blueTeamDescription: string;\n  nodes: Node[];\n  edges: Edge[];\n}\n\nconst attackVectors: AttackVector[] = [\n  {\n    id: 'memory-dump',\n    name: 'Memory Dump Attack',\n    difficulty: 'medium',\n    redTeamDescription: 'Dump process memory during playback to extract decrypted content keys from L2/L3 CDM.',\n    blueTeamDescription: 'Detect memory access patterns, implement anti-debugging, use hardware TEE for L1.',\n    nodes: [\n      { id: 'player', type: 'drm', position: { x: 100, y: 100 }, data: { label: 'Video Player', type: 'client' } },\n      { id: 'cdm', type: 'drm', position: { x: 300, y: 100 }, data: { label: 'CDM (L2/L3)', type: 'key' } },\n      { id: 'memory', type: 'drm', position: { x: 300, y: 250 }, data: { label: 'RAM', description: 'Keys in memory', type: 'content' } },\n      { id: 'debugger', type: 'drm', position: { x: 500, y: 250 }, data: { label: 'Debugger', description: 'GDB/LLDB/x64dbg', type: 'attacker' } },\n      { id: 'keys', type: 'drm', position: { x: 500, y: 100 }, data: { label: 'Extracted Keys', type: 'attacker' } },\n    ],\n    edges: [\n      { id: 'player-cdm', source: 'player', target: 'cdm', label: 'Decrypt request' },\n      { id: 'cdm-memory', source: 'cdm', target: 'memory', label: 'Keys loaded', style: { stroke: '#ef4444' } },\n      { id: 'memory-debugger', source: 'memory', target: 'debugger', label: 'Memory read', style: { stroke: '#ef4444' } },\n      { id: 'debugger-keys', source: 'debugger', target: 'keys', label: 'Extract', style: { stroke: '#ef4444' } },\n    ],\n  },\n  {\n    id: 'mitm',\n    name: 'MITM License Interception',\n    difficulty: 'easy',\n    redTeamDescription: 'Intercept license requests/responses using proxy. Extract content keys from unencrypted or weakly protected responses.',\n    blueTeamDescription: 'Implement TLS pinning, encrypt license payloads end-to-end, validate certificate chains.',\n    nodes: [\n      { id: 'client', type: 'drm', position: { x: 50, y: 150 }, data: { label: 'Client', type: 'client' } },\n      { id: 'proxy', type: 'drm', position: { x: 250, y: 150 }, data: { label: 'Attacker Proxy', description: 'mitmproxy/Burp', type: 'attacker' } },\n      { id: 'server', type: 'drm', position: { x: 450, y: 150 }, data: { label: 'License Server', type: 'server' } },\n      { id: 'capture', type: 'drm', position: { x: 250, y: 280 }, data: { label: 'Captured License', description: 'Contains keys', type: 'attacker' } },\n    ],\n    edges: [\n      { id: 'client-proxy', source: 'client', target: 'proxy', label: 'TLS intercepted', style: { stroke: '#ef4444' } },\n      { id: 'proxy-server', source: 'proxy', target: 'server', label: 'Forwarded' },\n      { id: 'proxy-capture', source: 'proxy', target: 'capture', label: 'Copy response', style: { stroke: '#ef4444' } },\n    ],\n  },\n  {\n    id: 'cdm-emulation',\n    name: 'CDM Emulation',\n    difficulty: 'hard',\n    redTeamDescription: 'Reverse engineer CDM protocol and create software emulator that impersonates legitimate device.',\n    blueTeamDescription: 'Hardware attestation, device binding, frequent protocol updates, behavioral analysis.',\n    nodes: [\n      { id: 'real-cdm', type: 'drm', position: { x: 50, y: 100 }, data: { label: 'Real CDM', description: 'Reference', type: 'client' } },\n      { id: 'reversing', type: 'drm', position: { x: 250, y: 100 }, data: { label: 'Reverse Engineering', description: 'IDA Pro/Ghidra', type: 'attacker' } },\n      { id: 'fake-cdm', type: 'drm', position: { x: 450, y: 100 }, data: { label: 'Fake CDM', description: 'pywidevine', type: 'attacker' } },\n      { id: 'license', type: 'drm', position: { x: 450, y: 250 }, data: { label: 'License Server', type: 'server' } },\n      { id: 'keys', type: 'drm', position: { x: 250, y: 250 }, data: { label: 'Decrypted Keys', type: 'attacker' } },\n    ],\n    edges: [\n      { id: 'real-reversing', source: 'real-cdm', target: 'reversing', label: 'Analyze', style: { stroke: '#ef4444' } },\n      { id: 'reversing-fake', source: 'reversing', target: 'fake-cdm', label: 'Build clone', style: { stroke: '#ef4444' } },\n      { id: 'fake-license', source: 'fake-cdm', target: 'license', label: 'Request license' },\n      { id: 'license-keys', source: 'license', target: 'keys', label: 'Valid response', style: { stroke: '#ef4444' } },\n    ],\n  },\n  {\n    id: 'hdcp-strip',\n    name: 'HDCP Stripping',\n    difficulty: 'easy',\n    redTeamDescription: 'Use HDMI splitter/capture card that strips HDCP, allowing recording of decrypted video output.',\n    blueTeamDescription: 'Require HDCP 2.2, implement watermarking, detect capture devices via timing analysis.',\n    nodes: [\n      { id: 'player', type: 'drm', position: { x: 50, y: 150 }, data: { label: 'Player Device', description: 'Roku/FireTV', type: 'client' } },\n      { id: 'splitter', type: 'drm', position: { x: 250, y: 150 }, data: { label: 'HDMI Splitter', description: 'Strips HDCP', type: 'attacker' } },\n      { id: 'capture', type: 'drm', position: { x: 450, y: 150 }, data: { label: 'Capture Card', description: 'Elgato/BlackMagic', type: 'attacker' } },\n      { id: 'recording', type: 'drm', position: { x: 450, y: 280 }, data: { label: 'Recording', description: 'Unprotected file', type: 'attacker' } },\n      { id: 'tv', type: 'drm', position: { x: 250, y: 280 }, data: { label: 'TV', description: 'Normal viewing', type: 'content' } },\n    ],\n    edges: [\n      { id: 'player-splitter', source: 'player', target: 'splitter', label: 'HDCP signal' },\n      { id: 'splitter-capture', source: 'splitter', target: 'capture', label: 'HDCP stripped', style: { stroke: '#ef4444' } },\n      { id: 'capture-recording', source: 'capture', target: 'recording', label: 'Record', style: { stroke: '#ef4444' } },\n      { id: 'splitter-tv', source: 'splitter', target: 'tv', label: 'Passthrough' },\n    ],\n  },\n];\n\nconst difficultyColors = {\n  easy: 'bg-green-500/10 text-green-500 border-green-500/30',\n  medium: 'bg-yellow-500/10 text-yellow-500 border-yellow-500/30',\n  hard: 'bg-orange-500/10 text-orange-500 border-orange-500/30',\n  expert: 'bg-red-500/10 text-red-500 border-red-500/30',\n};\n\nexport function AttackVectorsDiagram() {\n  const [selectedAttack, setSelectedAttack] = useState(attackVectors[0]);\n  const { perspective, isRedTeam, isBlueTeam } = usePerspective();\n\n  const getDescription = (attack: AttackVector) => {\n    if (isRedTeam) return attack.redTeamDescription;\n    if (isBlueTeam) return attack.blueTeamDescription;\n    return `${attack.redTeamDescription}\\n\\nDefense: ${attack.blueTeamDescription}`;\n  };\n\n  return (\n    <Card>\n      <CardHeader>\n        <div className=\"flex items-center justify-between\">\n          <CardTitle className=\"flex items-center gap-2\">\n            {isRedTeam ? (\n              <Sword className=\"h-5 w-5 text-red-500\" />\n            ) : isBlueTeam ? (\n              <Shield className=\"h-5 w-5 text-cyan-500\" />\n            ) : (\n              <Eye className=\"h-5 w-5 text-primary\" />\n            )}\n            Attack Vectors\n          </CardTitle>\n          <Badge variant=\"outline\">\n            {perspective === 'red-team' ? 'Attacker View' : perspective === 'blue-team' ? 'Defender View' : 'Observer View'}\n          </Badge>\n        </div>\n      </CardHeader>\n      <CardContent className=\"space-y-4\">\n        {/* Attack selector */}\n        <div className=\"flex flex-wrap gap-2\">\n          {attackVectors.map((attack) => (\n            <Button\n              key={attack.id}\n              variant={selectedAttack.id === attack.id ? 'default' : 'outline'}\n              size=\"sm\"\n              onClick={() => setSelectedAttack(attack)}\n              className=\"gap-2\"\n            >\n              {attack.name}\n              <Badge variant=\"outline\" className={difficultyColors[attack.difficulty]}>\n                {attack.difficulty}\n              </Badge>\n            </Button>\n          ))}\n        </div>\n\n        {/* Attack details */}\n        <div className={`p-4 rounded-lg border ${isRedTeam ? 'border-red-500/30 bg-red-500/5' : isBlueTeam ? 'border-cyan-500/30 bg-cyan-500/5' : 'border-border bg-muted/50'}`}>\n          <h3 className=\"font-semibold mb-2\">{selectedAttack.name}</h3>\n          <p className=\"text-sm text-muted-foreground whitespace-pre-line\">\n            {getDescription(selectedAttack)}\n          </p>\n        </div>\n\n        {/* Diagram */}\n        <FlowDiagram\n          nodes={selectedAttack.nodes}\n          edges={selectedAttack.edges}\n          interactive={false}\n          showControls={false}\n          className=\"h-[350px]\"\n        />\n      </CardContent>\n    </Card>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3920, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/app/diagrams/page.tsx"],"sourcesContent":["'use client';\n\nimport { Header } from '@/components/layout/Header';\nimport { Sidebar } from '@/components/layout/Sidebar';\nimport { Footer } from '@/components/layout/Footer';\nimport { LicenseFlowDiagram } from '@/components/diagrams/LicenseFlowDiagram';\nimport { SecurityLevelsDiagram } from '@/components/diagrams/SecurityLevelsDiagram';\nimport { AttackVectorsDiagram } from '@/components/diagrams/AttackVectorsDiagram';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { Badge } from '@/components/ui/badge';\nimport { Network, Shield, Sword } from 'lucide-react';\n\nexport default function DiagramsPage() {\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <Header />\n      <div className=\"flex\">\n        <Sidebar className=\"hidden lg:flex\" />\n        <main className=\"flex-1 p-6 lg:p-8\">\n          <div className=\"mx-auto max-w-6xl\">\n            <div className=\"mb-8\">\n              <div className=\"flex items-center gap-3 mb-2\">\n                <h1 className=\"text-3xl font-bold text-foreground\">Interactive Diagrams</h1>\n                <Badge variant=\"outline\" className=\"bg-primary/10 text-primary border-primary/30\">\n                  Interactive\n                </Badge>\n              </div>\n              <p className=\"text-muted-foreground\">\n                Explore DRM systems through interactive visualizations. Click nodes, step through flows,\n                and switch perspectives to understand both attack and defense scenarios.\n              </p>\n            </div>\n\n            <Tabs defaultValue=\"license-flow\" className=\"space-y-6\">\n              <TabsList className=\"grid w-full grid-cols-3\">\n                <TabsTrigger value=\"license-flow\" className=\"gap-2\">\n                  <Network className=\"h-4 w-4\" />\n                  License Flow\n                </TabsTrigger>\n                <TabsTrigger value=\"security-levels\" className=\"gap-2\">\n                  <Shield className=\"h-4 w-4\" />\n                  Security Levels\n                </TabsTrigger>\n                <TabsTrigger value=\"attack-vectors\" className=\"gap-2\">\n                  <Sword className=\"h-4 w-4\" />\n                  Attack Vectors\n                </TabsTrigger>\n              </TabsList>\n\n              <TabsContent value=\"license-flow\" className=\"space-y-4\">\n                <div className=\"text-sm text-muted-foreground mb-4\">\n                  Step through the complete DRM license acquisition flow. See how content keys\n                  travel from license servers to your device securely.\n                </div>\n                <LicenseFlowDiagram />\n              </TabsContent>\n\n              <TabsContent value=\"security-levels\" className=\"space-y-4\">\n                <div className=\"text-sm text-muted-foreground mb-4\">\n                  Compare Widevine L1, L2, and L3 security levels. Understand the trade-offs\n                  between security and compatibility.\n                </div>\n                <SecurityLevelsDiagram />\n              </TabsContent>\n\n              <TabsContent value=\"attack-vectors\" className=\"space-y-4\">\n                <div className=\"text-sm text-muted-foreground mb-4\">\n                  Explore common attack vectors against DRM systems. Toggle your perspective\n                  to see attacker techniques or defender countermeasures.\n                </div>\n                <AttackVectorsDiagram />\n              </TabsContent>\n            </Tabs>\n          </div>\n        </main>\n      </div>\n      <Footer />\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAVA;;;;;;;;;;;AAYe,SAAS;IACtB,qBACE,2RAAC;QAAI,WAAU;;0BACb,2RAAC,6LAAM;;;;;0BACP,2RAAC;gBAAI,WAAU;;kCACb,2RAAC,+LAAO;wBAAC,WAAU;;;;;;kCACnB,2RAAC;wBAAK,WAAU;kCACd,cAAA,2RAAC;4BAAI,WAAU;;8CACb,2RAAC;oCAAI,WAAU;;sDACb,2RAAC;4CAAI,WAAU;;8DACb,2RAAC;oDAAG,WAAU;8DAAqC;;;;;;8DACnD,2RAAC,uLAAK;oDAAC,SAAQ;oDAAU,WAAU;8DAA+C;;;;;;;;;;;;sDAIpF,2RAAC;4CAAE,WAAU;sDAAwB;;;;;;;;;;;;8CAMvC,2RAAC,qLAAI;oCAAC,cAAa;oCAAe,WAAU;;sDAC1C,2RAAC,yLAAQ;4CAAC,WAAU;;8DAClB,2RAAC,4LAAW;oDAAC,OAAM;oDAAe,WAAU;;sEAC1C,2RAAC,gQAAO;4DAAC,WAAU;;;;;;wDAAY;;;;;;;8DAGjC,2RAAC,4LAAW;oDAAC,OAAM;oDAAkB,WAAU;;sEAC7C,2RAAC,6PAAM;4DAAC,WAAU;;;;;;wDAAY;;;;;;;8DAGhC,2RAAC,4LAAW;oDAAC,OAAM;oDAAiB,WAAU;;sEAC5C,2RAAC,0PAAK;4DAAC,WAAU;;;;;;wDAAY;;;;;;;;;;;;;sDAKjC,2RAAC,4LAAW;4CAAC,OAAM;4CAAe,WAAU;;8DAC1C,2RAAC;oDAAI,WAAU;8DAAqC;;;;;;8DAIpD,2RAAC,uNAAkB;;;;;;;;;;;sDAGrB,2RAAC,4LAAW;4CAAC,OAAM;4CAAkB,WAAU;;8DAC7C,2RAAC;oDAAI,WAAU;8DAAqC;;;;;;8DAIpD,2RAAC,6NAAqB;;;;;;;;;;;sDAGxB,2RAAC,4LAAW;4CAAC,OAAM;4CAAiB,WAAU;;8DAC5C,2RAAC;oDAAI,WAAU;8DAAqC;;;;;;8DAIpD,2RAAC,2NAAoB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;0BAM/B,2RAAC,6LAAM;;;;;;;;;;;AAGb"}}]
}