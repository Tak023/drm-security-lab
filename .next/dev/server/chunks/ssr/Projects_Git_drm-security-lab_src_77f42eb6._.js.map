{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/lib/utils.ts"],"sourcesContent":["import { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,SAAS,GAAG,GAAG,MAAoB;IACxC,OAAO,IAAA,mNAAO,EAAC,IAAA,0LAAI,EAAC;AACtB"}},
    {"offset": {"line": 19, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/components/ui/card.tsx"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Card({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card\"\n      className={cn(\n        \"bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-header\"\n      className={cn(\n        \"@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardTitle({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-title\"\n      className={cn(\"leading-none font-semibold\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardDescription({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-description\"\n      className={cn(\"text-muted-foreground text-sm\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardAction({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-action\"\n      className={cn(\n        \"col-start-2 row-span-2 row-start-1 self-start justify-self-end\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-content\"\n      className={cn(\"px-6\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-footer\"\n      className={cn(\"flex items-center px-6 [.border-t]:pt-6\", className)}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Card,\n  CardHeader,\n  CardFooter,\n  CardTitle,\n  CardAction,\n  CardDescription,\n  CardContent,\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAEA;;;AAEA,SAAS,KAAK,EAAE,SAAS,EAAE,GAAG,OAAoC;IAChE,qBACE,2RAAC;QACC,aAAU;QACV,WAAW,IAAA,sKAAE,EACX,qFACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,2RAAC;QACC,aAAU;QACV,WAAW,IAAA,sKAAE,EACX,4JACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,UAAU,EAAE,SAAS,EAAE,GAAG,OAAoC;IACrE,qBACE,2RAAC;QACC,aAAU;QACV,WAAW,IAAA,sKAAE,EAAC,8BAA8B;QAC3C,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,gBAAgB,EAAE,SAAS,EAAE,GAAG,OAAoC;IAC3E,qBACE,2RAAC;QACC,aAAU;QACV,WAAW,IAAA,sKAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,2RAAC;QACC,aAAU;QACV,WAAW,IAAA,sKAAE,EACX,kEACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,YAAY,EAAE,SAAS,EAAE,GAAG,OAAoC;IACvE,qBACE,2RAAC;QACC,aAAU;QACV,WAAW,IAAA,sKAAE,EAAC,QAAQ;QACrB,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,2RAAC;QACC,aAAU;QACV,WAAW,IAAA,sKAAE,EAAC,2CAA2C;QACxD,GAAG,KAAK;;;;;;AAGf"}},
    {"offset": {"line": 121, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/components/ui/button.tsx"],"sourcesContent":["import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-primary text-primary-foreground hover:bg-primary/90\",\n        destructive:\n          \"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60\",\n        outline:\n          \"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50\",\n        secondary:\n          \"bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        ghost:\n          \"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50\",\n        link: \"text-primary underline-offset-4 hover:underline\",\n      },\n      size: {\n        default: \"h-9 px-4 py-2 has-[>svg]:px-3\",\n        sm: \"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5\",\n        lg: \"h-10 rounded-md px-6 has-[>svg]:px-4\",\n        icon: \"size-9\",\n        \"icon-sm\": \"size-8\",\n        \"icon-lg\": \"size-10\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nfunction Button({\n  className,\n  variant = \"default\",\n  size = \"default\",\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"button\"> &\n  VariantProps<typeof buttonVariants> & {\n    asChild?: boolean\n  }) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"button\"\n      data-variant={variant}\n      data-size={size}\n      className={cn(buttonVariants({ variant, size, className }))}\n      {...props}\n    />\n  )\n}\n\nexport { Button, buttonVariants }\n"],"names":[],"mappings":";;;;;;;AACA;AACA;AAEA;;;;;AAEA,MAAM,iBAAiB,IAAA,oNAAG,EACxB,+bACA;IACE,UAAU;QACR,SAAS;YACP,SAAS;YACT,aACE;YACF,SACE;YACF,WACE;YACF,OACE;YACF,MAAM;QACR;QACA,MAAM;YACJ,SAAS;YACT,IAAI;YACJ,IAAI;YACJ,MAAM;YACN,WAAW;YACX,WAAW;QACb;IACF;IACA,iBAAiB;QACf,SAAS;QACT,MAAM;IACR;AACF;AAGF,SAAS,OAAO,EACd,SAAS,EACT,UAAU,SAAS,EACnB,OAAO,SAAS,EAChB,UAAU,KAAK,EACf,GAAG,OAIF;IACD,MAAM,OAAO,UAAU,qNAAI,GAAG;IAE9B,qBACE,2RAAC;QACC,aAAU;QACV,gBAAc;QACd,aAAW;QACX,WAAW,IAAA,sKAAE,EAAC,eAAe;YAAE;YAAS;YAAM;QAAU;QACvD,GAAG,KAAK;;;;;;AAGf"}},
    {"offset": {"line": 182, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/components/ui/badge.tsx"],"sourcesContent":["import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  \"inline-flex items-center justify-center rounded-full border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90\",\n        secondary:\n          \"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90\",\n        destructive:\n          \"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60\",\n        outline:\n          \"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nfunction Badge({\n  className,\n  variant,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"span\"> &\n  VariantProps<typeof badgeVariants> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"span\"\n\n  return (\n    <Comp\n      data-slot=\"badge\"\n      className={cn(badgeVariants({ variant }), className)}\n      {...props}\n    />\n  )\n}\n\nexport { Badge, badgeVariants }\n"],"names":[],"mappings":";;;;;;;AACA;AACA;AAEA;;;;;AAEA,MAAM,gBAAgB,IAAA,oNAAG,EACvB,oZACA;IACE,UAAU;QACR,SAAS;YACP,SACE;YACF,WACE;YACF,aACE;YACF,SACE;QACJ;IACF;IACA,iBAAiB;QACf,SAAS;IACX;AACF;AAGF,SAAS,MAAM,EACb,SAAS,EACT,OAAO,EACP,UAAU,KAAK,EACf,GAAG,OAEuD;IAC1D,MAAM,OAAO,UAAU,qNAAI,GAAG;IAE9B,qBACE,2RAAC;QACC,aAAU;QACV,WAAW,IAAA,sKAAE,EAAC,cAAc;YAAE;QAAQ,IAAI;QACzC,GAAG,KAAK;;;;;;AAGf"}},
    {"offset": {"line": 228, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/components/ui/alert.tsx"],"sourcesContent":["import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst alertVariants = cva(\n  \"relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-card text-card-foreground\",\n        destructive:\n          \"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nfunction Alert({\n  className,\n  variant,\n  ...props\n}: React.ComponentProps<\"div\"> & VariantProps<typeof alertVariants>) {\n  return (\n    <div\n      data-slot=\"alert\"\n      role=\"alert\"\n      className={cn(alertVariants({ variant }), className)}\n      {...props}\n    />\n  )\n}\n\nfunction AlertTitle({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"alert-title\"\n      className={cn(\n        \"col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction AlertDescription({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"alert-description\"\n      className={cn(\n        \"text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Alert, AlertTitle, AlertDescription }\n"],"names":[],"mappings":";;;;;;;;;AACA;AAEA;;;;AAEA,MAAM,gBAAgB,IAAA,oNAAG,EACvB,qOACA;IACE,UAAU;QACR,SAAS;YACP,SAAS;YACT,aACE;QACJ;IACF;IACA,iBAAiB;QACf,SAAS;IACX;AACF;AAGF,SAAS,MAAM,EACb,SAAS,EACT,OAAO,EACP,GAAG,OAC8D;IACjE,qBACE,2RAAC;QACC,aAAU;QACV,MAAK;QACL,WAAW,IAAA,sKAAE,EAAC,cAAc;YAAE;QAAQ,IAAI;QACzC,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,2RAAC;QACC,aAAU;QACV,WAAW,IAAA,sKAAE,EACX,+DACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,iBAAiB,EACxB,SAAS,EACT,GAAG,OACyB;IAC5B,qBACE,2RAAC;QACC,aAAU;QACV,WAAW,IAAA,sKAAE,EACX,kGACA;QAED,GAAG,KAAK;;;;;;AAGf"}},
    {"offset": {"line": 294, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/components/ui/scroll-area.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as ScrollAreaPrimitive from \"@radix-ui/react-scroll-area\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction ScrollArea({\n  className,\n  children,\n  ...props\n}: React.ComponentProps<typeof ScrollAreaPrimitive.Root>) {\n  return (\n    <ScrollAreaPrimitive.Root\n      data-slot=\"scroll-area\"\n      className={cn(\"relative\", className)}\n      {...props}\n    >\n      <ScrollAreaPrimitive.Viewport\n        data-slot=\"scroll-area-viewport\"\n        className=\"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1\"\n      >\n        {children}\n      </ScrollAreaPrimitive.Viewport>\n      <ScrollBar />\n      <ScrollAreaPrimitive.Corner />\n    </ScrollAreaPrimitive.Root>\n  )\n}\n\nfunction ScrollBar({\n  className,\n  orientation = \"vertical\",\n  ...props\n}: React.ComponentProps<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>) {\n  return (\n    <ScrollAreaPrimitive.ScrollAreaScrollbar\n      data-slot=\"scroll-area-scrollbar\"\n      orientation={orientation}\n      className={cn(\n        \"flex touch-none p-px transition-colors select-none\",\n        orientation === \"vertical\" &&\n          \"h-full w-2.5 border-l border-l-transparent\",\n        orientation === \"horizontal\" &&\n          \"h-2.5 flex-col border-t border-t-transparent\",\n        className\n      )}\n      {...props}\n    >\n      <ScrollAreaPrimitive.ScrollAreaThumb\n        data-slot=\"scroll-area-thumb\"\n        className=\"bg-border relative flex-1 rounded-full\"\n      />\n    </ScrollAreaPrimitive.ScrollAreaScrollbar>\n  )\n}\n\nexport { ScrollArea, ScrollBar }\n"],"names":[],"mappings":";;;;;;;AAGA;AAEA;AALA;;;;AAOA,SAAS,WAAW,EAClB,SAAS,EACT,QAAQ,EACR,GAAG,OACmD;IACtD,qBACE,2RAAC,+NAAwB;QACvB,aAAU;QACV,WAAW,IAAA,sKAAE,EAAC,YAAY;QACzB,GAAG,KAAK;;0BAET,2RAAC,mOAA4B;gBAC3B,aAAU;gBACV,WAAU;0BAET;;;;;;0BAEH,2RAAC;;;;;0BACD,2RAAC,iOAA0B;;;;;;;;;;;AAGjC;AAEA,SAAS,UAAU,EACjB,SAAS,EACT,cAAc,UAAU,EACxB,GAAG,OACkE;IACrE,qBACE,2RAAC,8OAAuC;QACtC,aAAU;QACV,aAAa;QACb,WAAW,IAAA,sKAAE,EACX,sDACA,gBAAgB,cACd,8CACF,gBAAgB,gBACd,gDACF;QAED,GAAG,KAAK;kBAET,cAAA,2RAAC,0OAAmC;YAClC,aAAU;YACV,WAAU;;;;;;;;;;;AAIlB"}},
    {"offset": {"line": 364, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/components/ui/separator.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as SeparatorPrimitive from \"@radix-ui/react-separator\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Separator({\n  className,\n  orientation = \"horizontal\",\n  decorative = true,\n  ...props\n}: React.ComponentProps<typeof SeparatorPrimitive.Root>) {\n  return (\n    <SeparatorPrimitive.Root\n      data-slot=\"separator\"\n      decorative={decorative}\n      orientation={orientation}\n      className={cn(\n        \"bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Separator }\n"],"names":[],"mappings":";;;;;AAGA;AAEA;AALA;;;;AAOA,SAAS,UAAU,EACjB,SAAS,EACT,cAAc,YAAY,EAC1B,aAAa,IAAI,EACjB,GAAG,OACkD;IACrD,qBACE,2RAAC,0NAAuB;QACtB,aAAU;QACV,YAAY;QACZ,aAAa;QACb,WAAW,IAAA,sKAAE,EACX,kKACA;QAED,GAAG,KAAK;;;;;;AAGf"}},
    {"offset": {"line": 393, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/lib/drm/crypto.ts"],"sourcesContent":["/**\n * Simplified crypto utilities for DRM simulation\n * This is for EDUCATIONAL purposes only - not production-grade crypto\n */\n\n// Simple XOR-based \"encryption\" for demonstration\nexport function xorEncrypt(data: Uint8Array, key: Uint8Array): Uint8Array {\n  const result = new Uint8Array(data.length);\n  for (let i = 0; i < data.length; i++) {\n    result[i] = data[i] ^ key[i % key.length];\n  }\n  return result;\n}\n\n// XOR two byte arrays (for educational block cipher demos)\nexport function xorBytes(a: Uint8Array, b: Uint8Array): Uint8Array {\n  const length = Math.min(a.length, b.length);\n  const result = new Uint8Array(length);\n  for (let i = 0; i < length; i++) {\n    result[i] = a[i] ^ b[i];\n  }\n  return result;\n}\n\nexport function xorDecrypt(data: Uint8Array, key: Uint8Array): Uint8Array {\n  // XOR is symmetric\n  return xorEncrypt(data, key);\n}\n\n// Generate a random key\nexport function generateKey(length: number = 16): Uint8Array {\n  const key = new Uint8Array(length);\n  if (typeof window !== 'undefined' && window.crypto) {\n    window.crypto.getRandomValues(key);\n  } else {\n    // Fallback for SSR\n    for (let i = 0; i < length; i++) {\n      key[i] = Math.floor(Math.random() * 256);\n    }\n  }\n  return key;\n}\n\n// Convert bytes to hex string\nexport function bytesToHex(bytes: Uint8Array): string {\n  return Array.from(bytes)\n    .map((b) => b.toString(16).padStart(2, '0'))\n    .join('');\n}\n\n// Convert hex string to bytes\nexport function hexToBytes(hex: string): Uint8Array {\n  const bytes = new Uint8Array(hex.length / 2);\n  for (let i = 0; i < bytes.length; i++) {\n    bytes[i] = parseInt(hex.substr(i * 2, 2), 16);\n  }\n  return bytes;\n}\n\n// Convert string to bytes\nexport function stringToBytes(str: string): Uint8Array {\n  return new TextEncoder().encode(str);\n}\n\n// Convert bytes to string\nexport function bytesToString(bytes: Uint8Array): string {\n  return new TextDecoder().decode(bytes);\n}\n\n// Base64 encode\nexport function base64Encode(bytes: Uint8Array): string {\n  if (typeof window !== 'undefined') {\n    return btoa(String.fromCharCode(...bytes));\n  }\n  return Buffer.from(bytes).toString('base64');\n}\n\n// Base64 decode\nexport function base64Decode(str: string): Uint8Array {\n  if (typeof window !== 'undefined') {\n    return Uint8Array.from(atob(str), (c) => c.charCodeAt(0));\n  }\n  return new Uint8Array(Buffer.from(str, 'base64'));\n}\n\n// Simple hash function (not cryptographically secure, for demo only)\nexport function simpleHash(data: Uint8Array): string {\n  let hash = 0;\n  for (let i = 0; i < data.length; i++) {\n    hash = ((hash << 5) - hash + data[i]) | 0;\n  }\n  return Math.abs(hash).toString(16).padStart(8, '0');\n}\n\n// Generate a key ID (UUID-like)\nexport function generateKeyId(): string {\n  const bytes = generateKey(16);\n  const hex = bytesToHex(bytes);\n  return `${hex.slice(0, 8)}-${hex.slice(8, 12)}-${hex.slice(12, 16)}-${hex.slice(16, 20)}-${hex.slice(20, 32)}`;\n}\n\n// AES-like block cipher simulation (simplified for education)\nexport class SimpleCipher {\n  private key: Uint8Array;\n  private iv: Uint8Array;\n\n  constructor(key: Uint8Array, iv?: Uint8Array) {\n    this.key = key;\n    this.iv = iv || generateKey(16);\n  }\n\n  // Simulated CTR mode encryption\n  encryptCTR(plaintext: Uint8Array): { ciphertext: Uint8Array; iv: Uint8Array } {\n    const ciphertext = new Uint8Array(plaintext.length);\n    const blockSize = 16;\n\n    for (let i = 0; i < plaintext.length; i += blockSize) {\n      // Create counter block\n      const counter = new Uint8Array(blockSize);\n      counter.set(this.iv.slice(0, 8), 0);\n      const blockNum = Math.floor(i / blockSize);\n      for (let j = 0; j < 8; j++) {\n        counter[8 + j] = (blockNum >> (8 * (7 - j))) & 0xff;\n      }\n\n      // \"Encrypt\" counter with key (simplified - just XOR in real AES this is block cipher)\n      const keystream = xorEncrypt(counter, this.key);\n\n      // XOR plaintext with keystream\n      const blockEnd = Math.min(i + blockSize, plaintext.length);\n      for (let j = i; j < blockEnd; j++) {\n        ciphertext[j] = plaintext[j] ^ keystream[j - i];\n      }\n    }\n\n    return { ciphertext, iv: this.iv };\n  }\n\n  decryptCTR(ciphertext: Uint8Array): Uint8Array {\n    // CTR mode is symmetric\n    return this.encryptCTR(ciphertext).ciphertext;\n  }\n\n  getIV(): Uint8Array {\n    return this.iv;\n  }\n}\n\n// Simulated RSA-like asymmetric operations (NOT SECURE - for demo only)\nexport class SimpleAsymmetric {\n  private privateKey: number;\n  private publicKey: number;\n  private modulus: number;\n\n  constructor() {\n    // Use small primes for demonstration (real RSA uses 2048+ bit primes)\n    const p = 61;\n    const q = 53;\n    this.modulus = p * q; // 3233\n    const phi = (p - 1) * (q - 1); // 3120\n    this.publicKey = 17; // Common choice\n    this.privateKey = this.modInverse(this.publicKey, phi); // 2753\n  }\n\n  private modInverse(a: number, m: number): number {\n    let [old_r, r] = [a, m];\n    let [old_s, s] = [1, 0];\n\n    while (r !== 0) {\n      const q = Math.floor(old_r / r);\n      [old_r, r] = [r, old_r - q * r];\n      [old_s, s] = [s, old_s - q * s];\n    }\n\n    return ((old_s % m) + m) % m;\n  }\n\n  private modPow(base: number, exp: number, mod: number): number {\n    let result = 1;\n    base = base % mod;\n    while (exp > 0) {\n      if (exp % 2 === 1) {\n        result = (result * base) % mod;\n      }\n      exp = Math.floor(exp / 2);\n      base = (base * base) % mod;\n    }\n    return result;\n  }\n\n  // Encrypt a single byte (demo only - real RSA encrypts blocks)\n  encrypt(byte: number): number {\n    return this.modPow(byte, this.publicKey, this.modulus);\n  }\n\n  // Decrypt a single value\n  decrypt(encrypted: number): number {\n    return this.modPow(encrypted, this.privateKey, this.modulus);\n  }\n\n  // Encrypt bytes (very simplified)\n  encryptBytes(data: Uint8Array): number[] {\n    return Array.from(data).map((b) => this.encrypt(b));\n  }\n\n  // Decrypt to bytes\n  decryptBytes(encrypted: number[]): Uint8Array {\n    return new Uint8Array(encrypted.map((e) => this.decrypt(e)));\n  }\n\n  getPublicKey(): { e: number; n: number } {\n    return { e: this.publicKey, n: this.modulus };\n  }\n\n  // Sign data (hash and encrypt with private key)\n  sign(data: Uint8Array): string {\n    const hash = simpleHash(data);\n    const hashBytes = stringToBytes(hash);\n    const signature = Array.from(hashBytes).map((b) =>\n      this.modPow(b, this.privateKey, this.modulus)\n    );\n    return signature.join(',');\n  }\n\n  // Verify signature\n  verify(data: Uint8Array, signature: string): boolean {\n    const hash = simpleHash(data);\n    const sigParts = signature.split(',').map(Number);\n    const decrypted = sigParts.map((s) =>\n      this.modPow(s, this.publicKey, this.modulus)\n    );\n    const recovered = bytesToString(new Uint8Array(decrypted));\n    return recovered === hash;\n  }\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 625, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/app/labs/key-exchange/page.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useCallback } from 'react';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Alert, AlertDescription, AlertTitle } from '@/components/ui/alert';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { ScrollArea } from '@/components/ui/scroll-area';\nimport { Separator } from '@/components/ui/separator';\nimport {\n  Key,\n  Lock,\n  ArrowRight,\n  ArrowLeftRight,\n  Shield,\n  User,\n  Server,\n  RefreshCw,\n  CheckCircle2,\n} from 'lucide-react';\nimport { bytesToHex, generateKey } from '@/lib/drm/crypto';\n\ninterface KeyExchangeStep {\n  id: string;\n  actor: 'client' | 'server' | 'shared';\n  title: string;\n  description: string;\n  value?: string;\n  status: 'pending' | 'complete';\n}\n\nexport default function KeyExchangePage() {\n  const [steps, setSteps] = useState<KeyExchangeStep[]>([]);\n  const [isRunning, setIsRunning] = useState(false);\n  const [exchangeType, setExchangeType] = useState<'dh' | 'rsa'>('dh');\n\n  const delay = (ms: number) => new Promise(resolve => setTimeout(resolve, ms));\n\n  const runDHExchange = async () => {\n    setIsRunning(true);\n    setSteps([]);\n\n    // Simulated DH parameters\n    const p = 23; // Small prime for demo\n    const g = 5;  // Generator\n\n    // Step 1: Agree on parameters\n    setSteps([{\n      id: '1',\n      actor: 'shared',\n      title: 'Agree on Parameters',\n      description: `Both parties agree on prime p=${p} and generator g=${g}`,\n      value: `p=${p}, g=${g}`,\n      status: 'complete',\n    }]);\n    await delay(800);\n\n    // Step 2: Client generates private key\n    const clientPrivate = Math.floor(Math.random() * 10) + 1;\n    const clientPublic = Math.pow(g, clientPrivate) % p;\n    setSteps(prev => [...prev, {\n      id: '2',\n      actor: 'client',\n      title: 'Client Private Key',\n      description: `Client chooses secret a=${clientPrivate}`,\n      value: `a = ${clientPrivate} (secret)`,\n      status: 'complete',\n    }]);\n    await delay(600);\n\n    setSteps(prev => [...prev, {\n      id: '3',\n      actor: 'client',\n      title: 'Client Public Key',\n      description: `Client computes A = g^a mod p = ${g}^${clientPrivate} mod ${p}`,\n      value: `A = ${clientPublic}`,\n      status: 'complete',\n    }]);\n    await delay(600);\n\n    // Step 3: Server generates private key\n    const serverPrivate = Math.floor(Math.random() * 10) + 1;\n    const serverPublic = Math.pow(g, serverPrivate) % p;\n    setSteps(prev => [...prev, {\n      id: '4',\n      actor: 'server',\n      title: 'Server Private Key',\n      description: `Server chooses secret b=${serverPrivate}`,\n      value: `b = ${serverPrivate} (secret)`,\n      status: 'complete',\n    }]);\n    await delay(600);\n\n    setSteps(prev => [...prev, {\n      id: '5',\n      actor: 'server',\n      title: 'Server Public Key',\n      description: `Server computes B = g^b mod p = ${g}^${serverPrivate} mod ${p}`,\n      value: `B = ${serverPublic}`,\n      status: 'complete',\n    }]);\n    await delay(600);\n\n    // Step 4: Exchange public keys\n    setSteps(prev => [...prev, {\n      id: '6',\n      actor: 'shared',\n      title: 'Exchange Public Keys',\n      description: 'Client sends A to server, server sends B to client',\n      value: `Client→Server: ${clientPublic}, Server→Client: ${serverPublic}`,\n      status: 'complete',\n    }]);\n    await delay(800);\n\n    // Step 5: Compute shared secret\n    const clientShared = Math.pow(serverPublic, clientPrivate) % p;\n    const serverShared = Math.pow(clientPublic, serverPrivate) % p;\n\n    setSteps(prev => [...prev, {\n      id: '7',\n      actor: 'client',\n      title: 'Client Computes Shared Secret',\n      description: `s = B^a mod p = ${serverPublic}^${clientPrivate} mod ${p}`,\n      value: `s = ${clientShared}`,\n      status: 'complete',\n    }]);\n    await delay(600);\n\n    setSteps(prev => [...prev, {\n      id: '8',\n      actor: 'server',\n      title: 'Server Computes Shared Secret',\n      description: `s = A^b mod p = ${clientPublic}^${serverPrivate} mod ${p}`,\n      value: `s = ${serverShared}`,\n      status: 'complete',\n    }]);\n    await delay(600);\n\n    // Final verification\n    setSteps(prev => [...prev, {\n      id: '9',\n      actor: 'shared',\n      title: 'Shared Secret Established!',\n      description: `Both parties now share secret ${clientShared} for encryption`,\n      value: clientShared === serverShared ? 'Secrets Match!' : 'Error!',\n      status: 'complete',\n    }]);\n\n    setIsRunning(false);\n  };\n\n  const runRSAExchange = async () => {\n    setIsRunning(true);\n    setSteps([]);\n\n    // Step 1: Server generates key pair\n    setSteps([{\n      id: '1',\n      actor: 'server',\n      title: 'Generate RSA Key Pair',\n      description: 'Server generates public/private key pair',\n      value: `n=3233, e=17, d=2753`,\n      status: 'complete',\n    }]);\n    await delay(800);\n\n    // Step 2: Share public key\n    setSteps(prev => [...prev, {\n      id: '2',\n      actor: 'server',\n      title: 'Share Public Key',\n      description: 'Server sends public key (n, e) to client',\n      value: `Public: (n=3233, e=17)`,\n      status: 'complete',\n    }]);\n    await delay(600);\n\n    // Step 3: Client generates session key\n    const sessionKey = bytesToHex(generateKey(16));\n    setSteps(prev => [...prev, {\n      id: '3',\n      actor: 'client',\n      title: 'Generate Session Key',\n      description: 'Client generates random AES session key',\n      value: sessionKey.substring(0, 32) + '...',\n      status: 'complete',\n    }]);\n    await delay(600);\n\n    // Step 4: Encrypt session key\n    setSteps(prev => [...prev, {\n      id: '4',\n      actor: 'client',\n      title: 'Encrypt Session Key',\n      description: 'Client encrypts session key with server public key',\n      value: bytesToHex(generateKey(32)).substring(0, 32) + '...',\n      status: 'complete',\n    }]);\n    await delay(600);\n\n    // Step 5: Send encrypted key\n    setSteps(prev => [...prev, {\n      id: '5',\n      actor: 'shared',\n      title: 'Send Encrypted Key',\n      description: 'Client sends encrypted session key to server',\n      status: 'complete',\n    }]);\n    await delay(600);\n\n    // Step 6: Server decrypts\n    setSteps(prev => [...prev, {\n      id: '6',\n      actor: 'server',\n      title: 'Decrypt Session Key',\n      description: 'Server decrypts using private key d',\n      value: sessionKey.substring(0, 32) + '...',\n      status: 'complete',\n    }]);\n    await delay(600);\n\n    // Final\n    setSteps(prev => [...prev, {\n      id: '7',\n      actor: 'shared',\n      title: 'Secure Channel Established!',\n      description: 'Both parties share the AES session key',\n      value: 'Keys Match!',\n      status: 'complete',\n    }]);\n\n    setIsRunning(false);\n  };\n\n  const handleRun = () => {\n    if (exchangeType === 'dh') {\n      runDHExchange();\n    } else {\n      runRSAExchange();\n    }\n  };\n\n  const getActorColor = (actor: string) => {\n    switch (actor) {\n      case 'client': return 'bg-blue-500/10 border-blue-500/30 text-blue-400';\n      case 'server': return 'bg-purple-500/10 border-purple-500/30 text-purple-400';\n      case 'shared': return 'bg-green-500/10 border-green-500/30 text-green-400';\n      default: return '';\n    }\n  };\n\n  return (\n    <div className=\"container max-w-6xl py-8\">\n      <div className=\"mb-8\">\n        <h1 className=\"text-2xl font-bold flex items-center gap-2\">\n          <Key className=\"w-6 h-6 text-primary\" />\n          Key Exchange Lab\n        </h1>\n        <p className=\"text-muted-foreground mt-1\">\n          Visualize Diffie-Hellman and RSA key exchange protocols\n        </p>\n      </div>\n\n      <Alert className=\"mb-6\">\n        <Shield className=\"h-4 w-4\" />\n        <AlertTitle>How DRM Uses Key Exchange</AlertTitle>\n        <AlertDescription>\n          DRM systems use key exchange protocols to securely transfer content decryption keys\n          from the license server to the client. This ensures only authorized devices can decrypt content.\n        </AlertDescription>\n      </Alert>\n\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n        {/* Controls */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"text-lg\">Exchange Protocol</CardTitle>\n            <CardDescription>Select key exchange method</CardDescription>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            <div className=\"space-y-2\">\n              <Button\n                variant={exchangeType === 'dh' ? 'default' : 'outline'}\n                className=\"w-full justify-start\"\n                onClick={() => setExchangeType('dh')}\n                disabled={isRunning}\n              >\n                <ArrowLeftRight className=\"w-4 h-4 mr-2\" />\n                Diffie-Hellman\n              </Button>\n              <Button\n                variant={exchangeType === 'rsa' ? 'default' : 'outline'}\n                className=\"w-full justify-start\"\n                onClick={() => setExchangeType('rsa')}\n                disabled={isRunning}\n              >\n                <Lock className=\"w-4 h-4 mr-2\" />\n                RSA Key Transport\n              </Button>\n            </div>\n\n            <Separator />\n\n            <Button\n              onClick={handleRun}\n              disabled={isRunning}\n              className=\"w-full gap-2\"\n            >\n              {isRunning ? (\n                <RefreshCw className=\"w-4 h-4 animate-spin\" />\n              ) : (\n                <Key className=\"w-4 h-4\" />\n              )}\n              {isRunning ? 'Running...' : 'Run Exchange'}\n            </Button>\n\n            <div className=\"text-xs text-muted-foreground space-y-2\">\n              <div className=\"flex items-center gap-2\">\n                <User className=\"w-3 h-3 text-blue-400\" /> Client\n              </div>\n              <div className=\"flex items-center gap-2\">\n                <Server className=\"w-3 h-3 text-purple-400\" /> Server\n              </div>\n              <div className=\"flex items-center gap-2\">\n                <ArrowLeftRight className=\"w-3 h-3 text-green-400\" /> Shared\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Exchange Steps */}\n        <Card className=\"lg:col-span-2\">\n          <CardHeader>\n            <CardTitle className=\"text-lg\">Exchange Process</CardTitle>\n            <CardDescription>Step-by-step key exchange visualization</CardDescription>\n          </CardHeader>\n          <CardContent>\n            <ScrollArea className=\"h-[400px] pr-4\">\n              {steps.length === 0 ? (\n                <div className=\"text-center py-12 text-muted-foreground\">\n                  <Key className=\"w-12 h-12 mx-auto mb-4 opacity-50\" />\n                  <p>Select a protocol and run the exchange</p>\n                </div>\n              ) : (\n                <div className=\"space-y-3\">\n                  {steps.map((step, index) => (\n                    <div\n                      key={step.id}\n                      className={`p-4 rounded-lg border ${getActorColor(step.actor)}`}\n                    >\n                      <div className=\"flex items-center gap-2 mb-2\">\n                        <Badge variant=\"outline\" className=\"text-xs\">\n                          Step {index + 1}\n                        </Badge>\n                        <Badge variant=\"outline\" className=\"text-xs capitalize\">\n                          {step.actor}\n                        </Badge>\n                        {step.status === 'complete' && (\n                          <CheckCircle2 className=\"w-4 h-4 text-green-500 ml-auto\" />\n                        )}\n                      </div>\n                      <h4 className=\"font-medium\">{step.title}</h4>\n                      <p className=\"text-sm text-muted-foreground mt-1\">{step.description}</p>\n                      {step.value && (\n                        <code className=\"text-xs bg-background/50 px-2 py-1 rounded mt-2 inline-block\">\n                          {step.value}\n                        </code>\n                      )}\n                    </div>\n                  ))}\n                </div>\n              )}\n            </ScrollArea>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}