{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/lib/utils.ts"],"sourcesContent":["import { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,SAAS,GAAG,GAAG,MAAoB;IACxC,OAAO,IAAA,sNAAO,EAAC,IAAA,6LAAI,EAAC;AACtB"}},
    {"offset": {"line": 22, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/components/ui/card.tsx"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Card({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card\"\n      className={cn(\n        \"bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-header\"\n      className={cn(\n        \"@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardTitle({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-title\"\n      className={cn(\"leading-none font-semibold\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardDescription({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-description\"\n      className={cn(\"text-muted-foreground text-sm\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardAction({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-action\"\n      className={cn(\n        \"col-start-2 row-span-2 row-start-1 self-start justify-self-end\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-content\"\n      className={cn(\"px-6\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-footer\"\n      className={cn(\"flex items-center px-6 [.border-t]:pt-6\", className)}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Card,\n  CardHeader,\n  CardFooter,\n  CardTitle,\n  CardAction,\n  CardDescription,\n  CardContent,\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAEA;;;AAEA,SAAS,KAAK,EAAE,SAAS,EAAE,GAAG,OAAoC;IAChE,qBACE,0OAAC;QACC,aAAU;QACV,WAAW,IAAA,yKAAE,EACX,qFACA;QAED,GAAG,KAAK;;;;;;AAGf;KAXS;AAaT,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,0OAAC;QACC,aAAU;QACV,WAAW,IAAA,yKAAE,EACX,4JACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,UAAU,EAAE,SAAS,EAAE,GAAG,OAAoC;IACrE,qBACE,0OAAC;QACC,aAAU;QACV,WAAW,IAAA,yKAAE,EAAC,8BAA8B;QAC3C,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,gBAAgB,EAAE,SAAS,EAAE,GAAG,OAAoC;IAC3E,qBACE,0OAAC;QACC,aAAU;QACV,WAAW,IAAA,yKAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,0OAAC;QACC,aAAU;QACV,WAAW,IAAA,yKAAE,EACX,kEACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,YAAY,EAAE,SAAS,EAAE,GAAG,OAAoC;IACvE,qBACE,0OAAC;QACC,aAAU;QACV,WAAW,IAAA,yKAAE,EAAC,QAAQ;QACrB,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,0OAAC;QACC,aAAU;QACV,WAAW,IAAA,yKAAE,EAAC,2CAA2C;QACxD,GAAG,KAAK;;;;;;AAGf;MARS"}},
    {"offset": {"line": 142, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/components/ui/button.tsx"],"sourcesContent":["import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-primary text-primary-foreground hover:bg-primary/90\",\n        destructive:\n          \"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60\",\n        outline:\n          \"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50\",\n        secondary:\n          \"bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        ghost:\n          \"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50\",\n        link: \"text-primary underline-offset-4 hover:underline\",\n      },\n      size: {\n        default: \"h-9 px-4 py-2 has-[>svg]:px-3\",\n        sm: \"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5\",\n        lg: \"h-10 rounded-md px-6 has-[>svg]:px-4\",\n        icon: \"size-9\",\n        \"icon-sm\": \"size-8\",\n        \"icon-lg\": \"size-10\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nfunction Button({\n  className,\n  variant = \"default\",\n  size = \"default\",\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"button\"> &\n  VariantProps<typeof buttonVariants> & {\n    asChild?: boolean\n  }) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"button\"\n      data-variant={variant}\n      data-size={size}\n      className={cn(buttonVariants({ variant, size, className }))}\n      {...props}\n    />\n  )\n}\n\nexport { Button, buttonVariants }\n"],"names":[],"mappings":";;;;;;;AACA;AACA;AAEA;;;;;AAEA,MAAM,iBAAiB,IAAA,uNAAG,EACxB,+bACA;IACE,UAAU;QACR,SAAS;YACP,SAAS;YACT,aACE;YACF,SACE;YACF,WACE;YACF,OACE;YACF,MAAM;QACR;QACA,MAAM;YACJ,SAAS;YACT,IAAI;YACJ,IAAI;YACJ,MAAM;YACN,WAAW;YACX,WAAW;QACb;IACF;IACA,iBAAiB;QACf,SAAS;QACT,MAAM;IACR;AACF;AAGF,SAAS,OAAO,EACd,SAAS,EACT,UAAU,SAAS,EACnB,OAAO,SAAS,EAChB,UAAU,KAAK,EACf,GAAG,OAIF;IACD,MAAM,OAAO,UAAU,wNAAI,GAAG;IAE9B,qBACE,0OAAC;QACC,aAAU;QACV,gBAAc;QACd,aAAW;QACX,WAAW,IAAA,yKAAE,EAAC,eAAe;YAAE;YAAS;YAAM;QAAU;QACvD,GAAG,KAAK;;;;;;AAGf;KArBS"}},
    {"offset": {"line": 209, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/components/ui/badge.tsx"],"sourcesContent":["import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  \"inline-flex items-center justify-center rounded-full border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90\",\n        secondary:\n          \"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90\",\n        destructive:\n          \"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60\",\n        outline:\n          \"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nfunction Badge({\n  className,\n  variant,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"span\"> &\n  VariantProps<typeof badgeVariants> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"span\"\n\n  return (\n    <Comp\n      data-slot=\"badge\"\n      className={cn(badgeVariants({ variant }), className)}\n      {...props}\n    />\n  )\n}\n\nexport { Badge, badgeVariants }\n"],"names":[],"mappings":";;;;;;;AACA;AACA;AAEA;;;;;AAEA,MAAM,gBAAgB,IAAA,uNAAG,EACvB,oZACA;IACE,UAAU;QACR,SAAS;YACP,SACE;YACF,WACE;YACF,aACE;YACF,SACE;QACJ;IACF;IACA,iBAAiB;QACf,SAAS;IACX;AACF;AAGF,SAAS,MAAM,EACb,SAAS,EACT,OAAO,EACP,UAAU,KAAK,EACf,GAAG,OAEuD;IAC1D,MAAM,OAAO,UAAU,wNAAI,GAAG;IAE9B,qBACE,0OAAC;QACC,aAAU;QACV,WAAW,IAAA,yKAAE,EAAC,cAAc;YAAE;QAAQ,IAAI;QACzC,GAAG,KAAK;;;;;;AAGf;KAhBS"}},
    {"offset": {"line": 261, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/components/ui/alert.tsx"],"sourcesContent":["import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst alertVariants = cva(\n  \"relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-card text-card-foreground\",\n        destructive:\n          \"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nfunction Alert({\n  className,\n  variant,\n  ...props\n}: React.ComponentProps<\"div\"> & VariantProps<typeof alertVariants>) {\n  return (\n    <div\n      data-slot=\"alert\"\n      role=\"alert\"\n      className={cn(alertVariants({ variant }), className)}\n      {...props}\n    />\n  )\n}\n\nfunction AlertTitle({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"alert-title\"\n      className={cn(\n        \"col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction AlertDescription({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"alert-description\"\n      className={cn(\n        \"text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Alert, AlertTitle, AlertDescription }\n"],"names":[],"mappings":";;;;;;;;;AACA;AAEA;;;;AAEA,MAAM,gBAAgB,IAAA,uNAAG,EACvB,qOACA;IACE,UAAU;QACR,SAAS;YACP,SAAS;YACT,aACE;QACJ;IACF;IACA,iBAAiB;QACf,SAAS;IACX;AACF;AAGF,SAAS,MAAM,EACb,SAAS,EACT,OAAO,EACP,GAAG,OAC8D;IACjE,qBACE,0OAAC;QACC,aAAU;QACV,MAAK;QACL,WAAW,IAAA,yKAAE,EAAC,cAAc;YAAE;QAAQ,IAAI;QACzC,GAAG,KAAK;;;;;;AAGf;KAbS;AAeT,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,0OAAC;QACC,aAAU;QACV,WAAW,IAAA,yKAAE,EACX,+DACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,iBAAiB,EACxB,SAAS,EACT,GAAG,OACyB;IAC5B,qBACE,0OAAC;QACC,aAAU;QACV,WAAW,IAAA,yKAAE,EACX,kGACA;QAED,GAAG,KAAK;;;;;;AAGf;MAdS"}},
    {"offset": {"line": 337, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/components/ui/separator.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as SeparatorPrimitive from \"@radix-ui/react-separator\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Separator({\n  className,\n  orientation = \"horizontal\",\n  decorative = true,\n  ...props\n}: React.ComponentProps<typeof SeparatorPrimitive.Root>) {\n  return (\n    <SeparatorPrimitive.Root\n      data-slot=\"separator\"\n      decorative={decorative}\n      orientation={orientation}\n      className={cn(\n        \"bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Separator }\n"],"names":[],"mappings":";;;;;AAGA;AAEA;AALA;;;;AAOA,SAAS,UAAU,EACjB,SAAS,EACT,cAAc,YAAY,EAC1B,aAAa,IAAI,EACjB,GAAG,OACkD;IACrD,qBACE,0OAAC,6NAAuB;QACtB,aAAU;QACV,YAAY;QACZ,aAAa;QACb,WAAW,IAAA,yKAAE,EACX,kKACA;QAED,GAAG,KAAK;;;;;;AAGf;KAlBS"}},
    {"offset": {"line": 372, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/components/ui/textarea.tsx"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Textarea({ className, ...props }: React.ComponentProps<\"textarea\">) {\n  return (\n    <textarea\n      data-slot=\"textarea\"\n      className={cn(\n        \"border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Textarea }\n"],"names":[],"mappings":";;;;;AAEA;;;AAEA,SAAS,SAAS,EAAE,SAAS,EAAE,GAAG,OAAyC;IACzE,qBACE,0OAAC;QACC,aAAU;QACV,WAAW,IAAA,yKAAE,EACX,ucACA;QAED,GAAG,KAAK;;;;;;AAGf;KAXS"}},
    {"offset": {"line": 402, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/lib/challenges/index.ts"],"sourcesContent":["/**\n * CTF Challenge definitions for DRM Security Lab\n * Each challenge has a puzzle, hints, and verification logic\n */\n\nexport interface Challenge {\n  id: string;\n  title: string;\n  description: string;\n  category: 'encryption' | 'protocol-analysis' | 'forensics' | 'reverse-engineering' | 'defense-bypass';\n  difficulty: 'beginner' | 'intermediate' | 'advanced' | 'expert';\n  points: number;\n  scenario: string;\n  initialData: Record<string, string>;\n  hints: string[];\n  solution: string;\n  solutionExplanation: string;\n  verifyAnswer: (answer: string) => boolean;\n}\n\nexport const challenges: Record<string, Challenge> = {\n  'enc-basics-01': {\n    id: 'enc-basics-01',\n    title: 'Decode the Key',\n    description: 'A license server responded with an encoded key. Can you determine the original content key?',\n    category: 'encryption',\n    difficulty: 'beginner',\n    points: 100,\n    scenario: `You've intercepted a license response from a DRM server. The response contains an encoded content key, but it uses a simple encoding scheme.\n\nThe key appears to be Base64 encoded, but when you decode it, you get garbage. Upon further analysis, you notice the bytes seem to be XOR'd with a repeating pattern.\n\nYour task: Decode the content key.`,\n    initialData: {\n      'Encoded Key': 'RUFFU1NJTkdYT1JLRVRFU1Q=',\n      'XOR Pattern': '0x42 (repeating)',\n      'Expected Key Length': '16 bytes',\n    },\n    hints: [\n      'First, Base64 decode the encoded key',\n      'Then XOR each byte with 0x42',\n      'The result should be readable ASCII',\n    ],\n    solution: 'CONTENTSECRETKEY',\n    solutionExplanation: `The encoded key was created by:\n1. Taking the plaintext key \"CONTENTSECRETKEY\"\n2. XORing each byte with 0x42\n3. Base64 encoding the result\n\nTo decode:\n1. Base64 decode: EAESSINGXORKETEST\n2. XOR with 0x42: CONTENTSECRETKEY`,\n    verifyAnswer: (answer: string) => {\n      return answer.toUpperCase().replace(/\\s/g, '') === 'CONTENTSECRETKEY';\n    },\n  },\n\n  'enc-basics-02': {\n    id: 'enc-basics-02',\n    title: 'IV Discovery',\n    description: 'The encryption is AES-CBC, but something is wrong with the IV. Find the issue.',\n    category: 'encryption',\n    difficulty: 'beginner',\n    points: 100,\n    scenario: `A streaming service is using AES-128-CBC encryption for their content segments. You've captured several encrypted segments and noticed something suspicious about the initialization vectors.\n\nSegment 1 IV: 00000000000000000000000000000001\nSegment 2 IV: 00000000000000000000000000000002\nSegment 3 IV: 00000000000000000000000000000003\n...\n\nWhat security vulnerability does this create?`,\n    initialData: {\n      'Encryption': 'AES-128-CBC',\n      'Key': '(same for all segments)',\n      'IV Pattern': 'Sequential counter',\n    },\n    hints: [\n      'Think about what IVs are supposed to provide',\n      'Sequential IVs are predictable',\n      'Research \"CBC mode IV reuse attacks\"',\n    ],\n    solution: 'predictable',\n    solutionExplanation: `The vulnerability is **predictable IVs**.\n\nIn CBC mode, IVs should be:\n- Unpredictable (random)\n- Never reused with the same key\n\nSequential IVs allow:\n1. **Known-plaintext attacks**: If an attacker knows any plaintext block, they can manipulate the next segment\n2. **Chosen-plaintext attacks**: Attacker can craft inputs to leak information\n\nThe fix: Use randomly generated IVs for each segment.`,\n    verifyAnswer: (answer: string) => {\n      const normalized = answer.toLowerCase().replace(/\\s/g, '');\n      return normalized.includes('predictable') ||\n             normalized.includes('sequential') ||\n             normalized.includes('reuse') ||\n             normalized.includes('notrandm') ||\n             normalized.includes('counter');\n    },\n  },\n\n  'proto-01': {\n    id: 'proto-01',\n    title: 'License Request Analysis',\n    description: 'Analyze a captured license request and identify the protected content ID.',\n    category: 'protocol-analysis',\n    difficulty: 'intermediate',\n    points: 250,\n    scenario: `You've captured a Widevine license request (PSSH box) from network traffic. The PSSH data is Base64 encoded and contains the content ID.\n\nCaptured PSSH (Base64):\nAAAAOHBzc2gAAAAA7e+LqXnWSs6jyCfc1R0h7QAAABgSEGNvbnRlbnRfaWRfMTIzNDUYAQ==\n\nExtract the content ID from this PSSH box.`,\n    initialData: {\n      'PSSH Box': 'AAAAOHBzc2gAAAAA7e+LqXnWSs6jyCfc1R0h7QAAABgSEGNvbnRlbnRfaWRfMTIzNDUYAQ==',\n      'System ID': 'edef8ba9-79d6-4ace-a3c8-27dcd51d21ed (Widevine)',\n      'Format': 'CENC PSSH Box',\n    },\n    hints: [\n      'Base64 decode the PSSH first',\n      'PSSH boxes have a specific structure: header + system ID + data',\n      'The content ID is in the data section, often as ASCII text',\n    ],\n    solution: 'content_id_12345',\n    solutionExplanation: `The PSSH box structure:\n1. Box size (4 bytes)\n2. Box type \"pssh\" (4 bytes)\n3. Version/flags (4 bytes)\n4. System ID (16 bytes) - Widevine\n5. Data length (4 bytes)\n6. Data (contains content ID)\n\nWhen decoded, the content ID \"content_id_12345\" is visible in the data section.`,\n    verifyAnswer: (answer: string) => {\n      const normalized = answer.toLowerCase().replace(/\\s/g, '').replace(/-/g, '_');\n      return normalized === 'content_id_12345' || normalized === 'contentid12345';\n    },\n  },\n\n  'proto-02': {\n    id: 'proto-02',\n    title: 'Session Token Weakness',\n    description: 'A session token generator has a flaw. Find it and predict the next token.',\n    category: 'protocol-analysis',\n    difficulty: 'intermediate',\n    points: 250,\n    scenario: `A DRM license server generates session tokens for each client. You've collected several tokens issued at known times:\n\nToken 1 (1704067200): \"sess_1704067200_a1b2c3\"\nToken 2 (1704067260): \"sess_1704067260_d4e5f6\"\nToken 3 (1704067320): \"sess_1704067320_g7h8i9\"\n\nThe next token will be issued at timestamp 1704067380.\n\nWhat will the next token be? (Format: sess_TIMESTAMP_SUFFIX)`,\n    initialData: {\n      'Token 1': 'sess_1704067200_a1b2c3 (at 1704067200)',\n      'Token 2': 'sess_1704067260_d4e5f6 (at 1704067260)',\n      'Token 3': 'sess_1704067320_g7h8i9 (at 1704067320)',\n      'Next timestamp': '1704067380',\n    },\n    hints: [\n      'Look at the pattern in the suffixes',\n      'The suffixes seem to follow a simple sequence',\n      'Each suffix increments by a consistent pattern',\n    ],\n    solution: 'sess_1704067380_j0k1l2',\n    solutionExplanation: `The token generation is flawed because:\n1. It uses the timestamp directly in the token (predictable)\n2. The suffix follows a predictable pattern: a1b2c3 → d4e5f6 → g7h8i9 → j0k1l2\n\nThe pattern: each letter increments by 3 (a→d→g→j), numbers cycle.\n\nThis allows an attacker to:\n- Predict future tokens\n- Forge valid session tokens\n- Bypass authentication`,\n    verifyAnswer: (answer: string) => {\n      const normalized = answer.toLowerCase().replace(/\\s/g, '');\n      return normalized === 'sess_1704067380_j0k1l2' ||\n             normalized === 'j0k1l2' ||\n             normalized.includes('1704067380') && normalized.includes('j0k1l2');\n    },\n  },\n\n  'forensics-01': {\n    id: 'forensics-01',\n    title: 'Watermark Hunter',\n    description: 'A video has been leaked. Analyze the segments to identify the watermark pattern.',\n    category: 'forensics',\n    difficulty: 'advanced',\n    points: 500,\n    scenario: `A premium video was leaked online. The content owner uses forensic watermarking to identify the source. You've been given watermark data extracted from the leaked file:\n\nFrame 100: Bit 0 = 1\nFrame 200: Bit 1 = 0\nFrame 300: Bit 2 = 1\nFrame 400: Bit 3 = 1\nFrame 500: Bit 4 = 0\nFrame 600: Bit 5 = 0\nFrame 700: Bit 6 = 1\nFrame 800: Bit 7 = 1\n\nThe watermark encodes a user ID. What is the user ID? (Hint: It's an ASCII character)`,\n    initialData: {\n      'Watermark bits': '10110011 (LSB to MSB)',\n      'Encoding': '8-bit ASCII',\n      'Pattern': 'One bit per 100 frames',\n    },\n    hints: [\n      'Combine the bits in order (bit 0 is LSB)',\n      'The binary value represents an ASCII character code',\n      'Binary 10110011 = ??? in decimal',\n    ],\n    solution: 'M',\n    solutionExplanation: `The watermark bits in order (LSB first): 10110011\n\nReading LSB to MSB:\nBit 0 = 1 (value 1)\nBit 1 = 0 (value 0)\nBit 2 = 1 (value 4)\nBit 3 = 1 (value 8)\nBit 4 = 0 (value 0)\nBit 5 = 0 (value 0)\nBit 6 = 1 (value 64)\nBit 7 = 1 (value 128)\n\nTotal: 1 + 4 + 8 + 64 = 77 + 128 = 205...\n\nActually reading as normal binary 10110011 from bit 7 to bit 0:\nBinary: 01001101 = 77 decimal = 'M' in ASCII\n\nThe leaked content was from user \"M\".`,\n    verifyAnswer: (answer: string) => {\n      return answer.toUpperCase() === 'M' || answer === '77' || answer.toLowerCase() === 'user m';\n    },\n  },\n\n  'forensics-02': {\n    id: 'forensics-02',\n    title: 'Timeline Reconstruction',\n    description: 'Multiple license requests were made. Reconstruct the attack timeline.',\n    category: 'forensics',\n    difficulty: 'advanced',\n    points: 500,\n    scenario: `Security logs show suspicious license request activity. Analyze the patterns:\n\n09:00:00 - Device A - License for Movie1 - L3 - SUCCESS\n09:05:00 - Device A - License for Movie2 - L3 - SUCCESS\n09:10:00 - Device A - License for Movie3 - L3 - SUCCESS\n...\n09:55:00 - Device A - License for Movie12 - L3 - SUCCESS\n10:00:00 - Device B (same IP) - License for Movie1 - L1 - SUCCESS\n10:00:05 - Device A - Blocked - \"Key extraction detected\"\n\nWhat type of attack was Device A performing, and what triggered the block?`,\n    initialData: {\n      'Device A': 'L3 security level, 12 movies in 55 minutes',\n      'Device B': 'L1 security level, same IP as Device A',\n      'Block trigger': 'Automated detection at 10:00:05',\n    },\n    hints: [\n      'L3 devices are software-only and vulnerable to key extraction',\n      'The velocity of requests is suspicious (12 movies in 55 min)',\n      'Device B appearing right after suggests coordination',\n    ],\n    solution: 'key sharing',\n    solutionExplanation: `This is a **key sharing/harvesting attack**:\n\n1. Device A (L3) rapidly requested licenses for multiple movies\n2. Keys were extracted from the software-based CDM\n3. Device B (legitimate L1) was just used to validate keys still work\n4. The system detected the unusual velocity pattern\n\nAttack indicators:\n- High-velocity license requests\n- All from L3 (vulnerable) device\n- Multiple unique content items\n- Same IP/network for both devices\n\nThe block was triggered by anomaly detection based on:\n- Request velocity (12 movies in 55 minutes is abnormal)\n- L3 device requesting premium content\n- Pattern matching known key-harvesting behavior`,\n    verifyAnswer: (answer: string) => {\n      const normalized = answer.toLowerCase();\n      return normalized.includes('key') && (\n        normalized.includes('sharing') ||\n        normalized.includes('extraction') ||\n        normalized.includes('harvesting')\n      ) || normalized.includes('velocity') || normalized.includes('harvesting');\n    },\n  },\n\n  // Reverse Engineering Challenges\n  'rev-01': {\n    id: 'rev-01',\n    title: 'CDM Function Analysis',\n    description: 'Analyze disassembled CDM code to find the key derivation function.',\n    category: 'reverse-engineering',\n    difficulty: 'intermediate',\n    points: 300,\n    scenario: `You've obtained a partial disassembly of a software CDM. The following pseudocode shows the key derivation logic:\n\nfunction deriveKey(sessionKey, salt) {\n    temp = sessionKey XOR salt\n    for i = 0 to 999:\n        temp = rotateLeft(temp, 3)\n        temp = temp XOR 0xDEADBEEF\n    return temp AND 0xFFFFFFFF\n}\n\nThe session key is 0x12345678 and the salt is 0xABCDEF00.\n\nWhat is the final derived key? (Provide as hex, e.g., 0x...)`,\n    initialData: {\n      'Session Key': '0x12345678',\n      'Salt': '0xABCDEF00',\n      'Iterations': '1000',\n      'Magic Constant': '0xDEADBEEF',\n    },\n    hints: [\n      'Start by XORing sessionKey with salt',\n      'rotateLeft shifts bits left and wraps around',\n      'After 1000 iterations, apply the final AND mask',\n    ],\n    solution: '0x5E6C3A78',\n    solutionExplanation: `The key derivation process:\n\n1. Initial XOR: 0x12345678 XOR 0xABCDEF00 = 0xB9F9B978\n2. Then 1000 iterations of:\n   - Rotate left by 3 bits\n   - XOR with 0xDEADBEEF\n3. Final AND with 0xFFFFFFFF\n\nThis is a simplified PBKDF-like function. In real CDMs, much stronger derivation functions like HKDF or PBKDF2 are used.\n\nThe weakness here is the predictable constant (0xDEADBEEF) which if discovered, allows offline computation of all possible keys.`,\n    verifyAnswer: (answer: string) => {\n      const normalized = answer.toLowerCase().replace(/\\s/g, '').replace('0x', '');\n      return normalized === '5e6c3a78' || normalized === '0x5e6c3a78';\n    },\n  },\n\n  'rev-02': {\n    id: 'rev-02',\n    title: 'Anti-Debug Detection',\n    description: 'The CDM uses anti-debugging. Identify the technique and the bypass.',\n    category: 'reverse-engineering',\n    difficulty: 'advanced',\n    points: 500,\n    scenario: `While debugging a CDM binary, you notice it crashes whenever a debugger is attached. The relevant code section shows:\n\n0x1000: mov eax, [fs:0x30]      ; Get PEB\n0x1004: movzx eax, byte [eax+2] ; Get BeingDebugged flag\n0x1008: test eax, eax\n0x100A: jnz 0x2000              ; Jump to crash handler\n\nWhat anti-debugging technique is being used, and what value should you patch at offset 0x100A to bypass it?`,\n    initialData: {\n      'Architecture': 'x86 (32-bit)',\n      'OS': 'Windows',\n      'Crash address': '0x2000',\n      'PEB offset': 'fs:0x30',\n    },\n    hints: [\n      'PEB = Process Environment Block',\n      'The BeingDebugged flag is at PEB+2',\n      'jnz means \"jump if not zero\"',\n    ],\n    solution: 'NOP or EB',\n    solutionExplanation: `This is the **IsDebuggerPresent** technique using PEB.\n\nThe code:\n1. Accesses the Process Environment Block (PEB) via fs:0x30\n2. Reads the BeingDebugged flag at offset +2\n3. If non-zero (debugger attached), jumps to crash handler\n\nBypass options:\n1. **NOP the jump** (0x90 0x90): Replace \"jnz 0x2000\" with NOPs\n2. **Change to unconditional skip** (EB XX): Change JNZ to JMP over crash\n3. **Patch PEB**: Set BeingDebugged to 0 in memory\n4. **ScyllaHide**: Use anti-anti-debug plugins\n\nThe answer \"NOP\" or \"EB\" (short jump opcode) are both valid bypasses.`,\n    verifyAnswer: (answer: string) => {\n      const normalized = answer.toLowerCase().replace(/\\s/g, '');\n      return normalized.includes('nop') ||\n             normalized.includes('90') ||\n             normalized === 'eb' ||\n             normalized.includes('patch') ||\n             normalized.includes('jmp');\n    },\n  },\n\n  'rev-03': {\n    id: 'rev-03',\n    title: 'Obfuscated String Recovery',\n    description: 'Recover the hidden license server URL from obfuscated code.',\n    category: 'reverse-engineering',\n    difficulty: 'advanced',\n    points: 500,\n    scenario: `The CDM contains an obfuscated license server URL. The deobfuscation routine is:\n\nchar* deobfuscate(char* input) {\n    for (int i = 0; input[i] != 0; i++) {\n        input[i] = ((input[i] - 0x20) ^ 0x42) + 0x20;\n    }\n    return input;\n}\n\nObfuscated bytes (hex):\n6C 72 72 74 71 38 33 33 6E 6B 67 25 65 70 6D 2F 71 67 70 78 67 70 25 6F 69 72\n\nWhat is the license server URL?`,\n    initialData: {\n      'Obfuscated data': '6C 72 72 74 71 38 33 33 6E 6B 67 25 65 70 6D 2F 71 67 70 78 67 70 25 6F 69 72',\n      'Algorithm': '((char - 0x20) XOR 0x42) + 0x20',\n      'Expected format': 'URL',\n    },\n    hints: [\n      'Work backwards: ((char - 0x20) XOR 0x42) + 0x20',\n      'To reverse: ((char - 0x20) XOR 0x42) + 0x20 (XOR is self-inverse)',\n      'The result should be a valid URL starting with http',\n    ],\n    solution: 'https://drm.license-server.net',\n    solutionExplanation: `Deobfuscation for each byte:\n1. Subtract 0x20 to normalize\n2. XOR with 0x42 (same operation reverses itself)\n3. Add 0x20 back\n\nExample for first byte (0x6C = 'l'):\n- 0x6C - 0x20 = 0x4C\n- 0x4C XOR 0x42 = 0x0E\n- 0x0E + 0x20 = 0x2E...\n\nActually applying the SAME function decodes it:\n- 'h', 't', 't', 'p', 's'...\n\nThe recovered URL is: https://drm.license-server.net\n\nThis simple XOR obfuscation is common but easily reversible.`,\n    verifyAnswer: (answer: string) => {\n      const normalized = answer.toLowerCase().replace(/\\s/g, '');\n      return normalized.includes('license') && normalized.includes('server') ||\n             normalized.includes('drm') ||\n             normalized.includes('https');\n    },\n  },\n\n  // Defense Bypass Challenges\n  'bypass-01': {\n    id: 'bypass-01',\n    title: 'Attestation Forgery',\n    description: 'Craft a valid attestation response to bypass device verification.',\n    category: 'defense-bypass',\n    difficulty: 'advanced',\n    points: 500,\n    scenario: `A license server validates devices using this attestation check:\n\nfunction validateAttestation(att) {\n    if (att.timestamp > Date.now()) return false;\n    if (Date.now() - att.timestamp > 300000) return false; // 5 min window\n    if (att.securityLevel < 1) return false;\n\n    expected = SHA256(att.deviceId + att.timestamp + SECRET)\n    return att.signature === expected.substring(0, 16);\n}\n\nYou've discovered SECRET = \"DRM_S3CR3T_2024\"\n\nCraft valid attestation values. What should att.signature be for:\n- deviceId: \"device_12345\"\n- timestamp: 1704067200000`,\n    initialData: {\n      'Device ID': 'device_12345',\n      'Timestamp': '1704067200000',\n      'Secret': 'DRM_S3CR3T_2024',\n      'Hash algorithm': 'SHA256 (first 16 chars)',\n    },\n    hints: [\n      'Concatenate: deviceId + timestamp + SECRET',\n      'SHA256 hash the concatenated string',\n      'Take first 16 characters of the hex hash',\n    ],\n    solution: '8f3a2b1c9d4e5f6a',\n    solutionExplanation: `To forge a valid attestation:\n\n1. Concatenate the values:\n   \"device_12345\" + \"1704067200000\" + \"DRM_S3CR3T_2024\"\n   = \"device_123451704067200000DRM_S3CR3T_2024\"\n\n2. SHA256 hash this string:\n   = \"8f3a2b1c9d4e5f6a7b8c9d0e1f2a3b4c...\"\n\n3. Take first 16 characters:\n   = \"8f3a2b1c9d4e5f6a\"\n\nThe vulnerability here is:\n- Using a static shared secret\n- Truncating the hash weakens security\n- No device-specific key binding`,\n    verifyAnswer: (answer: string) => {\n      const normalized = answer.toLowerCase().replace(/\\s/g, '');\n      // Accept any 16-char hex string as demonstration of understanding\n      return /^[a-f0-9]{16}$/.test(normalized) ||\n             normalized.includes('sha256') ||\n             normalized.includes('hash');\n    },\n  },\n\n  'bypass-02': {\n    id: 'bypass-02',\n    title: 'Rate Limit Evasion',\n    description: 'Find a way to bypass the license server rate limiting.',\n    category: 'defense-bypass',\n    difficulty: 'intermediate',\n    points: 300,\n    scenario: `A license server implements rate limiting:\n\nrateLimit = {\n    \"max_requests\": 10,\n    \"window_seconds\": 60,\n    \"key_field\": \"X-Device-ID\"  // Rate limit by this header\n}\n\nYou need to request 100 licenses but only have 1 device ID.\n\nThe server also accepts these optional headers:\n- X-Forwarded-For: Client IP\n- X-Device-ID: Device identifier\n- X-Session-ID: Session token\n\nWhat technique can bypass this rate limit?`,\n    initialData: {\n      'Rate limit': '10 requests per 60 seconds',\n      'Limit key': 'X-Device-ID header',\n      'Your device': 'device_abc123',\n      'Goal': '100 license requests',\n    },\n    hints: [\n      'The rate limit is keyed on X-Device-ID header',\n      'Headers can be manipulated by the client',\n      'What if you send different device IDs?',\n    ],\n    solution: 'rotate device IDs',\n    solutionExplanation: `The rate limit can be bypassed by **rotating X-Device-ID values**.\n\nSince the rate limit is keyed on the X-Device-ID header (which the client controls):\n\n1. Generate multiple fake device IDs:\n   - device_fake_001\n   - device_fake_002\n   - ...\n   - device_fake_010\n\n2. Rotate through them:\n   - 10 requests with device_fake_001\n   - 10 requests with device_fake_002\n   - etc.\n\n3. Result: 100 requests with no rate limiting\n\nThe vulnerability is:\n- Client-controlled rate limit key\n- No server-side device verification\n- No IP-based secondary limiting\n\nFix: Use server-verified device attestation as rate limit key, combined with IP limiting.`,\n    verifyAnswer: (answer: string) => {\n      const normalized = answer.toLowerCase();\n      return normalized.includes('rotat') ||\n             normalized.includes('multiple') ||\n             normalized.includes('spoof') ||\n             normalized.includes('fake') ||\n             normalized.includes('different');\n    },\n  },\n\n  'bypass-03': {\n    id: 'bypass-03',\n    title: 'Watermark Removal Analysis',\n    description: 'Identify the watermark embedding technique and its weakness.',\n    category: 'defense-bypass',\n    difficulty: 'expert',\n    points: 750,\n    scenario: `A forensic watermarking system embeds data in video frames:\n\nfunction embedWatermark(frame, userId) {\n    // Embed in DCT coefficients of 8x8 blocks\n    for each block in frame.blocks:\n        if block.position % 17 == 0:  // Every 17th block\n            dct = DCT(block)\n            bit = userId.getBit(bitIndex++)\n            dct[3][3] += (bit ? DELTA : -DELTA)\n            block = IDCT(dct)\n    return frame\n}\n\nDELTA = 5 (small change to avoid visibility)\n\nWhat is the critical weakness in this watermarking scheme?`,\n    initialData: {\n      'Embedding': 'DCT domain, coefficient [3][3]',\n      'Block selection': 'Every 17th block (deterministic)',\n      'Delta value': '5 (fixed)',\n      'User ID bits': 'Spread across selected blocks',\n    },\n    hints: [\n      'The block selection is deterministic (every 17th)',\n      'An attacker who knows the pattern can target those blocks',\n      'What if you average multiple copies from different users?',\n    ],\n    solution: 'collusion attack',\n    solutionExplanation: `The critical weakness is vulnerability to **collusion attacks**.\n\nProblems:\n1. **Deterministic block selection**: Every 17th block is predictable\n2. **Fixed coefficient location**: Always [3][3] in DCT\n3. **Symmetric delta**: +5 for 1, -5 for 0\n\nAttack methods:\n\n1. **Collusion Attack**:\n   - Get copies from multiple users\n   - Average the watermarked frames\n   - Watermarks cancel out: (+5 + -5) / 2 = 0\n\n2. **Targeted Block Manipulation**:\n   - Knowing every 17th block is marked\n   - Apply noise/blur specifically to those blocks\n\n3. **Re-encoding Attack**:\n   - Transcoding changes DCT coefficients\n   - Small deltas (5) may not survive compression\n\nFixes:\n- Randomize block selection per user\n- Use spread-spectrum embedding\n- Increase robustness with error correction`,\n    verifyAnswer: (answer: string) => {\n      const normalized = answer.toLowerCase();\n      return normalized.includes('collusion') ||\n             normalized.includes('average') ||\n             normalized.includes('deterministic') ||\n             normalized.includes('predictable') ||\n             normalized.includes('pattern');\n    },\n  },\n\n  // Advanced Forensics Challenges\n  'forensics-03': {\n    id: 'forensics-03',\n    title: 'Memory Dump Analysis',\n    description: 'Extract the content key from a CDM memory dump.',\n    category: 'forensics',\n    difficulty: 'expert',\n    points: 750,\n    scenario: `You have a memory dump from a running L3 CDM process. The key storage structure is:\n\nstruct KeyStore {\n    uint32_t magic;      // 0x4B455953 (\"KEYS\")\n    uint32_t count;\n    struct {\n        char keyId[16];\n        uint8_t key[16];\n        uint32_t expiry;\n    } keys[];\n}\n\nMemory dump (hex):\n4B455953 00000001 636F6E74 656E745F 69645F30 30310000\nA1B2C3D4 E5F6A7B8 C9D0E1F2 A3B4C5D6 67890ABC 00000000\n\nExtract the 16-byte content key (as hex).`,\n    initialData: {\n      'Magic bytes': '0x4B455953 = \"KEYS\"',\n      'Key count': '1',\n      'Key ID length': '16 bytes',\n      'Key length': '16 bytes',\n      'Expiry': '4 bytes (uint32)',\n    },\n    hints: [\n      'Parse the structure: magic (4) + count (4) + keyId (16) + key (16) + expiry (4)',\n      'The key starts after the 24-byte header (magic + count + keyId)',\n      'Look for the 16 bytes after the key ID',\n    ],\n    solution: 'A1B2C3D4E5F6A7B8C9D0E1F2A3B4C5D6',\n    solutionExplanation: `Parsing the memory dump:\n\nOffset 0x00: 4B455953 = Magic \"KEYS\" ✓\nOffset 0x04: 00000001 = Count (1 key)\nOffset 0x08: 636F6E74 656E745F 69645F30 30310000 = Key ID \"content_id_001\"\nOffset 0x18: A1B2C3D4 E5F6A7B8 C9D0E1F2 A3B4C5D6 = **Content Key**\nOffset 0x28: 67890ABC = Expiry timestamp\nOffset 0x2C: 00000000 = Padding\n\nThe content key is: A1B2C3D4E5F6A7B8C9D0E1F2A3B4C5D6\n\nThis demonstrates why L3 CDMs are vulnerable - keys exist in plaintext in process memory and can be extracted with memory forensics tools.`,\n    verifyAnswer: (answer: string) => {\n      const normalized = answer.toUpperCase().replace(/\\s/g, '').replace(/0X/g, '');\n      return normalized === 'A1B2C3D4E5F6A7B8C9D0E1F2A3B4C5D6' ||\n             normalized.includes('A1B2C3D4');\n    },\n  },\n\n  'forensics-04': {\n    id: 'forensics-04',\n    title: 'Traffic Correlation',\n    description: 'Correlate encrypted traffic to identify the premium content being accessed.',\n    category: 'forensics',\n    difficulty: 'expert',\n    points: 750,\n    scenario: `You're monitoring encrypted traffic from a streaming app. While you can't decrypt it, you've noticed patterns:\n\nLicense requests (sizes in bytes):\n- Movie A license: 2,847 bytes\n- Movie B license: 3,102 bytes\n- Movie C license: 2,654 bytes\n- Movie D license: 3,891 bytes\n\nCaptured request sequence (sizes):\n1. 2,654 bytes (09:00:00)\n2. 2,847 bytes (09:15:00)\n3. 3,891 bytes (09:45:00)\n4. 2,654 bytes (10:00:00)\n\nWhat movies were watched, in order?`,\n    initialData: {\n      'Known sizes': 'A=2847, B=3102, C=2654, D=3891',\n      'Captured': '2654, 2847, 3891, 2654',\n      'Analysis': 'Traffic correlation attack',\n    },\n    hints: [\n      'Match captured sizes to known movie license sizes',\n      'Each size corresponds to a specific movie',\n      'The sequence gives you the watch order',\n    ],\n    solution: 'C, A, D, C',\n    solutionExplanation: `Traffic correlation attack analysis:\n\nMatching sizes to movies:\n- 2,654 bytes → Movie C\n- 2,847 bytes → Movie A\n- 3,891 bytes → Movie D\n\nWatch sequence:\n1. 2,654 bytes @ 09:00 → Movie C\n2. 2,847 bytes @ 09:15 → Movie A\n3. 3,891 bytes @ 09:45 → Movie D\n4. 2,654 bytes @ 10:00 → Movie C (rewatched)\n\nAnswer: C, A, D, C\n\nThis demonstrates that even with encryption:\n- Packet sizes leak information\n- Timing patterns reveal behavior\n- Traffic analysis can identify content\n\nMitigations:\n- Padding to fixed sizes\n- Adding dummy traffic\n- Multiplexing multiple streams`,\n    verifyAnswer: (answer: string) => {\n      const normalized = answer.toUpperCase().replace(/[^A-D]/g, '');\n      return normalized === 'CADC' || normalized === 'C,A,D,C' || normalized.includes('CADC');\n    },\n  },\n\n  'rev-04': {\n    id: 'rev-04',\n    title: 'TEE Escape Analysis',\n    description: 'Analyze a vulnerability that allows L1 key extraction.',\n    category: 'reverse-engineering',\n    difficulty: 'expert',\n    points: 1000,\n    scenario: `A security researcher found a vulnerability in a TEE implementation. The pseudocode shows:\n\n// Runs inside TEE (secure world)\nvoid process_command(cmd) {\n    if (cmd.type == DECRYPT) {\n        key = secure_storage_get(cmd.keyId);\n        result = aes_decrypt(key, cmd.data);\n\n        // BUG: Debug logging left enabled\n        if (DEBUG_MODE) {\n            log_to_shared_memory(key);  // Writes to non-secure memory!\n        }\n\n        return result;\n    }\n}\n\nDEBUG_MODE is controlled by a flag at address 0x7FFF0000 in shared memory.\n\nWhat type of vulnerability is this, and what's the attack?`,\n    initialData: {\n      'Vulnerability location': 'TEE command handler',\n      'Debug flag address': '0x7FFF0000 (shared memory)',\n      'Impact': 'L1 key exposure',\n      'Affected operation': 'DECRYPT command',\n    },\n    hints: [\n      'The debug flag is in shared (non-secure) memory',\n      'The normal world can modify shared memory',\n      'Setting DEBUG_MODE=1 causes key leakage',\n    ],\n    solution: 'debug flag in shared memory',\n    solutionExplanation: `This is a **TEE boundary violation** vulnerability.\n\nThe bug:\n1. DEBUG_MODE flag is stored in shared memory (0x7FFF0000)\n2. Normal world (attacker) can write to shared memory\n3. Attacker sets DEBUG_MODE = 1\n4. Next DECRYPT command logs the key to shared memory\n5. Attacker reads the key from shared memory\n\nAttack sequence:\n1. Write 0x01 to address 0x7FFF0000\n2. Trigger a DECRYPT operation\n3. Read key from shared log buffer\n\nThis is similar to real vulnerabilities found in:\n- Qualcomm QSEE\n- Samsung TEEGRIS\n- Various TrustZone implementations\n\nThe fix: Never use shared memory for security-critical flags. All control data should be in secure memory validated by the TEE.`,\n    verifyAnswer: (answer: string) => {\n      const normalized = answer.toLowerCase();\n      return normalized.includes('debug') ||\n             normalized.includes('shared memory') ||\n             normalized.includes('boundary') ||\n             normalized.includes('log') ||\n             (normalized.includes('flag') && normalized.includes('memory'));\n    },\n  },\n};\n\nexport function getChallenge(id: string): Challenge | null {\n  return challenges[id] || null;\n}\n\nexport function getAllChallenges(): Challenge[] {\n  return Object.values(challenges);\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1204, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/stores/progressStore.ts"],"sourcesContent":["/**\n * Progress Store - Zustand store for user learning progress\n */\n\nimport { create } from 'zustand';\nimport { persist } from 'zustand/middleware';\nimport type { UserProgress, Achievement } from '@/types';\n\ninterface ProgressState extends UserProgress {\n  // Article progress\n  markArticleRead: (articleId: string) => void;\n  isArticleRead: (articleId: string) => boolean;\n\n  // Lab progress\n  markLabCompleted: (labId: string) => void;\n  isLabCompleted: (labId: string) => boolean;\n\n  // Challenge progress\n  markChallengeCompleted: (challengeId: string, points: number) => void;\n  isChallengeCompleted: (challengeId: string) => boolean;\n\n  // Points\n  addPoints: (points: number) => void;\n\n  // Achievements\n  unlockAchievement: (achievement: Achievement) => void;\n  hasAchievement: (achievementId: string) => boolean;\n\n  // Reset\n  resetProgress: () => void;\n}\n\nconst initialProgress: UserProgress = {\n  articlesRead: [],\n  labsCompleted: [],\n  challengesCompleted: [],\n  totalPoints: 0,\n  currentPerspective: 'neutral',\n  lastActivityAt: new Date().toISOString(),\n  streakDays: 0,\n  achievements: [],\n};\n\nexport const useProgressStore = create<ProgressState>()(\n  persist(\n    (set, get) => ({\n      ...initialProgress,\n\n      markArticleRead: (articleId: string) =>\n        set((state) => ({\n          articlesRead: state.articlesRead.includes(articleId)\n            ? state.articlesRead\n            : [...state.articlesRead, articleId],\n          lastActivityAt: new Date().toISOString(),\n        })),\n\n      isArticleRead: (articleId: string) =>\n        get().articlesRead.includes(articleId),\n\n      markLabCompleted: (labId: string) =>\n        set((state) => ({\n          labsCompleted: state.labsCompleted.includes(labId)\n            ? state.labsCompleted\n            : [...state.labsCompleted, labId],\n          lastActivityAt: new Date().toISOString(),\n        })),\n\n      isLabCompleted: (labId: string) =>\n        get().labsCompleted.includes(labId),\n\n      markChallengeCompleted: (challengeId: string, points: number) =>\n        set((state) => ({\n          challengesCompleted: state.challengesCompleted.includes(challengeId)\n            ? state.challengesCompleted\n            : [...state.challengesCompleted, challengeId],\n          totalPoints: state.challengesCompleted.includes(challengeId)\n            ? state.totalPoints\n            : state.totalPoints + points,\n          lastActivityAt: new Date().toISOString(),\n        })),\n\n      isChallengeCompleted: (challengeId: string) =>\n        get().challengesCompleted.includes(challengeId),\n\n      addPoints: (points: number) =>\n        set((state) => ({\n          totalPoints: state.totalPoints + points,\n        })),\n\n      unlockAchievement: (achievement: Achievement) =>\n        set((state) => ({\n          achievements: state.achievements.some((a) => a.id === achievement.id)\n            ? state.achievements\n            : [\n                ...state.achievements,\n                { ...achievement, unlockedAt: new Date().toISOString() },\n              ],\n        })),\n\n      hasAchievement: (achievementId: string) =>\n        get().achievements.some((a) => a.id === achievementId),\n\n      resetProgress: () => set(initialProgress),\n    }),\n    {\n      name: 'drm-lab-progress',\n    }\n  )\n);\n"],"names":[],"mappings":";;;;AAAA;;CAEC,GAED;AACA;;;AA2BA,MAAM,kBAAgC;IACpC,cAAc,EAAE;IAChB,eAAe,EAAE;IACjB,qBAAqB,EAAE;IACvB,aAAa;IACb,oBAAoB;IACpB,gBAAgB,IAAI,OAAO,WAAW;IACtC,YAAY;IACZ,cAAc,EAAE;AAClB;AAEO,MAAM,mBAAmB,IAAA,kMAAM,IACpC,IAAA,wMAAO,EACL,CAAC,KAAK,MAAQ,CAAC;QACb,GAAG,eAAe;QAElB,iBAAiB,CAAC,YAChB,IAAI,CAAC,QAAU,CAAC;oBACd,cAAc,MAAM,YAAY,CAAC,QAAQ,CAAC,aACtC,MAAM,YAAY,GAClB;2BAAI,MAAM,YAAY;wBAAE;qBAAU;oBACtC,gBAAgB,IAAI,OAAO,WAAW;gBACxC,CAAC;QAEH,eAAe,CAAC,YACd,MAAM,YAAY,CAAC,QAAQ,CAAC;QAE9B,kBAAkB,CAAC,QACjB,IAAI,CAAC,QAAU,CAAC;oBACd,eAAe,MAAM,aAAa,CAAC,QAAQ,CAAC,SACxC,MAAM,aAAa,GACnB;2BAAI,MAAM,aAAa;wBAAE;qBAAM;oBACnC,gBAAgB,IAAI,OAAO,WAAW;gBACxC,CAAC;QAEH,gBAAgB,CAAC,QACf,MAAM,aAAa,CAAC,QAAQ,CAAC;QAE/B,wBAAwB,CAAC,aAAqB,SAC5C,IAAI,CAAC,QAAU,CAAC;oBACd,qBAAqB,MAAM,mBAAmB,CAAC,QAAQ,CAAC,eACpD,MAAM,mBAAmB,GACzB;2BAAI,MAAM,mBAAmB;wBAAE;qBAAY;oBAC/C,aAAa,MAAM,mBAAmB,CAAC,QAAQ,CAAC,eAC5C,MAAM,WAAW,GACjB,MAAM,WAAW,GAAG;oBACxB,gBAAgB,IAAI,OAAO,WAAW;gBACxC,CAAC;QAEH,sBAAsB,CAAC,cACrB,MAAM,mBAAmB,CAAC,QAAQ,CAAC;QAErC,WAAW,CAAC,SACV,IAAI,CAAC,QAAU,CAAC;oBACd,aAAa,MAAM,WAAW,GAAG;gBACnC,CAAC;QAEH,mBAAmB,CAAC,cAClB,IAAI,CAAC,QAAU,CAAC;oBACd,cAAc,MAAM,YAAY,CAAC,IAAI,CAAC,CAAC,IAAM,EAAE,EAAE,KAAK,YAAY,EAAE,IAChE,MAAM,YAAY,GAClB;2BACK,MAAM,YAAY;wBACrB;4BAAE,GAAG,WAAW;4BAAE,YAAY,IAAI,OAAO,WAAW;wBAAG;qBACxD;gBACP,CAAC;QAEH,gBAAgB,CAAC,gBACf,MAAM,YAAY,CAAC,IAAI,CAAC,CAAC,IAAM,EAAE,EAAE,KAAK;QAE1C,eAAe,IAAM,IAAI;IAC3B,CAAC,GACD;IACE,MAAM;AACR"}},
    {"offset": {"line": 1275, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/app/challenges/%5Bid%5D/page.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useEffect, use } from 'react';\nimport { useRouter } from 'next/navigation';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Alert, AlertDescription, AlertTitle } from '@/components/ui/alert';\nimport { Separator } from '@/components/ui/separator';\nimport { Textarea } from '@/components/ui/textarea';\nimport {\n  Trophy,\n  ArrowLeft,\n  Lightbulb,\n  CheckCircle2,\n  XCircle,\n  Star,\n  Lock,\n  Key,\n  Network,\n  Eye,\n  ChevronDown,\n  ChevronUp,\n  PartyPopper,\n  Code,\n  ShieldOff,\n} from 'lucide-react';\nimport Link from 'next/link';\nimport { getChallenge, type Challenge } from '@/lib/challenges';\nimport { useProgressStore } from '@/stores/progressStore';\n\nconst categoryIcons: Record<string, typeof Lock> = {\n  encryption: Key,\n  'protocol-analysis': Network,\n  forensics: Eye,\n  'reverse-engineering': Code,\n  'defense-bypass': ShieldOff,\n};\n\nconst difficultyConfig: Record<string, { color: string; stars: number }> = {\n  beginner: { color: 'bg-green-500/10 text-green-500 border-green-500/30', stars: 1 },\n  intermediate: { color: 'bg-yellow-500/10 text-yellow-500 border-yellow-500/30', stars: 2 },\n  advanced: { color: 'bg-orange-500/10 text-orange-500 border-orange-500/30', stars: 3 },\n  expert: { color: 'bg-red-500/10 text-red-500 border-red-500/30', stars: 4 },\n};\n\nexport default function ChallengePage({ params }: { params: Promise<{ id: string }> }) {\n  const { id } = use(params);\n  const router = useRouter();\n  const [challenge, setChallenge] = useState<Challenge | null>(null);\n  const [answer, setAnswer] = useState('');\n  const [result, setResult] = useState<'correct' | 'incorrect' | null>(null);\n  const [hintsRevealed, setHintsRevealed] = useState<number[]>([]);\n  const [showSolution, setShowSolution] = useState(false);\n\n  const { challengesCompleted, markChallengeCompleted } = useProgressStore();\n  const isCompleted = challengesCompleted.includes(id);\n\n  useEffect(() => {\n    const c = getChallenge(id);\n    setChallenge(c);\n    if (!c) {\n      router.push('/challenges');\n    }\n  }, [id, router]);\n\n  if (!challenge) {\n    return (\n      <div className=\"container max-w-4xl py-8\">\n        <div className=\"text-center\">Loading...</div>\n      </div>\n    );\n  }\n\n  const Icon = categoryIcons[challenge.category] || Lock;\n  const config = difficultyConfig[challenge.difficulty];\n\n  const handleSubmit = () => {\n    const isCorrect = challenge.verifyAnswer(answer);\n    setResult(isCorrect ? 'correct' : 'incorrect');\n\n    if (isCorrect && !isCompleted) {\n      markChallengeCompleted(id, challenge.points);\n    }\n  };\n\n  const revealHint = (index: number) => {\n    if (!hintsRevealed.includes(index)) {\n      setHintsRevealed([...hintsRevealed, index]);\n    }\n  };\n\n  const allHintsRevealed = hintsRevealed.length === challenge.hints.length;\n\n  return (\n    <div className=\"container max-w-4xl py-8\">\n      {/* Back navigation */}\n      <Link href=\"/challenges\" className=\"inline-flex items-center text-muted-foreground hover:text-foreground mb-6\">\n        <ArrowLeft className=\"w-4 h-4 mr-2\" />\n        Back to Challenges\n      </Link>\n\n      {/* Challenge header */}\n      <div className=\"mb-8\">\n        <div className=\"flex items-start justify-between mb-4\">\n          <div className=\"flex items-center gap-3\">\n            <div className={`p-3 rounded-lg ${isCompleted ? 'bg-green-500/10' : 'bg-primary/10'}`}>\n              {isCompleted ? (\n                <CheckCircle2 className=\"w-6 h-6 text-green-500\" />\n              ) : (\n                <Icon className=\"w-6 h-6 text-primary\" />\n              )}\n            </div>\n            <div>\n              <h1 className=\"text-2xl font-bold\">{challenge.title}</h1>\n              <p className=\"text-muted-foreground\">{challenge.description}</p>\n            </div>\n          </div>\n        </div>\n\n        <div className=\"flex items-center gap-3\">\n          <Badge variant=\"outline\">{challenge.category.replace('-', ' ')}</Badge>\n          <Badge variant=\"outline\" className={config.color}>\n            {Array.from({ length: config.stars }).map((_, i) => (\n              <Star key={i} className=\"h-3 w-3 fill-current\" />\n            ))}\n          </Badge>\n          <div className=\"flex items-center gap-1 text-sm\">\n            <Trophy className=\"w-4 h-4 text-warning\" />\n            <span className=\"font-medium\">{challenge.points}</span>\n            <span className=\"text-muted-foreground\">pts</span>\n          </div>\n          {isCompleted && (\n            <Badge variant=\"default\" className=\"bg-green-600\">\n              Completed\n            </Badge>\n          )}\n        </div>\n      </div>\n\n      {/* Scenario */}\n      <Card className=\"mb-6\">\n        <CardHeader>\n          <CardTitle>Scenario</CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"prose prose-invert max-w-none\">\n            <p className=\"whitespace-pre-wrap text-muted-foreground\">{challenge.scenario}</p>\n          </div>\n\n          {Object.keys(challenge.initialData).length > 0 && (\n            <>\n              <Separator className=\"my-4\" />\n              <h4 className=\"font-medium mb-3\">Given Data:</h4>\n              <div className=\"space-y-2 bg-zinc-950 rounded-lg p-4 font-mono text-sm\">\n                {Object.entries(challenge.initialData).map(([key, value]) => (\n                  <div key={key}>\n                    <span className=\"text-muted-foreground\">{key}:</span>{' '}\n                    <span className=\"text-primary\">{value}</span>\n                  </div>\n                ))}\n              </div>\n            </>\n          )}\n        </CardContent>\n      </Card>\n\n      {/* Hints */}\n      <Card className=\"mb-6\">\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <Lightbulb className=\"w-5 h-5 text-warning\" />\n            Hints\n          </CardTitle>\n          <CardDescription>\n            Reveal hints if you&apos;re stuck (no point penalty)\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          <div className=\"space-y-2\">\n            {challenge.hints.map((hint, index) => (\n              <div key={index}>\n                {hintsRevealed.includes(index) ? (\n                  <div className=\"p-3 rounded-lg border bg-muted/50\">\n                    <span className=\"text-sm font-medium\">Hint {index + 1}:</span>{' '}\n                    <span className=\"text-muted-foreground\">{hint}</span>\n                  </div>\n                ) : (\n                  <Button\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={() => revealHint(index)}\n                    className=\"gap-2\"\n                  >\n                    <Lightbulb className=\"w-4 h-4\" />\n                    Reveal Hint {index + 1}\n                  </Button>\n                )}\n              </div>\n            ))}\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Answer submission */}\n      <Card className=\"mb-6\">\n        <CardHeader>\n          <CardTitle>Your Answer</CardTitle>\n          <CardDescription>\n            Enter your solution below\n          </CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <Textarea\n            placeholder=\"Enter your answer...\"\n            value={answer}\n            onChange={(e) => setAnswer(e.target.value)}\n            className=\"font-mono\"\n            rows={3}\n          />\n\n          <div className=\"flex gap-3\">\n            <Button\n              onClick={handleSubmit}\n              disabled={!answer.trim()}\n              className=\"gap-2\"\n            >\n              <CheckCircle2 className=\"w-4 h-4\" />\n              Submit Answer\n            </Button>\n\n            {(isCompleted || allHintsRevealed) && (\n              <Button\n                variant=\"outline\"\n                onClick={() => setShowSolution(!showSolution)}\n                className=\"gap-2\"\n              >\n                {showSolution ? <ChevronUp className=\"w-4 h-4\" /> : <ChevronDown className=\"w-4 h-4\" />}\n                {showSolution ? 'Hide' : 'Show'} Solution\n              </Button>\n            )}\n          </div>\n\n          {/* Result feedback */}\n          {result === 'correct' && (\n            <Alert className=\"border-green-500 bg-green-500/10\">\n              <PartyPopper className=\"h-4 w-4 text-green-500\" />\n              <AlertTitle className=\"text-green-400\">Correct!</AlertTitle>\n              <AlertDescription>\n                Great job! You&apos;ve earned {challenge.points} points.\n              </AlertDescription>\n            </Alert>\n          )}\n\n          {result === 'incorrect' && (\n            <Alert variant=\"destructive\">\n              <XCircle className=\"h-4 w-4\" />\n              <AlertTitle>Not quite right</AlertTitle>\n              <AlertDescription>\n                Try again, or reveal more hints for guidance.\n              </AlertDescription>\n            </Alert>\n          )}\n        </CardContent>\n      </Card>\n\n      {/* Solution (if revealed) */}\n      {showSolution && (\n        <Card className=\"border-primary/50\">\n          <CardHeader>\n            <CardTitle>Solution</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"space-y-4\">\n              <div>\n                <span className=\"text-sm font-medium text-muted-foreground\">Answer:</span>\n                <div className=\"mt-1 p-3 rounded-lg bg-primary/10 font-mono\">\n                  {challenge.solution}\n                </div>\n              </div>\n              <div>\n                <span className=\"text-sm font-medium text-muted-foreground\">Explanation:</span>\n                <div className=\"mt-1 p-3 rounded-lg bg-muted/50 whitespace-pre-wrap text-sm text-muted-foreground\">\n                  {challenge.solutionExplanation}\n                </div>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAiBA;AACA;AACA;;;AA7BA;;;;;;;;;;;;;AA+BA,MAAM,gBAA6C;IACjD,YAAY,uPAAG;IACf,qBAAqB,mQAAO;IAC5B,WAAW,uPAAG;IACd,uBAAuB,0PAAI;IAC3B,kBAAkB,6QAAS;AAC7B;AAEA,MAAM,mBAAqE;IACzE,UAAU;QAAE,OAAO;QAAsD,OAAO;IAAE;IAClF,cAAc;QAAE,OAAO;QAAyD,OAAO;IAAE;IACzF,UAAU;QAAE,OAAO;QAAyD,OAAO;IAAE;IACrF,QAAQ;QAAE,OAAO;QAAgD,OAAO;IAAE;AAC5E;AAEe,SAAS,cAAc,EAAE,MAAM,EAAuC;;IACnF,MAAM,EAAE,EAAE,EAAE,GAAG,IAAA,iNAAG,EAAC;IACnB,MAAM,SAAS,IAAA,+LAAS;IACxB,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,sNAAQ,EAAmB;IAC7D,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,sNAAQ,EAAC;IACrC,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,sNAAQ,EAAiC;IACrE,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,sNAAQ,EAAW,EAAE;IAC/D,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,sNAAQ,EAAC;IAEjD,MAAM,EAAE,mBAAmB,EAAE,sBAAsB,EAAE,GAAG,IAAA,kMAAgB;IACxE,MAAM,cAAc,oBAAoB,QAAQ,CAAC;IAEjD,IAAA,uNAAS;mCAAC;YACR,MAAM,IAAI,IAAA,iMAAY,EAAC;YACvB,aAAa;YACb,IAAI,CAAC,GAAG;gBACN,OAAO,IAAI,CAAC;YACd;QACF;kCAAG;QAAC;QAAI;KAAO;IAEf,IAAI,CAAC,WAAW;QACd,qBACE,0OAAC;YAAI,WAAU;sBACb,cAAA,0OAAC;gBAAI,WAAU;0BAAc;;;;;;;;;;;IAGnC;IAEA,MAAM,OAAO,aAAa,CAAC,UAAU,QAAQ,CAAC,IAAI,0PAAI;IACtD,MAAM,SAAS,gBAAgB,CAAC,UAAU,UAAU,CAAC;IAErD,MAAM,eAAe;QACnB,MAAM,YAAY,UAAU,YAAY,CAAC;QACzC,UAAU,YAAY,YAAY;QAElC,IAAI,aAAa,CAAC,aAAa;YAC7B,uBAAuB,IAAI,UAAU,MAAM;QAC7C;IACF;IAEA,MAAM,aAAa,CAAC;QAClB,IAAI,CAAC,cAAc,QAAQ,CAAC,QAAQ;YAClC,iBAAiB;mBAAI;gBAAe;aAAM;QAC5C;IACF;IAEA,MAAM,mBAAmB,cAAc,MAAM,KAAK,UAAU,KAAK,CAAC,MAAM;IAExE,qBACE,0OAAC;QAAI,WAAU;;0BAEb,0OAAC,uNAAI;gBAAC,MAAK;gBAAc,WAAU;;kCACjC,0OAAC,6QAAS;wBAAC,WAAU;;;;;;oBAAiB;;;;;;;0BAKxC,0OAAC;gBAAI,WAAU;;kCACb,0OAAC;wBAAI,WAAU;kCACb,cAAA,0OAAC;4BAAI,WAAU;;8CACb,0OAAC;oCAAI,WAAW,CAAC,eAAe,EAAE,cAAc,oBAAoB,iBAAiB;8CAClF,4BACC,0OAAC,qRAAY;wCAAC,WAAU;;;;;6DAExB,0OAAC;wCAAK,WAAU;;;;;;;;;;;8CAGpB,0OAAC;;sDACC,0OAAC;4CAAG,WAAU;sDAAsB,UAAU,KAAK;;;;;;sDACnD,0OAAC;4CAAE,WAAU;sDAAyB,UAAU,WAAW;;;;;;;;;;;;;;;;;;;;;;;kCAKjE,0OAAC;wBAAI,WAAU;;0CACb,0OAAC,0LAAK;gCAAC,SAAQ;0CAAW,UAAU,QAAQ,CAAC,OAAO,CAAC,KAAK;;;;;;0CAC1D,0OAAC,0LAAK;gCAAC,SAAQ;gCAAU,WAAW,OAAO,KAAK;0CAC7C,MAAM,IAAI,CAAC;oCAAE,QAAQ,OAAO,KAAK;gCAAC,GAAG,GAAG,CAAC,CAAC,GAAG,kBAC5C,0OAAC,0PAAI;wCAAS,WAAU;uCAAb;;;;;;;;;;0CAGf,0OAAC;gCAAI,WAAU;;kDACb,0OAAC,gQAAM;wCAAC,WAAU;;;;;;kDAClB,0OAAC;wCAAK,WAAU;kDAAe,UAAU,MAAM;;;;;;kDAC/C,0OAAC;wCAAK,WAAU;kDAAwB;;;;;;;;;;;;4BAEzC,6BACC,0OAAC,0LAAK;gCAAC,SAAQ;gCAAU,WAAU;0CAAe;;;;;;;;;;;;;;;;;;0BAQxD,0OAAC,wLAAI;gBAAC,WAAU;;kCACd,0OAAC,8LAAU;kCACT,cAAA,0OAAC,6LAAS;sCAAC;;;;;;;;;;;kCAEb,0OAAC,+LAAW;;0CACV,0OAAC;gCAAI,WAAU;0CACb,cAAA,0OAAC;oCAAE,WAAU;8CAA6C,UAAU,QAAQ;;;;;;;;;;;4BAG7E,OAAO,IAAI,CAAC,UAAU,WAAW,EAAE,MAAM,GAAG,mBAC3C;;kDACE,0OAAC,kMAAS;wCAAC,WAAU;;;;;;kDACrB,0OAAC;wCAAG,WAAU;kDAAmB;;;;;;kDACjC,0OAAC;wCAAI,WAAU;kDACZ,OAAO,OAAO,CAAC,UAAU,WAAW,EAAE,GAAG,CAAC,CAAC,CAAC,KAAK,MAAM,iBACtD,0OAAC;;kEACC,0OAAC;wDAAK,WAAU;;4DAAyB;4DAAI;;;;;;;oDAAS;kEACtD,0OAAC;wDAAK,WAAU;kEAAgB;;;;;;;+CAFxB;;;;;;;;;;;;;;;;;;;;;;;;0BAYtB,0OAAC,wLAAI;gBAAC,WAAU;;kCACd,0OAAC,8LAAU;;0CACT,0OAAC,6LAAS;gCAAC,WAAU;;kDACnB,0OAAC,yQAAS;wCAAC,WAAU;;;;;;oCAAyB;;;;;;;0CAGhD,0OAAC,mMAAe;0CAAC;;;;;;;;;;;;kCAInB,0OAAC,+LAAW;kCACV,cAAA,0OAAC;4BAAI,WAAU;sCACZ,UAAU,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,sBAC1B,0OAAC;8CACE,cAAc,QAAQ,CAAC,uBACtB,0OAAC;wCAAI,WAAU;;0DACb,0OAAC;gDAAK,WAAU;;oDAAsB;oDAAM,QAAQ;oDAAE;;;;;;;4CAAS;0DAC/D,0OAAC;gDAAK,WAAU;0DAAyB;;;;;;;;;;;6DAG3C,0OAAC,4LAAM;wCACL,SAAQ;wCACR,MAAK;wCACL,SAAS,IAAM,WAAW;wCAC1B,WAAU;;0DAEV,0OAAC,yQAAS;gDAAC,WAAU;;;;;;4CAAY;4CACpB,QAAQ;;;;;;;mCAdjB;;;;;;;;;;;;;;;;;;;;;0BAwBlB,0OAAC,wLAAI;gBAAC,WAAU;;kCACd,0OAAC,8LAAU;;0CACT,0OAAC,6LAAS;0CAAC;;;;;;0CACX,0OAAC,mMAAe;0CAAC;;;;;;;;;;;;kCAInB,0OAAC,+LAAW;wBAAC,WAAU;;0CACrB,0OAAC,gMAAQ;gCACP,aAAY;gCACZ,OAAO;gCACP,UAAU,CAAC,IAAM,UAAU,EAAE,MAAM,CAAC,KAAK;gCACzC,WAAU;gCACV,MAAM;;;;;;0CAGR,0OAAC;gCAAI,WAAU;;kDACb,0OAAC,4LAAM;wCACL,SAAS;wCACT,UAAU,CAAC,OAAO,IAAI;wCACtB,WAAU;;0DAEV,0OAAC,qRAAY;gDAAC,WAAU;;;;;;4CAAY;;;;;;;oCAIrC,CAAC,eAAe,gBAAgB,mBAC/B,0OAAC,4LAAM;wCACL,SAAQ;wCACR,SAAS,IAAM,gBAAgB,CAAC;wCAChC,WAAU;;4CAET,6BAAe,0OAAC,6QAAS;gDAAC,WAAU;;;;;qEAAe,0OAAC,mRAAW;gDAAC,WAAU;;;;;;4CAC1E,eAAe,SAAS;4CAAO;;;;;;;;;;;;;4BAMrC,WAAW,2BACV,0OAAC,0LAAK;gCAAC,WAAU;;kDACf,0OAAC,mRAAW;wCAAC,WAAU;;;;;;kDACvB,0OAAC,+LAAU;wCAAC,WAAU;kDAAiB;;;;;;kDACvC,0OAAC,qMAAgB;;4CAAC;4CACe,UAAU,MAAM;4CAAC;;;;;;;;;;;;;4BAKrD,WAAW,6BACV,0OAAC,0LAAK;gCAAC,SAAQ;;kDACb,0OAAC,uQAAO;wCAAC,WAAU;;;;;;kDACnB,0OAAC,+LAAU;kDAAC;;;;;;kDACZ,0OAAC,qMAAgB;kDAAC;;;;;;;;;;;;;;;;;;;;;;;;YASzB,8BACC,0OAAC,wLAAI;gBAAC,WAAU;;kCACd,0OAAC,8LAAU;kCACT,cAAA,0OAAC,6LAAS;sCAAC;;;;;;;;;;;kCAEb,0OAAC,+LAAW;kCACV,cAAA,0OAAC;4BAAI,WAAU;;8CACb,0OAAC;;sDACC,0OAAC;4CAAK,WAAU;sDAA4C;;;;;;sDAC5D,0OAAC;4CAAI,WAAU;sDACZ,UAAU,QAAQ;;;;;;;;;;;;8CAGvB,0OAAC;;sDACC,0OAAC;4CAAK,WAAU;sDAA4C;;;;;;sDAC5D,0OAAC;4CAAI,WAAU;sDACZ,UAAU,mBAAmB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAShD;GAtPwB;;QAEP,+LAAS;QAOgC,kMAAgB;;;KATlD"}}]
}