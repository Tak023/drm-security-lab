(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,96622,(e,t,a)=>{"use strict";Object.defineProperty(a,"__esModule",{value:!0}),Object.defineProperty(a,"warnOnce",{enumerable:!0,get:function(){return s}});let s=e=>{}},34768,e=>{"use strict";var t=e.i(53811),a=e.i(83899),s=e.i(12096),i=e.i(73403),r=e.i(25030),n=e.i(60602),o=e.i(67313),l=e.i(63108),c=e.i(2474),d=e.i(74944),u=e.i(32016),m="rovingFocusGroup.onEntryFocus",f={bubbles:!1,cancelable:!0},p="RovingFocusGroup",[b,v,x]=(0,r.createCollection)(p),[h,g]=(0,i.createContextScope)(p,[x]),[j,w]=h(p),y=a.forwardRef((e,a)=>(0,t.jsx)(b.Provider,{scope:e.__scopeRovingFocusGroup,children:(0,t.jsx)(b.Slot,{scope:e.__scopeRovingFocusGroup,children:(0,t.jsx)(N,{...e,ref:a})})}));y.displayName=p;var N=a.forwardRef((e,i)=>{let{__scopeRovingFocusGroup:r,orientation:o,loop:b=!1,dir:x,currentTabStopId:h,defaultCurrentTabStopId:g,onCurrentTabStopIdChange:w,onEntryFocus:y,preventScrollOnEntryFocus:N=!1,...T}=e,C=a.useRef(null),k=(0,n.useComposedRefs)(i,C),D=(0,u.useDirection)(x),[A,E]=(0,d.useControllableState)({prop:h,defaultProp:g??null,onChange:w,caller:p}),[R,F]=a.useState(!1),I=(0,c.useCallbackRef)(y),P=v(r),L=a.useRef(!1),[K,M]=a.useState(0);return a.useEffect(()=>{let e=C.current;if(e)return e.addEventListener(m,I),()=>e.removeEventListener(m,I)},[I]),(0,t.jsx)(j,{scope:r,orientation:o,dir:D,loop:b,currentTabStopId:A,onItemFocus:a.useCallback(e=>E(e),[E]),onItemShiftTab:a.useCallback(()=>F(!0),[]),onFocusableItemAdd:a.useCallback(()=>M(e=>e+1),[]),onFocusableItemRemove:a.useCallback(()=>M(e=>e-1),[]),children:(0,t.jsx)(l.Primitive.div,{tabIndex:R||0===K?-1:0,"data-orientation":o,...T,ref:k,style:{outline:"none",...e.style},onMouseDown:(0,s.composeEventHandlers)(e.onMouseDown,()=>{L.current=!0}),onFocus:(0,s.composeEventHandlers)(e.onFocus,e=>{let t=!L.current;if(e.target===e.currentTarget&&t&&!R){let t=new CustomEvent(m,f);if(e.currentTarget.dispatchEvent(t),!t.defaultPrevented){let e=P().filter(e=>e.focusable);S([e.find(e=>e.active),e.find(e=>e.id===A),...e].filter(Boolean).map(e=>e.ref.current),N)}}L.current=!1}),onBlur:(0,s.composeEventHandlers)(e.onBlur,()=>F(!1))})})}),T="RovingFocusGroupItem",C=a.forwardRef((e,i)=>{let{__scopeRovingFocusGroup:r,focusable:n=!0,active:c=!1,tabStopId:d,children:u,...m}=e,f=(0,o.useId)(),p=d||f,x=w(T,r),h=x.currentTabStopId===p,g=v(r),{onFocusableItemAdd:j,onFocusableItemRemove:y,currentTabStopId:N}=x;return a.useEffect(()=>{if(n)return j(),()=>y()},[n,j,y]),(0,t.jsx)(b.ItemSlot,{scope:r,id:p,focusable:n,active:c,children:(0,t.jsx)(l.Primitive.span,{tabIndex:h?0:-1,"data-orientation":x.orientation,...m,ref:i,onMouseDown:(0,s.composeEventHandlers)(e.onMouseDown,e=>{n?x.onItemFocus(p):e.preventDefault()}),onFocus:(0,s.composeEventHandlers)(e.onFocus,()=>x.onItemFocus(p)),onKeyDown:(0,s.composeEventHandlers)(e.onKeyDown,e=>{if("Tab"===e.key&&e.shiftKey)return void x.onItemShiftTab();if(e.target!==e.currentTarget)return;let t=function(e,t,a){var s;let i=(s=e.key,"rtl"!==a?s:"ArrowLeft"===s?"ArrowRight":"ArrowRight"===s?"ArrowLeft":s);if(!("vertical"===t&&["ArrowLeft","ArrowRight"].includes(i))&&!("horizontal"===t&&["ArrowUp","ArrowDown"].includes(i)))return k[i]}(e,x.orientation,x.dir);if(void 0!==t){if(e.metaKey||e.ctrlKey||e.altKey||e.shiftKey)return;e.preventDefault();let i=g().filter(e=>e.focusable).map(e=>e.ref.current);if("last"===t)i.reverse();else if("prev"===t||"next"===t){var a,s;"prev"===t&&i.reverse();let r=i.indexOf(e.currentTarget);i=x.loop?(a=i,s=r+1,a.map((e,t)=>a[(s+t)%a.length])):i.slice(r+1)}setTimeout(()=>S(i))}}),children:"function"==typeof u?u({isCurrentTabStop:h,hasTabStop:null!=N}):u})})});C.displayName=T;var k={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function S(e,t=!1){let a=document.activeElement;for(let s of e)if(s===a||(s.focus({preventScroll:t}),document.activeElement!==a))return}var D=e.i(62393),A="Tabs",[E,R]=(0,i.createContextScope)(A,[g]),F=g(),[I,P]=E(A),L=a.forwardRef((e,a)=>{let{__scopeTabs:s,value:i,onValueChange:r,defaultValue:n,orientation:c="horizontal",dir:m,activationMode:f="automatic",...p}=e,b=(0,u.useDirection)(m),[v,x]=(0,d.useControllableState)({prop:i,onChange:r,defaultProp:n??"",caller:A});return(0,t.jsx)(I,{scope:s,baseId:(0,o.useId)(),value:v,onValueChange:x,orientation:c,dir:b,activationMode:f,children:(0,t.jsx)(l.Primitive.div,{dir:b,"data-orientation":c,...p,ref:a})})});L.displayName=A;var K="TabsList",M=a.forwardRef((e,a)=>{let{__scopeTabs:s,loop:i=!0,...r}=e,n=P(K,s),o=F(s);return(0,t.jsx)(y,{asChild:!0,...o,orientation:n.orientation,dir:n.dir,loop:i,children:(0,t.jsx)(l.Primitive.div,{role:"tablist","aria-orientation":n.orientation,...r,ref:a})})});M.displayName=K;var H="TabsTrigger",B=a.forwardRef((e,a)=>{let{__scopeTabs:i,value:r,disabled:n=!1,...o}=e,c=P(H,i),d=F(i),u=z(c.baseId,r),m=O(c.baseId,r),f=r===c.value;return(0,t.jsx)(C,{asChild:!0,...d,focusable:!n,active:f,children:(0,t.jsx)(l.Primitive.button,{type:"button",role:"tab","aria-selected":f,"aria-controls":m,"data-state":f?"active":"inactive","data-disabled":n?"":void 0,disabled:n,id:u,...o,ref:a,onMouseDown:(0,s.composeEventHandlers)(e.onMouseDown,e=>{n||0!==e.button||!1!==e.ctrlKey?e.preventDefault():c.onValueChange(r)}),onKeyDown:(0,s.composeEventHandlers)(e.onKeyDown,e=>{[" ","Enter"].includes(e.key)&&c.onValueChange(r)}),onFocus:(0,s.composeEventHandlers)(e.onFocus,()=>{let e="manual"!==c.activationMode;f||n||!e||c.onValueChange(r)})})})});B.displayName=H;var $="TabsContent",_=a.forwardRef((e,s)=>{let{__scopeTabs:i,value:r,forceMount:n,children:o,...c}=e,d=P($,i),u=z(d.baseId,r),m=O(d.baseId,r),f=r===d.value,p=a.useRef(f);return a.useEffect(()=>{let e=requestAnimationFrame(()=>p.current=!1);return()=>cancelAnimationFrame(e)},[]),(0,t.jsx)(D.Presence,{present:n||f,children:({present:a})=>(0,t.jsx)(l.Primitive.div,{"data-state":f?"active":"inactive","data-orientation":d.orientation,role:"tabpanel","aria-labelledby":u,hidden:!a,id:m,tabIndex:0,...c,ref:s,style:{...e.style,animationDuration:p.current?"0s":void 0},children:a&&o})})});function z(e,t){return`${e}-trigger-${t}`}function O(e,t){return`${e}-content-${t}`}_.displayName=$;var V=e.i(9799);function U({className:e,...a}){return(0,t.jsx)(L,{"data-slot":"tabs",className:(0,V.cn)("flex flex-col gap-2",e),...a})}function G({className:e,...a}){return(0,t.jsx)(M,{"data-slot":"tabs-list",className:(0,V.cn)("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",e),...a})}function q({className:e,...a}){return(0,t.jsx)(B,{"data-slot":"tabs-trigger",className:(0,V.cn)("data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...a})}function W({className:e,...a}){return(0,t.jsx)(_,{"data-slot":"tabs-content",className:(0,V.cn)("flex-1 outline-none",e),...a})}e.s(["Tabs",()=>U,"TabsContent",()=>W,"TabsList",()=>G,"TabsTrigger",()=>q],34768)},11186,e=>{"use strict";let t=(0,e.i(27489).default)("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);e.s(["ArrowRight",()=>t],11186)},25110,e=>{"use strict";var t=e.i(53811),a=e.i(2353),s=e.i(55920),i=e.i(92191),r=e.i(23376),n=e.i(11350),o=e.i(34768),l=e.i(3789),c=e.i(21591),d=e.i(9925),u=e.i(36783),m=e.i(2130),f=e.i(57325),p=e.i(3189),b=e.i(37171),v=e.i(66359),x=e.i(41713),h=e.i(10914),g=e.i(11186),j=e.i(28151);let w=[{id:"license-server",title:"License Server",description:"Interact with a mock license server. Observe request/response flows.",icon:d.Network,status:"available"},{id:"key-exchange",title:"Key Exchange",description:"Visualize Diffie-Hellman and RSA key exchange protocols.",icon:u.Key,status:"available"},{id:"encryption",title:"Encryption Lab",description:"Encrypt and decrypt content using AES-CTR and AES-CBC modes.",icon:m.Lock,status:"available"},{id:"cdm-simulator",title:"CDM Simulator",description:"Simulate Content Decryption Module behavior at different security levels.",icon:f.Shield,status:"available"}],y=[{id:"cdm-extraction",title:"CDM Extraction",description:"Understand how software CDMs can be reverse-engineered (conceptual).",icon:p.Sword,status:"available"},{id:"key-sharing",title:"Key Sharing",description:"Learn about license portability and session binding weaknesses.",icon:u.Key,status:"available"},{id:"mitm",title:"MITM Attack",description:"Visualize man-in-the-middle attacks on license flows.",icon:b.Eye,status:"available"},{id:"hdcp-bypass",title:"HDCP Bypass",description:"Explore output protection and hardware trust chains.",icon:h.AlertTriangle,status:"available"}],N=[{id:"attestation",title:"Device Attestation",description:"Simulate device attestation and trust establishment.",icon:v.Fingerprint,status:"available"},{id:"watermarking",title:"Forensic Watermarking",description:"Visualize A/B segment watermarking for content tracing.",icon:x.FileText,status:"available"},{id:"anomaly",title:"Anomaly Detection",description:"Simulate real-time detection of suspicious access patterns.",icon:h.AlertTriangle,status:"available"}];function T({lab:e,category:a}){let s="attack"===a?`/labs/attacks/${e.id}`:"defense"===a?`/labs/defense/${e.id}`:`/labs/${e.id}`,i="coming-soon"===e.status,o=(0,t.jsxs)(r.Card,{className:`h-full transition-all ${i?"opacity-60":"hover:border-primary/50 hover:shadow-lg cursor-pointer"}`,children:[(0,t.jsxs)(r.CardHeader,{children:[(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsx)("div",{className:`flex h-10 w-10 items-center justify-center rounded-lg bg-primary/10 ${{simulation:"text-primary",attack:"text-red-team",defense:"text-blue-team"}[a]}`,children:(0,t.jsx)(e.icon,{className:"h-5 w-5"})}),i&&(0,t.jsx)(n.Badge,{variant:"outline",className:"text-xs",children:"Coming Soon"})]}),(0,t.jsx)(r.CardTitle,{className:"mt-4",children:e.title}),(0,t.jsx)(r.CardDescription,{children:e.description})]}),(0,t.jsx)(r.CardContent,{children:!i&&(0,t.jsxs)("div",{className:"flex items-center text-sm text-primary",children:["Open Lab ",(0,t.jsx)(g.ArrowRight,{className:"ml-1 h-4 w-4"})]})})]});return i?o:(0,t.jsx)(c.default,{href:s,children:o})}function C(){let e=(0,l.usePerspectiveStore)(e=>e.perspective);return(0,t.jsxs)("div",{className:"min-h-screen bg-background",children:[(0,t.jsx)(a.Header,{}),(0,t.jsxs)("div",{className:"flex",children:[(0,t.jsx)(s.Sidebar,{className:"hidden lg:flex"}),(0,t.jsx)("main",{className:"flex-1 p-6 lg:p-8",children:(0,t.jsxs)("div",{className:"mx-auto max-w-5xl",children:[(0,t.jsx)("div",{className:"mb-8",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-success/10",children:(0,t.jsx)(j.FlaskConical,{className:"h-5 w-5 text-success"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-foreground",children:"Interactive Labs"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Hands-on simulations of DRM systems, attacks, and defenses"})]})]})}),(0,t.jsxs)(o.Tabs,{defaultValue:"red-team"===e?"attacks":"blue-team"===e?"defense":"simulations",children:[(0,t.jsxs)(o.TabsList,{className:"grid w-full grid-cols-3",children:[(0,t.jsxs)(o.TabsTrigger,{value:"simulations",className:"gap-2",children:[(0,t.jsx)(d.Network,{className:"h-4 w-4"}),"Simulations"]}),(0,t.jsxs)(o.TabsTrigger,{value:"attacks",className:"gap-2",children:[(0,t.jsx)(p.Sword,{className:"h-4 w-4 text-red-team"}),"Attack Scenarios"]}),(0,t.jsxs)(o.TabsTrigger,{value:"defense",className:"gap-2",children:[(0,t.jsx)(f.Shield,{className:"h-4 w-4 text-blue-team"}),"Defense Lab"]})]}),(0,t.jsx)(o.TabsContent,{value:"simulations",className:"mt-6",children:(0,t.jsx)("div",{className:"grid gap-6 md:grid-cols-2",children:w.map(e=>(0,t.jsx)(T,{lab:e,category:"simulation"},e.id))})}),(0,t.jsxs)(o.TabsContent,{value:"attacks",className:"mt-6",children:[(0,t.jsxs)("div",{className:"mb-4 rounded-lg border border-red-team/30 bg-red-team/5 p-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 text-red-team",children:[(0,t.jsx)(p.Sword,{className:"h-5 w-5"}),(0,t.jsx)("span",{className:"font-semibold",children:"Red Team Perspective"})]}),(0,t.jsx)("p",{className:"mt-1 text-sm text-muted-foreground",children:"These labs demonstrate attack concepts for educational purposes. Understanding attacks helps build better defenses."})]}),(0,t.jsx)("div",{className:"grid gap-6 md:grid-cols-2",children:y.map(e=>(0,t.jsx)(T,{lab:e,category:"attack"},e.id))})]}),(0,t.jsxs)(o.TabsContent,{value:"defense",className:"mt-6",children:[(0,t.jsxs)("div",{className:"mb-4 rounded-lg border border-blue-team/30 bg-blue-team/5 p-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 text-blue-team",children:[(0,t.jsx)(f.Shield,{className:"h-5 w-5"}),(0,t.jsx)("span",{className:"font-semibold",children:"Blue Team Perspective"})]}),(0,t.jsx)("p",{className:"mt-1 text-sm text-muted-foreground",children:"Learn how to implement and configure defense mechanisms to protect content and detect malicious activity."})]}),(0,t.jsx)("div",{className:"grid gap-6 md:grid-cols-2",children:N.map(e=>(0,t.jsx)(T,{lab:e,category:"defense"},e.id))})]})]})]})})]}),(0,t.jsx)(i.Footer,{})]})}e.s(["default",()=>C])}]);