(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,2130,e=>{"use strict";let t=(0,e.i(27489).default)("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);e.s(["Lock",()=>t],2130)},36783,e=>{"use strict";let t=(0,e.i(27489).default)("key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);e.s(["Key",()=>t],36783)},11186,e=>{"use strict";let t=(0,e.i(27489).default)("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);e.s(["ArrowRight",()=>t],11186)},68524,e=>{"use strict";var t=e.i(53811),r=e.i(12140),s=e.i(9799);let a=(0,r.cva)("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function i({className:e,variant:r,...i}){return(0,t.jsx)("div",{"data-slot":"alert",role:"alert",className:(0,s.cn)(a({variant:r}),e),...i})}function n({className:e,...r}){return(0,t.jsx)("div",{"data-slot":"alert-title",className:(0,s.cn)("col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight",e),...r})}function l({className:e,...r}){return(0,t.jsx)("div",{"data-slot":"alert-description",className:(0,s.cn)("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",e),...r})}e.s(["Alert",()=>i,"AlertDescription",()=>l,"AlertTitle",()=>n])},11931,e=>{"use strict";function t(e,t){let r=Math.min(e.length,t.length),s=new Uint8Array(r);for(let a=0;a<r;a++)s[a]=e[a]^t[a];return s}function r(e=16){let t=new Uint8Array(e);if(window.crypto)window.crypto.getRandomValues(t);else for(let r=0;r<e;r++)t[r]=Math.floor(256*Math.random());return t}function s(e){return Array.from(e).map(e=>e.toString(16).padStart(2,"0")).join("")}function a(e){let t=new Uint8Array(e.length/2);for(let r=0;r<t.length;r++)t[r]=parseInt(e.substr(2*r,2),16);return t}function i(e){return new TextEncoder().encode(e)}function n(e){return btoa(String.fromCharCode(...e))}function l(e){return Uint8Array.from(atob(e),e=>e.charCodeAt(0))}function o(e){let t=0;for(let r=0;r<e.length;r++)t=(t<<5)-t+e[r]|0;return Math.abs(t).toString(16).padStart(8,"0")}function c(){let e=s(r(16));return`${e.slice(0,8)}-${e.slice(8,12)}-${e.slice(12,16)}-${e.slice(16,20)}-${e.slice(20,32)}`}class d{key;iv;constructor(e,t){this.key=e,this.iv=t||r(16)}encryptCTR(e){let t=new Uint8Array(e.length);for(let r=0;r<e.length;r+=16){let s=new Uint8Array(16);s.set(this.iv.slice(0,8),0);let a=Math.floor(r/16);for(let e=0;e<8;e++)s[8+e]=a>>8*(7-e)&255;let i=function(e,t){let r=new Uint8Array(e.length);for(let s=0;s<e.length;s++)r[s]=e[s]^t[s%t.length];return r}(s,this.key),n=Math.min(r+16,e.length);for(let s=r;s<n;s++)t[s]=e[s]^i[s-r]}return{ciphertext:t,iv:this.iv}}decryptCTR(e){return this.encryptCTR(e).ciphertext}getIV(){return this.iv}}class u{privateKey;publicKey;modulus;constructor(){this.modulus=3233,this.publicKey=17,this.privateKey=this.modInverse(this.publicKey,3120)}modInverse(e,t){let[r,s]=[e,t],[a,i]=[1,0];for(;0!==s;){let e=Math.floor(r/s);[r,s]=[s,r-e*s],[a,i]=[i,a-e*i]}return(a%t+t)%t}modPow(e,t,r){let s=1;for(e%=r;t>0;)t%2==1&&(s=s*e%r),t=Math.floor(t/2),e=e*e%r;return s}encrypt(e){return this.modPow(e,this.publicKey,this.modulus)}decrypt(e){return this.modPow(e,this.privateKey,this.modulus)}encryptBytes(e){return Array.from(e).map(e=>this.encrypt(e))}decryptBytes(e){return new Uint8Array(e.map(e=>this.decrypt(e)))}getPublicKey(){return{e:this.publicKey,n:this.modulus}}sign(e){return Array.from(i(o(e))).map(e=>this.modPow(e,this.privateKey,this.modulus)).join(",")}verify(e,t){var r;let s=o(e);return r=new Uint8Array(t.split(",").map(Number).map(e=>this.modPow(e,this.publicKey,this.modulus))),new TextDecoder().decode(r)===s}}e.s(["SimpleAsymmetric",()=>u,"SimpleCipher",()=>d,"base64Decode",()=>l,"base64Encode",()=>n,"bytesToHex",()=>s,"generateKey",()=>r,"generateKeyId",()=>c,"hexToBytes",()=>a,"simpleHash",()=>o,"stringToBytes",()=>i,"xorBytes",()=>t])},34768,e=>{"use strict";var t=e.i(53811),r=e.i(83899),s=e.i(12096),a=e.i(73403),i=e.i(25030),n=e.i(60602),l=e.i(67313),o=e.i(63108),c=e.i(2474),d=e.i(74944),u=e.i(32016),h="rovingFocusGroup.onEntryFocus",x={bubbles:!1,cancelable:!0},p="RovingFocusGroup",[m,f,g]=(0,i.createCollection)(p),[y,v]=(0,a.createContextScope)(p,[g]),[b,j]=y(p),w=r.forwardRef((e,r)=>(0,t.jsx)(m.Provider,{scope:e.__scopeRovingFocusGroup,children:(0,t.jsx)(m.Slot,{scope:e.__scopeRovingFocusGroup,children:(0,t.jsx)(C,{...e,ref:r})})}));w.displayName=p;var C=r.forwardRef((e,a)=>{let{__scopeRovingFocusGroup:i,orientation:l,loop:m=!1,dir:g,currentTabStopId:y,defaultCurrentTabStopId:v,onCurrentTabStopIdChange:j,onEntryFocus:w,preventScrollOnEntryFocus:C=!1,...N}=e,k=r.useRef(null),T=(0,n.useComposedRefs)(a,k),R=(0,u.useDirection)(g),[A,E]=(0,d.useControllableState)({prop:y,defaultProp:v??null,onChange:j,caller:p}),[P,M]=r.useState(!1),B=(0,c.useCallbackRef)(w),K=f(i),H=r.useRef(!1),[I,D]=r.useState(0);return r.useEffect(()=>{let e=k.current;if(e)return e.addEventListener(h,B),()=>e.removeEventListener(h,B)},[B]),(0,t.jsx)(b,{scope:i,orientation:l,dir:R,loop:m,currentTabStopId:A,onItemFocus:r.useCallback(e=>E(e),[E]),onItemShiftTab:r.useCallback(()=>M(!0),[]),onFocusableItemAdd:r.useCallback(()=>D(e=>e+1),[]),onFocusableItemRemove:r.useCallback(()=>D(e=>e-1),[]),children:(0,t.jsx)(o.Primitive.div,{tabIndex:P||0===I?-1:0,"data-orientation":l,...N,ref:T,style:{outline:"none",...e.style},onMouseDown:(0,s.composeEventHandlers)(e.onMouseDown,()=>{H.current=!0}),onFocus:(0,s.composeEventHandlers)(e.onFocus,e=>{let t=!H.current;if(e.target===e.currentTarget&&t&&!P){let t=new CustomEvent(h,x);if(e.currentTarget.dispatchEvent(t),!t.defaultPrevented){let e=K().filter(e=>e.focusable);S([e.find(e=>e.active),e.find(e=>e.id===A),...e].filter(Boolean).map(e=>e.ref.current),C)}}H.current=!1}),onBlur:(0,s.composeEventHandlers)(e.onBlur,()=>M(!1))})})}),N="RovingFocusGroupItem",k=r.forwardRef((e,a)=>{let{__scopeRovingFocusGroup:i,focusable:n=!0,active:c=!1,tabStopId:d,children:u,...h}=e,x=(0,l.useId)(),p=d||x,g=j(N,i),y=g.currentTabStopId===p,v=f(i),{onFocusableItemAdd:b,onFocusableItemRemove:w,currentTabStopId:C}=g;return r.useEffect(()=>{if(n)return b(),()=>w()},[n,b,w]),(0,t.jsx)(m.ItemSlot,{scope:i,id:p,focusable:n,active:c,children:(0,t.jsx)(o.Primitive.span,{tabIndex:y?0:-1,"data-orientation":g.orientation,...h,ref:a,onMouseDown:(0,s.composeEventHandlers)(e.onMouseDown,e=>{n?g.onItemFocus(p):e.preventDefault()}),onFocus:(0,s.composeEventHandlers)(e.onFocus,()=>g.onItemFocus(p)),onKeyDown:(0,s.composeEventHandlers)(e.onKeyDown,e=>{if("Tab"===e.key&&e.shiftKey)return void g.onItemShiftTab();if(e.target!==e.currentTarget)return;let t=function(e,t,r){var s;let a=(s=e.key,"rtl"!==r?s:"ArrowLeft"===s?"ArrowRight":"ArrowRight"===s?"ArrowLeft":s);if(!("vertical"===t&&["ArrowLeft","ArrowRight"].includes(a))&&!("horizontal"===t&&["ArrowUp","ArrowDown"].includes(a)))return T[a]}(e,g.orientation,g.dir);if(void 0!==t){if(e.metaKey||e.ctrlKey||e.altKey||e.shiftKey)return;e.preventDefault();let a=v().filter(e=>e.focusable).map(e=>e.ref.current);if("last"===t)a.reverse();else if("prev"===t||"next"===t){var r,s;"prev"===t&&a.reverse();let i=a.indexOf(e.currentTarget);a=g.loop?(r=a,s=i+1,r.map((e,t)=>r[(s+t)%r.length])):a.slice(i+1)}setTimeout(()=>S(a))}}),children:"function"==typeof u?u({isCurrentTabStop:y,hasTabStop:null!=C}):u})})});k.displayName=N;var T={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function S(e,t=!1){let r=document.activeElement;for(let s of e)if(s===r||(s.focus({preventScroll:t}),document.activeElement!==r))return}var R=e.i(62393),A="Tabs",[E,P]=(0,a.createContextScope)(A,[v]),M=v(),[B,K]=E(A),H=r.forwardRef((e,r)=>{let{__scopeTabs:s,value:a,onValueChange:i,defaultValue:n,orientation:c="horizontal",dir:h,activationMode:x="automatic",...p}=e,m=(0,u.useDirection)(h),[f,g]=(0,d.useControllableState)({prop:a,onChange:i,defaultProp:n??"",caller:A});return(0,t.jsx)(B,{scope:s,baseId:(0,l.useId)(),value:f,onValueChange:g,orientation:c,dir:m,activationMode:x,children:(0,t.jsx)(o.Primitive.div,{dir:m,"data-orientation":c,...p,ref:r})})});H.displayName=A;var I="TabsList",D=r.forwardRef((e,r)=>{let{__scopeTabs:s,loop:a=!0,...i}=e,n=K(I,s),l=M(s);return(0,t.jsx)(w,{asChild:!0,...l,orientation:n.orientation,dir:n.dir,loop:a,children:(0,t.jsx)(o.Primitive.div,{role:"tablist","aria-orientation":n.orientation,...i,ref:r})})});D.displayName=I;var $="TabsTrigger",z=r.forwardRef((e,r)=>{let{__scopeTabs:a,value:i,disabled:n=!1,...l}=e,c=K($,a),d=M(a),u=F(c.baseId,i),h=V(c.baseId,i),x=i===c.value;return(0,t.jsx)(k,{asChild:!0,...d,focusable:!n,active:x,children:(0,t.jsx)(o.Primitive.button,{type:"button",role:"tab","aria-selected":x,"aria-controls":h,"data-state":x?"active":"inactive","data-disabled":n?"":void 0,disabled:n,id:u,...l,ref:r,onMouseDown:(0,s.composeEventHandlers)(e.onMouseDown,e=>{n||0!==e.button||!1!==e.ctrlKey?e.preventDefault():c.onValueChange(i)}),onKeyDown:(0,s.composeEventHandlers)(e.onKeyDown,e=>{[" ","Enter"].includes(e.key)&&c.onValueChange(i)}),onFocus:(0,s.composeEventHandlers)(e.onFocus,()=>{let e="manual"!==c.activationMode;x||n||!e||c.onValueChange(i)})})})});z.displayName=$;var L="TabsContent",U=r.forwardRef((e,s)=>{let{__scopeTabs:a,value:i,forceMount:n,children:l,...c}=e,d=K(L,a),u=F(d.baseId,i),h=V(d.baseId,i),x=i===d.value,p=r.useRef(x);return r.useEffect(()=>{let e=requestAnimationFrame(()=>p.current=!1);return()=>cancelAnimationFrame(e)},[]),(0,t.jsx)(R.Presence,{present:n||x,children:({present:r})=>(0,t.jsx)(o.Primitive.div,{"data-state":x?"active":"inactive","data-orientation":d.orientation,role:"tabpanel","aria-labelledby":u,hidden:!r,id:h,tabIndex:0,...c,ref:s,style:{...e.style,animationDuration:p.current?"0s":void 0},children:r&&l})})});function F(e,t){return`${e}-trigger-${t}`}function V(e,t){return`${e}-content-${t}`}U.displayName=L;var q=e.i(9799);function _({className:e,...r}){return(0,t.jsx)(H,{"data-slot":"tabs",className:(0,q.cn)("flex flex-col gap-2",e),...r})}function O({className:e,...r}){return(0,t.jsx)(D,{"data-slot":"tabs-list",className:(0,q.cn)("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",e),...r})}function G({className:e,...r}){return(0,t.jsx)(z,{"data-slot":"tabs-trigger",className:(0,q.cn)("data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...r})}function W({className:e,...r}){return(0,t.jsx)(U,{"data-slot":"tabs-content",className:(0,q.cn)("flex-1 outline-none",e),...r})}e.s(["Tabs",()=>_,"TabsContent",()=>W,"TabsList",()=>O,"TabsTrigger",()=>G],34768)},45511,e=>{"use strict";let t=(0,e.i(27489).default)("lock-open",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]);e.s(["Unlock",()=>t],45511)},69842,e=>{"use strict";let t=(0,e.i(27489).default)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);e.s(["RefreshCw",()=>t],69842)},49371,e=>{"use strict";let t=(0,e.i(27489).default)("copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);e.s(["Copy",()=>t],49371)},93430,e=>{"use strict";var t=e.i(53811),r=e.i(9799);function s({className:e,...s}){return(0,t.jsx)("textarea",{"data-slot":"textarea",className:(0,r.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),...s})}e.s(["Textarea",()=>s])},94756,e=>{"use strict";var t=e.i(83899);function r(e){let r=t.useRef({value:e,previous:e});return t.useMemo(()=>(r.current.value!==e&&(r.current.previous=r.current.value,r.current.value=e),r.current.previous),[e])}e.s(["usePrevious",()=>r])},89616,e=>{"use strict";var t=e.i(83899),r=e.i(58489);function s(e){let[s,a]=t.useState(void 0);return(0,r.useLayoutEffect)(()=>{if(e){a({width:e.offsetWidth,height:e.offsetHeight});let t=new ResizeObserver(t=>{let r,s;if(!Array.isArray(t)||!t.length)return;let i=t[0];if("borderBoxSize"in i){let e=i.borderBoxSize,t=Array.isArray(e)?e[0]:e;r=t.inlineSize,s=t.blockSize}else r=e.offsetWidth,s=e.offsetHeight;a({width:r,height:s})});return t.observe(e,{box:"border-box"}),()=>t.unobserve(e)}a(void 0)},[e]),s}e.s(["useSize",()=>s])},28883,e=>{"use strict";var t=e.i(53811),r=e.i(83899),s=e.i(12096),a=e.i(60602),i=e.i(73403),n=e.i(74944),l=e.i(94756),o=e.i(89616),c=e.i(63108),d="Switch",[u,h]=(0,i.createContextScope)(d),[x,p]=u(d),m=r.forwardRef((e,i)=>{let{__scopeSwitch:l,name:o,checked:u,defaultChecked:h,required:p,disabled:m,value:f="on",onCheckedChange:g,form:b,...j}=e,[w,C]=r.useState(null),N=(0,a.useComposedRefs)(i,e=>C(e)),k=r.useRef(!1),T=!w||b||!!w.closest("form"),[S,R]=(0,n.useControllableState)({prop:u,defaultProp:h??!1,onChange:g,caller:d});return(0,t.jsxs)(x,{scope:l,checked:S,disabled:m,children:[(0,t.jsx)(c.Primitive.button,{type:"button",role:"switch","aria-checked":S,"aria-required":p,"data-state":v(S),"data-disabled":m?"":void 0,disabled:m,value:f,...j,ref:N,onClick:(0,s.composeEventHandlers)(e.onClick,e=>{R(e=>!e),T&&(k.current=e.isPropagationStopped(),k.current||e.stopPropagation())})}),T&&(0,t.jsx)(y,{control:w,bubbles:!k.current,name:o,value:f,checked:S,required:p,disabled:m,form:b,style:{transform:"translateX(-100%)"}})]})});m.displayName=d;var f="SwitchThumb",g=r.forwardRef((e,r)=>{let{__scopeSwitch:s,...a}=e,i=p(f,s);return(0,t.jsx)(c.Primitive.span,{"data-state":v(i.checked),"data-disabled":i.disabled?"":void 0,...a,ref:r})});g.displayName=f;var y=r.forwardRef(({__scopeSwitch:e,control:s,checked:i,bubbles:n=!0,...c},d)=>{let u=r.useRef(null),h=(0,a.useComposedRefs)(u,d),x=(0,l.usePrevious)(i),p=(0,o.useSize)(s);return r.useEffect(()=>{let e=u.current;if(!e)return;let t=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(x!==i&&t){let r=new Event("click",{bubbles:n});t.call(e,i),e.dispatchEvent(r)}},[x,i,n]),(0,t.jsx)("input",{type:"checkbox","aria-hidden":!0,defaultChecked:i,...c,tabIndex:-1,ref:h,style:{...c.style,...p,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});function v(e){return e?"checked":"unchecked"}y.displayName="SwitchBubbleInput";var b=e.i(9799);function j({className:e,...r}){return(0,t.jsx)(m,{"data-slot":"switch",className:(0,b.cn)("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",e),...r,children:(0,t.jsx)(g,{"data-slot":"switch-thumb",className:(0,b.cn)("bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0")})})}e.s(["Switch",()=>j],28883)},50284,e=>{"use strict";var t=e.i(53811),r=e.i(83899);e.i(94126);var s=e.i(88422),a=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,a)=>{let i=(0,s.createSlot)(`Primitive.${a}`),n=r.forwardRef((e,r)=>{let{asChild:s,...n}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,t.jsx)(s?i:a,{...n,ref:r})});return n.displayName=`Primitive.${a}`,{...e,[a]:n}},{}),i=r.forwardRef((e,r)=>(0,t.jsx)(a.label,{...e,ref:r,onMouseDown:t=>{t.target.closest("button, input, select, textarea")||(e.onMouseDown?.(t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));i.displayName="Label";var n=e.i(9799);function l({className:e,...r}){return(0,t.jsx)(i,{"data-slot":"label",className:(0,n.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",e),...r})}e.s(["Label",()=>l],50284)},12667,e=>{"use strict";var t=e.i(53811),r=e.i(83899),s=e.i(23376),a=e.i(78349),i=e.i(11350),n=e.i(68524),l=e.i(34768),o=e.i(93430),c=e.i(15004),d=e.i(50985),u=e.i(28883),h=e.i(50284),x=e.i(2130),p=e.i(45511),m=e.i(36783),f=e.i(57325),g=e.i(69842),y=e.i(49371),v=e.i(11186),b=e.i(27489);let j=(0,b.default)("binary",[["rect",{x:"14",y:"14",width:"4",height:"6",rx:"2",key:"p02svl"}],["rect",{x:"6",y:"4",width:"4",height:"6",rx:"2",key:"xm4xkj"}],["path",{d:"M6 20h4",key:"1i6q5t"}],["path",{d:"M14 10h4",key:"ru81e7"}],["path",{d:"M6 14h2v6",key:"16z9wg"}],["path",{d:"M14 4h2v6",key:"1idq9u"}]]),w=(0,b.default)("blocks",[["path",{d:"M10 22V7a1 1 0 0 0-1-1H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-5a1 1 0 0 0-1-1H2",key:"1ah6g2"}],["rect",{x:"14",y:"2",width:"8",height:"8",rx:"1",key:"88lufb"}]]),C=(0,b.default)("shuffle",[["path",{d:"m18 14 4 4-4 4",key:"10pe0f"}],["path",{d:"m18 2 4 4-4 4",key:"pucp1d"}],["path",{d:"M2 18h1.973a4 4 0 0 0 3.3-1.7l5.454-8.6a4 4 0 0 1 3.3-1.7H22",key:"1ailkh"}],["path",{d:"M2 6h1.972a4 4 0 0 1 3.6 2.2",key:"km57vx"}],["path",{d:"M22 18h-6.041a4 4 0 0 1-3.3-1.8l-.359-.45",key:"os18l9"}]]);var N=e.i(11931);function k(){let[e,b]=(0,r.useState)("Hello, DRM World!"),[k,T]=(0,r.useState)("ctr"),[S,R]=(0,r.useState)((0,N.generateKey)(16)),[A,E]=(0,r.useState)((0,N.generateKey)(16)),[P,M]=(0,r.useState)(""),[B,K]=(0,r.useState)(""),[H,I]=(0,r.useState)([]),[D,$]=(0,r.useState)(!1),[z,L]=(0,r.useState)(!1),U=e=>new Promise(t=>setTimeout(t,e)),F=(e,t)=>(0,N.xorBytes)(e,t.slice(0,e.length)),V=e=>new TextDecoder().decode(e),q=async e=>{let t=[],r=Math.ceil(e.length/16),s=new Uint8Array(e.length),a=new Uint8Array(A);t.push({id:"0",label:"Initialization",input:`Plaintext: "${V(e)}" (${e.length} bytes)`,output:`IV/Nonce: ${(0,N.bytesToHex)(A).substring(0,32)}...`,operation:"Set up counter from IV"}),await U(400),I([...t]);for(let i=0;i<r;i++){if(i>0)for(let e=a.length-1;e>=0&&(a[e]++,0===a[e]);e--);let r=F(a,S),n=16*i,l=Math.min(n+16,e.length),o=e.slice(n,l);for(let e=0;e<o.length;e++)s[n+e]=o[e]^r[e];t.push({id:String(i+1),label:`Block ${i+1}`,input:`Counter: ${(0,N.bytesToHex)(a).substring(0,16)}... → Keystream`,output:`Plaintext XOR Keystream = ${(0,N.bytesToHex)(s.slice(n,l))}`,operation:`E(K, Counter${i}) ⊕ P${i}`}),await U(300),I([...t])}return{ciphertext:s,steps:t}},_=async e=>{let t=[],r=((e,t)=>{let r=16-e.length%16,s=new Uint8Array(e.length+r);s.set(e);for(let t=e.length;t<s.length;t++)s[t]=r;return s})(e,0),s=r.length/16,a=new Uint8Array(r.length),i=new Uint8Array(A.buffer.slice(0));t.push({id:"0",label:"Initialization",input:`Plaintext: "${V(e)}" → Padded to ${r.length} bytes`,output:`IV: ${(0,N.bytesToHex)(A).substring(0,32)}...`,operation:"PKCS#7 padding applied"}),await U(400),I([...t]);for(let e=0;e<s;e++){let s=16*e,n=r.slice(s,s+16),l=(0,N.xorBytes)(n,i),o=F(l,S);a.set(o,s),i=new Uint8Array(o.buffer.slice(0)),t.push({id:String(e+1),label:`Block ${e+1}`,input:`P${e} ⊕ ${0===e?"IV":`C${e-1}`} = ${(0,N.bytesToHex)(l).substring(0,16)}...`,output:`C${e} = ${(0,N.bytesToHex)(o).substring(0,16)}...`,operation:`E(K, P${e} ⊕ ${0===e?"IV":`C${e-1}`})`}),await U(300),I([...t])}return{ciphertext:a,steps:t}},O=async()=>{L(!0),I([]),M(""),K("");try{let t=new TextEncoder().encode(e),r="ctr"===k?await q(t):await _(t);M((0,N.bytesToHex)(r.ciphertext)),await U(500),K(e)}catch(e){console.error("Encryption error:",e)}L(!1)},G=e=>{navigator.clipboard.writeText(e)};return(0,t.jsxs)("div",{className:"container max-w-6xl py-8",children:[(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsxs)("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[(0,t.jsx)(x.Lock,{className:"w-6 h-6 text-primary"}),"Encryption Lab"]}),(0,t.jsx)("p",{className:"text-muted-foreground mt-1",children:"Explore AES encryption modes used in DRM content protection"})]}),(0,t.jsxs)(n.Alert,{className:"mb-6",children:[(0,t.jsx)(f.Shield,{className:"h-4 w-4"}),(0,t.jsx)(n.AlertTitle,{children:"DRM Content Encryption"}),(0,t.jsx)(n.AlertDescription,{children:"DRM systems typically use AES-128 in CTR or CBC mode. CTR mode enables random access for streaming, while CBC provides stronger diffusion. This lab demonstrates the core concepts with simplified operations."})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)(s.Card,{children:[(0,t.jsxs)(s.CardHeader,{children:[(0,t.jsx)(s.CardTitle,{className:"text-lg",children:"Encryption Mode"}),(0,t.jsx)(s.CardDescription,{children:"Select AES operation mode"})]}),(0,t.jsxs)(s.CardContent,{children:[(0,t.jsx)(l.Tabs,{value:k,onValueChange:e=>T(e),children:(0,t.jsxs)(l.TabsList,{className:"grid w-full grid-cols-2",children:[(0,t.jsxs)(l.TabsTrigger,{value:"ctr",className:"gap-2",children:[(0,t.jsx)(j,{className:"w-4 h-4"}),"CTR"]}),(0,t.jsxs)(l.TabsTrigger,{value:"cbc",className:"gap-2",children:[(0,t.jsx)(w,{className:"w-4 h-4"}),"CBC"]})]})}),(0,t.jsx)("div",{className:"mt-4 p-3 rounded-lg bg-muted/50 text-sm",children:"ctr"===k?(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium text-primary",children:"Counter Mode (CTR)"}),(0,t.jsxs)("ul",{className:"mt-2 space-y-1 text-muted-foreground text-xs",children:[(0,t.jsx)("li",{children:"• Parallel encryption/decryption"}),(0,t.jsx)("li",{children:"• Random access to encrypted data"}),(0,t.jsx)("li",{children:"• Used in DASH/HLS streaming"}),(0,t.jsx)("li",{children:"• No padding required"})]})]}):(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium text-primary",children:"Cipher Block Chaining (CBC)"}),(0,t.jsxs)("ul",{className:"mt-2 space-y-1 text-muted-foreground text-xs",children:[(0,t.jsx)("li",{children:"• Each block depends on previous"}),(0,t.jsx)("li",{children:"• Better error propagation"}),(0,t.jsx)("li",{children:"• PKCS#7 padding required"}),(0,t.jsx)("li",{children:"• Sequential processing only"})]})]})})]})]}),(0,t.jsxs)(s.Card,{children:[(0,t.jsx)(s.CardHeader,{children:(0,t.jsxs)(s.CardTitle,{className:"text-lg flex items-center gap-2",children:[(0,t.jsx)(m.Key,{className:"w-4 h-4"}),"Cryptographic Parameters"]})}),(0,t.jsxs)(s.CardContent,{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)(h.Label,{className:"text-sm",children:"AES-128 Key"}),(0,t.jsx)(a.Button,{variant:"ghost",size:"sm",onClick:()=>{R((0,N.generateKey)(16)),M(""),K(""),I([])},children:(0,t.jsx)(g.RefreshCw,{className:"w-3 h-3"})})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)("code",{className:"flex-1 text-xs bg-zinc-950 p-2 rounded overflow-hidden text-ellipsis",children:[(0,N.bytesToHex)(S).substring(0,24),"..."]}),(0,t.jsx)(a.Button,{variant:"outline",size:"sm",onClick:()=>G((0,N.bytesToHex)(S)),children:(0,t.jsx)(y.Copy,{className:"w-3 h-3"})})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)(h.Label,{className:"text-sm",children:"ctr"===k?"Nonce/Counter":"IV"}),(0,t.jsx)(a.Button,{variant:"ghost",size:"sm",onClick:()=>{E((0,N.generateKey)(16)),M(""),K(""),I([])},children:(0,t.jsx)(g.RefreshCw,{className:"w-3 h-3"})})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)("code",{className:"flex-1 text-xs bg-zinc-950 p-2 rounded overflow-hidden text-ellipsis",children:[(0,N.bytesToHex)(A).substring(0,24),"..."]}),(0,t.jsx)(a.Button,{variant:"outline",size:"sm",onClick:()=>G((0,N.bytesToHex)(A)),children:(0,t.jsx)(y.Copy,{className:"w-3 h-3"})})]})]}),(0,t.jsx)(d.Separator,{}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)(h.Label,{className:"text-sm",children:"Show Binary"}),(0,t.jsx)(u.Switch,{checked:D,onCheckedChange:$})]})]})]}),(0,t.jsxs)(s.Card,{children:[(0,t.jsx)(s.CardHeader,{children:(0,t.jsx)(s.CardTitle,{className:"text-lg",children:"Input"})}),(0,t.jsxs)(s.CardContent,{className:"space-y-4",children:[(0,t.jsx)(o.Textarea,{placeholder:"Enter plaintext...",value:e,onChange:e=>b(e.target.value),className:"font-mono text-sm",rows:3}),(0,t.jsxs)(a.Button,{onClick:O,disabled:z||!e,className:"w-full gap-2",children:[z?(0,t.jsx)(g.RefreshCw,{className:"w-4 h-4 animate-spin"}):(0,t.jsx)(x.Lock,{className:"w-4 h-4"}),z?"Encrypting...":"Encrypt"]})]})]})]}),(0,t.jsxs)(s.Card,{className:"lg:col-span-2",children:[(0,t.jsxs)(s.CardHeader,{children:[(0,t.jsxs)(s.CardTitle,{className:"text-lg flex items-center gap-2",children:[(0,t.jsx)(C,{className:"w-5 h-5"}),"ctr"===k?"CTR Mode":"CBC Mode"," Encryption Process"]}),(0,t.jsx)(s.CardDescription,{children:"Step-by-step visualization of the encryption process"})]}),(0,t.jsx)(s.CardContent,{children:0===H.length?(0,t.jsxs)("div",{className:"text-center py-16 text-muted-foreground",children:[(0,t.jsx)(x.Lock,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),(0,t.jsx)("p",{children:"Enter plaintext and click Encrypt to see the process"})]}):(0,t.jsx)(c.ScrollArea,{className:"h-[400px] pr-4",children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"p-4 rounded-lg border bg-zinc-950",children:[(0,t.jsx)("div",{className:"text-xs text-muted-foreground mb-2",children:"ctr"===k?"CTR Mode Structure":"CBC Mode Structure"}),(0,t.jsx)("div",{className:"flex items-center justify-center gap-2 text-sm font-mono",children:"ctr"===k?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.Badge,{variant:"outline",children:"Counter"}),(0,t.jsx)(v.ArrowRight,{className:"w-4 h-4"}),(0,t.jsx)(i.Badge,{variant:"secondary",children:"E(K)"}),(0,t.jsx)(v.ArrowRight,{className:"w-4 h-4"}),(0,t.jsx)(i.Badge,{variant:"outline",children:"Keystream"}),(0,t.jsx)("span",{className:"text-primary",children:"⊕"}),(0,t.jsx)(i.Badge,{variant:"outline",children:"Plaintext"}),(0,t.jsx)(v.ArrowRight,{className:"w-4 h-4"}),(0,t.jsx)(i.Badge,{className:"bg-primary",children:"Ciphertext"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.Badge,{variant:"outline",children:"Plaintext"}),(0,t.jsx)("span",{className:"text-primary",children:"⊕"}),(0,t.jsx)(i.Badge,{variant:"outline",children:"IV/Prev"}),(0,t.jsx)(v.ArrowRight,{className:"w-4 h-4"}),(0,t.jsx)(i.Badge,{variant:"secondary",children:"E(K)"}),(0,t.jsx)(v.ArrowRight,{className:"w-4 h-4"}),(0,t.jsx)(i.Badge,{className:"bg-primary",children:"Ciphertext"})]})})]}),H.map((e,r)=>(0,t.jsxs)("div",{className:"p-4 rounded-lg border bg-muted/30",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,t.jsx)(i.Badge,{variant:"outline",children:e.label}),(0,t.jsx)("span",{className:"text-xs text-muted-foreground font-mono",children:e.operation})]}),(0,t.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Input: "}),(0,t.jsx)("code",{className:"text-xs bg-background px-2 py-1 rounded",children:e.input})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Output: "}),(0,t.jsx)("code",{className:"text-xs bg-primary/10 text-primary px-2 py-1 rounded",children:e.output})]})]})]},e.id)),P&&(0,t.jsxs)("div",{className:"p-4 rounded-lg border border-primary/50 bg-primary/5",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,t.jsx)(x.Lock,{className:"w-4 h-4 text-primary"}),(0,t.jsx)("span",{className:"font-medium",children:"Encryption Complete"})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(h.Label,{className:"text-xs text-muted-foreground",children:"Ciphertext (hex)"}),(0,t.jsxs)("div",{className:"flex gap-2 mt-1",children:[(0,t.jsx)("code",{className:"flex-1 text-xs bg-zinc-950 p-2 rounded break-all",children:P}),(0,t.jsx)(a.Button,{variant:"outline",size:"sm",onClick:()=>G(P),children:(0,t.jsx)(y.Copy,{className:"w-3 h-3"})})]})]}),D&&(0,t.jsxs)("div",{children:[(0,t.jsx)(h.Label,{className:"text-xs text-muted-foreground",children:"Ciphertext (binary)"}),(0,t.jsx)("code",{className:"block text-xs bg-zinc-950 p-2 rounded break-all mt-1",children:Array.from((0,N.hexToBytes)(P)).map(e=>e.toString(2).padStart(8,"0")).join(" ")})]}),B&&(0,t.jsxs)("div",{className:"pt-2 border-t",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,t.jsx)(p.Unlock,{className:"w-4 h-4 text-green-500"}),(0,t.jsx)(h.Label,{className:"text-xs text-green-400",children:"Decrypted"})]}),(0,t.jsx)("code",{className:"block text-sm bg-green-500/10 text-green-400 p-2 rounded",children:B})]})]})]})]})})})]})]}),(0,t.jsxs)(s.Card,{className:"mt-6",children:[(0,t.jsx)(s.CardHeader,{children:(0,t.jsx)(s.CardTitle,{className:"text-lg",children:"DRM Encryption in Practice"})}),(0,t.jsx)(s.CardContent,{children:(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[(0,t.jsxs)("div",{className:"p-4 rounded-lg bg-muted/30",children:[(0,t.jsx)("h4",{className:"font-medium mb-2",children:"Widevine"}),(0,t.jsx)("p",{className:"text-muted-foreground text-xs",children:"Uses AES-128 CTR for video encryption. Each segment has a unique IV derived from segment number, enabling efficient seeking in encrypted streams."})]}),(0,t.jsxs)("div",{className:"p-4 rounded-lg bg-muted/30",children:[(0,t.jsx)("h4",{className:"font-medium mb-2",children:"FairPlay"}),(0,t.jsx)("p",{className:"text-muted-foreground text-xs",children:"Apple's system uses AES-128 CBC for HLS content. Keys are rotated periodically and delivered via secure session with the device."})]}),(0,t.jsxs)("div",{className:"p-4 rounded-lg bg-muted/30",children:[(0,t.jsx)("h4",{className:"font-medium mb-2",children:"PlayReady"}),(0,t.jsx)("p",{className:"text-muted-foreground text-xs",children:"Microsoft's DRM supports both CTR and CBC modes. Often uses AES-128 CTR for DASH streams with per-sample encryption."})]})]})})]})]})}e.s(["default",()=>k],12667)}]);