(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,96622,(e,t,s)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"warnOnce",{enumerable:!0,get:function(){return i}});let i=e=>{}},45511,e=>{"use strict";let t=(0,e.i(27489).default)("lock-open",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]);e.s(["Unlock",()=>t],45511)},69842,e=>{"use strict";let t=(0,e.i(27489).default)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);e.s(["RefreshCw",()=>t],69842)},88549,e=>{"use strict";let t=(0,e.i(27489).default)("shield-x",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m14.5 9.5-5 5",key:"17q4r4"}],["path",{d:"m9.5 9.5 5 5",key:"18nt4w"}]]);e.s(["ShieldX",()=>t],88549)},39043,e=>{"use strict";let t=(0,e.i(27489).default)("shield-alert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]);e.s(["ShieldAlert",()=>t],39043)},19539,e=>{"use strict";let t=(0,e.i(27489).default)("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);e.s(["CheckCircle2",()=>t],19539)},68524,e=>{"use strict";var t=e.i(53811),s=e.i(12140),i=e.i(9799);let r=(0,s.cva)("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function n({className:e,variant:s,...n}){return(0,t.jsx)("div",{"data-slot":"alert",role:"alert",className:(0,i.cn)(r({variant:s}),e),...n})}function o({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"alert-title",className:(0,i.cn)("col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight",e),...s})}function c({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"alert-description",className:(0,i.cn)("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",e),...s})}e.s(["Alert",()=>n,"AlertDescription",()=>c,"AlertTitle",()=>o])},11931,e=>{"use strict";function t(e,t){let s=Math.min(e.length,t.length),i=new Uint8Array(s);for(let r=0;r<s;r++)i[r]=e[r]^t[r];return i}function s(e=16){let t=new Uint8Array(e);if(window.crypto)window.crypto.getRandomValues(t);else for(let s=0;s<e;s++)t[s]=Math.floor(256*Math.random());return t}function i(e){return Array.from(e).map(e=>e.toString(16).padStart(2,"0")).join("")}function r(e){let t=new Uint8Array(e.length/2);for(let s=0;s<t.length;s++)t[s]=parseInt(e.substr(2*s,2),16);return t}function n(e){return new TextEncoder().encode(e)}function o(e){return btoa(String.fromCharCode(...e))}function c(e){return Uint8Array.from(atob(e),e=>e.charCodeAt(0))}function l(e){let t=0;for(let s=0;s<e.length;s++)t=(t<<5)-t+e[s]|0;return Math.abs(t).toString(16).padStart(8,"0")}function a(){let e=i(s(16));return`${e.slice(0,8)}-${e.slice(8,12)}-${e.slice(12,16)}-${e.slice(16,20)}-${e.slice(20,32)}`}class d{key;iv;constructor(e,t){this.key=e,this.iv=t||s(16)}encryptCTR(e){let t=new Uint8Array(e.length);for(let s=0;s<e.length;s+=16){let i=new Uint8Array(16);i.set(this.iv.slice(0,8),0);let r=Math.floor(s/16);for(let e=0;e<8;e++)i[8+e]=r>>8*(7-e)&255;let n=function(e,t){let s=new Uint8Array(e.length);for(let i=0;i<e.length;i++)s[i]=e[i]^t[i%t.length];return s}(i,this.key),o=Math.min(s+16,e.length);for(let i=s;i<o;i++)t[i]=e[i]^n[i-s]}return{ciphertext:t,iv:this.iv}}decryptCTR(e){return this.encryptCTR(e).ciphertext}getIV(){return this.iv}}class u{privateKey;publicKey;modulus;constructor(){this.modulus=3233,this.publicKey=17,this.privateKey=this.modInverse(this.publicKey,3120)}modInverse(e,t){let[s,i]=[e,t],[r,n]=[1,0];for(;0!==i;){let e=Math.floor(s/i);[s,i]=[i,s-e*i],[r,n]=[n,r-e*n]}return(r%t+t)%t}modPow(e,t,s){let i=1;for(e%=s;t>0;)t%2==1&&(i=i*e%s),t=Math.floor(t/2),e=e*e%s;return i}encrypt(e){return this.modPow(e,this.publicKey,this.modulus)}decrypt(e){return this.modPow(e,this.privateKey,this.modulus)}encryptBytes(e){return Array.from(e).map(e=>this.encrypt(e))}decryptBytes(e){return new Uint8Array(e.map(e=>this.decrypt(e)))}getPublicKey(){return{e:this.publicKey,n:this.modulus}}sign(e){return Array.from(n(l(e))).map(e=>this.modPow(e,this.privateKey,this.modulus)).join(",")}verify(e,t){var s;let i=l(e);return s=new Uint8Array(t.split(",").map(Number).map(e=>this.modPow(e,this.publicKey,this.modulus))),new TextDecoder().decode(s)===i}}e.s(["SimpleAsymmetric",()=>u,"SimpleCipher",()=>d,"base64Decode",()=>c,"base64Encode",()=>o,"bytesToHex",()=>i,"generateKey",()=>s,"generateKeyId",()=>a,"hexToBytes",()=>r,"simpleHash",()=>l,"stringToBytes",()=>n,"xorBytes",()=>t])},1504,e=>{"use strict";let t=(0,e.i(27489).default)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);e.s(["XCircle",()=>t],1504)},89616,e=>{"use strict";var t=e.i(83899),s=e.i(58489);function i(e){let[i,r]=t.useState(void 0);return(0,s.useLayoutEffect)(()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});let t=new ResizeObserver(t=>{let s,i;if(!Array.isArray(t)||!t.length)return;let n=t[0];if("borderBoxSize"in n){let e=n.borderBoxSize,t=Array.isArray(e)?e[0]:e;s=t.inlineSize,i=t.blockSize}else s=e.offsetWidth,i=e.offsetHeight;r({width:s,height:i})});return t.observe(e,{box:"border-box"}),()=>t.unobserve(e)}r(void 0)},[e]),i}e.s(["useSize",()=>i])},94756,e=>{"use strict";var t=e.i(83899);function s(e){let s=t.useRef({value:e,previous:e});return t.useMemo(()=>(s.current.value!==e&&(s.current.previous=s.current.value,s.current.value=e),s.current.previous),[e])}e.s(["usePrevious",()=>s])},62297,e=>{"use strict";let t=(0,e.i(27489).default)("server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]);e.s(["Server",()=>t],62297)},81818,e=>{"use strict";let t=(0,e.i(27489).default)("smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);e.s(["Smartphone",()=>t],81818)},54531,e=>{"use strict";let t=(0,e.i(27489).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);e.s(["ArrowLeft",()=>t],54531)},71744,39287,e=>{"use strict";var t=e.i(27489);let s=(0,t.default)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);e.s(["default",()=>s],71744);let i=(0,t.default)("chevron-up",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);e.s(["default",()=>i],39287)},69596,99957,e=>{"use strict";var t=e.i(11931);class s{deviceId;securityLevel;asymmetric;sessions;events;manufacturer;model;constructor(e="L3",s={},i){this.securityLevel=e,this.deviceId=(0,t.generateKeyId)(),this.asymmetric=new t.SimpleAsymmetric,this.sessions=new Map,this.events=s,this.manufacturer=i?.manufacturer||"Mock Devices Inc",this.model=i?.model||`MockCDM-${e}`,this.log(`CDM initialized with security level ${e}`)}log(e,t){this.events.onLog?.(`[CDM] ${e}`,t)}getDeviceCertificate(){let e={deviceId:this.deviceId,securityLevel:this.securityLevel,publicKey:this.asymmetric.getPublicKey(),manufacturer:this.manufacturer,model:this.model,timestamp:Date.now()},s=this.asymmetric.sign((0,t.stringToBytes)(JSON.stringify(e)));return{...e,signature:s}}createSession(e){let s=(0,t.generateKeyId)(),i={sessionId:s,keyIds:e,keys:new Map,state:"created",createdAt:Date.now(),expiresAt:null};return this.sessions.set(s,i),this.log(`Session created: ${s}`,{keyIds:e}),this.events.onSessionCreated?.(i),i}generateLicenseChallenge(e){let s=this.sessions.get(e);if(!s)throw Error(`Session not found: ${e}`);s.state="pending",this.events.onSessionUpdated?.(s);let i={version:1,deviceCertificate:this.getDeviceCertificate(),keyIds:s.keyIds,sessionId:e,nonce:(0,t.bytesToHex)((0,t.generateKey)(16)),timestamp:Date.now()},r=this.asymmetric.sign((0,t.stringToBytes)(JSON.stringify(i))),n={...i,signature:r};return this.log("License challenge generated",{sessionId:e,keyIds:s.keyIds}),n}processLicenseResponse(e){let s=this.sessions.get(e.sessionId);if(!s)throw Error(`Session not found: ${e.sessionId}`);for(let i of(this.log("Processing license response",{sessionId:e.sessionId}),e.keys))if("CONTENT"===i.type){let e=(0,t.base64Decode)(i.key);s.keys.set(i.keyId,e),this.log(`Key added: ${i.keyId}`,{keyLength:e.length,keyHex:"L3"===this.securityLevel?(0,t.bytesToHex)(e):"[PROTECTED]"}),this.events.onKeyAdded?.(s.sessionId,i.keyId)}s.state="active",e.policy.licenseDuration>0&&(s.expiresAt=Date.now()+1e3*e.policy.licenseDuration),this.events.onSessionUpdated?.(s),this.log("Session activated",{sessionId:s.sessionId,keyCount:s.keys.size})}decrypt(e,s,i,r){let n=this.sessions.get(e);if(!n)throw Error(`Session not found: ${e}`);if("active"!==n.state)throw Error(`Session not active: ${n.state}`);let o=n.keys.get(s);if(!o)throw Error(`Key not found: ${s}`);this.log("Decrypting content",{sessionId:e,keyId:s,ciphertextLength:i.length});let c=new t.SimpleCipher(o,r).decryptCTR(i);return"L1"===this.securityLevel?this.log("L1: Decryption in hardware TEE - content protected"):"L2"===this.securityLevel?this.log("L2: Keys in hardware, decryption in software - partially protected"):this.log("L3: Full software decryption - content accessible in memory"),c}getSession(e){return this.sessions.get(e)}closeSession(e){let t=this.sessions.get(e);t&&(t.state="closed",t.keys.clear(),this.sessions.delete(e),this.log("Session closed",{sessionId:e}),this.events.onSessionClosed?.(e))}getSessions(){return Array.from(this.sessions.values())}getSecurityLevel(){return this.securityLevel}getDeviceId(){return this.deviceId}simulateMemoryDump(){if("L1"===this.securityLevel)return this.log("Memory dump blocked - L1 hardware protection"),null;if("L2"===this.securityLevel)return this.log("Memory dump partial - keys in hardware, but decrypted content accessible"),null;this.log("VULNERABILITY: L3 memory dump successful - keys extracted!");let e=new Map;for(let s of this.sessions.values())for(let[i,r]of s.keys)e.set(i,(0,t.bytesToHex)(r));return e}}e.s(["MockCDM",()=>s],69596);let i={serverName:"Mock DRM License Server",enableSecurityCheck:!0,enableDeviceRevocation:!0,defaultPolicy:{canPlay:!0,canPersist:!1,licenseDuration:86400,playbackDuration:14400,renewalDelay:3600}};class r{config;content;revokedDevices;issuedLicenses;asymmetric;events;constructor(e={},s={}){this.config={...i,...e},this.content=new Map,this.revokedDevices=new Set,this.issuedLicenses=new Map,this.asymmetric=new t.SimpleAsymmetric,this.events=s,this.log("License server initialized",{serverName:this.config.serverName})}log(e,t){this.events.onLog?.(`[Server] ${e}`,t)}registerContent(e,s,i="L3",r){let n=(0,t.generateKeyId)(),o={contentId:e,title:s,keyId:n,key:(0,t.generateKey)(16),iv:(0,t.generateKey)(16),requiredSecurityLevel:i,policy:{...this.config.defaultPolicy,...r}};return this.content.set(e,o),this.log("Content registered",{contentId:e,title:s,keyId:n,requiredSecurityLevel:i}),o}getContentInfo(e){let t=this.content.get(e);if(!t)return null;let{key:s,...i}=t;return i}getKeyId(e){return this.content.get(e)?.keyId||null}revokeDevice(e){this.revokedDevices.add(e),this.log("Device revoked",{deviceId:e}),this.events.onDeviceRevoked?.(e)}isDeviceRevoked(e){return this.revokedDevices.has(e)}validateChallenge(e){if(Math.abs(Date.now()-e.timestamp)>3e5)return{valid:!1,reason:"Challenge expired"};let t=e.deviceCertificate;return t.deviceId&&t.securityLevel?this.config.enableDeviceRevocation&&this.isDeviceRevoked(t.deviceId)?{valid:!1,reason:"Device revoked"}:e.keyIds&&0!==e.keyIds.length?{valid:!0}:{valid:!1,reason:"No key IDs requested"}:{valid:!1,reason:"Invalid device certificate"}}checkSecurityLevel(e,t){let s={L1:3,L2:2,L3:1};return s[e]>=s[t]}processLicenseRequest(e,s){this.log("Processing license request",{sessionId:e.sessionId,contentId:s,deviceId:e.deviceCertificate.deviceId,securityLevel:e.deviceCertificate.securityLevel}),this.events.onLicenseRequest?.(e);let i=this.validateChallenge(e);if(!i.valid)return this.log("License request denied",{reason:i.reason}),this.events.onLicenseDenied?.(i.reason,e),{error:i.reason};let r=this.content.get(s);if(!r){let t="Content not found";return this.log("License request denied",{reason:t}),this.events.onLicenseDenied?.(t,e),{error:t}}if(this.config.enableSecurityCheck&&!this.checkSecurityLevel(e.deviceCertificate.securityLevel,r.requiredSecurityLevel)){let t=`Security level too low. Required: ${r.requiredSecurityLevel}, Device: ${e.deviceCertificate.securityLevel}`;return this.log("License request denied",{reason:t}),this.events.onLicenseDenied?.(t,e),{error:t}}let n=[{keyId:r.keyId,key:(0,t.base64Encode)(r.key),iv:(0,t.base64Encode)(r.iv),type:"CONTENT"}],o={version:1,sessionId:e.sessionId,keys:n,policy:r.policy,serverNonce:(0,t.bytesToHex)((0,t.generateKey)(16)),timestamp:Date.now()},c=this.asymmetric.sign((0,t.stringToBytes)(JSON.stringify(o))),l={...o,signature:c};return this.issuedLicenses.set(e.sessionId,{challenge:e,response:l,timestamp:Date.now()}),this.log("License issued",{sessionId:e.sessionId,contentId:s,keyId:r.keyId}),this.events.onLicenseIssued?.(l,r),l}getIssuedLicense(e){return this.issuedLicenses.get(e)}getAllContent(){let e=new Map;for(let[t,s]of this.content){let{key:i,...r}=s;e.set(t,r)}return e}getContentWithKey(e){return this.content.get(e)||null}getStats(){return{serverName:this.config.serverName,registeredContent:this.content.size,issuedLicenses:this.issuedLicenses.size,revokedDevices:this.revokedDevices.size}}}e.s(["MockLicenseServer",()=>r],99957)},96856,e=>{"use strict";let t=(0,e.i(27489).default)("terminal",[["path",{d:"M12 19h8",key:"baeox8"}],["path",{d:"m4 17 6-6-6-6",key:"1yngyt"}]]);e.s(["Terminal",()=>t],96856)}]);