(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,2130,e=>{"use strict";let t=(0,e.i(27489).default)("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);e.s(["Lock",()=>t],2130)},36783,e=>{"use strict";let t=(0,e.i(27489).default)("key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);e.s(["Key",()=>t],36783)},62297,e=>{"use strict";let t=(0,e.i(27489).default)("server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]);e.s(["Server",()=>t],62297)},69842,e=>{"use strict";let t=(0,e.i(27489).default)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);e.s(["RefreshCw",()=>t],69842)},17392,e=>{"use strict";let t=(0,e.i(27489).default)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);e.s(["User",()=>t],17392)},54030,e=>{"use strict";var t=e.i(53811),s=e.i(83899),a=e.i(23376),r=e.i(78349),i=e.i(11350),l=e.i(68524),c=e.i(15004),n=e.i(50985),d=e.i(36783),o=e.i(2130);let h=(0,e.i(27489).default)("arrow-left-right",[["path",{d:"M8 3 4 7l4 4",key:"9rb6wj"}],["path",{d:"M4 7h16",key:"6tx8e3"}],["path",{d:"m16 21 4-4-4-4",key:"siv7j2"}],["path",{d:"M20 17H4",key:"h6l3hr"}]]);var p=e.i(57325),u=e.i(17392),m=e.i(62297),x=e.i(69842),y=e.i(19539),v=e.i(11931);function g(){let[e,g]=(0,s.useState)([]),[j,w]=(0,s.useState)(!1),[b,k]=(0,s.useState)("dh"),f=e=>new Promise(t=>setTimeout(t,e)),S=async()=>{w(!0),g([]),g([{id:"1",actor:"shared",title:"Agree on Parameters",description:"Both parties agree on prime p=23 and generator g=5",value:"p=23, g=5",status:"complete"}]),await f(800);let e=Math.floor(10*Math.random())+1,t=Math.pow(5,e)%23;g(t=>[...t,{id:"2",actor:"client",title:"Client Private Key",description:`Client chooses secret a=${e}`,value:`a = ${e} (secret)`,status:"complete"}]),await f(600),g(s=>[...s,{id:"3",actor:"client",title:"Client Public Key",description:`Client computes A = g^a mod p = 5^${e} mod 23`,value:`A = ${t}`,status:"complete"}]),await f(600);let s=Math.floor(10*Math.random())+1,a=Math.pow(5,s)%23;g(e=>[...e,{id:"4",actor:"server",title:"Server Private Key",description:`Server chooses secret b=${s}`,value:`b = ${s} (secret)`,status:"complete"}]),await f(600),g(e=>[...e,{id:"5",actor:"server",title:"Server Public Key",description:`Server computes B = g^b mod p = 5^${s} mod 23`,value:`B = ${a}`,status:"complete"}]),await f(600),g(e=>[...e,{id:"6",actor:"shared",title:"Exchange Public Keys",description:"Client sends A to server, server sends B to client",value:`Client→Server: ${t}, Server→Client: ${a}`,status:"complete"}]),await f(800);let r=Math.pow(a,e)%23,i=Math.pow(t,s)%23;g(t=>[...t,{id:"7",actor:"client",title:"Client Computes Shared Secret",description:`s = B^a mod p = ${a}^${e} mod 23`,value:`s = ${r}`,status:"complete"}]),await f(600),g(e=>[...e,{id:"8",actor:"server",title:"Server Computes Shared Secret",description:`s = A^b mod p = ${t}^${s} mod 23`,value:`s = ${i}`,status:"complete"}]),await f(600),g(e=>[...e,{id:"9",actor:"shared",title:"Shared Secret Established!",description:`Both parties now share secret ${r} for encryption`,value:r===i?"Secrets Match!":"Error!",status:"complete"}]),w(!1)},N=async()=>{w(!0),g([]),g([{id:"1",actor:"server",title:"Generate RSA Key Pair",description:"Server generates public/private key pair",value:"n=3233, e=17, d=2753",status:"complete"}]),await f(800),g(e=>[...e,{id:"2",actor:"server",title:"Share Public Key",description:"Server sends public key (n, e) to client",value:"Public: (n=3233, e=17)",status:"complete"}]),await f(600);let e=(0,v.bytesToHex)((0,v.generateKey)(16));g(t=>[...t,{id:"3",actor:"client",title:"Generate Session Key",description:"Client generates random AES session key",value:e.substring(0,32)+"...",status:"complete"}]),await f(600),g(e=>[...e,{id:"4",actor:"client",title:"Encrypt Session Key",description:"Client encrypts session key with server public key",value:(0,v.bytesToHex)((0,v.generateKey)(32)).substring(0,32)+"...",status:"complete"}]),await f(600),g(e=>[...e,{id:"5",actor:"shared",title:"Send Encrypted Key",description:"Client sends encrypted session key to server",status:"complete"}]),await f(600),g(t=>[...t,{id:"6",actor:"server",title:"Decrypt Session Key",description:"Server decrypts using private key d",value:e.substring(0,32)+"...",status:"complete"}]),await f(600),g(e=>[...e,{id:"7",actor:"shared",title:"Secure Channel Established!",description:"Both parties share the AES session key",value:"Keys Match!",status:"complete"}]),w(!1)};return(0,t.jsxs)("div",{className:"container max-w-6xl py-8",children:[(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsxs)("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[(0,t.jsx)(d.Key,{className:"w-6 h-6 text-primary"}),"Key Exchange Lab"]}),(0,t.jsx)("p",{className:"text-muted-foreground mt-1",children:"Visualize Diffie-Hellman and RSA key exchange protocols"})]}),(0,t.jsxs)(l.Alert,{className:"mb-6",children:[(0,t.jsx)(p.Shield,{className:"h-4 w-4"}),(0,t.jsx)(l.AlertTitle,{children:"How DRM Uses Key Exchange"}),(0,t.jsx)(l.AlertDescription,{children:"DRM systems use key exchange protocols to securely transfer content decryption keys from the license server to the client. This ensures only authorized devices can decrypt content."})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,t.jsxs)(a.Card,{children:[(0,t.jsxs)(a.CardHeader,{children:[(0,t.jsx)(a.CardTitle,{className:"text-lg",children:"Exchange Protocol"}),(0,t.jsx)(a.CardDescription,{children:"Select key exchange method"})]}),(0,t.jsxs)(a.CardContent,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(r.Button,{variant:"dh"===b?"default":"outline",className:"w-full justify-start",onClick:()=>k("dh"),disabled:j,children:[(0,t.jsx)(h,{className:"w-4 h-4 mr-2"}),"Diffie-Hellman"]}),(0,t.jsxs)(r.Button,{variant:"rsa"===b?"default":"outline",className:"w-full justify-start",onClick:()=>k("rsa"),disabled:j,children:[(0,t.jsx)(o.Lock,{className:"w-4 h-4 mr-2"}),"RSA Key Transport"]})]}),(0,t.jsx)(n.Separator,{}),(0,t.jsxs)(r.Button,{onClick:()=>{"dh"===b?S():N()},disabled:j,className:"w-full gap-2",children:[j?(0,t.jsx)(x.RefreshCw,{className:"w-4 h-4 animate-spin"}):(0,t.jsx)(d.Key,{className:"w-4 h-4"}),j?"Running...":"Run Exchange"]}),(0,t.jsxs)("div",{className:"text-xs text-muted-foreground space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(u.User,{className:"w-3 h-3 text-blue-400"})," Client"]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(m.Server,{className:"w-3 h-3 text-purple-400"})," Server"]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(h,{className:"w-3 h-3 text-green-400"})," Shared"]})]})]})]}),(0,t.jsxs)(a.Card,{className:"lg:col-span-2",children:[(0,t.jsxs)(a.CardHeader,{children:[(0,t.jsx)(a.CardTitle,{className:"text-lg",children:"Exchange Process"}),(0,t.jsx)(a.CardDescription,{children:"Step-by-step key exchange visualization"})]}),(0,t.jsx)(a.CardContent,{children:(0,t.jsx)(c.ScrollArea,{className:"h-[400px] pr-4",children:0===e.length?(0,t.jsxs)("div",{className:"text-center py-12 text-muted-foreground",children:[(0,t.jsx)(d.Key,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),(0,t.jsx)("p",{children:"Select a protocol and run the exchange"})]}):(0,t.jsx)("div",{className:"space-y-3",children:e.map((e,s)=>(0,t.jsxs)("div",{className:`p-4 rounded-lg border ${(e=>{switch(e){case"client":return"bg-blue-500/10 border-blue-500/30 text-blue-400";case"server":return"bg-purple-500/10 border-purple-500/30 text-purple-400";case"shared":return"bg-green-500/10 border-green-500/30 text-green-400";default:return""}})(e.actor)}`,children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,t.jsxs)(i.Badge,{variant:"outline",className:"text-xs",children:["Step ",s+1]}),(0,t.jsx)(i.Badge,{variant:"outline",className:"text-xs capitalize",children:e.actor}),"complete"===e.status&&(0,t.jsx)(y.CheckCircle2,{className:"w-4 h-4 text-green-500 ml-auto"})]}),(0,t.jsx)("h4",{className:"font-medium",children:e.title}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:e.description}),e.value&&(0,t.jsx)("code",{className:"text-xs bg-background/50 px-2 py-1 rounded mt-2 inline-block",children:e.value})]},e.id))})})})]})]})]})}e.s(["default",()=>g],54030)}]);