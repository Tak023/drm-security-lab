(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,36783,e=>{"use strict";let t=(0,e.i(27489).default)("key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);e.s(["Key",()=>t],36783)},3189,e=>{"use strict";let t=(0,e.i(27489).default)("sword",[["path",{d:"m11 19-6-6",key:"s7kpr"}],["path",{d:"m5 21-2-2",key:"1kw20b"}],["path",{d:"m8 16-4 4",key:"1oqv8h"}],["path",{d:"M9.5 17.5 21 6V3h-3L6.5 14.5",key:"pkxemp"}]]);e.s(["Sword",()=>t],3189)},68524,e=>{"use strict";var t=e.i(53811),s=e.i(12140),r=e.i(9799);let a=(0,s.cva)("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function i({className:e,variant:s,...i}){return(0,t.jsx)("div",{"data-slot":"alert",role:"alert",className:(0,r.cn)(a({variant:s}),e),...i})}function n({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"alert-title",className:(0,r.cn)("col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight",e),...s})}function l({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"alert-description",className:(0,r.cn)("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",e),...s})}e.s(["Alert",()=>i,"AlertDescription",()=>l,"AlertTitle",()=>n])},11931,e=>{"use strict";function t(e,t){let s=Math.min(e.length,t.length),r=new Uint8Array(s);for(let a=0;a<s;a++)r[a]=e[a]^t[a];return r}function s(e=16){let t=new Uint8Array(e);if(window.crypto)window.crypto.getRandomValues(t);else for(let s=0;s<e;s++)t[s]=Math.floor(256*Math.random());return t}function r(e){return Array.from(e).map(e=>e.toString(16).padStart(2,"0")).join("")}function a(e){let t=new Uint8Array(e.length/2);for(let s=0;s<t.length;s++)t[s]=parseInt(e.substr(2*s,2),16);return t}function i(e){return new TextEncoder().encode(e)}function n(e){return btoa(String.fromCharCode(...e))}function l(e){return Uint8Array.from(atob(e),e=>e.charCodeAt(0))}function d(e){let t=0;for(let s=0;s<e.length;s++)t=(t<<5)-t+e[s]|0;return Math.abs(t).toString(16).padStart(8,"0")}function o(){let e=r(s(16));return`${e.slice(0,8)}-${e.slice(8,12)}-${e.slice(12,16)}-${e.slice(16,20)}-${e.slice(20,32)}`}class c{key;iv;constructor(e,t){this.key=e,this.iv=t||s(16)}encryptCTR(e){let t=new Uint8Array(e.length);for(let s=0;s<e.length;s+=16){let r=new Uint8Array(16);r.set(this.iv.slice(0,8),0);let a=Math.floor(s/16);for(let e=0;e<8;e++)r[8+e]=a>>8*(7-e)&255;let i=function(e,t){let s=new Uint8Array(e.length);for(let r=0;r<e.length;r++)s[r]=e[r]^t[r%t.length];return s}(r,this.key),n=Math.min(s+16,e.length);for(let r=s;r<n;r++)t[r]=e[r]^i[r-s]}return{ciphertext:t,iv:this.iv}}decryptCTR(e){return this.encryptCTR(e).ciphertext}getIV(){return this.iv}}class u{privateKey;publicKey;modulus;constructor(){this.modulus=3233,this.publicKey=17,this.privateKey=this.modInverse(this.publicKey,3120)}modInverse(e,t){let[s,r]=[e,t],[a,i]=[1,0];for(;0!==r;){let e=Math.floor(s/r);[s,r]=[r,s-e*r],[a,i]=[i,a-e*i]}return(a%t+t)%t}modPow(e,t,s){let r=1;for(e%=s;t>0;)t%2==1&&(r=r*e%s),t=Math.floor(t/2),e=e*e%s;return r}encrypt(e){return this.modPow(e,this.publicKey,this.modulus)}decrypt(e){return this.modPow(e,this.privateKey,this.modulus)}encryptBytes(e){return Array.from(e).map(e=>this.encrypt(e))}decryptBytes(e){return new Uint8Array(e.map(e=>this.decrypt(e)))}getPublicKey(){return{e:this.publicKey,n:this.modulus}}sign(e){return Array.from(i(d(e))).map(e=>this.modPow(e,this.privateKey,this.modulus)).join(",")}verify(e,t){var s;let r=d(e);return s=new Uint8Array(t.split(",").map(Number).map(e=>this.modPow(e,this.publicKey,this.modulus))),new TextDecoder().decode(s)===r}}e.s(["SimpleAsymmetric",()=>u,"SimpleCipher",()=>c,"base64Decode",()=>l,"base64Encode",()=>n,"bytesToHex",()=>r,"generateKey",()=>s,"generateKeyId",()=>o,"hexToBytes",()=>a,"simpleHash",()=>d,"stringToBytes",()=>i,"xorBytes",()=>t])},34768,e=>{"use strict";var t=e.i(53811),s=e.i(83899),r=e.i(12096),a=e.i(73403),i=e.i(25030),n=e.i(60602),l=e.i(67313),d=e.i(63108),o=e.i(2474),c=e.i(74944),u=e.i(32016),h="rovingFocusGroup.onEntryFocus",m={bubbles:!1,cancelable:!0},x="RovingFocusGroup",[p,g,y]=(0,i.createCollection)(x),[f,v]=(0,a.createContextScope)(x,[y]),[b,j]=f(x),w=s.forwardRef((e,s)=>(0,t.jsx)(p.Provider,{scope:e.__scopeRovingFocusGroup,children:(0,t.jsx)(p.Slot,{scope:e.__scopeRovingFocusGroup,children:(0,t.jsx)(N,{...e,ref:s})})}));w.displayName=x;var N=s.forwardRef((e,a)=>{let{__scopeRovingFocusGroup:i,orientation:l,loop:p=!1,dir:y,currentTabStopId:f,defaultCurrentTabStopId:v,onCurrentTabStopIdChange:j,onEntryFocus:w,preventScrollOnEntryFocus:N=!1,...k}=e,C=s.useRef(null),S=(0,n.useComposedRefs)(a,C),K=(0,u.useDirection)(y),[A,D]=(0,c.useControllableState)({prop:f,defaultProp:v??null,onChange:j,caller:x}),[E,I]=s.useState(!1),M=(0,o.useCallbackRef)(w),L=g(i),R=s.useRef(!1),[B,P]=s.useState(0);return s.useEffect(()=>{let e=C.current;if(e)return e.addEventListener(h,M),()=>e.removeEventListener(h,M)},[M]),(0,t.jsx)(b,{scope:i,orientation:l,dir:K,loop:p,currentTabStopId:A,onItemFocus:s.useCallback(e=>D(e),[D]),onItemShiftTab:s.useCallback(()=>I(!0),[]),onFocusableItemAdd:s.useCallback(()=>P(e=>e+1),[]),onFocusableItemRemove:s.useCallback(()=>P(e=>e-1),[]),children:(0,t.jsx)(d.Primitive.div,{tabIndex:E||0===B?-1:0,"data-orientation":l,...k,ref:S,style:{outline:"none",...e.style},onMouseDown:(0,r.composeEventHandlers)(e.onMouseDown,()=>{R.current=!0}),onFocus:(0,r.composeEventHandlers)(e.onFocus,e=>{let t=!R.current;if(e.target===e.currentTarget&&t&&!E){let t=new CustomEvent(h,m);if(e.currentTarget.dispatchEvent(t),!t.defaultPrevented){let e=L().filter(e=>e.focusable);T([e.find(e=>e.active),e.find(e=>e.id===A),...e].filter(Boolean).map(e=>e.ref.current),N)}}R.current=!1}),onBlur:(0,r.composeEventHandlers)(e.onBlur,()=>I(!1))})})}),k="RovingFocusGroupItem",C=s.forwardRef((e,a)=>{let{__scopeRovingFocusGroup:i,focusable:n=!0,active:o=!1,tabStopId:c,children:u,...h}=e,m=(0,l.useId)(),x=c||m,y=j(k,i),f=y.currentTabStopId===x,v=g(i),{onFocusableItemAdd:b,onFocusableItemRemove:w,currentTabStopId:N}=y;return s.useEffect(()=>{if(n)return b(),()=>w()},[n,b,w]),(0,t.jsx)(p.ItemSlot,{scope:i,id:x,focusable:n,active:o,children:(0,t.jsx)(d.Primitive.span,{tabIndex:f?0:-1,"data-orientation":y.orientation,...h,ref:a,onMouseDown:(0,r.composeEventHandlers)(e.onMouseDown,e=>{n?y.onItemFocus(x):e.preventDefault()}),onFocus:(0,r.composeEventHandlers)(e.onFocus,()=>y.onItemFocus(x)),onKeyDown:(0,r.composeEventHandlers)(e.onKeyDown,e=>{if("Tab"===e.key&&e.shiftKey)return void y.onItemShiftTab();if(e.target!==e.currentTarget)return;let t=function(e,t,s){var r;let a=(r=e.key,"rtl"!==s?r:"ArrowLeft"===r?"ArrowRight":"ArrowRight"===r?"ArrowLeft":r);if(!("vertical"===t&&["ArrowLeft","ArrowRight"].includes(a))&&!("horizontal"===t&&["ArrowUp","ArrowDown"].includes(a)))return S[a]}(e,y.orientation,y.dir);if(void 0!==t){if(e.metaKey||e.ctrlKey||e.altKey||e.shiftKey)return;e.preventDefault();let a=v().filter(e=>e.focusable).map(e=>e.ref.current);if("last"===t)a.reverse();else if("prev"===t||"next"===t){var s,r;"prev"===t&&a.reverse();let i=a.indexOf(e.currentTarget);a=y.loop?(s=a,r=i+1,s.map((e,t)=>s[(r+t)%s.length])):a.slice(i+1)}setTimeout(()=>T(a))}}),children:"function"==typeof u?u({isCurrentTabStop:f,hasTabStop:null!=N}):u})})});C.displayName=k;var S={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function T(e,t=!1){let s=document.activeElement;for(let r of e)if(r===s||(r.focus({preventScroll:t}),document.activeElement!==s))return}var K=e.i(62393),A="Tabs",[D,E]=(0,a.createContextScope)(A,[v]),I=v(),[M,L]=D(A),R=s.forwardRef((e,s)=>{let{__scopeTabs:r,value:a,onValueChange:i,defaultValue:n,orientation:o="horizontal",dir:h,activationMode:m="automatic",...x}=e,p=(0,u.useDirection)(h),[g,y]=(0,c.useControllableState)({prop:a,onChange:i,defaultProp:n??"",caller:A});return(0,t.jsx)(M,{scope:r,baseId:(0,l.useId)(),value:g,onValueChange:y,orientation:o,dir:p,activationMode:m,children:(0,t.jsx)(d.Primitive.div,{dir:p,"data-orientation":o,...x,ref:s})})});R.displayName=A;var B="TabsList",P=s.forwardRef((e,s)=>{let{__scopeTabs:r,loop:a=!0,...i}=e,n=L(B,r),l=I(r);return(0,t.jsx)(w,{asChild:!0,...l,orientation:n.orientation,dir:n.dir,loop:a,children:(0,t.jsx)(d.Primitive.div,{role:"tablist","aria-orientation":n.orientation,...i,ref:s})})});P.displayName=B;var H="TabsTrigger",U=s.forwardRef((e,s)=>{let{__scopeTabs:a,value:i,disabled:n=!1,...l}=e,o=L(H,a),c=I(a),u=q(o.baseId,i),h=V(o.baseId,i),m=i===o.value;return(0,t.jsx)(C,{asChild:!0,...c,focusable:!n,active:m,children:(0,t.jsx)(d.Primitive.button,{type:"button",role:"tab","aria-selected":m,"aria-controls":h,"data-state":m?"active":"inactive","data-disabled":n?"":void 0,disabled:n,id:u,...l,ref:s,onMouseDown:(0,r.composeEventHandlers)(e.onMouseDown,e=>{n||0!==e.button||!1!==e.ctrlKey?e.preventDefault():o.onValueChange(i)}),onKeyDown:(0,r.composeEventHandlers)(e.onKeyDown,e=>{[" ","Enter"].includes(e.key)&&o.onValueChange(i)}),onFocus:(0,r.composeEventHandlers)(e.onFocus,()=>{let e="manual"!==o.activationMode;m||n||!e||o.onValueChange(i)})})})});U.displayName=H;var F="TabsContent",$=s.forwardRef((e,r)=>{let{__scopeTabs:a,value:i,forceMount:n,children:l,...o}=e,c=L(F,a),u=q(c.baseId,i),h=V(c.baseId,i),m=i===c.value,x=s.useRef(m);return s.useEffect(()=>{let e=requestAnimationFrame(()=>x.current=!1);return()=>cancelAnimationFrame(e)},[]),(0,t.jsx)(K.Presence,{present:n||m,children:({present:s})=>(0,t.jsx)(d.Primitive.div,{"data-state":m?"active":"inactive","data-orientation":c.orientation,role:"tabpanel","aria-labelledby":u,hidden:!s,id:h,tabIndex:0,...o,ref:r,style:{...e.style,animationDuration:x.current?"0s":void 0},children:s&&l})})});function q(e,t){return`${e}-trigger-${t}`}function V(e,t){return`${e}-content-${t}`}$.displayName=F;var z=e.i(9799);function G({className:e,...s}){return(0,t.jsx)(R,{"data-slot":"tabs",className:(0,z.cn)("flex flex-col gap-2",e),...s})}function _({className:e,...s}){return(0,t.jsx)(P,{"data-slot":"tabs-list",className:(0,z.cn)("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",e),...s})}function O({className:e,...s}){return(0,t.jsx)(U,{"data-slot":"tabs-trigger",className:(0,z.cn)("data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...s})}function Y({className:e,...s}){return(0,t.jsx)($,{"data-slot":"tabs-content",className:(0,z.cn)("flex-1 outline-none",e),...s})}e.s(["Tabs",()=>G,"TabsContent",()=>Y,"TabsList",()=>_,"TabsTrigger",()=>O],34768)},49371,e=>{"use strict";let t=(0,e.i(27489).default)("copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);e.s(["Copy",()=>t],49371)},83379,e=>{"use strict";let t=(0,e.i(27489).default)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]);e.s(["Download",()=>t],83379)},51204,34671,e=>{"use strict";var t=e.i(27489);let s=(0,t.default)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]);e.s(["Users",()=>s],51204);let r=(0,t.default)("globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);e.s(["Globe",()=>r],34671)},44064,e=>{"use strict";var t=e.i(53811),s=e.i(83899),r=e.i(23376),a=e.i(78349),i=e.i(11350),n=e.i(68524),l=e.i(34768),d=e.i(15004),o=e.i(50985),c=e.i(10914),u=e.i(57325),h=e.i(3189),m=e.i(36783),x=e.i(51204);let p=(0,e.i(27489).default)("share-2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);var g=e.i(34671),y=e.i(49371),f=e.i(83379),v=e.i(80042),b=e.i(11931);function j(){let{perspective:e}=(0,v.usePerspective)(),[j,w]=(0,s.useState)([]),[N,k]=(0,s.useState)([{id:"1",name:"Alice",type:"legitimate",hasLicense:!0,usingSharedKey:!1},{id:"2",name:"Bob",type:"pirate",hasLicense:!1,usingSharedKey:!1},{id:"3",name:"Charlie",type:"pirate",hasLicense:!1,usingSharedKey:!1},{id:"4",name:"Diana",type:"legitimate",hasLicense:!0,usingSharedKey:!1}]),[C,S]=(0,s.useState)([]),[T,K]=(0,s.useState)("none"),[A,D]=(0,s.useState)(!1),[E,I]=(0,s.useState)(new Set),M=(0,s.useCallback)(e=>{S(t=>[...t,`[${new Date().toLocaleTimeString()}] ${e}`])},[]);return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[(0,t.jsx)(p,{className:"w-6 h-6 text-red-500"}),"Key Sharing Attack"]}),(0,t.jsx)("p",{className:"text-muted-foreground mt-1",children:"Simulate content key sharing and redistribution attacks"})]}),(0,t.jsx)(i.Badge,{variant:"red-team"===e?"destructive":"default",children:"red-team"===e?"Attack Mode":"Defense Analysis"})]}),(0,t.jsxs)(n.Alert,{variant:"destructive",children:[(0,t.jsx)(c.AlertTriangle,{className:"h-4 w-4"}),(0,t.jsx)(n.AlertTitle,{children:"Educational Simulation Only"}),(0,t.jsx)(n.AlertDescription,{children:"This simulates key sharing for educational purposes. Sharing copyrighted content keys is illegal."})]}),(0,t.jsxs)(l.Tabs,{defaultValue:"simulation",className:"space-y-4",children:[(0,t.jsxs)(l.TabsList,{children:[(0,t.jsxs)(l.TabsTrigger,{value:"simulation",className:"gap-2",children:[(0,t.jsx)(x.Users,{className:"w-4 h-4"}),"Simulation"]}),(0,t.jsxs)(l.TabsTrigger,{value:"defense",className:"gap-2",children:[(0,t.jsx)(u.Shield,{className:"w-4 h-4"}),"Defense"]}),(0,t.jsxs)(l.TabsTrigger,{value:"technical",className:"gap-2",children:[(0,t.jsx)(m.Key,{className:"w-4 h-4"}),"Technical"]})]}),(0,t.jsxs)(l.TabsContent,{value:"simulation",className:"space-y-4",children:[(0,t.jsxs)(r.Card,{children:[(0,t.jsxs)(r.CardHeader,{children:[(0,t.jsx)(r.CardTitle,{className:"text-lg",children:"Scenario Controls"}),(0,t.jsx)(r.CardDescription,{children:"Run key sharing attack simulation"})]}),(0,t.jsx)(r.CardContent,{children:(0,t.jsxs)("div",{className:"flex gap-3 flex-wrap",children:[(0,t.jsxs)(a.Button,{onClick:()=>{K("sharing"),M("Alice (legitimate user) extracts key from her L3 device...");let e=(0,b.bytesToHex)((0,b.generateKey)(8)),t=(0,b.bytesToHex)((0,b.generateKey)(16));setTimeout(()=>{let s={keyId:e,key:t,contentId:"premium-movie-2024",sharedBy:"Alice",timestamp:Date.now(),downloads:0};w(e=>[...e,s]),M(`Key extracted: ${e.substring(0,8)}...`),M("Alice shares key on underground forum...")},1e3)},variant:"destructive",disabled:j.length>0,className:"gap-2",children:[(0,t.jsx)(h.Sword,{className:"w-4 h-4"}),"Extract & Share Key"]}),(0,t.jsxs)(a.Button,{onClick:()=>{K("detection"),D(!0),M("Enabling anomaly detection system..."),M("Monitoring: License-to-playback correlation"),M("Monitoring: Geographic impossibility checks"),M("Monitoring: Device fingerprint analysis"),N.forEach(e=>{e.usingSharedKey&&setTimeout(()=>{M(`DETECTED: ${e.name} - No license but decrypting content`),M(`ACTION: Revoking access for ${e.name}`),I(t=>new Set([...t,e.id])),k(t=>t.map(t=>t.id===e.id?{...t,usingSharedKey:!1}:t))},1e3)})},variant:"default",disabled:A,className:"gap-2",children:[(0,t.jsx)(u.Shield,{className:"w-4 h-4"}),"Enable Detection"]}),(0,t.jsx)(a.Button,{onClick:()=>{w([]),k([{id:"1",name:"Alice",type:"legitimate",hasLicense:!0,usingSharedKey:!1},{id:"2",name:"Bob",type:"pirate",hasLicense:!1,usingSharedKey:!1},{id:"3",name:"Charlie",type:"pirate",hasLicense:!1,usingSharedKey:!1},{id:"4",name:"Diana",type:"legitimate",hasLicense:!0,usingSharedKey:!1}]),S([]),K("none"),D(!1),I(new Set)},variant:"outline",className:"gap-2",children:"Reset"})]})})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[(0,t.jsxs)(r.Card,{children:[(0,t.jsxs)(r.CardHeader,{children:[(0,t.jsxs)(r.CardTitle,{className:"text-lg flex items-center gap-2",children:[(0,t.jsx)(g.Globe,{className:"w-5 h-5 text-red-500"}),"Underground Forum"]}),(0,t.jsx)(r.CardDescription,{children:"Shared decryption keys"})]}),(0,t.jsx)(r.CardContent,{children:0===j.length?(0,t.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,t.jsx)(m.Key,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),(0,t.jsx)("p",{className:"text-sm",children:"No keys shared yet"})]}):(0,t.jsx)("div",{className:"space-y-3",children:j.map((e,s)=>(0,t.jsxs)("div",{className:"rounded-lg border border-red-500/30 bg-red-500/10 p-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)("span",{className:"text-sm font-medium text-red-400",children:e.contentId}),(0,t.jsxs)(i.Badge,{variant:"outline",className:"text-xs",children:[e.downloads," downloads"]})]}),(0,t.jsxs)("div",{className:"text-xs space-y-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Key ID:"}),(0,t.jsxs)("code",{className:"bg-background px-1 rounded",children:[e.keyId.substring(0,16),"..."]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Key:"}),(0,t.jsxs)("code",{className:"bg-background px-1 rounded",children:[e.key.substring(0,16),"..."]}),(0,t.jsx)(a.Button,{variant:"ghost",size:"icon",className:"h-5 w-5",children:(0,t.jsx)(y.Copy,{className:"w-3 h-3"})})]}),(0,t.jsxs)("div",{className:"text-muted-foreground",children:["Shared by: ",e.sharedBy]})]})]},s))})})]}),(0,t.jsxs)(r.Card,{children:[(0,t.jsxs)(r.CardHeader,{children:[(0,t.jsxs)(r.CardTitle,{className:"text-lg flex items-center gap-2",children:[(0,t.jsx)(x.Users,{className:"w-5 h-5"}),"Users"]}),(0,t.jsx)(r.CardDescription,{children:"Simulated user behavior"})]}),(0,t.jsx)(r.CardContent,{children:(0,t.jsx)("div",{className:"space-y-3",children:N.map(e=>(0,t.jsxs)("div",{className:`rounded-lg border p-3 ${E.has(e.id)?"border-red-500 bg-red-500/10":e.usingSharedKey?"border-yellow-500 bg-yellow-500/10":e.hasLicense?"border-green-500/30 bg-green-500/5":"border-border"}`,children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)("span",{className:"font-medium",children:e.name}),(0,t.jsxs)("div",{className:"flex gap-1",children:[e.hasLicense&&(0,t.jsx)(i.Badge,{variant:"outline",className:"text-xs text-green-500 border-green-500",children:"Licensed"}),e.usingSharedKey&&(0,t.jsx)(i.Badge,{variant:"outline",className:"text-xs text-yellow-500 border-yellow-500",children:"Pirating"}),E.has(e.id)&&(0,t.jsx)(i.Badge,{variant:"destructive",className:"text-xs",children:"Blocked"})]})]}),!e.hasLicense&&j.length>0&&!E.has(e.id)&&(0,t.jsxs)(a.Button,{size:"sm",variant:"outline",onClick:()=>(e=>{let t=N.find(t=>t.id===e);if(t&&!t.hasLicense){if(E.has(e))return void M(`${t.name} is blocked from the service!`);M(`${t.name} downloads shared key...`),k(t=>t.map(t=>t.id===e?{...t,usingSharedKey:!0}:t)),w(e=>e.map(e=>({...e,downloads:e.downloads+1}))),A?setTimeout(()=>{M(`ANOMALY DETECTED: ${t.name} using key without valid license!`),M(`Blocking user ${t.name}...`),I(t=>new Set([...t,e])),k(t=>t.map(t=>t.id===e?{...t,usingSharedKey:!1}:t))},1500):M(`${t.name} is now watching content for free!`)}})(e.id),disabled:e.usingSharedKey,className:"w-full gap-2 mt-2",children:[(0,t.jsx)(f.Download,{className:"w-3 h-3"}),e.usingSharedKey?"Already Using Key":"Download Shared Key"]})]},e.id))})})]}),(0,t.jsxs)(r.Card,{children:[(0,t.jsxs)(r.CardHeader,{children:[(0,t.jsx)(r.CardTitle,{className:"text-lg",children:"Event Log"}),(0,t.jsx)(r.CardDescription,{children:"Real-time activity"})]}),(0,t.jsx)(r.CardContent,{children:(0,t.jsx)(d.ScrollArea,{className:"h-[300px] rounded-lg border bg-zinc-950 p-3",children:0===C.length?(0,t.jsx)("div",{className:"text-center text-muted-foreground text-sm py-8",children:"Start simulation to see events..."}):(0,t.jsx)("div",{className:"space-y-1 font-mono text-xs",children:C.map((e,s)=>(0,t.jsx)("div",{className:e.includes("DETECTED")||e.includes("ANOMALY")?"text-red-400":e.includes("ACTION")||e.includes("Blocking")?"text-yellow-400":e.includes("Enabling")?"text-blue-400":e.includes("free")||e.includes("shares")?"text-orange-400":"text-muted-foreground",children:e},s))})})})]})]})]}),(0,t.jsx)(l.TabsContent,{value:"defense",className:"space-y-4",children:(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)(r.Card,{children:[(0,t.jsx)(r.CardHeader,{children:(0,t.jsxs)(r.CardTitle,{className:"flex items-center gap-2",children:[(0,t.jsx)(u.Shield,{className:"w-5 h-5 text-blue-500"}),"Prevention Strategies"]})}),(0,t.jsx)(r.CardContent,{className:"space-y-4",children:(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"p-3 rounded-lg border bg-green-500/10 border-green-500/30",children:[(0,t.jsx)("h4",{className:"font-medium text-green-400 mb-1",children:"Device Binding"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Bind licenses to specific device fingerprints. Keys won't work on different devices even if extracted."})]}),(0,t.jsxs)("div",{className:"p-3 rounded-lg border bg-blue-500/10 border-blue-500/30",children:[(0,t.jsx)("h4",{className:"font-medium text-blue-400 mb-1",children:"Session-Based Keys"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Generate unique keys per session with short validity periods. Shared keys expire quickly."})]}),(0,t.jsxs)("div",{className:"p-3 rounded-lg border bg-purple-500/10 border-purple-500/30",children:[(0,t.jsx)("h4",{className:"font-medium text-purple-400 mb-1",children:"Forensic Watermarking"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Embed unique identifiers per user/session in the content. Trace leaked content back to source."})]})]})})]}),(0,t.jsxs)(r.Card,{children:[(0,t.jsx)(r.CardHeader,{children:(0,t.jsxs)(r.CardTitle,{className:"flex items-center gap-2",children:[(0,t.jsx)(c.AlertTriangle,{className:"w-5 h-5 text-yellow-500"}),"Detection Methods"]})}),(0,t.jsx)(r.CardContent,{className:"space-y-4",children:(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"p-3 rounded-lg border",children:[(0,t.jsx)("h4",{className:"font-medium mb-1",children:"License Correlation"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Monitor for playback without corresponding license acquisition. Detect decryption using keys from other devices."})]}),(0,t.jsxs)("div",{className:"p-3 rounded-lg border",children:[(0,t.jsx)("h4",{className:"font-medium mb-1",children:"Geographic Analysis"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Detect impossible scenarios like the same key being used in different countries simultaneously."})]}),(0,t.jsxs)("div",{className:"p-3 rounded-lg border",children:[(0,t.jsx)("h4",{className:"font-medium mb-1",children:"Key Usage Monitoring"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Track how many unique devices use each key. Unusual spikes indicate key sharing."})]})]})})]})]})}),(0,t.jsx)(l.TabsContent,{value:"technical",className:"space-y-4",children:(0,t.jsxs)(r.Card,{children:[(0,t.jsxs)(r.CardHeader,{children:[(0,t.jsx)(r.CardTitle,{children:"Key Sharing Ecosystem"}),(0,t.jsx)(r.CardDescription,{children:"How key sharing networks operate"})]}),(0,t.jsx)(r.CardContent,{className:"prose prose-invert max-w-none",children:(0,t.jsxs)("div",{className:"space-y-4 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-medium mb-2",children:"The Key Sharing Process"}),(0,t.jsxs)("ol",{className:"list-decimal pl-4 text-muted-foreground space-y-2",children:[(0,t.jsxs)("li",{children:[(0,t.jsx)("strong",{children:"Key Extraction:"})," A user with a legitimate license extracts the decryption key from their L3 device using memory dump techniques"]}),(0,t.jsxs)("li",{children:[(0,t.jsx)("strong",{children:"Distribution:"})," The extracted key (and Key ID) are shared on underground forums, private groups, or automated key servers"]}),(0,t.jsxs)("li",{children:[(0,t.jsx)("strong",{children:"Consumption:"})," Pirates download the shared key and use it in modified players to decrypt content without paying"]}),(0,t.jsxs)("li",{children:[(0,t.jsx)("strong",{children:"Scaling:"})," Automated systems can request licenses, extract keys, and share them in near real-time"]})]})]}),(0,t.jsx)(o.Separator,{}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-medium mb-2",children:"Key Server Infrastructure"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:'Sophisticated piracy operations run "key servers" that automatically:'}),(0,t.jsxs)("ul",{className:"list-disc pl-4 text-muted-foreground space-y-1 mt-2",children:[(0,t.jsx)("li",{children:"Request licenses from content providers using legitimate accounts"}),(0,t.jsx)("li",{children:"Extract keys using automated CDM exploitation tools"}),(0,t.jsx)("li",{children:"Store and index keys by content ID for quick lookup"}),(0,t.jsx)("li",{children:"Serve keys to pirate player applications on demand"})]})]}),(0,t.jsx)(o.Separator,{}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-medium mb-2",children:"Impact and Scale"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Key sharing is one of the most damaging forms of DRM circumvention because:"}),(0,t.jsxs)("ul",{className:"list-disc pl-4 text-muted-foreground space-y-1 mt-2",children:[(0,t.jsx)("li",{children:"A single extracted key can enable unlimited piracy"}),(0,t.jsx)("li",{children:"Keys can be shared instantly worldwide"}),(0,t.jsx)("li",{children:"Content remains in original quality (no re-encoding losses)"}),(0,t.jsx)("li",{children:"Harder to trace than screen recording"})]})]})]})})]})})]})]})}e.s(["KeySharingLab",()=>j],44064)}]);