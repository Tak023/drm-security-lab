{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/components/ui/badge.tsx"],"sourcesContent":["import * as React from \"react\";\nimport { Slot } from \"@radix-ui/react-slot\";\nimport { cva, type VariantProps } from \"class-variance-authority\";\nimport { cn } from \"@/lib/utils\";\n\nconst badgeVariants = cva(\n  \"inline-flex items-center justify-center rounded-full border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none transition-colors\",\n  {\n    variants: {\n      variant: {\n        default: \"border-transparent bg-primary text-primary-foreground\",\n        secondary: \"border-transparent bg-secondary text-secondary-foreground\",\n        destructive: \"border-transparent bg-destructive text-white\",\n        outline: \"text-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n);\n\nexport interface BadgeProps\n  extends React.HTMLAttributes<HTMLSpanElement>,\n    VariantProps<typeof badgeVariants> {\n  asChild?: boolean;\n}\n\nfunction Badge({ className, variant, asChild = false, ...props }: BadgeProps) {\n  const Comp = asChild ? Slot : \"span\";\n  return (\n    <Comp\n      data-slot=\"badge\"\n      className={cn(badgeVariants({ variant }), className)}\n      {...props}\n    />\n  );\n}\n\nexport { Badge, badgeVariants };\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAFA;;;;;AAIA,MAAM,gBAAgB,CAAA,GAAA,mKAAA,CAAA,MAAG,AAAD,EACtB,mMACA;IACE,UAAU;QACR,SAAS;YACP,SAAS;YACT,WAAW;YACX,aAAa;YACb,SAAS;QACX;IACF;IACA,iBAAiB;QACf,SAAS;IACX;AACF;AASF,SAAS,MAAM,EAAE,SAAS,EAAE,OAAO,EAAE,UAAU,KAAK,EAAE,GAAG,OAAmB;IAC1E,MAAM,OAAO,UAAU,mKAAA,CAAA,OAAI,GAAG;IAC9B,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EAAE,cAAc;YAAE;QAAQ,IAAI;QACzC,GAAG,KAAK;;;;;;AAGf;KATS"}},
    {"offset": {"line": 53, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 59, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/components/ui/card.tsx"],"sourcesContent":["import * as React from \"react\";\nimport { cn } from \"@/lib/utils\";\n\nfunction Card({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      data-slot=\"card\"\n      className={cn(\n        \"bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm\",\n        className\n      )}\n      {...props}\n    />\n  );\n}\n\nfunction CardHeader({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      data-slot=\"card-header\"\n      className={cn(\"flex flex-col gap-2 px-6\", className)}\n      {...props}\n    />\n  );\n}\n\nfunction CardTitle({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      data-slot=\"card-title\"\n      className={cn(\"leading-none font-semibold\", className)}\n      {...props}\n    />\n  );\n}\n\nfunction CardDescription({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      data-slot=\"card-description\"\n      className={cn(\"text-muted-foreground text-sm\", className)}\n      {...props}\n    />\n  );\n}\n\nfunction CardContent({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      data-slot=\"card-content\"\n      className={cn(\"px-6\", className)}\n      {...props}\n    />\n  );\n}\n\nfunction CardFooter({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      data-slot=\"card-footer\"\n      className={cn(\"flex items-center px-6\", className)}\n      {...props}\n    />\n  );\n}\n\nexport { Card, CardHeader, CardTitle, CardDescription, CardContent, CardFooter };\n"],"names":[],"mappings":";;;;;;;;;AACA;;;AAEA,SAAS,KAAK,EAAE,SAAS,EAAE,GAAG,OAA6C;IACzE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EACV,qFACA;QAED,GAAG,KAAK;;;;;;AAGf;KAXS;AAaT,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAA6C;IAC/E,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EAAE,4BAA4B;QACzC,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,UAAU,EAAE,SAAS,EAAE,GAAG,OAA6C;IAC9E,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EAAE,8BAA8B;QAC3C,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,gBAAgB,EAAE,SAAS,EAAE,GAAG,OAA6C;IACpF,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EAAE,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,YAAY,EAAE,SAAS,EAAE,GAAG,OAA6C;IAChF,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EAAE,QAAQ;QACrB,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAA6C;IAC/E,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EAAE,0BAA0B;QACvC,GAAG,KAAK;;;;;;AAGf;MARS"}},
    {"offset": {"line": 154, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 160, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/lib/crypto.ts"],"sourcesContent":["// Simple crypto utilities for educational demonstrations\n// NOT for production use - these are simplified for learning\n\nexport function generatePrime(bits: number = 8): number {\n  // Generate a simple prime for demonstration\n  const primes = [17, 19, 23, 29, 31, 37, 41, 43, 47, 53, 59, 61, 67, 71, 73, 79, 83, 89, 97];\n  return primes[Math.floor(Math.random() * primes.length)];\n}\n\nexport function generateGenerator(prime: number): number {\n  // Simple generator for the prime\n  return Math.floor(Math.random() * (prime - 2)) + 2;\n}\n\nexport function generatePrivateKey(prime: number): number {\n  return Math.floor(Math.random() * (prime - 2)) + 2;\n}\n\nexport function modPow(base: number, exp: number, mod: number): number {\n  let result = 1;\n  base = base % mod;\n  while (exp > 0) {\n    if (exp % 2 === 1) {\n      result = (result * base) % mod;\n    }\n    exp = Math.floor(exp / 2);\n    base = (base * base) % mod;\n  }\n  return result;\n}\n\nexport function computePublicKey(g: number, privateKey: number, p: number): number {\n  return modPow(g, privateKey, p);\n}\n\nexport function computeSharedSecret(otherPublicKey: number, privateKey: number, p: number): number {\n  return modPow(otherPublicKey, privateKey, p);\n}\n\n// Simple XOR encryption for demonstration\nexport function xorEncrypt(data: string, key: number): string {\n  return data\n    .split('')\n    .map((char) => String.fromCharCode(char.charCodeAt(0) ^ (key % 256)))\n    .join('');\n}\n\nexport function xorDecrypt(data: string, key: number): string {\n  return xorEncrypt(data, key); // XOR is symmetric\n}\n\n// Simple AES-like block cipher demonstration (NOT real AES)\nexport function simpleBlockEncrypt(plaintext: string, key: number): string {\n  const keyBytes = key.toString(16).padStart(8, '0');\n  let result = '';\n  for (let i = 0; i < plaintext.length; i++) {\n    const keyByte = parseInt(keyBytes[i % keyBytes.length], 16);\n    result += String.fromCharCode((plaintext.charCodeAt(i) + keyByte) % 256);\n  }\n  return btoa(result);\n}\n\nexport function simpleBlockDecrypt(ciphertext: string, key: number): string {\n  const keyBytes = key.toString(16).padStart(8, '0');\n  const decoded = atob(ciphertext);\n  let result = '';\n  for (let i = 0; i < decoded.length; i++) {\n    const keyByte = parseInt(keyBytes[i % keyBytes.length], 16);\n    result += String.fromCharCode((decoded.charCodeAt(i) - keyByte + 256) % 256);\n  }\n  return result;\n}\n\n// Generate a random hex key\nexport function generateHexKey(length: number = 32): string {\n  const chars = '0123456789abcdef';\n  let result = '';\n  for (let i = 0; i < length; i++) {\n    result += chars[Math.floor(Math.random() * chars.length)];\n  }\n  return result;\n}\n\n// Derive a key using simple HKDF-like function\nexport function deriveKey(masterKey: string, salt: string, info: string): string {\n  let hash = 0;\n  const combined = masterKey + salt + info;\n  for (let i = 0; i < combined.length; i++) {\n    const char = combined.charCodeAt(i);\n    hash = ((hash << 5) - hash) + char;\n    hash = hash & hash;\n  }\n  return Math.abs(hash).toString(16).padStart(16, '0');\n}\n\n// Simple RSA-like key generation for demonstration\nexport function generateRSAKeyPair(): { publicKey: { n: number; e: number }; privateKey: { n: number; d: number } } {\n  const p = 61;\n  const q = 53;\n  const n = p * q;\n  const phi = (p - 1) * (q - 1);\n  const e = 17;\n\n  // Calculate d (modular multiplicative inverse of e mod phi)\n  let d = 1;\n  while ((d * e) % phi !== 1) {\n    d++;\n  }\n\n  return {\n    publicKey: { n, e },\n    privateKey: { n, d },\n  };\n}\n\nexport function rsaEncrypt(message: number, publicKey: { n: number; e: number }): number {\n  return modPow(message, publicKey.e, publicKey.n);\n}\n\nexport function rsaDecrypt(ciphertext: number, privateKey: { n: number; d: number }): number {\n  return modPow(ciphertext, privateKey.d, privateKey.n);\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 303, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 309, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/components/labs/KeyExchangeLab.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState, useCallback } from \"react\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport {\n  RefreshCw,\n  Play,\n  Lock,\n  Key,\n  ArrowRight,\n  ArrowDown,\n  CheckCircle2,\n  Shield,\n  Laptop,\n  Server,\n} from \"lucide-react\";\nimport {\n  generatePrime,\n  generateGenerator,\n  generatePrivateKey,\n  computePublicKey,\n  computeSharedSecret,\n} from \"@/lib/crypto\";\n\ntype Protocol = \"diffie-hellman\" | \"rsa\";\n\ninterface Step {\n  id: number;\n  title: string;\n  description: string;\n  clientValue?: string;\n  serverValue?: string;\n  sharedValue?: string;\n  completed: boolean;\n}\n\nexport function KeyExchangeLab() {\n  const [protocol, setProtocol] = useState<Protocol>(\"diffie-hellman\");\n  const [isRunning, setIsRunning] = useState(false);\n  const [currentStep, setCurrentStep] = useState(0);\n  const [steps, setSteps] = useState<Step[]>([]);\n  const [params, setParams] = useState<{\n    p?: number;\n    g?: number;\n    clientPrivate?: number;\n    serverPrivate?: number;\n    clientPublic?: number;\n    serverPublic?: number;\n    sharedSecret?: number;\n  }>({});\n\n  const delay = (ms: number) => new Promise((resolve) => setTimeout(resolve, ms));\n\n  const runDiffieHellman = useCallback(async () => {\n    setIsRunning(true);\n    setSteps([]);\n    setParams({});\n    setCurrentStep(0);\n\n    // Step 1: Generate public parameters\n    const p = generatePrime();\n    const g = generateGenerator(p);\n    setParams((prev) => ({ ...prev, p, g }));\n    setSteps([\n      {\n        id: 1,\n        title: \"Generate Public Parameters\",\n        description: `Both parties agree on public parameters: prime p=${p}, generator g=${g}`,\n        sharedValue: `p=${p}, g=${g}`,\n        completed: true,\n      },\n    ]);\n    setCurrentStep(1);\n    await delay(1000);\n\n    // Step 2: Generate private keys\n    const clientPrivate = generatePrivateKey(p);\n    const serverPrivate = generatePrivateKey(p);\n    setParams((prev) => ({ ...prev, clientPrivate, serverPrivate }));\n    setSteps((prev) => [\n      ...prev,\n      {\n        id: 2,\n        title: \"Generate Private Keys\",\n        description: \"Each party generates a secret private key\",\n        clientValue: `a=${clientPrivate} (secret)`,\n        serverValue: `b=${serverPrivate} (secret)`,\n        completed: true,\n      },\n    ]);\n    setCurrentStep(2);\n    await delay(1000);\n\n    // Step 3: Compute public keys\n    const clientPublic = computePublicKey(g, clientPrivate, p);\n    const serverPublic = computePublicKey(g, serverPrivate, p);\n    setParams((prev) => ({ ...prev, clientPublic, serverPublic }));\n    setSteps((prev) => [\n      ...prev,\n      {\n        id: 3,\n        title: \"Compute Public Keys\",\n        description: `Compute A = g^a mod p and B = g^b mod p`,\n        clientValue: `A = ${g}^${clientPrivate} mod ${p} = ${clientPublic}`,\n        serverValue: `B = ${g}^${serverPrivate} mod ${p} = ${serverPublic}`,\n        completed: true,\n      },\n    ]);\n    setCurrentStep(3);\n    await delay(1000);\n\n    // Step 4: Exchange public keys\n    setSteps((prev) => [\n      ...prev,\n      {\n        id: 4,\n        title: \"Exchange Public Keys\",\n        description: \"Public keys are exchanged over the insecure channel\",\n        clientValue: `Receives B=${serverPublic}`,\n        serverValue: `Receives A=${clientPublic}`,\n        completed: true,\n      },\n    ]);\n    setCurrentStep(4);\n    await delay(1000);\n\n    // Step 5: Compute shared secret\n    const clientShared = computeSharedSecret(serverPublic, clientPrivate, p);\n    const serverShared = computeSharedSecret(clientPublic, serverPrivate, p);\n    setParams((prev) => ({ ...prev, sharedSecret: clientShared }));\n    setSteps((prev) => [\n      ...prev,\n      {\n        id: 5,\n        title: \"Compute Shared Secret\",\n        description: \"Both parties compute the same shared secret!\",\n        clientValue: `s = B^a mod p = ${serverPublic}^${clientPrivate} mod ${p} = ${clientShared}`,\n        serverValue: `s = A^b mod p = ${clientPublic}^${serverPrivate} mod ${p} = ${serverShared}`,\n        sharedValue: clientShared === serverShared ? `Shared Secret: ${clientShared}` : \"ERROR: Secrets don't match!\",\n        completed: true,\n      },\n    ]);\n    setCurrentStep(5);\n    await delay(500);\n\n    // Step 6: Derive session key\n    setSteps((prev) => [\n      ...prev,\n      {\n        id: 6,\n        title: \"Derive Session Key\",\n        description: \"The shared secret is used to derive an AES session key for encryption\",\n        sharedValue: `Session Key: ${clientShared.toString(16).padStart(8, '0').toUpperCase()}`,\n        completed: true,\n      },\n    ]);\n    setCurrentStep(6);\n\n    setIsRunning(false);\n  }, []);\n\n  const reset = () => {\n    setSteps([]);\n    setParams({});\n    setCurrentStep(0);\n    setIsRunning(false);\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Protocol Selector */}\n      <div className=\"flex items-center gap-4\">\n        <span className=\"text-sm font-medium\">Protocol:</span>\n        <div className=\"flex gap-2\">\n          <Button\n            variant={protocol === \"diffie-hellman\" ? \"default\" : \"outline\"}\n            size=\"sm\"\n            onClick={() => {\n              setProtocol(\"diffie-hellman\");\n              reset();\n            }}\n          >\n            Diffie-Hellman\n          </Button>\n          <Button\n            variant={protocol === \"rsa\" ? \"default\" : \"outline\"}\n            size=\"sm\"\n            onClick={() => {\n              setProtocol(\"rsa\");\n              reset();\n            }}\n          >\n            RSA Key Transport\n          </Button>\n        </div>\n      </div>\n\n      {/* Main Visualization */}\n      <div className=\"grid gap-6 lg:grid-cols-3\">\n        {/* Client Side */}\n        <Card className=\"border-blue-500/30 bg-blue-500/5\">\n          <CardHeader className=\"pb-3\">\n            <CardTitle className=\"flex items-center gap-2 text-blue-400\">\n              <Laptop className=\"h-5 w-5\" />\n              Client (CDM)\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-3\">\n            {params.clientPrivate && (\n              <div className=\"rounded-lg bg-blue-500/10 p-3\">\n                <p className=\"text-xs text-muted-foreground\">Private Key (Secret)</p>\n                <p className=\"font-mono text-sm text-blue-400\">a = {params.clientPrivate}</p>\n              </div>\n            )}\n            {params.clientPublic && (\n              <div className=\"rounded-lg bg-blue-500/10 p-3\">\n                <p className=\"text-xs text-muted-foreground\">Public Key</p>\n                <p className=\"font-mono text-sm text-blue-400\">A = {params.clientPublic}</p>\n              </div>\n            )}\n            {params.sharedSecret && (\n              <div className=\"rounded-lg bg-green-500/10 p-3 border border-green-500/30\">\n                <p className=\"text-xs text-muted-foreground\">Computed Secret</p>\n                <p className=\"font-mono text-sm text-green-400\">{params.sharedSecret}</p>\n              </div>\n            )}\n          </CardContent>\n        </Card>\n\n        {/* Exchange Channel */}\n        <Card className=\"border-purple-500/30 bg-purple-500/5\">\n          <CardHeader className=\"pb-3\">\n            <CardTitle className=\"flex items-center gap-2 text-purple-400\">\n              <ArrowRight className=\"h-5 w-5\" />\n              Public Channel\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-3\">\n            {params.p && params.g && (\n              <div className=\"rounded-lg bg-purple-500/10 p-3\">\n                <p className=\"text-xs text-muted-foreground\">Public Parameters</p>\n                <p className=\"font-mono text-sm text-purple-400\">p = {params.p}</p>\n                <p className=\"font-mono text-sm text-purple-400\">g = {params.g}</p>\n              </div>\n            )}\n            {params.clientPublic && params.serverPublic && (\n              <div className=\"rounded-lg bg-purple-500/10 p-3\">\n                <p className=\"text-xs text-muted-foreground\">Exchanged Public Keys</p>\n                <div className=\"flex items-center gap-2 text-sm\">\n                  <span className=\"text-blue-400\">A={params.clientPublic}</span>\n                  <ArrowRight className=\"h-3 w-3\" />\n                </div>\n                <div className=\"flex items-center gap-2 text-sm\">\n                  <ArrowRight className=\"h-3 w-3 rotate-180\" />\n                  <span className=\"text-orange-400\">B={params.serverPublic}</span>\n                </div>\n              </div>\n            )}\n            <p className=\"text-xs text-muted-foreground text-center\">\n              An attacker can see these values but cannot derive the shared secret!\n            </p>\n          </CardContent>\n        </Card>\n\n        {/* Server Side */}\n        <Card className=\"border-orange-500/30 bg-orange-500/5\">\n          <CardHeader className=\"pb-3\">\n            <CardTitle className=\"flex items-center gap-2 text-orange-400\">\n              <Server className=\"h-5 w-5\" />\n              License Server\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-3\">\n            {params.serverPrivate && (\n              <div className=\"rounded-lg bg-orange-500/10 p-3\">\n                <p className=\"text-xs text-muted-foreground\">Private Key (Secret)</p>\n                <p className=\"font-mono text-sm text-orange-400\">b = {params.serverPrivate}</p>\n              </div>\n            )}\n            {params.serverPublic && (\n              <div className=\"rounded-lg bg-orange-500/10 p-3\">\n                <p className=\"text-xs text-muted-foreground\">Public Key</p>\n                <p className=\"font-mono text-sm text-orange-400\">B = {params.serverPublic}</p>\n              </div>\n            )}\n            {params.sharedSecret && (\n              <div className=\"rounded-lg bg-green-500/10 p-3 border border-green-500/30\">\n                <p className=\"text-xs text-muted-foreground\">Computed Secret</p>\n                <p className=\"font-mono text-sm text-green-400\">{params.sharedSecret}</p>\n              </div>\n            )}\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Steps Timeline */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center justify-between\">\n            <span>Exchange Process</span>\n            <div className=\"flex gap-2\">\n              <Button\n                onClick={runDiffieHellman}\n                disabled={isRunning}\n                className=\"gap-2\"\n              >\n                {isRunning ? (\n                  <>\n                    <RefreshCw className=\"h-4 w-4 animate-spin\" />\n                    Running...\n                  </>\n                ) : (\n                  <>\n                    <Play className=\"h-4 w-4\" />\n                    Run Exchange\n                  </>\n                )}\n              </Button>\n              <Button variant=\"outline\" onClick={reset} disabled={isRunning}>\n                Reset\n              </Button>\n            </div>\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          {steps.length === 0 ? (\n            <div className=\"text-center py-8 text-muted-foreground\">\n              <Key className=\"h-12 w-12 mx-auto mb-4 opacity-50\" />\n              <p>Click &quot;Run Exchange&quot; to start the Diffie-Hellman key exchange demonstration</p>\n            </div>\n          ) : (\n            <div className=\"space-y-4\">\n              {steps.map((step, index) => (\n                <div\n                  key={step.id}\n                  className={`flex gap-4 ${\n                    index < currentStep ? \"opacity-100\" : \"opacity-50\"\n                  }`}\n                >\n                  <div className=\"flex flex-col items-center\">\n                    <div\n                      className={`flex h-8 w-8 items-center justify-center rounded-full ${\n                        step.completed\n                          ? \"bg-green-500/20 text-green-500\"\n                          : \"bg-muted text-muted-foreground\"\n                      }`}\n                    >\n                      {step.completed ? (\n                        <CheckCircle2 className=\"h-5 w-5\" />\n                      ) : (\n                        <span>{step.id}</span>\n                      )}\n                    </div>\n                    {index < steps.length - 1 && (\n                      <div className=\"h-full w-px bg-border mt-2\" />\n                    )}\n                  </div>\n                  <div className=\"flex-1 pb-4\">\n                    <h4 className=\"font-medium\">{step.title}</h4>\n                    <p className=\"text-sm text-muted-foreground mt-1\">\n                      {step.description}\n                    </p>\n                    <div className=\"grid gap-2 mt-3 sm:grid-cols-2\">\n                      {step.clientValue && (\n                        <div className=\"rounded bg-blue-500/10 px-3 py-2\">\n                          <p className=\"text-xs text-blue-400 font-mono\">\n                            {step.clientValue}\n                          </p>\n                        </div>\n                      )}\n                      {step.serverValue && (\n                        <div className=\"rounded bg-orange-500/10 px-3 py-2\">\n                          <p className=\"text-xs text-orange-400 font-mono\">\n                            {step.serverValue}\n                          </p>\n                        </div>\n                      )}\n                    </div>\n                    {step.sharedValue && (\n                      <div className=\"rounded bg-green-500/10 px-3 py-2 mt-2 border border-green-500/30\">\n                        <p className=\"text-xs text-green-400 font-mono text-center\">\n                          {step.sharedValue}\n                        </p>\n                      </div>\n                    )}\n                  </div>\n                </div>\n              ))}\n            </div>\n          )}\n        </CardContent>\n      </Card>\n\n      {/* Security Note */}\n      <Card className=\"border-yellow-500/30 bg-yellow-500/5\">\n        <CardContent className=\"flex items-start gap-3 pt-6\">\n          <Shield className=\"h-5 w-5 text-yellow-500 shrink-0 mt-0.5\" />\n          <div>\n            <p className=\"font-medium text-yellow-500\">Security Note</p>\n            <p className=\"text-sm text-muted-foreground mt-1\">\n              In real DRM systems like Widevine, the key exchange is more complex and uses\n              elliptic curve cryptography (ECDH) for better security. The CDM&apos;s private key\n              is protected in hardware (TEE) to prevent extraction.\n            </p>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1253, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 1259, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/components/labs/EncryptionLab.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState } from \"react\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport {\n  Lock,\n  Unlock,\n  Key,\n  RefreshCw,\n  ArrowRight,\n  FileText,\n  Binary,\n  Shield,\n} from \"lucide-react\";\nimport { generateHexKey, simpleBlockEncrypt, simpleBlockDecrypt } from \"@/lib/crypto\";\n\ntype EncryptionMode = \"ctr\" | \"cbc\";\n\nexport function EncryptionLab() {\n  const [mode, setMode] = useState<EncryptionMode>(\"ctr\");\n  const [plaintext, setPlaintext] = useState(\"Hello, this is protected DRM content!\");\n  const [key, setKey] = useState(generateHexKey(16));\n  const [iv, setIv] = useState(generateHexKey(16));\n  const [ciphertext, setCiphertext] = useState(\"\");\n  const [decrypted, setDecrypted] = useState(\"\");\n  const [isEncrypting, setIsEncrypting] = useState(false);\n  const [isDecrypting, setIsDecrypting] = useState(false);\n  const [showSteps, setShowSteps] = useState(false);\n\n  const encrypt = async () => {\n    setIsEncrypting(true);\n    setShowSteps(true);\n    await new Promise((r) => setTimeout(r, 500));\n\n    // Convert key to number for our simple demo\n    const keyNum = parseInt(key.slice(0, 8), 16);\n    const encrypted = simpleBlockEncrypt(plaintext, keyNum);\n    setCiphertext(encrypted);\n    setDecrypted(\"\");\n    setIsEncrypting(false);\n  };\n\n  const decrypt = async () => {\n    if (!ciphertext) return;\n    setIsDecrypting(true);\n    await new Promise((r) => setTimeout(r, 500));\n\n    const keyNum = parseInt(key.slice(0, 8), 16);\n    const decryptedText = simpleBlockDecrypt(ciphertext, keyNum);\n    setDecrypted(decryptedText);\n    setIsDecrypting(false);\n  };\n\n  const generateNewKey = () => {\n    setKey(generateHexKey(16));\n    setCiphertext(\"\");\n    setDecrypted(\"\");\n    setShowSteps(false);\n  };\n\n  const generateNewIV = () => {\n    setIv(generateHexKey(16));\n    setCiphertext(\"\");\n    setDecrypted(\"\");\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Mode Selector */}\n      <div className=\"flex items-center gap-4\">\n        <span className=\"text-sm font-medium\">Encryption Mode:</span>\n        <div className=\"flex gap-2\">\n          <Button\n            variant={mode === \"ctr\" ? \"default\" : \"outline\"}\n            size=\"sm\"\n            onClick={() => setMode(\"ctr\")}\n          >\n            AES-CTR\n            <Badge variant=\"secondary\" className=\"ml-2 text-xs\">\n              Streaming\n            </Badge>\n          </Button>\n          <Button\n            variant={mode === \"cbc\" ? \"default\" : \"outline\"}\n            size=\"sm\"\n            onClick={() => setMode(\"cbc\")}\n          >\n            AES-CBC\n            <Badge variant=\"secondary\" className=\"ml-2 text-xs\">\n              Block\n            </Badge>\n          </Button>\n        </div>\n      </div>\n\n      {/* Key and IV Display */}\n      <div className=\"grid gap-4 md:grid-cols-2\">\n        <Card>\n          <CardHeader className=\"pb-3\">\n            <CardTitle className=\"flex items-center justify-between text-base\">\n              <span className=\"flex items-center gap-2\">\n                <Key className=\"h-4 w-4\" />\n                Content Key (128-bit)\n              </span>\n              <Button variant=\"ghost\" size=\"sm\" onClick={generateNewKey}>\n                <RefreshCw className=\"h-4 w-4\" />\n              </Button>\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            <code className=\"block rounded bg-muted px-3 py-2 text-sm font-mono text-green-400 break-all\">\n              {key}\n            </code>\n            <p className=\"text-xs text-muted-foreground mt-2\">\n              This key is delivered securely via the license server\n            </p>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader className=\"pb-3\">\n            <CardTitle className=\"flex items-center justify-between text-base\">\n              <span className=\"flex items-center gap-2\">\n                <Binary className=\"h-4 w-4\" />\n                Initialization Vector (IV)\n              </span>\n              <Button variant=\"ghost\" size=\"sm\" onClick={generateNewIV}>\n                <RefreshCw className=\"h-4 w-4\" />\n              </Button>\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            <code className=\"block rounded bg-muted px-3 py-2 text-sm font-mono text-blue-400 break-all\">\n              {iv}\n            </code>\n            <p className=\"text-xs text-muted-foreground mt-2\">\n              {mode === \"ctr\"\n                ? \"Counter starting value, increments for each block\"\n                : \"Random value, XORed with first plaintext block\"}\n            </p>\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Encryption Flow */}\n      <div className=\"grid gap-4 lg:grid-cols-3\">\n        {/* Plaintext Input */}\n        <Card className=\"border-blue-500/30\">\n          <CardHeader className=\"pb-3\">\n            <CardTitle className=\"flex items-center gap-2 text-base text-blue-400\">\n              <FileText className=\"h-4 w-4\" />\n              Plaintext (Input)\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            <textarea\n              value={plaintext}\n              onChange={(e) => {\n                setPlaintext(e.target.value);\n                setCiphertext(\"\");\n                setDecrypted(\"\");\n                setShowSteps(false);\n              }}\n              className=\"w-full h-32 rounded-md border border-input bg-background px-3 py-2 text-sm font-mono resize-none focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring\"\n              placeholder=\"Enter text to encrypt...\"\n            />\n            <Button\n              onClick={encrypt}\n              disabled={isEncrypting || !plaintext}\n              className=\"w-full mt-3 gap-2\"\n            >\n              {isEncrypting ? (\n                <>\n                  <RefreshCw className=\"h-4 w-4 animate-spin\" />\n                  Encrypting...\n                </>\n              ) : (\n                <>\n                  <Lock className=\"h-4 w-4\" />\n                  Encrypt\n                </>\n              )}\n            </Button>\n          </CardContent>\n        </Card>\n\n        {/* Process Arrow */}\n        <div className=\"flex items-center justify-center\">\n          <div className=\"flex flex-col items-center gap-4\">\n            <ArrowRight className=\"h-8 w-8 text-muted-foreground hidden lg:block\" />\n            <div className=\"text-center\">\n              <Badge variant=\"outline\" className=\"mb-2\">\n                {mode.toUpperCase()}\n              </Badge>\n              <p className=\"text-xs text-muted-foreground\">\n                {mode === \"ctr\"\n                  ? \"XOR with encrypted counter\"\n                  : \"Chain block cipher\"}\n              </p>\n            </div>\n            <ArrowRight className=\"h-8 w-8 text-muted-foreground hidden lg:block\" />\n          </div>\n        </div>\n\n        {/* Ciphertext Output */}\n        <Card className=\"border-purple-500/30\">\n          <CardHeader className=\"pb-3\">\n            <CardTitle className=\"flex items-center gap-2 text-base text-purple-400\">\n              <Lock className=\"h-4 w-4\" />\n              Ciphertext (Output)\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"h-32 rounded-md border border-input bg-muted/50 px-3 py-2 text-sm font-mono overflow-auto\">\n              {ciphertext ? (\n                <span className=\"text-purple-400 break-all\">{ciphertext}</span>\n              ) : (\n                <span className=\"text-muted-foreground\">\n                  Encrypted data will appear here...\n                </span>\n              )}\n            </div>\n            <Button\n              onClick={decrypt}\n              disabled={isDecrypting || !ciphertext}\n              variant=\"outline\"\n              className=\"w-full mt-3 gap-2\"\n            >\n              {isDecrypting ? (\n                <>\n                  <RefreshCw className=\"h-4 w-4 animate-spin\" />\n                  Decrypting...\n                </>\n              ) : (\n                <>\n                  <Unlock className=\"h-4 w-4\" />\n                  Decrypt\n                </>\n              )}\n            </Button>\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Decrypted Result */}\n      {decrypted && (\n        <Card className=\"border-green-500/30 bg-green-500/5\">\n          <CardHeader className=\"pb-3\">\n            <CardTitle className=\"flex items-center gap-2 text-base text-green-400\">\n              <Unlock className=\"h-4 w-4\" />\n              Decrypted Result\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"rounded-md bg-green-500/10 px-4 py-3 font-mono text-sm text-green-400\">\n              {decrypted}\n            </div>\n            {decrypted === plaintext ? (\n              <p className=\"text-xs text-green-500 mt-2 flex items-center gap-1\">\n                <Shield className=\"h-3 w-3\" />\n                Decryption successful - original content recovered!\n              </p>\n            ) : (\n              <p className=\"text-xs text-yellow-500 mt-2\">\n                Note: Minor differences may occur due to simplified demo encryption\n              </p>\n            )}\n          </CardContent>\n        </Card>\n      )}\n\n      {/* How It Works */}\n      {showSteps && (\n        <Card>\n          <CardHeader>\n            <CardTitle>How {mode.toUpperCase()} Mode Works</CardTitle>\n          </CardHeader>\n          <CardContent>\n            {mode === \"ctr\" ? (\n              <div className=\"space-y-4\">\n                <div className=\"grid gap-4 md:grid-cols-4\">\n                  <div className=\"rounded-lg bg-muted p-4 text-center\">\n                    <Binary className=\"h-6 w-6 mx-auto mb-2 text-blue-400\" />\n                    <p className=\"text-xs font-medium\">1. Initialize Counter</p>\n                    <p className=\"text-xs text-muted-foreground mt-1\">\n                      Start with IV value\n                    </p>\n                  </div>\n                  <div className=\"rounded-lg bg-muted p-4 text-center\">\n                    <Lock className=\"h-6 w-6 mx-auto mb-2 text-purple-400\" />\n                    <p className=\"text-xs font-medium\">2. Encrypt Counter</p>\n                    <p className=\"text-xs text-muted-foreground mt-1\">\n                      AES(key, counter)\n                    </p>\n                  </div>\n                  <div className=\"rounded-lg bg-muted p-4 text-center\">\n                    <ArrowRight className=\"h-6 w-6 mx-auto mb-2 text-green-400\" />\n                    <p className=\"text-xs font-medium\">3. XOR with Plaintext</p>\n                    <p className=\"text-xs text-muted-foreground mt-1\">\n                      Creates ciphertext\n                    </p>\n                  </div>\n                  <div className=\"rounded-lg bg-muted p-4 text-center\">\n                    <RefreshCw className=\"h-6 w-6 mx-auto mb-2 text-yellow-400\" />\n                    <p className=\"text-xs font-medium\">4. Increment & Repeat</p>\n                    <p className=\"text-xs text-muted-foreground mt-1\">\n                      For each block\n                    </p>\n                  </div>\n                </div>\n                <p className=\"text-sm text-muted-foreground\">\n                  CTR mode turns AES into a stream cipher, allowing parallel encryption\n                  and random access - perfect for video streaming in DRM systems.\n                </p>\n              </div>\n            ) : (\n              <div className=\"space-y-4\">\n                <div className=\"grid gap-4 md:grid-cols-4\">\n                  <div className=\"rounded-lg bg-muted p-4 text-center\">\n                    <Binary className=\"h-6 w-6 mx-auto mb-2 text-blue-400\" />\n                    <p className=\"text-xs font-medium\">1. XOR with IV/Previous</p>\n                    <p className=\"text-xs text-muted-foreground mt-1\">\n                      Chain blocks together\n                    </p>\n                  </div>\n                  <div className=\"rounded-lg bg-muted p-4 text-center\">\n                    <Lock className=\"h-6 w-6 mx-auto mb-2 text-purple-400\" />\n                    <p className=\"text-xs font-medium\">2. Encrypt Block</p>\n                    <p className=\"text-xs text-muted-foreground mt-1\">\n                      AES(key, block)\n                    </p>\n                  </div>\n                  <div className=\"rounded-lg bg-muted p-4 text-center\">\n                    <ArrowRight className=\"h-6 w-6 mx-auto mb-2 text-green-400\" />\n                    <p className=\"text-xs font-medium\">3. Output Ciphertext</p>\n                    <p className=\"text-xs text-muted-foreground mt-1\">\n                      Encrypted block\n                    </p>\n                  </div>\n                  <div className=\"rounded-lg bg-muted p-4 text-center\">\n                    <RefreshCw className=\"h-6 w-6 mx-auto mb-2 text-yellow-400\" />\n                    <p className=\"text-xs font-medium\">4. Chain & Repeat</p>\n                    <p className=\"text-xs text-muted-foreground mt-1\">\n                      Use output as next IV\n                    </p>\n                  </div>\n                </div>\n                <p className=\"text-sm text-muted-foreground\">\n                  CBC mode chains blocks together, providing better diffusion but\n                  requiring sequential processing - less common in modern streaming.\n                </p>\n              </div>\n            )}\n          </CardContent>\n        </Card>\n      )}\n\n      {/* CENC Info */}\n      <Card className=\"border-yellow-500/30 bg-yellow-500/5\">\n        <CardContent className=\"flex items-start gap-3 pt-6\">\n          <Shield className=\"h-5 w-5 text-yellow-500 shrink-0 mt-0.5\" />\n          <div>\n            <p className=\"font-medium text-yellow-500\">CENC (Common Encryption)</p>\n            <p className=\"text-sm text-muted-foreground mt-1\">\n              Real DRM systems use CENC which standardizes encryption across Widevine,\n              FairPlay, and PlayReady. Content is encrypted once and can be decrypted\n              by any compatible DRM system. CENC typically uses AES-CTR with 128-bit keys.\n            </p>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2290, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 2296, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/components/labs/LicenseServerLab.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState } from \"react\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport {\n  Server,\n  Laptop,\n  ArrowRight,\n  ArrowLeft,\n  Key,\n  Shield,\n  CheckCircle2,\n  XCircle,\n  Clock,\n  RefreshCw,\n  Play,\n  FileText,\n  Lock,\n} from \"lucide-react\";\nimport { generateHexKey } from \"@/lib/crypto\";\n\ninterface LicenseRequest {\n  deviceId: string;\n  contentId: string;\n  sessionId: string;\n  timestamp: number;\n  clientToken: string;\n}\n\ninterface License {\n  contentKey: string;\n  keyId: string;\n  policy: {\n    expiresAt: number;\n    hdcpRequired: boolean;\n    securityLevel: number;\n    allowedOutputs: string[];\n  };\n  signature: string;\n}\n\ntype Step = {\n  id: number;\n  title: string;\n  status: \"pending\" | \"active\" | \"success\" | \"error\";\n  data?: object;\n  message?: string;\n};\n\nexport function LicenseServerLab() {\n  const [isRunning, setIsRunning] = useState(false);\n  const [steps, setSteps] = useState<Step[]>([]);\n  const [request, setRequest] = useState<LicenseRequest | null>(null);\n  const [license, setLicense] = useState<License | null>(null);\n  const [securityLevel, setSecurityLevel] = useState<1 | 2 | 3>(1);\n\n  const delay = (ms: number) => new Promise((r) => setTimeout(r, ms));\n\n  const updateStep = (id: number, updates: Partial<Step>) => {\n    setSteps((prev) =>\n      prev.map((step) => (step.id === id ? { ...step, ...updates } : step))\n    );\n  };\n\n  const runLicenseFlow = async () => {\n    setIsRunning(true);\n    setRequest(null);\n    setLicense(null);\n\n    const initialSteps: Step[] = [\n      { id: 1, title: \"Generate License Request\", status: \"pending\" },\n      { id: 2, title: \"Send Request to Server\", status: \"pending\" },\n      { id: 3, title: \"Server Validates Device\", status: \"pending\" },\n      { id: 4, title: \"Check Content Rights\", status: \"pending\" },\n      { id: 5, title: \"Generate Content Key\", status: \"pending\" },\n      { id: 6, title: \"Apply License Policy\", status: \"pending\" },\n      { id: 7, title: \"Sign & Return License\", status: \"pending\" },\n      { id: 8, title: \"CDM Processes License\", status: \"pending\" },\n    ];\n    setSteps(initialSteps);\n\n    // Step 1: Generate License Request\n    updateStep(1, { status: \"active\" });\n    await delay(800);\n    const licenseRequest: LicenseRequest = {\n      deviceId: `DEV-${generateHexKey(8).toUpperCase()}`,\n      contentId: `CONTENT-${generateHexKey(4).toUpperCase()}`,\n      sessionId: generateHexKey(16),\n      timestamp: Date.now(),\n      clientToken: generateHexKey(32),\n    };\n    setRequest(licenseRequest);\n    updateStep(1, { status: \"success\", data: licenseRequest });\n    await delay(500);\n\n    // Step 2: Send Request\n    updateStep(2, { status: \"active\" });\n    await delay(600);\n    updateStep(2, { status: \"success\", message: \"Request sent via HTTPS\" });\n    await delay(400);\n\n    // Step 3: Validate Device\n    updateStep(3, { status: \"active\" });\n    await delay(800);\n    const deviceValid = securityLevel <= 2; // L3 might fail validation\n    if (securityLevel === 3 && Math.random() > 0.7) {\n      updateStep(3, {\n        status: \"error\",\n        message: \"Device attestation failed - potential tampering detected\",\n      });\n      setIsRunning(false);\n      return;\n    }\n    updateStep(3, {\n      status: \"success\",\n      message: `Device verified: Security Level L${securityLevel}`,\n    });\n    await delay(400);\n\n    // Step 4: Check Content Rights\n    updateStep(4, { status: \"active\" });\n    await delay(700);\n    updateStep(4, {\n      status: \"success\",\n      message: \"Content rights verified - user has valid subscription\",\n    });\n    await delay(400);\n\n    // Step 5: Generate Content Key\n    updateStep(5, { status: \"active\" });\n    await delay(600);\n    const contentKey = generateHexKey(32);\n    const keyId = generateHexKey(16);\n    updateStep(5, {\n      status: \"success\",\n      data: { keyId, contentKey: `${contentKey.slice(0, 8)}...` },\n    });\n    await delay(400);\n\n    // Step 6: Apply Policy\n    updateStep(6, { status: \"active\" });\n    await delay(700);\n    const policy = {\n      expiresAt: Date.now() + 24 * 60 * 60 * 1000,\n      hdcpRequired: securityLevel === 1,\n      securityLevel,\n      allowedOutputs:\n        securityLevel === 1\n          ? [\"HDMI-HDCP2.2\", \"Internal\"]\n          : securityLevel === 2\n          ? [\"HDMI-HDCP1.4\", \"Internal\"]\n          : [\"Internal\"],\n    };\n    updateStep(6, { status: \"success\", data: policy });\n    await delay(400);\n\n    // Step 7: Sign License\n    updateStep(7, { status: \"active\" });\n    await delay(600);\n    const signature = generateHexKey(64);\n    const fullLicense: License = {\n      contentKey,\n      keyId,\n      policy,\n      signature,\n    };\n    setLicense(fullLicense);\n    updateStep(7, { status: \"success\", message: \"License signed with server key\" });\n    await delay(400);\n\n    // Step 8: Process License\n    updateStep(8, { status: \"active\" });\n    await delay(800);\n    updateStep(8, {\n      status: \"success\",\n      message: \"License decrypted and stored in CDM\",\n    });\n\n    setIsRunning(false);\n  };\n\n  const reset = () => {\n    setSteps([]);\n    setRequest(null);\n    setLicense(null);\n    setIsRunning(false);\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Security Level Selector */}\n      <div className=\"flex flex-wrap items-center gap-4\">\n        <span className=\"text-sm font-medium\">Device Security Level:</span>\n        <div className=\"flex gap-2\">\n          {[1, 2, 3].map((level) => (\n            <Button\n              key={level}\n              variant={securityLevel === level ? \"default\" : \"outline\"}\n              size=\"sm\"\n              onClick={() => setSecurityLevel(level as 1 | 2 | 3)}\n              disabled={isRunning}\n              className=\"gap-2\"\n            >\n              L{level}\n              <Badge\n                variant=\"secondary\"\n                className={`text-xs ${\n                  level === 1\n                    ? \"bg-green-500/20 text-green-400\"\n                    : level === 2\n                    ? \"bg-yellow-500/20 text-yellow-400\"\n                    : \"bg-red-500/20 text-red-400\"\n                }`}\n              >\n                {level === 1 ? \"Hardware\" : level === 2 ? \"Hybrid\" : \"Software\"}\n              </Badge>\n            </Button>\n          ))}\n        </div>\n      </div>\n\n      {/* Client-Server Visualization */}\n      <div className=\"grid gap-6 lg:grid-cols-3\">\n        {/* Client */}\n        <Card className=\"border-blue-500/30 bg-blue-500/5\">\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2 text-blue-400\">\n              <Laptop className=\"h-5 w-5\" />\n              Client (CDM)\n            </CardTitle>\n            <CardDescription>\n              Widevine L{securityLevel} Device\n            </CardDescription>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            {request && (\n              <>\n                <div className=\"rounded-lg bg-blue-500/10 p-3\">\n                  <p className=\"text-xs text-muted-foreground mb-1\">Device ID</p>\n                  <code className=\"text-xs text-blue-400\">{request.deviceId}</code>\n                </div>\n                <div className=\"rounded-lg bg-blue-500/10 p-3\">\n                  <p className=\"text-xs text-muted-foreground mb-1\">Session ID</p>\n                  <code className=\"text-xs text-blue-400 break-all\">\n                    {request.sessionId}\n                  </code>\n                </div>\n              </>\n            )}\n            {license && (\n              <div className=\"rounded-lg bg-green-500/10 p-3 border border-green-500/30\">\n                <p className=\"text-xs text-muted-foreground mb-1\">Content Key (Decrypted)</p>\n                <code className=\"text-xs text-green-400 break-all\">\n                  {license.contentKey.slice(0, 16)}...\n                </code>\n              </div>\n            )}\n          </CardContent>\n        </Card>\n\n        {/* Network */}\n        <Card className=\"border-purple-500/30 bg-purple-500/5\">\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2 text-purple-400\">\n              <ArrowRight className=\"h-5 w-5\" />\n              License Exchange\n            </CardTitle>\n            <CardDescription>HTTPS/TLS 1.3 Encrypted</CardDescription>\n          </CardHeader>\n          <CardContent>\n            <div className=\"space-y-3\">\n              {request && (\n                <div className=\"flex items-center gap-2 text-sm\">\n                  <ArrowRight className=\"h-4 w-4 text-blue-400\" />\n                  <span className=\"text-muted-foreground\">License Request</span>\n                </div>\n              )}\n              {license && (\n                <div className=\"flex items-center gap-2 text-sm\">\n                  <ArrowLeft className=\"h-4 w-4 text-orange-400\" />\n                  <span className=\"text-muted-foreground\">License Response</span>\n                </div>\n              )}\n              <div className=\"rounded-lg bg-purple-500/10 p-3 mt-4\">\n                <p className=\"text-xs text-muted-foreground\">\n                  All communication is encrypted. Even if intercepted, the license\n                  is also encrypted with device-specific keys.\n                </p>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Server */}\n        <Card className=\"border-orange-500/30 bg-orange-500/5\">\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2 text-orange-400\">\n              <Server className=\"h-5 w-5\" />\n              License Server\n            </CardTitle>\n            <CardDescription>Widevine Cloud Service</CardDescription>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            {request && (\n              <div className=\"rounded-lg bg-orange-500/10 p-3\">\n                <p className=\"text-xs text-muted-foreground mb-1\">Content ID</p>\n                <code className=\"text-xs text-orange-400\">{request.contentId}</code>\n              </div>\n            )}\n            {license && (\n              <>\n                <div className=\"rounded-lg bg-orange-500/10 p-3\">\n                  <p className=\"text-xs text-muted-foreground mb-1\">Key ID</p>\n                  <code className=\"text-xs text-orange-400\">{license.keyId}</code>\n                </div>\n                <div className=\"rounded-lg bg-orange-500/10 p-3\">\n                  <p className=\"text-xs text-muted-foreground mb-1\">Policy</p>\n                  <div className=\"space-y-1 text-xs\">\n                    <p className=\"text-orange-400\">\n                      Expires: {new Date(license.policy.expiresAt).toLocaleString()}\n                    </p>\n                    <p className=\"text-orange-400\">\n                      HDCP: {license.policy.hdcpRequired ? \"Required\" : \"Not Required\"}\n                    </p>\n                  </div>\n                </div>\n              </>\n            )}\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Control & Steps */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center justify-between\">\n            <span>License Acquisition Flow</span>\n            <div className=\"flex gap-2\">\n              <Button onClick={runLicenseFlow} disabled={isRunning} className=\"gap-2\">\n                {isRunning ? (\n                  <>\n                    <RefreshCw className=\"h-4 w-4 animate-spin\" />\n                    Running...\n                  </>\n                ) : (\n                  <>\n                    <Play className=\"h-4 w-4\" />\n                    Request License\n                  </>\n                )}\n              </Button>\n              <Button variant=\"outline\" onClick={reset} disabled={isRunning}>\n                Reset\n              </Button>\n            </div>\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          {steps.length === 0 ? (\n            <div className=\"text-center py-8 text-muted-foreground\">\n              <FileText className=\"h-12 w-12 mx-auto mb-4 opacity-50\" />\n              <p>Click &quot;Request License&quot; to simulate the license acquisition process</p>\n            </div>\n          ) : (\n            <div className=\"grid gap-3 sm:grid-cols-2 lg:grid-cols-4\">\n              {steps.map((step) => (\n                <div\n                  key={step.id}\n                  className={`rounded-lg border p-4 transition-all ${\n                    step.status === \"active\"\n                      ? \"border-blue-500 bg-blue-500/10\"\n                      : step.status === \"success\"\n                      ? \"border-green-500/50 bg-green-500/5\"\n                      : step.status === \"error\"\n                      ? \"border-red-500/50 bg-red-500/5\"\n                      : \"border-border bg-muted/30\"\n                  }`}\n                >\n                  <div className=\"flex items-start gap-3\">\n                    <div\n                      className={`flex h-6 w-6 shrink-0 items-center justify-center rounded-full text-xs ${\n                        step.status === \"active\"\n                          ? \"bg-blue-500 text-white\"\n                          : step.status === \"success\"\n                          ? \"bg-green-500 text-white\"\n                          : step.status === \"error\"\n                          ? \"bg-red-500 text-white\"\n                          : \"bg-muted text-muted-foreground\"\n                      }`}\n                    >\n                      {step.status === \"active\" ? (\n                        <RefreshCw className=\"h-3 w-3 animate-spin\" />\n                      ) : step.status === \"success\" ? (\n                        <CheckCircle2 className=\"h-4 w-4\" />\n                      ) : step.status === \"error\" ? (\n                        <XCircle className=\"h-4 w-4\" />\n                      ) : (\n                        step.id\n                      )}\n                    </div>\n                    <div className=\"min-w-0\">\n                      <p className=\"text-sm font-medium truncate\">{step.title}</p>\n                      {step.message && (\n                        <p\n                          className={`text-xs mt-1 ${\n                            step.status === \"error\"\n                              ? \"text-red-400\"\n                              : \"text-muted-foreground\"\n                          }`}\n                        >\n                          {step.message}\n                        </p>\n                      )}\n                    </div>\n                  </div>\n                </div>\n              ))}\n            </div>\n          )}\n        </CardContent>\n      </Card>\n\n      {/* Security Level Info */}\n      <Card className=\"border-yellow-500/30 bg-yellow-500/5\">\n        <CardContent className=\"flex items-start gap-3 pt-6\">\n          <Shield className=\"h-5 w-5 text-yellow-500 shrink-0 mt-0.5\" />\n          <div>\n            <p className=\"font-medium text-yellow-500\">Security Levels Explained</p>\n            <div className=\"grid gap-3 mt-3 sm:grid-cols-3\">\n              <div className=\"rounded bg-green-500/10 p-3\">\n                <p className=\"text-sm font-medium text-green-400\">L1 - Hardware</p>\n                <p className=\"text-xs text-muted-foreground mt-1\">\n                  Keys protected in TEE. Supports 4K/HDR. Required for premium content.\n                </p>\n              </div>\n              <div className=\"rounded bg-yellow-500/10 p-3\">\n                <p className=\"text-sm font-medium text-yellow-400\">L2 - Hybrid</p>\n                <p className=\"text-xs text-muted-foreground mt-1\">\n                  Crypto in hardware, processing in software. Less common.\n                </p>\n              </div>\n              <div className=\"rounded bg-red-500/10 p-3\">\n                <p className=\"text-sm font-medium text-red-400\">L3 - Software</p>\n                <p className=\"text-xs text-muted-foreground mt-1\">\n                  All in software. SD only. Browsers without hardware support.\n                </p>\n              </div>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3307, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 3313, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/components/labs/CDMSimulatorLab.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState, useCallback } from \"react\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport {\n  Shield,\n  Key,\n  Lock,\n  Unlock,\n  Server,\n  FileVideo,\n  CheckCircle2,\n  XCircle,\n  RefreshCw,\n  Play,\n  Pause,\n  Database,\n  Cpu,\n} from \"lucide-react\";\nimport { generateHexKey } from \"@/lib/crypto\";\n\ntype CDMState = \"idle\" | \"initializing\" | \"requesting\" | \"processing\" | \"decrypting\" | \"playing\" | \"error\";\n\ninterface CDMSession {\n  sessionId: string;\n  contentId: string;\n  keyId: string | null;\n  contentKey: string | null;\n  state: CDMState;\n  securityLevel: 1 | 2 | 3;\n}\n\ninterface EncryptedContent {\n  id: string;\n  name: string;\n  encryptedData: string;\n  psshBox: string;\n  keyId: string;\n}\n\nexport function CDMSimulatorLab() {\n  const [session, setSession] = useState<CDMSession | null>(null);\n  const [logs, setLogs] = useState<string[]>([]);\n  const [decryptedContent, setDecryptedContent] = useState<string | null>(null);\n  const [isPlaying, setIsPlaying] = useState(false);\n  const [securityLevel, setSecurityLevel] = useState<1 | 2 | 3>(1);\n\n  const sampleContent: EncryptedContent = {\n    id: \"CONTENT-001\",\n    name: \"Sample Protected Video\",\n    encryptedData: generateHexKey(64),\n    psshBox: `0000003470737368${generateHexKey(32)}`,\n    keyId: generateHexKey(16),\n  };\n\n  const addLog = useCallback((message: string) => {\n    const timestamp = new Date().toLocaleTimeString();\n    setLogs((prev) => [...prev, `[${timestamp}] ${message}`]);\n  }, []);\n\n  const delay = (ms: number) => new Promise((r) => setTimeout(r, ms));\n\n  const initializeCDM = async () => {\n    setLogs([]);\n    setDecryptedContent(null);\n    setIsPlaying(false);\n\n    addLog(\"Initializing Content Decryption Module...\");\n    await delay(500);\n\n    const newSession: CDMSession = {\n      sessionId: generateHexKey(16),\n      contentId: sampleContent.id,\n      keyId: null,\n      contentKey: null,\n      state: \"initializing\",\n      securityLevel,\n    };\n\n    setSession(newSession);\n    addLog(`CDM initialized with Security Level L${securityLevel}`);\n    addLog(`Session ID: ${newSession.sessionId}`);\n    await delay(300);\n\n    // Parse PSSH box\n    addLog(\"Parsing PSSH box from content...\");\n    await delay(400);\n    addLog(`Found Key ID: ${sampleContent.keyId}`);\n\n    setSession((prev) => prev ? { ...prev, keyId: sampleContent.keyId, state: \"requesting\" } : null);\n  };\n\n  const requestLicense = async () => {\n    if (!session) return;\n\n    addLog(\"Generating license request challenge...\");\n    await delay(600);\n\n    const challenge = {\n      sessionId: session.sessionId,\n      keyId: sampleContent.keyId,\n      deviceCert: generateHexKey(32),\n      nonce: generateHexKey(8),\n    };\n\n    addLog(`Challenge generated: ${JSON.stringify(challenge).slice(0, 60)}...`);\n    await delay(400);\n\n    addLog(\"Sending license request to server...\");\n    await delay(800);\n\n    // Simulate server validation\n    if (securityLevel === 3 && Math.random() > 0.7) {\n      addLog(\"ERROR: Server rejected request - device attestation failed\");\n      setSession((prev) => prev ? { ...prev, state: \"error\" } : null);\n      return;\n    }\n\n    addLog(\"Server validated device certificate\");\n    addLog(\"Server checked content rights - user authorized\");\n    await delay(500);\n\n    const contentKey = generateHexKey(32);\n    addLog(`Received encrypted license response`);\n    await delay(400);\n\n    addLog(\"Decrypting license with device private key...\");\n    await delay(500);\n\n    setSession((prev) =>\n      prev ? { ...prev, contentKey, state: \"processing\" } : null\n    );\n    addLog(`Content key extracted: ${contentKey.slice(0, 16)}...`);\n  };\n\n  const decryptContent = async () => {\n    if (!session || !session.contentKey) return;\n\n    setSession((prev) => prev ? { ...prev, state: \"decrypting\" } : null);\n    addLog(\"Beginning content decryption...\");\n    await delay(400);\n\n    addLog(\"Loading encrypted media segments...\");\n    await delay(500);\n\n    addLog(\"Applying AES-CTR decryption with content key...\");\n    await delay(600);\n\n    // Simulate decryption\n    const decrypted = `DECRYPTED_CONTENT_${generateHexKey(8)}`;\n    setDecryptedContent(decrypted);\n\n    addLog(\"Content successfully decrypted\");\n    addLog(\"Passing to secure video pipeline...\");\n    await delay(400);\n\n    setSession((prev) => prev ? { ...prev, state: \"playing\" } : null);\n    addLog(\"Playback ready - content protected by HDCP\");\n  };\n\n  const runFullFlow = async () => {\n    await initializeCDM();\n    await delay(500);\n    await requestLicense();\n    await delay(500);\n    if (session?.state !== \"error\") {\n      await decryptContent();\n    }\n  };\n\n  const togglePlayback = () => {\n    if (session?.state === \"playing\") {\n      setIsPlaying((prev) => !prev);\n      addLog(isPlaying ? \"Playback paused\" : \"Playback resumed\");\n    }\n  };\n\n  const reset = () => {\n    setSession(null);\n    setLogs([]);\n    setDecryptedContent(null);\n    setIsPlaying(false);\n  };\n\n  const getStateColor = (state: CDMState) => {\n    switch (state) {\n      case \"idle\":\n        return \"bg-gray-500/20 text-gray-400\";\n      case \"initializing\":\n        return \"bg-blue-500/20 text-blue-400\";\n      case \"requesting\":\n        return \"bg-purple-500/20 text-purple-400\";\n      case \"processing\":\n        return \"bg-yellow-500/20 text-yellow-400\";\n      case \"decrypting\":\n        return \"bg-orange-500/20 text-orange-400\";\n      case \"playing\":\n        return \"bg-green-500/20 text-green-400\";\n      case \"error\":\n        return \"bg-red-500/20 text-red-400\";\n      default:\n        return \"bg-gray-500/20 text-gray-400\";\n    }\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Security Level Selector */}\n      <div className=\"flex flex-wrap items-center gap-4\">\n        <span className=\"text-sm font-medium\">Simulated Security Level:</span>\n        <div className=\"flex gap-2\">\n          {[1, 2, 3].map((level) => (\n            <Button\n              key={level}\n              variant={securityLevel === level ? \"default\" : \"outline\"}\n              size=\"sm\"\n              onClick={() => setSecurityLevel(level as 1 | 2 | 3)}\n              disabled={session !== null}\n              className=\"gap-2\"\n            >\n              L{level}\n              <Badge\n                variant=\"secondary\"\n                className={`text-xs ${\n                  level === 1\n                    ? \"bg-green-500/20 text-green-400\"\n                    : level === 2\n                    ? \"bg-yellow-500/20 text-yellow-400\"\n                    : \"bg-red-500/20 text-red-400\"\n                }`}\n              >\n                {level === 1 ? \"TEE\" : level === 2 ? \"Hybrid\" : \"Software\"}\n              </Badge>\n            </Button>\n          ))}\n        </div>\n      </div>\n\n      {/* CDM Architecture Visualization */}\n      <div className=\"grid gap-6 lg:grid-cols-2\">\n        {/* CDM State */}\n        <Card className=\"border-blue-500/30 bg-blue-500/5\">\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2 text-blue-400\">\n              <Shield className=\"h-5 w-5\" />\n              CDM State\n            </CardTitle>\n            <CardDescription>Content Decryption Module Status</CardDescription>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            <div className=\"flex items-center justify-between\">\n              <span className=\"text-sm text-muted-foreground\">Status</span>\n              <Badge className={getStateColor(session?.state || \"idle\")}>\n                {session?.state || \"idle\"}\n              </Badge>\n            </div>\n\n            {session && (\n              <>\n                <div className=\"rounded-lg bg-blue-500/10 p-3\">\n                  <p className=\"text-xs text-muted-foreground mb-1\">Session ID</p>\n                  <code className=\"text-xs text-blue-400\">{session.sessionId}</code>\n                </div>\n\n                {session.keyId && (\n                  <div className=\"rounded-lg bg-blue-500/10 p-3\">\n                    <p className=\"text-xs text-muted-foreground mb-1\">Key ID</p>\n                    <code className=\"text-xs text-blue-400\">{session.keyId}</code>\n                  </div>\n                )}\n\n                {session.contentKey && (\n                  <div className=\"rounded-lg bg-green-500/10 p-3 border border-green-500/30\">\n                    <p className=\"text-xs text-muted-foreground mb-1\">Content Key (Secure Storage)</p>\n                    <code className=\"text-xs text-green-400\">\n                      {session.contentKey.slice(0, 16)}... (protected)\n                    </code>\n                  </div>\n                )}\n              </>\n            )}\n\n            <div className=\"pt-4 space-y-2\">\n              <div className=\"flex items-center gap-2 text-sm\">\n                <Cpu className=\"h-4 w-4\" />\n                <span className=\"text-muted-foreground\">\n                  {securityLevel === 1\n                    ? \"Trusted Execution Environment\"\n                    : securityLevel === 2\n                    ? \"Hardware Crypto Engine\"\n                    : \"Software Implementation\"}\n                </span>\n              </div>\n              <div className=\"flex items-center gap-2 text-sm\">\n                <Database className=\"h-4 w-4\" />\n                <span className=\"text-muted-foreground\">\n                  {securityLevel === 1\n                    ? \"Secure key storage in TEE\"\n                    : securityLevel === 2\n                    ? \"Protected memory region\"\n                    : \"Obfuscated software storage\"}\n                </span>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Content & Playback */}\n        <Card className=\"border-purple-500/30 bg-purple-500/5\">\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2 text-purple-400\">\n              <FileVideo className=\"h-5 w-5\" />\n              Protected Content\n            </CardTitle>\n            <CardDescription>{sampleContent.name}</CardDescription>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            <div className=\"rounded-lg bg-purple-500/10 p-3\">\n              <p className=\"text-xs text-muted-foreground mb-1\">Content ID</p>\n              <code className=\"text-xs text-purple-400\">{sampleContent.id}</code>\n            </div>\n\n            <div className=\"rounded-lg bg-purple-500/10 p-3\">\n              <p className=\"text-xs text-muted-foreground mb-1\">PSSH Box</p>\n              <code className=\"text-xs text-purple-400 break-all\">\n                {sampleContent.psshBox.slice(0, 32)}...\n              </code>\n            </div>\n\n            {decryptedContent && (\n              <div className=\"rounded-lg bg-green-500/10 p-4 border border-green-500/30\">\n                <div className=\"flex items-center justify-between mb-2\">\n                  <span className=\"text-sm font-medium text-green-400\">\n                    Content Decrypted\n                  </span>\n                  {session?.state === \"playing\" && (\n                    <Button\n                      size=\"sm\"\n                      variant=\"ghost\"\n                      className=\"h-8 w-8 p-0\"\n                      onClick={togglePlayback}\n                    >\n                      {isPlaying ? (\n                        <Pause className=\"h-4 w-4\" />\n                      ) : (\n                        <Play className=\"h-4 w-4\" />\n                      )}\n                    </Button>\n                  )}\n                </div>\n                <div className=\"h-24 rounded bg-black/50 flex items-center justify-center\">\n                  {isPlaying ? (\n                    <div className=\"flex items-center gap-2 text-green-400\">\n                      <RefreshCw className=\"h-4 w-4 animate-spin\" />\n                      <span className=\"text-sm\">Playing protected content...</span>\n                    </div>\n                  ) : (\n                    <div className=\"flex items-center gap-2 text-muted-foreground\">\n                      <Lock className=\"h-4 w-4\" />\n                      <span className=\"text-sm\">Ready to play</span>\n                    </div>\n                  )}\n                </div>\n              </div>\n            )}\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Controls */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center justify-between\">\n            <span>CDM Workflow</span>\n            <div className=\"flex gap-2\">\n              <Button\n                onClick={runFullFlow}\n                disabled={session !== null}\n                className=\"gap-2\"\n              >\n                <Play className=\"h-4 w-4\" />\n                Run Full Flow\n              </Button>\n              <Button variant=\"outline\" onClick={reset}>\n                Reset\n              </Button>\n            </div>\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          {/* Step-by-step controls */}\n          <div className=\"flex flex-wrap gap-2 mb-6\">\n            <Button\n              size=\"sm\"\n              variant=\"outline\"\n              onClick={initializeCDM}\n              disabled={session !== null}\n              className=\"gap-2\"\n            >\n              <Shield className=\"h-4 w-4\" />\n              1. Initialize CDM\n            </Button>\n            <Button\n              size=\"sm\"\n              variant=\"outline\"\n              onClick={requestLicense}\n              disabled={!session || session.state !== \"requesting\"}\n              className=\"gap-2\"\n            >\n              <Key className=\"h-4 w-4\" />\n              2. Request License\n            </Button>\n            <Button\n              size=\"sm\"\n              variant=\"outline\"\n              onClick={decryptContent}\n              disabled={!session || session.state !== \"processing\"}\n              className=\"gap-2\"\n            >\n              <Unlock className=\"h-4 w-4\" />\n              3. Decrypt Content\n            </Button>\n          </div>\n\n          {/* Logs */}\n          <div className=\"rounded-lg bg-black/50 p-4 h-64 overflow-auto font-mono text-xs\">\n            {logs.length === 0 ? (\n              <p className=\"text-muted-foreground\">\n                CDM logs will appear here...\n              </p>\n            ) : (\n              logs.map((log, index) => (\n                <div\n                  key={index}\n                  className={`${\n                    log.includes(\"ERROR\")\n                      ? \"text-red-400\"\n                      : log.includes(\"SUCCESS\") || log.includes(\"successfully\")\n                      ? \"text-green-400\"\n                      : \"text-gray-300\"\n                  }`}\n                >\n                  {log}\n                </div>\n              ))\n            )}\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* CDM Components Info */}\n      <Card className=\"border-yellow-500/30 bg-yellow-500/5\">\n        <CardContent className=\"flex items-start gap-3 pt-6\">\n          <Cpu className=\"h-5 w-5 text-yellow-500 shrink-0 mt-0.5\" />\n          <div className=\"w-full\">\n            <p className=\"font-medium text-yellow-500\">CDM Components</p>\n            <div className=\"grid gap-3 mt-3 sm:grid-cols-2 lg:grid-cols-4\">\n              <div className=\"rounded bg-blue-500/10 p-3\">\n                <p className=\"text-sm font-medium text-blue-400\">Key System</p>\n                <p className=\"text-xs text-muted-foreground mt-1\">\n                  Handles license requests and key management\n                </p>\n              </div>\n              <div className=\"rounded bg-purple-500/10 p-3\">\n                <p className=\"text-sm font-medium text-purple-400\">Decryptor</p>\n                <p className=\"text-xs text-muted-foreground mt-1\">\n                  Performs AES decryption of media segments\n                </p>\n              </div>\n              <div className=\"rounded bg-green-500/10 p-3\">\n                <p className=\"text-sm font-medium text-green-400\">Secure Storage</p>\n                <p className=\"text-xs text-muted-foreground mt-1\">\n                  Protects keys and sensitive data\n                </p>\n              </div>\n              <div className=\"rounded bg-orange-500/10 p-3\">\n                <p className=\"text-sm font-medium text-orange-400\">Output Control</p>\n                <p className=\"text-xs text-muted-foreground mt-1\">\n                  Enforces HDCP and output restrictions\n                </p>\n              </div>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 4314, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 4320, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/app/labs/%5B...slug%5D/page.tsx"],"sourcesContent":["\"use client\";\n\nimport Link from \"next/link\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { ArrowLeft, Info, AlertTriangle } from \"lucide-react\";\nimport { KeyExchangeLab } from \"@/components/labs/KeyExchangeLab\";\nimport { EncryptionLab } from \"@/components/labs/EncryptionLab\";\nimport { LicenseServerLab } from \"@/components/labs/LicenseServerLab\";\nimport { CDMSimulatorLab } from \"@/components/labs/CDMSimulatorLab\";\nimport { use } from \"react\";\n\nconst labs: Record<string, {\n  title: string;\n  difficulty: string;\n  description: string;\n  objectives: string[];\n  prerequisites: string[];\n  warning?: string;\n}> = {\n  \"license-server\": {\n    title: \"License Server Lab\",\n    difficulty: \"Beginner\",\n    description: \"Learn how DRM license servers work by interacting with a simulated license server. You'll understand the license request/response flow and how content keys are delivered.\",\n    objectives: [\n      \"Understand the license request format\",\n      \"Learn how license servers validate requests\",\n      \"See how content keys are encrypted and delivered\",\n      \"Explore license policies and restrictions\",\n    ],\n    prerequisites: [\n      \"Basic understanding of HTTP requests\",\n      \"Familiarity with JSON data format\",\n    ],\n  },\n  \"key-exchange\": {\n    title: \"Key Exchange Lab\",\n    difficulty: \"Intermediate\",\n    description: \"Explore the cryptographic key exchange process used in DRM systems. Learn how devices and servers establish secure communication.\",\n    objectives: [\n      \"Understand public key cryptography basics\",\n      \"Learn the Diffie-Hellman key exchange\",\n      \"See how session keys are derived\",\n      \"Explore key wrapping techniques\",\n    ],\n    prerequisites: [\n      \"Basic cryptography knowledge\",\n      \"Understanding of public/private keys\",\n    ],\n  },\n  encryption: {\n    title: \"Encryption Lab\",\n    difficulty: \"Intermediate\",\n    description: \"Get hands-on experience with AES encryption used in DRM. Encrypt and decrypt sample content to understand the process.\",\n    objectives: [\n      \"Implement AES-CTR encryption\",\n      \"Understand initialization vectors (IV)\",\n      \"Learn about subsample encryption\",\n      \"Practice with CENC encryption schemes\",\n    ],\n    prerequisites: [\n      \"Basic programming knowledge\",\n      \"Understanding of binary data\",\n    ],\n  },\n  \"cdm-simulator\": {\n    title: \"CDM Simulator\",\n    difficulty: \"Advanced\",\n    description: \"Simulate a Content Decryption Module to understand the complete DRM client workflow from license acquisition to content decryption.\",\n    objectives: [\n      \"Build a minimal CDM implementation\",\n      \"Handle license requests and responses\",\n      \"Implement key derivation\",\n      \"Decrypt protected content samples\",\n    ],\n    prerequisites: [\n      \"Strong programming skills\",\n      \"Cryptography fundamentals\",\n      \"Understanding of DRM concepts\",\n    ],\n  },\n  \"attacks/cdm-extraction\": {\n    title: \"CDM Extraction Analysis\",\n    difficulty: \"Advanced\",\n    description: \"Learn how attackers attempt to extract CDM keys from devices and understand the security measures that prevent this.\",\n    objectives: [\n      \"Understand TEE security boundaries\",\n      \"Learn about memory protection\",\n      \"Analyze extraction techniques\",\n      \"Study countermeasures\",\n    ],\n    prerequisites: [\n      \"Reverse engineering basics\",\n      \"Understanding of L1/L3 security levels\",\n    ],\n    warning: \"This lab is for educational purposes only. Do not attempt these techniques on production systems.\",\n  },\n  \"attacks/key-sharing\": {\n    title: \"Key Sharing Analysis\",\n    difficulty: \"Intermediate\",\n    description: \"Understand the key sharing attack vector where content keys are shared between users to bypass DRM protection.\",\n    objectives: [\n      \"Understand how keys can be extracted\",\n      \"Learn about key sharing networks\",\n      \"Study detection mechanisms\",\n      \"Explore watermarking as a countermeasure\",\n    ],\n    prerequisites: [\n      \"Understanding of license acquisition\",\n      \"Basic DRM knowledge\",\n    ],\n    warning: \"This lab demonstrates vulnerabilities for defensive purposes.\",\n  },\n  \"attacks/mitm\": {\n    title: \"MITM Attack Lab\",\n    difficulty: \"Advanced\",\n    description: \"Explore man-in-the-middle attack scenarios on DRM license acquisition and learn how to prevent them.\",\n    objectives: [\n      \"Set up a proxy for license traffic\",\n      \"Analyze license request/response\",\n      \"Understand TLS pinning\",\n      \"Learn about request signing\",\n    ],\n    prerequisites: [\n      \"Network security fundamentals\",\n      \"HTTP/HTTPS understanding\",\n    ],\n    warning: \"Only perform these techniques in controlled lab environments.\",\n  },\n  \"attacks/hdcp-bypass\": {\n    title: \"HDCP Analysis\",\n    difficulty: \"Advanced\",\n    description: \"Learn about HDCP (High-bandwidth Digital Content Protection) and understand its role in the DRM chain.\",\n    objectives: [\n      \"Understand HDCP versions\",\n      \"Learn about the HDCP handshake\",\n      \"Study known vulnerabilities\",\n      \"Explore detection mechanisms\",\n    ],\n    prerequisites: [\n      \"Understanding of display protocols\",\n      \"Hardware security concepts\",\n    ],\n  },\n  \"defense/attestation\": {\n    title: \"Device Attestation Lab\",\n    difficulty: \"Advanced\",\n    description: \"Implement device attestation to verify client integrity before issuing licenses.\",\n    objectives: [\n      \"Build an attestation verification system\",\n      \"Implement certificate chain validation\",\n      \"Create device fingerprinting\",\n      \"Handle attestation failures\",\n    ],\n    prerequisites: [\n      \"PKI and certificate knowledge\",\n      \"Server-side programming\",\n    ],\n  },\n  \"defense/watermarking\": {\n    title: \"Watermarking Lab\",\n    difficulty: \"Intermediate\",\n    description: \"Learn forensic watermarking techniques for tracking content leaks and identifying the source of piracy.\",\n    objectives: [\n      \"Implement A/B watermarking\",\n      \"Create invisible watermarks\",\n      \"Build watermark detection\",\n      \"Study robustness against attacks\",\n    ],\n    prerequisites: [\n      \"Video encoding basics\",\n      \"Understanding of streaming\",\n    ],\n  },\n  \"defense/anomaly\": {\n    title: \"Anomaly Detection Lab\",\n    difficulty: \"Advanced\",\n    description: \"Build systems to detect suspicious license acquisition patterns that may indicate piracy or abuse.\",\n    objectives: [\n      \"Define normal usage patterns\",\n      \"Implement rate limiting\",\n      \"Create behavioral analysis\",\n      \"Build alerting systems\",\n    ],\n    prerequisites: [\n      \"Data analysis skills\",\n      \"Understanding of license flows\",\n    ],\n  },\n};\n\nfunction getDifficultyColor(difficulty: string) {\n  switch (difficulty) {\n    case \"Beginner\":\n      return \"bg-green-500/10 text-green-500\";\n    case \"Intermediate\":\n      return \"bg-yellow-500/10 text-yellow-500\";\n    case \"Advanced\":\n      return \"bg-red-500/10 text-red-500\";\n    default:\n      return \"bg-gray-500/10 text-gray-500\";\n  }\n}\n\n// Map of lab keys to their interactive components\nconst labComponents: Record<string, React.ComponentType> = {\n  \"license-server\": LicenseServerLab,\n  \"key-exchange\": KeyExchangeLab,\n  \"encryption\": EncryptionLab,\n  \"cdm-simulator\": CDMSimulatorLab,\n};\n\nexport default function LabPage({\n  params,\n}: {\n  params: Promise<{ slug: string[] }>;\n}) {\n  const { slug } = use(params);\n  const labKey = slug.join(\"/\");\n  const lab = labs[labKey];\n\n  if (!lab) {\n    return (\n      <div className=\"py-20\">\n        <div className=\"mx-auto max-w-3xl px-4 text-center\">\n          <h1 className=\"text-2xl font-bold\">Lab Not Found</h1>\n          <p className=\"mt-2 text-muted-foreground\">\n            The lab you&apos;re looking for doesn&apos;t exist.\n          </p>\n          <Link href=\"/labs\">\n            <Button className=\"mt-4\">Back to Labs</Button>\n          </Link>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"py-10\">\n      <div className=\"mx-auto max-w-4xl px-4 sm:px-6 lg:px-8\">\n        <Link href=\"/labs\">\n          <Button variant=\"ghost\" size=\"sm\" className=\"mb-6 gap-2\">\n            <ArrowLeft className=\"h-4 w-4\" />\n            Back to Labs\n          </Button>\n        </Link>\n\n        <header className=\"mb-8\">\n          <Badge className={getDifficultyColor(lab.difficulty)}>\n            {lab.difficulty}\n          </Badge>\n          <h1 className=\"mt-4 text-4xl font-bold tracking-tight\">{lab.title}</h1>\n          <p className=\"mt-4 text-lg text-muted-foreground\">{lab.description}</p>\n        </header>\n\n        {lab.warning && (\n          <div className=\"mb-8 flex items-start gap-3 rounded-lg border border-yellow-500/30 bg-yellow-500/10 p-4\">\n            <AlertTriangle className=\"h-5 w-5 text-yellow-500 shrink-0 mt-0.5\" />\n            <p className=\"text-sm text-yellow-200\">{lab.warning}</p>\n          </div>\n        )}\n\n        <div className=\"grid gap-6 md:grid-cols-2 mb-8\">\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <Info className=\"h-5 w-5\" />\n                Objectives\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              <ul className=\"space-y-2\">\n                {lab.objectives.map((objective, index) => (\n                  <li key={index} className=\"flex items-start gap-2 text-sm\">\n                    <span className=\"text-primary\"></span>\n                    <span className=\"text-muted-foreground\">{objective}</span>\n                  </li>\n                ))}\n              </ul>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardHeader>\n              <CardTitle>Prerequisites</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <ul className=\"space-y-2\">\n                {lab.prerequisites.map((prereq, index) => (\n                  <li key={index} className=\"flex items-start gap-2 text-sm\">\n                    <span className=\"text-primary\"></span>\n                    <span className=\"text-muted-foreground\">{prereq}</span>\n                  </li>\n                ))}\n              </ul>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Interactive Lab Component */}\n        <div className=\"rounded-lg border border-border bg-card p-6\">\n          <h2 className=\"text-xl font-semibold mb-6\">Interactive Lab Environment</h2>\n          {labComponents[labKey] ? (\n            (() => {\n              const LabComponent = labComponents[labKey];\n              return <LabComponent />;\n            })()\n          ) : (\n            <div className=\"text-center py-8 text-muted-foreground\">\n              <p>This lab is under development. Check back soon!</p>\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AALA;AAAA;AAAA;AANA;;;;;;;;;;;;AAaA,MAAM,OAOD;IACH,kBAAkB;QAChB,OAAO;QACP,YAAY;QACZ,aAAa;QACb,YAAY;YACV;YACA;YACA;YACA;SACD;QACD,eAAe;YACb;YACA;SACD;IACH;IACA,gBAAgB;QACd,OAAO;QACP,YAAY;QACZ,aAAa;QACb,YAAY;YACV;YACA;YACA;YACA;SACD;QACD,eAAe;YACb;YACA;SACD;IACH;IACA,YAAY;QACV,OAAO;QACP,YAAY;QACZ,aAAa;QACb,YAAY;YACV;YACA;YACA;YACA;SACD;QACD,eAAe;YACb;YACA;SACD;IACH;IACA,iBAAiB;QACf,OAAO;QACP,YAAY;QACZ,aAAa;QACb,YAAY;YACV;YACA;YACA;YACA;SACD;QACD,eAAe;YACb;YACA;YACA;SACD;IACH;IACA,0BAA0B;QACxB,OAAO;QACP,YAAY;QACZ,aAAa;QACb,YAAY;YACV;YACA;YACA;YACA;SACD;QACD,eAAe;YACb;YACA;SACD;QACD,SAAS;IACX;IACA,uBAAuB;QACrB,OAAO;QACP,YAAY;QACZ,aAAa;QACb,YAAY;YACV;YACA;YACA;YACA;SACD;QACD,eAAe;YACb;YACA;SACD;QACD,SAAS;IACX;IACA,gBAAgB;QACd,OAAO;QACP,YAAY;QACZ,aAAa;QACb,YAAY;YACV;YACA;YACA;YACA;SACD;QACD,eAAe;YACb;YACA;SACD;QACD,SAAS;IACX;IACA,uBAAuB;QACrB,OAAO;QACP,YAAY;QACZ,aAAa;QACb,YAAY;YACV;YACA;YACA;YACA;SACD;QACD,eAAe;YACb;YACA;SACD;IACH;IACA,uBAAuB;QACrB,OAAO;QACP,YAAY;QACZ,aAAa;QACb,YAAY;YACV;YACA;YACA;YACA;SACD;QACD,eAAe;YACb;YACA;SACD;IACH;IACA,wBAAwB;QACtB,OAAO;QACP,YAAY;QACZ,aAAa;QACb,YAAY;YACV;YACA;YACA;YACA;SACD;QACD,eAAe;YACb;YACA;SACD;I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"}},
    {"offset": {"line": 4872, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}