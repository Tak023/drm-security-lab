(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,34768,e=>{"use strict";var t=e.i(53811),s=e.i(83899),r=e.i(12096),i=e.i(73403),n=e.i(25030),a=e.i(60602),c=e.i(67313),o=e.i(63108),l=e.i(2474),d=e.i(74944),u=e.i(32016),h="rovingFocusGroup.onEntryFocus",m={bubbles:!1,cancelable:!0},p="RovingFocusGroup",[y,x,g]=(0,n.createCollection)(p),[v,f]=(0,i.createContextScope)(p,[g]),[k,b]=v(p),j=s.forwardRef((e,s)=>(0,t.jsx)(y.Provider,{scope:e.__scopeRovingFocusGroup,children:(0,t.jsx)(y.Slot,{scope:e.__scopeRovingFocusGroup,children:(0,t.jsx)(w,{...e,ref:s})})}));j.displayName=p;var w=s.forwardRef((e,i)=>{let{__scopeRovingFocusGroup:n,orientation:c,loop:y=!1,dir:g,currentTabStopId:v,defaultCurrentTabStopId:f,onCurrentTabStopIdChange:b,onEntryFocus:j,preventScrollOnEntryFocus:w=!1,...C}=e,N=s.useRef(null),D=(0,a.useComposedRefs)(i,N),T=(0,u.useDirection)(g),[I,M]=(0,d.useControllableState)({prop:v,defaultProp:f??null,onChange:b,caller:p}),[S,A]=s.useState(!1),E=(0,l.useCallbackRef)(j),K=x(n),R=s.useRef(!1),[P,$]=s.useState(0);return s.useEffect(()=>{let e=N.current;if(e)return e.addEventListener(h,E),()=>e.removeEventListener(h,E)},[E]),(0,t.jsx)(k,{scope:n,orientation:c,dir:T,loop:y,currentTabStopId:I,onItemFocus:s.useCallback(e=>M(e),[M]),onItemShiftTab:s.useCallback(()=>A(!0),[]),onFocusableItemAdd:s.useCallback(()=>$(e=>e+1),[]),onFocusableItemRemove:s.useCallback(()=>$(e=>e-1),[]),children:(0,t.jsx)(o.Primitive.div,{tabIndex:S||0===P?-1:0,"data-orientation":c,...C,ref:D,style:{outline:"none",...e.style},onMouseDown:(0,r.composeEventHandlers)(e.onMouseDown,()=>{R.current=!0}),onFocus:(0,r.composeEventHandlers)(e.onFocus,e=>{let t=!R.current;if(e.target===e.currentTarget&&t&&!S){let t=new CustomEvent(h,m);if(e.currentTarget.dispatchEvent(t),!t.defaultPrevented){let e=K().filter(e=>e.focusable);L([e.find(e=>e.active),e.find(e=>e.id===I),...e].filter(Boolean).map(e=>e.ref.current),w)}}R.current=!1}),onBlur:(0,r.composeEventHandlers)(e.onBlur,()=>A(!1))})})}),C="RovingFocusGroupItem",N=s.forwardRef((e,i)=>{let{__scopeRovingFocusGroup:n,focusable:a=!0,active:l=!1,tabStopId:d,children:u,...h}=e,m=(0,c.useId)(),p=d||m,g=b(C,n),v=g.currentTabStopId===p,f=x(n),{onFocusableItemAdd:k,onFocusableItemRemove:j,currentTabStopId:w}=g;return s.useEffect(()=>{if(a)return k(),()=>j()},[a,k,j]),(0,t.jsx)(y.ItemSlot,{scope:n,id:p,focusable:a,active:l,children:(0,t.jsx)(o.Primitive.span,{tabIndex:v?0:-1,"data-orientation":g.orientation,...h,ref:i,onMouseDown:(0,r.composeEventHandlers)(e.onMouseDown,e=>{a?g.onItemFocus(p):e.preventDefault()}),onFocus:(0,r.composeEventHandlers)(e.onFocus,()=>g.onItemFocus(p)),onKeyDown:(0,r.composeEventHandlers)(e.onKeyDown,e=>{if("Tab"===e.key&&e.shiftKey)return void g.onItemShiftTab();if(e.target!==e.currentTarget)return;let t=function(e,t,s){var r;let i=(r=e.key,"rtl"!==s?r:"ArrowLeft"===r?"ArrowRight":"ArrowRight"===r?"ArrowLeft":r);if(!("vertical"===t&&["ArrowLeft","ArrowRight"].includes(i))&&!("horizontal"===t&&["ArrowUp","ArrowDown"].includes(i)))return D[i]}(e,g.orientation,g.dir);if(void 0!==t){if(e.metaKey||e.ctrlKey||e.altKey||e.shiftKey)return;e.preventDefault();let i=f().filter(e=>e.focusable).map(e=>e.ref.current);if("last"===t)i.reverse();else if("prev"===t||"next"===t){var s,r;"prev"===t&&i.reverse();let n=i.indexOf(e.currentTarget);i=g.loop?(s=i,r=n+1,s.map((e,t)=>s[(r+t)%s.length])):i.slice(n+1)}setTimeout(()=>L(i))}}),children:"function"==typeof u?u({isCurrentTabStop:v,hasTabStop:null!=w}):u})})});N.displayName=C;var D={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function L(e,t=!1){let s=document.activeElement;for(let r of e)if(r===s||(r.focus({preventScroll:t}),document.activeElement!==s))return}var T=e.i(62393),I="Tabs",[M,S]=(0,i.createContextScope)(I,[f]),A=f(),[E,K]=M(I),R=s.forwardRef((e,s)=>{let{__scopeTabs:r,value:i,onValueChange:n,defaultValue:a,orientation:l="horizontal",dir:h,activationMode:m="automatic",...p}=e,y=(0,u.useDirection)(h),[x,g]=(0,d.useControllableState)({prop:i,onChange:n,defaultProp:a??"",caller:I});return(0,t.jsx)(E,{scope:r,baseId:(0,c.useId)(),value:x,onValueChange:g,orientation:l,dir:y,activationMode:m,children:(0,t.jsx)(o.Primitive.div,{dir:y,"data-orientation":l,...p,ref:s})})});R.displayName=I;var P="TabsList",$=s.forwardRef((e,s)=>{let{__scopeTabs:r,loop:i=!0,...n}=e,a=K(P,r),c=A(r);return(0,t.jsx)(j,{asChild:!0,...c,orientation:a.orientation,dir:a.dir,loop:i,children:(0,t.jsx)(o.Primitive.div,{role:"tablist","aria-orientation":a.orientation,...n,ref:s})})});$.displayName=P;var H="TabsTrigger",z=s.forwardRef((e,s)=>{let{__scopeTabs:i,value:n,disabled:a=!1,...c}=e,l=K(H,i),d=A(i),u=q(l.baseId,n),h=B(l.baseId,n),m=n===l.value;return(0,t.jsx)(N,{asChild:!0,...d,focusable:!a,active:m,children:(0,t.jsx)(o.Primitive.button,{type:"button",role:"tab","aria-selected":m,"aria-controls":h,"data-state":m?"active":"inactive","data-disabled":a?"":void 0,disabled:a,id:u,...c,ref:s,onMouseDown:(0,r.composeEventHandlers)(e.onMouseDown,e=>{a||0!==e.button||!1!==e.ctrlKey?e.preventDefault():l.onValueChange(n)}),onKeyDown:(0,r.composeEventHandlers)(e.onKeyDown,e=>{[" ","Enter"].includes(e.key)&&l.onValueChange(n)}),onFocus:(0,r.composeEventHandlers)(e.onFocus,()=>{let e="manual"!==l.activationMode;m||a||!e||l.onValueChange(n)})})})});z.displayName=H;var F="TabsContent",U=s.forwardRef((e,r)=>{let{__scopeTabs:i,value:n,forceMount:a,children:c,...l}=e,d=K(F,i),u=q(d.baseId,n),h=B(d.baseId,n),m=n===d.value,p=s.useRef(m);return s.useEffect(()=>{let e=requestAnimationFrame(()=>p.current=!1);return()=>cancelAnimationFrame(e)},[]),(0,t.jsx)(T.Presence,{present:a||m,children:({present:s})=>(0,t.jsx)(o.Primitive.div,{"data-state":m?"active":"inactive","data-orientation":d.orientation,role:"tabpanel","aria-labelledby":u,hidden:!s,id:h,tabIndex:0,...l,ref:r,style:{...e.style,animationDuration:p.current?"0s":void 0},children:s&&c})})});function q(e,t){return`${e}-trigger-${t}`}function B(e,t){return`${e}-content-${t}`}U.displayName=F;var V=e.i(9799);function O({className:e,...s}){return(0,t.jsx)(R,{"data-slot":"tabs",className:(0,V.cn)("flex flex-col gap-2",e),...s})}function _({className:e,...s}){return(0,t.jsx)($,{"data-slot":"tabs-list",className:(0,V.cn)("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",e),...s})}function W({className:e,...s}){return(0,t.jsx)(z,{"data-slot":"tabs-trigger",className:(0,V.cn)("data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...s})}function G({className:e,...s}){return(0,t.jsx)(U,{"data-slot":"tabs-content",className:(0,V.cn)("flex-1 outline-none",e),...s})}e.s(["Tabs",()=>O,"TabsContent",()=>G,"TabsList",()=>_,"TabsTrigger",()=>W],34768)},36783,e=>{"use strict";let t=(0,e.i(27489).default)("key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);e.s(["Key",()=>t],36783)},2130,e=>{"use strict";let t=(0,e.i(27489).default)("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);e.s(["Lock",()=>t],2130)},3189,e=>{"use strict";let t=(0,e.i(27489).default)("sword",[["path",{d:"m11 19-6-6",key:"s7kpr"}],["path",{d:"m5 21-2-2",key:"1kw20b"}],["path",{d:"m8 16-4 4",key:"1oqv8h"}],["path",{d:"M9.5 17.5 21 6V3h-3L6.5 14.5",key:"pkxemp"}]]);e.s(["Sword",()=>t],3189)},45511,e=>{"use strict";let t=(0,e.i(27489).default)("lock-open",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]);e.s(["Unlock",()=>t],45511)},77164,e=>{"use strict";let t=(0,e.i(27489).default)("play",[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]]);e.s(["Play",()=>t],77164)},64346,e=>{"use strict";let t=(0,e.i(27489).default)("cpu",[["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M17 20v2",key:"1rnc9c"}],["path",{d:"M17 2v2",key:"11trls"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M2 17h2",key:"7oei6x"}],["path",{d:"M2 7h2",key:"asdhe0"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"M20 17h2",key:"1fpfkl"}],["path",{d:"M20 7h2",key:"1o8tra"}],["path",{d:"M7 20v2",key:"4gnj0m"}],["path",{d:"M7 2v2",key:"1i4yhu"}],["rect",{x:"4",y:"4",width:"16",height:"16",rx:"2",key:"1vbyd7"}],["rect",{x:"8",y:"8",width:"8",height:"8",rx:"1",key:"z9xiuo"}]]);e.s(["Cpu",()=>t],64346)},19539,e=>{"use strict";let t=(0,e.i(27489).default)("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);e.s(["CheckCircle2",()=>t],19539)},68524,e=>{"use strict";var t=e.i(53811),s=e.i(12140),r=e.i(9799);let i=(0,s.cva)("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function n({className:e,variant:s,...n}){return(0,t.jsx)("div",{"data-slot":"alert",role:"alert",className:(0,r.cn)(i({variant:s}),e),...n})}function a({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"alert-title",className:(0,r.cn)("col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight",e),...s})}function c({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"alert-description",className:(0,r.cn)("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",e),...s})}e.s(["Alert",()=>n,"AlertDescription",()=>c,"AlertTitle",()=>a])},11931,e=>{"use strict";function t(e,t){let s=Math.min(e.length,t.length),r=new Uint8Array(s);for(let i=0;i<s;i++)r[i]=e[i]^t[i];return r}function s(e=16){let t=new Uint8Array(e);if(window.crypto)window.crypto.getRandomValues(t);else for(let s=0;s<e;s++)t[s]=Math.floor(256*Math.random());return t}function r(e){return Array.from(e).map(e=>e.toString(16).padStart(2,"0")).join("")}function i(e){let t=new Uint8Array(e.length/2);for(let s=0;s<t.length;s++)t[s]=parseInt(e.substr(2*s,2),16);return t}function n(e){return new TextEncoder().encode(e)}function a(e){return btoa(String.fromCharCode(...e))}function c(e){return Uint8Array.from(atob(e),e=>e.charCodeAt(0))}function o(e){let t=0;for(let s=0;s<e.length;s++)t=(t<<5)-t+e[s]|0;return Math.abs(t).toString(16).padStart(8,"0")}function l(){let e=r(s(16));return`${e.slice(0,8)}-${e.slice(8,12)}-${e.slice(12,16)}-${e.slice(16,20)}-${e.slice(20,32)}`}class d{key;iv;constructor(e,t){this.key=e,this.iv=t||s(16)}encryptCTR(e){let t=new Uint8Array(e.length);for(let s=0;s<e.length;s+=16){let r=new Uint8Array(16);r.set(this.iv.slice(0,8),0);let i=Math.floor(s/16);for(let e=0;e<8;e++)r[8+e]=i>>8*(7-e)&255;let n=function(e,t){let s=new Uint8Array(e.length);for(let r=0;r<e.length;r++)s[r]=e[r]^t[r%t.length];return s}(r,this.key),a=Math.min(s+16,e.length);for(let r=s;r<a;r++)t[r]=e[r]^n[r-s]}return{ciphertext:t,iv:this.iv}}decryptCTR(e){return this.encryptCTR(e).ciphertext}getIV(){return this.iv}}class u{privateKey;publicKey;modulus;constructor(){this.modulus=3233,this.publicKey=17,this.privateKey=this.modInverse(this.publicKey,3120)}modInverse(e,t){let[s,r]=[e,t],[i,n]=[1,0];for(;0!==r;){let e=Math.floor(s/r);[s,r]=[r,s-e*r],[i,n]=[n,i-e*n]}return(i%t+t)%t}modPow(e,t,s){let r=1;for(e%=s;t>0;)t%2==1&&(r=r*e%s),t=Math.floor(t/2),e=e*e%s;return r}encrypt(e){return this.modPow(e,this.publicKey,this.modulus)}decrypt(e){return this.modPow(e,this.privateKey,this.modulus)}encryptBytes(e){return Array.from(e).map(e=>this.encrypt(e))}decryptBytes(e){return new Uint8Array(e.map(e=>this.decrypt(e)))}getPublicKey(){return{e:this.publicKey,n:this.modulus}}sign(e){return Array.from(n(o(e))).map(e=>this.modPow(e,this.privateKey,this.modulus)).join(",")}verify(e,t){var s;let r=o(e);return s=new Uint8Array(t.split(",").map(Number).map(e=>this.modPow(e,this.publicKey,this.modulus))),new TextDecoder().decode(s)===r}}e.s(["SimpleAsymmetric",()=>u,"SimpleCipher",()=>d,"base64Decode",()=>c,"base64Encode",()=>a,"bytesToHex",()=>r,"generateKey",()=>s,"generateKeyId",()=>l,"hexToBytes",()=>i,"simpleHash",()=>o,"stringToBytes",()=>n,"xorBytes",()=>t])},1504,e=>{"use strict";let t=(0,e.i(27489).default)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);e.s(["XCircle",()=>t],1504)},69596,99957,e=>{"use strict";var t=e.i(11931);class s{deviceId;securityLevel;asymmetric;sessions;events;manufacturer;model;constructor(e="L3",s={},r){this.securityLevel=e,this.deviceId=(0,t.generateKeyId)(),this.asymmetric=new t.SimpleAsymmetric,this.sessions=new Map,this.events=s,this.manufacturer=r?.manufacturer||"Mock Devices Inc",this.model=r?.model||`MockCDM-${e}`,this.log(`CDM initialized with security level ${e}`)}log(e,t){this.events.onLog?.(`[CDM] ${e}`,t)}getDeviceCertificate(){let e={deviceId:this.deviceId,securityLevel:this.securityLevel,publicKey:this.asymmetric.getPublicKey(),manufacturer:this.manufacturer,model:this.model,timestamp:Date.now()},s=this.asymmetric.sign((0,t.stringToBytes)(JSON.stringify(e)));return{...e,signature:s}}createSession(e){let s=(0,t.generateKeyId)(),r={sessionId:s,keyIds:e,keys:new Map,state:"created",createdAt:Date.now(),expiresAt:null};return this.sessions.set(s,r),this.log(`Session created: ${s}`,{keyIds:e}),this.events.onSessionCreated?.(r),r}generateLicenseChallenge(e){let s=this.sessions.get(e);if(!s)throw Error(`Session not found: ${e}`);s.state="pending",this.events.onSessionUpdated?.(s);let r={version:1,deviceCertificate:this.getDeviceCertificate(),keyIds:s.keyIds,sessionId:e,nonce:(0,t.bytesToHex)((0,t.generateKey)(16)),timestamp:Date.now()},i=this.asymmetric.sign((0,t.stringToBytes)(JSON.stringify(r))),n={...r,signature:i};return this.log("License challenge generated",{sessionId:e,keyIds:s.keyIds}),n}processLicenseResponse(e){let s=this.sessions.get(e.sessionId);if(!s)throw Error(`Session not found: ${e.sessionId}`);for(let r of(this.log("Processing license response",{sessionId:e.sessionId}),e.keys))if("CONTENT"===r.type){let e=(0,t.base64Decode)(r.key);s.keys.set(r.keyId,e),this.log(`Key added: ${r.keyId}`,{keyLength:e.length,keyHex:"L3"===this.securityLevel?(0,t.bytesToHex)(e):"[PROTECTED]"}),this.events.onKeyAdded?.(s.sessionId,r.keyId)}s.state="active",e.policy.licenseDuration>0&&(s.expiresAt=Date.now()+1e3*e.policy.licenseDuration),this.events.onSessionUpdated?.(s),this.log("Session activated",{sessionId:s.sessionId,keyCount:s.keys.size})}decrypt(e,s,r,i){let n=this.sessions.get(e);if(!n)throw Error(`Session not found: ${e}`);if("active"!==n.state)throw Error(`Session not active: ${n.state}`);let a=n.keys.get(s);if(!a)throw Error(`Key not found: ${s}`);this.log("Decrypting content",{sessionId:e,keyId:s,ciphertextLength:r.length});let c=new t.SimpleCipher(a,i).decryptCTR(r);return"L1"===this.securityLevel?this.log("L1: Decryption in hardware TEE - content protected"):"L2"===this.securityLevel?this.log("L2: Keys in hardware, decryption in software - partially protected"):this.log("L3: Full software decryption - content accessible in memory"),c}getSession(e){return this.sessions.get(e)}closeSession(e){let t=this.sessions.get(e);t&&(t.state="closed",t.keys.clear(),this.sessions.delete(e),this.log("Session closed",{sessionId:e}),this.events.onSessionClosed?.(e))}getSessions(){return Array.from(this.sessions.values())}getSecurityLevel(){return this.securityLevel}getDeviceId(){return this.deviceId}simulateMemoryDump(){if("L1"===this.securityLevel)return this.log("Memory dump blocked - L1 hardware protection"),null;if("L2"===this.securityLevel)return this.log("Memory dump partial - keys in hardware, but decrypted content accessible"),null;this.log("VULNERABILITY: L3 memory dump successful - keys extracted!");let e=new Map;for(let s of this.sessions.values())for(let[r,i]of s.keys)e.set(r,(0,t.bytesToHex)(i));return e}}e.s(["MockCDM",()=>s],69596);let r={serverName:"Mock DRM License Server",enableSecurityCheck:!0,enableDeviceRevocation:!0,defaultPolicy:{canPlay:!0,canPersist:!1,licenseDuration:86400,playbackDuration:14400,renewalDelay:3600}};class i{config;content;revokedDevices;issuedLicenses;asymmetric;events;constructor(e={},s={}){this.config={...r,...e},this.content=new Map,this.revokedDevices=new Set,this.issuedLicenses=new Map,this.asymmetric=new t.SimpleAsymmetric,this.events=s,this.log("License server initialized",{serverName:this.config.serverName})}log(e,t){this.events.onLog?.(`[Server] ${e}`,t)}registerContent(e,s,r="L3",i){let n=(0,t.generateKeyId)(),a={contentId:e,title:s,keyId:n,key:(0,t.generateKey)(16),iv:(0,t.generateKey)(16),requiredSecurityLevel:r,policy:{...this.config.defaultPolicy,...i}};return this.content.set(e,a),this.log("Content registered",{contentId:e,title:s,keyId:n,requiredSecurityLevel:r}),a}getContentInfo(e){let t=this.content.get(e);if(!t)return null;let{key:s,...r}=t;return r}getKeyId(e){return this.content.get(e)?.keyId||null}revokeDevice(e){this.revokedDevices.add(e),this.log("Device revoked",{deviceId:e}),this.events.onDeviceRevoked?.(e)}isDeviceRevoked(e){return this.revokedDevices.has(e)}validateChallenge(e){if(Math.abs(Date.now()-e.timestamp)>3e5)return{valid:!1,reason:"Challenge expired"};let t=e.deviceCertificate;return t.deviceId&&t.securityLevel?this.config.enableDeviceRevocation&&this.isDeviceRevoked(t.deviceId)?{valid:!1,reason:"Device revoked"}:e.keyIds&&0!==e.keyIds.length?{valid:!0}:{valid:!1,reason:"No key IDs requested"}:{valid:!1,reason:"Invalid device certificate"}}checkSecurityLevel(e,t){let s={L1:3,L2:2,L3:1};return s[e]>=s[t]}processLicenseRequest(e,s){this.log("Processing license request",{sessionId:e.sessionId,contentId:s,deviceId:e.deviceCertificate.deviceId,securityLevel:e.deviceCertificate.securityLevel}),this.events.onLicenseRequest?.(e);let r=this.validateChallenge(e);if(!r.valid)return this.log("License request denied",{reason:r.reason}),this.events.onLicenseDenied?.(r.reason,e),{error:r.reason};let i=this.content.get(s);if(!i){let t="Content not found";return this.log("License request denied",{reason:t}),this.events.onLicenseDenied?.(t,e),{error:t}}if(this.config.enableSecurityCheck&&!this.checkSecurityLevel(e.deviceCertificate.securityLevel,i.requiredSecurityLevel)){let t=`Security level too low. Required: ${i.requiredSecurityLevel}, Device: ${e.deviceCertificate.securityLevel}`;return this.log("License request denied",{reason:t}),this.events.onLicenseDenied?.(t,e),{error:t}}let n=[{keyId:i.keyId,key:(0,t.base64Encode)(i.key),iv:(0,t.base64Encode)(i.iv),type:"CONTENT"}],a={version:1,sessionId:e.sessionId,keys:n,policy:i.policy,serverNonce:(0,t.bytesToHex)((0,t.generateKey)(16)),timestamp:Date.now()},c=this.asymmetric.sign((0,t.stringToBytes)(JSON.stringify(a))),o={...a,signature:c};return this.issuedLicenses.set(e.sessionId,{challenge:e,response:o,timestamp:Date.now()}),this.log("License issued",{sessionId:e.sessionId,contentId:s,keyId:i.keyId}),this.events.onLicenseIssued?.(o,i),o}getIssuedLicense(e){return this.issuedLicenses.get(e)}getAllContent(){let e=new Map;for(let[t,s]of this.content){let{key:r,...i}=s;e.set(t,i)}return e}getContentWithKey(e){return this.content.get(e)||null}getStats(){return{serverName:this.config.serverName,registeredContent:this.content.size,issuedLicenses:this.issuedLicenses.size,revokedDevices:this.revokedDevices.size}}}e.s(["MockLicenseServer",()=>i],99957)},96856,e=>{"use strict";let t=(0,e.i(27489).default)("terminal",[["path",{d:"M12 19h8",key:"baeox8"}],["path",{d:"m4 17 6-6-6-6",key:"1yngyt"}]]);e.s(["Terminal",()=>t],96856)},34804,e=>{"use strict";var t=e.i(53811),s=e.i(83899),r=e.i(23376),i=e.i(78349),n=e.i(11350),a=e.i(68524),c=e.i(34768),o=e.i(15004),l=e.i(50985),d=e.i(77164),u=e.i(10914),h=e.i(57325),m=e.i(3189),p=e.i(64346),y=e.i(27489);let x=(0,y.default)("hard-drive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]);var g=e.i(36783),v=e.i(2130),f=e.i(45511),k=e.i(19539),b=e.i(1504),j=e.i(96856);let w=(0,y.default)("bug",[["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M14 7a4 4 0 0 1 4 4v3a6 6 0 0 1-12 0v-3a4 4 0 0 1 4-4z",key:"uouzyp"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M21 21a4 4 0 0 0-3.81-4",key:"1b0z45"}],["path",{d:"M21 5a4 4 0 0 1-3.55 3.97",key:"5cxbf6"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M3 21a4 4 0 0 1 3.81-4",key:"1fjd4g"}],["path",{d:"M3 5a4 4 0 0 0 3.55 3.97",key:"1d7oge"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M9 7.13V6a3 3 0 1 1 6 0v1.13",key:"1vgav8"}]]);var C=e.i(80042),N=e.i(69596),D=e.i(99957);function L(){let{perspective:e}=(0,C.usePerspective)(),[y,L]=(0,s.useState)("L3"),[T,I]=(0,s.useState)([{id:"identify",title:"Identify CDM Type",description:"Detect Widevine CDM version and security level",status:"pending"},{id:"locate",title:"Locate CDM Binary",description:"Find CDM library in browser/device memory",status:"pending"},{id:"attach",title:"Attach Debugger",description:"Attach to process and set breakpoints",status:"pending"},{id:"intercept",title:"Intercept License",description:"Capture license response before processing",status:"pending"},{id:"extract",title:"Extract Keys",description:"Dump decryption keys from memory",status:"pending"},{id:"verify",title:"Verify Keys",description:"Test extracted keys against encrypted content",status:"pending"}]),[M,S]=(0,s.useState)([]),[A,E]=(0,s.useState)(!1),[K,R]=(0,s.useState)(null),P=(0,s.useCallback)((e,t,s)=>{S(r=>[...r,{timestamp:Date.now(),type:e,message:t,data:s}])},[]),$=(0,s.useCallback)((e,t,s)=>{I(r=>r.map(r=>r.id===e?{...r,status:t,details:s}:r))},[]),H=e=>new Promise(t=>setTimeout(t,e)),z=async()=>{E(!0),R(null),I(e=>e.map(e=>({...e,status:"pending",details:void 0}))),S([]),P("info",`Starting CDM extraction attack against ${y} device...`),P("warning","This is a simulation for educational purposes only");let e=new N.MockCDM(y,{onLog:(e,t)=>P("info",e,t)}),t=new D.MockLicenseServer({},{onLog:(e,t)=>P("info",e,t)}),s=t.registerContent("test-movie","Test Movie",y);if(P("info",`Target content: ${s.title} (KeyID: ${s.keyId})`),$("identify","running"),await H(1e3),P("attack",`Detected CDM: Widevine ${y}`),P("info",`Device ID: ${e.getDeviceId()}`),$("identify","success",`Widevine ${y} detected`),$("locate","running"),await H(1200),"L1"===y){P("error","CDM binary protected by hardware TEE - cannot locate in memory"),$("locate","blocked","Hardware TEE protection active"),P("warning","Attack blocked: L1 hardware protection prevents memory access"),E(!1);return}P("attack","Located libwidevinecdm.so in process memory"),P("info","Base address: 0x7f4a8c000000"),$("locate","success","CDM library located at 0x7f4a8c000000"),$("attach","running"),await H(800),"L2"===y&&(P("warning","L2 protection: Keys stored in hardware, but decryption in software"),P("info","Can intercept decrypted content, but not extract raw keys")),P("attack","Debugger attached to CDM process"),P("info","Set breakpoint at Cdm_Decrypt function"),$("attach","success","Debugger attached, breakpoints set"),$("intercept","running"),await H(1500);let r=e.createSession([s.keyId]),i=e.generateLicenseChallenge(r.sessionId);P("attack","Intercepted license challenge");let n=t.processLicenseRequest(i,s.contentId);if("error"in n){P("error",`License request failed: ${n.error}`),$("intercept","failed",n.error),E(!1);return}e.processLicenseResponse(n),P("attack","Intercepted license response with encrypted keys"),P("info",`Session ID: ${r.sessionId}`),$("intercept","success","License response captured"),$("extract","running"),await H(1e3);let a=e.simulateMemoryDump();if(!a){P("error","Memory dump blocked by hardware protection"),$("extract","blocked","Hardware protection active"),"L2"===y&&(P("warning","L2: Keys protected in hardware security module"),P("info","Alternative: Intercept decrypted frames instead of keys")),E(!1);return}P("attack",`VULNERABILITY EXPLOITED: ${a.size} key(s) extracted from memory!`),a.forEach((e,t)=>{P("success",`Key ID: ${t}`),P("success",`Key: ${e}`)}),R(a),$("extract","success",`${a.size} key(s) extracted`),$("verify","running"),await H(800),P("attack","Testing extracted keys against encrypted content..."),P("success","Keys verified - content can be decrypted!"),$("verify","success","Keys working"),P("success","Attack completed successfully"),P("warning","This demonstrates why L3 devices are vulnerable to key extraction"),E(!1)};return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[(0,t.jsx)(p.Cpu,{className:"w-6 h-6 text-red-500"}),"CDM Extraction Attack"]}),(0,t.jsx)("p",{className:"text-muted-foreground mt-1",children:"Simulate Content Decryption Module key extraction attack"})]}),(0,t.jsx)(n.Badge,{variant:"red-team"===e?"destructive":"default",children:"red-team"===e?"Attack Mode":"Defense Analysis"})]}),(0,t.jsxs)(a.Alert,{variant:"destructive",children:[(0,t.jsx)(u.AlertTriangle,{className:"h-4 w-4"}),(0,t.jsx)(a.AlertTitle,{children:"Educational Simulation Only"}),(0,t.jsx)(a.AlertDescription,{children:"This simulates a CDM memory dump attack for educational purposes. Actual attacks against production DRM systems are illegal."})]}),(0,t.jsxs)(c.Tabs,{defaultValue:"attack",className:"space-y-4",children:[(0,t.jsxs)(c.TabsList,{children:[(0,t.jsxs)(c.TabsTrigger,{value:"attack",className:"gap-2",children:[(0,t.jsx)(m.Sword,{className:"w-4 h-4"}),"Attack Simulation"]}),(0,t.jsxs)(c.TabsTrigger,{value:"defense",className:"gap-2",children:[(0,t.jsx)(h.Shield,{className:"w-4 h-4"}),"Defense Analysis"]}),(0,t.jsxs)(c.TabsTrigger,{value:"technical",className:"gap-2",children:[(0,t.jsx)(j.Terminal,{className:"w-4 h-4"}),"Technical Details"]})]}),(0,t.jsxs)(c.TabsContent,{value:"attack",className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[(0,t.jsxs)(r.Card,{children:[(0,t.jsxs)(r.CardHeader,{children:[(0,t.jsx)(r.CardTitle,{className:"text-lg",children:"Target Configuration"}),(0,t.jsx)(r.CardDescription,{children:"Select target device security level"})]}),(0,t.jsxs)(r.CardContent,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium",children:"Security Level"}),(0,t.jsx)("div",{className:"flex gap-2",children:["L1","L2","L3"].map(e=>(0,t.jsx)(i.Button,{variant:y===e?"default":"outline",size:"sm",onClick:()=>L(e),disabled:A,className:"flex-1",children:e},e))})]}),(0,t.jsxs)("div",{className:"rounded-lg border p-3 bg-muted/50",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:["L1"===y&&(0,t.jsx)(v.Lock,{className:"w-4 h-4 text-green-500"}),"L2"===y&&(0,t.jsx)(g.Key,{className:"w-4 h-4 text-yellow-500"}),"L3"===y&&(0,t.jsx)(f.Unlock,{className:"w-4 h-4 text-red-500"}),(0,t.jsxs)("span",{className:"font-medium",children:[y," Protection"]})]}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:["L1"===y&&"Hardware TEE protection - keys never exposed","L2"===y&&"Keys in hardware, decryption in software","L3"===y&&"Full software - vulnerable to memory attacks"]})]}),(0,t.jsxs)(i.Button,{onClick:z,disabled:A,className:"w-full gap-2",variant:"destructive",children:[(0,t.jsx)(d.Play,{className:"w-4 h-4"}),A?"Attack Running...":"Launch Attack"]})]})]}),(0,t.jsxs)(r.Card,{children:[(0,t.jsxs)(r.CardHeader,{children:[(0,t.jsx)(r.CardTitle,{className:"text-lg",children:"Attack Progress"}),(0,t.jsx)(r.CardDescription,{children:"Step-by-step extraction process"})]}),(0,t.jsx)(r.CardContent,{children:(0,t.jsx)("div",{className:"space-y-3",children:T.map((e,s)=>(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)("div",{className:"mt-0.5",children:(e=>{switch(e){case"pending":return(0,t.jsx)("div",{className:"w-4 h-4 rounded-full border-2 border-muted-foreground"});case"running":return(0,t.jsx)("div",{className:"w-4 h-4 rounded-full border-2 border-primary animate-pulse bg-primary/20"});case"success":return(0,t.jsx)(k.CheckCircle2,{className:"w-4 h-4 text-green-500"});case"failed":return(0,t.jsx)(b.XCircle,{className:"w-4 h-4 text-red-500"});case"blocked":return(0,t.jsx)(h.Shield,{className:"w-4 h-4 text-blue-500"})}})(e.status)}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)("span",{className:"text-xs text-muted-foreground",children:[s+1,"."]}),(0,t.jsx)("span",{className:"font-medium text-sm",children:e.title})]}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:e.description}),e.details&&(0,t.jsx)("p",{className:"text-xs mt-1 text-primary",children:e.details})]})]},e.id))})})]}),(0,t.jsxs)(r.Card,{children:[(0,t.jsxs)(r.CardHeader,{children:[(0,t.jsx)(r.CardTitle,{className:"text-lg",children:"Extracted Keys"}),(0,t.jsx)(r.CardDescription,{children:"Keys recovered from memory"})]}),(0,t.jsx)(r.CardContent,{children:K?(0,t.jsxs)("div",{className:"space-y-3",children:[Array.from(K.entries()).map(([e,s])=>(0,t.jsxs)("div",{className:"rounded-lg border border-red-500/50 bg-red-500/10 p-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,t.jsx)(g.Key,{className:"w-4 h-4 text-red-500"}),(0,t.jsx)("span",{className:"text-sm font-medium text-red-400",children:"Key Extracted"})]}),(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsxs)("div",{className:"text-xs",children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Key ID: "}),(0,t.jsx)("code",{className:"text-xs bg-background px-1 rounded",children:e})]}),(0,t.jsxs)("div",{className:"text-xs",children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Key: "}),(0,t.jsx)("code",{className:"text-xs bg-background px-1 rounded break-all",children:s})]})]})]},e)),(0,t.jsxs)(a.Alert,{variant:"destructive",className:"mt-4",children:[(0,t.jsx)(u.AlertTriangle,{className:"h-4 w-4"}),(0,t.jsx)(a.AlertDescription,{className:"text-xs",children:"In a real attack, these keys could decrypt all protected content."})]})]}):(0,t.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,t.jsx)(x,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),(0,t.jsx)("p",{className:"text-sm",children:"No keys extracted yet"}),(0,t.jsx)("p",{className:"text-xs",children:"Run the attack to attempt extraction"})]})})]})]}),(0,t.jsxs)(r.Card,{children:[(0,t.jsxs)(r.CardHeader,{children:[(0,t.jsx)(r.CardTitle,{className:"text-lg",children:"Attack Log"}),(0,t.jsx)(r.CardDescription,{children:"Real-time attack output"})]}),(0,t.jsx)(r.CardContent,{children:(0,t.jsx)(o.ScrollArea,{className:"h-[200px] rounded-lg border bg-zinc-950 p-3",children:0===M.length?(0,t.jsx)("div",{className:"text-center text-muted-foreground text-sm py-8",children:"Launch attack to see output..."}):(0,t.jsx)("div",{className:"space-y-1 font-mono text-xs",children:M.map((e,s)=>(0,t.jsxs)("div",{className:"flex items-start gap-2",children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:new Date(e.timestamp).toLocaleTimeString()}),(e=>{switch(e){case"info":return(0,t.jsx)(j.Terminal,{className:"w-3 h-3 text-muted-foreground"});case"warning":return(0,t.jsx)(u.AlertTriangle,{className:"w-3 h-3 text-yellow-500"});case"success":return(0,t.jsx)(k.CheckCircle2,{className:"w-3 h-3 text-green-500"});case"error":return(0,t.jsx)(b.XCircle,{className:"w-3 h-3 text-red-500"});case"attack":return(0,t.jsx)(w,{className:"w-3 h-3 text-red-400"})}})(e.type),(0,t.jsx)("span",{className:"error"===e.type?"text-red-400":"warning"===e.type?"text-yellow-400":"success"===e.type?"text-green-400":"attack"===e.type?"text-red-400":"text-muted-foreground",children:e.message})]},s))})})})]})]}),(0,t.jsx)(c.TabsContent,{value:"defense",className:"space-y-4",children:(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)(r.Card,{children:[(0,t.jsx)(r.CardHeader,{children:(0,t.jsxs)(r.CardTitle,{className:"flex items-center gap-2",children:[(0,t.jsx)(h.Shield,{className:"w-5 h-5 text-blue-500"}),"Prevention Strategies"]})}),(0,t.jsx)(r.CardContent,{className:"space-y-4",children:(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"p-3 rounded-lg border bg-green-500/10 border-green-500/30",children:[(0,t.jsx)("h4",{className:"font-medium text-green-400 mb-1",children:"Use L1 Security Level"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Hardware TEE protection prevents any software-based key extraction. Keys never exist in accessible memory."})]}),(0,t.jsxs)("div",{className:"p-3 rounded-lg border bg-blue-500/10 border-blue-500/30",children:[(0,t.jsx)("h4",{className:"font-medium text-blue-400 mb-1",children:"Anti-Debugging Measures"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Implement ptrace detection, timing checks, and integrity verification to detect and prevent debugger attachment."})]}),(0,t.jsxs)("div",{className:"p-3 rounded-lg border bg-purple-500/10 border-purple-500/30",children:[(0,t.jsx)("h4",{className:"font-medium text-purple-400 mb-1",children:"Code Obfuscation"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Obfuscate CDM code paths and key handling routines to make reverse engineering more difficult."})]})]})})]}),(0,t.jsxs)(r.Card,{children:[(0,t.jsx)(r.CardHeader,{children:(0,t.jsxs)(r.CardTitle,{className:"flex items-center gap-2",children:[(0,t.jsx)(u.AlertTriangle,{className:"w-5 h-5 text-yellow-500"}),"Detection Methods"]})}),(0,t.jsx)(r.CardContent,{className:"space-y-4",children:(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"p-3 rounded-lg border",children:[(0,t.jsx)("h4",{className:"font-medium mb-1",children:"Device Attestation"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Verify device integrity before issuing licenses. Detect rooted/jailbroken devices that may have compromised CDMs."})]}),(0,t.jsxs)("div",{className:"p-3 rounded-lg border",children:[(0,t.jsx)("h4",{className:"font-medium mb-1",children:"Anomaly Detection"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Monitor for unusual patterns: same device ID requesting many different content licenses, impossible playback speeds, etc."})]}),(0,t.jsxs)("div",{className:"p-3 rounded-lg border",children:[(0,t.jsx)("h4",{className:"font-medium mb-1",children:"Forensic Watermarking"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Embed unique identifiers in content that survive re-encoding, enabling leak source identification."})]})]})})]})]})}),(0,t.jsx)(c.TabsContent,{value:"technical",className:"space-y-4",children:(0,t.jsxs)(r.Card,{children:[(0,t.jsxs)(r.CardHeader,{children:[(0,t.jsx)(r.CardTitle,{children:"Technical Background"}),(0,t.jsx)(r.CardDescription,{children:"How CDM extraction attacks work"})]}),(0,t.jsx)(r.CardContent,{className:"prose prose-invert max-w-none",children:(0,t.jsxs)("div",{className:"space-y-4 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-medium mb-2",children:"Attack Vector"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"CDM extraction attacks target the Content Decryption Module, which is responsible for receiving encrypted keys from a license server and using them to decrypt protected content. In L3 (software-only) implementations, these keys exist unprotected in process memory during playback."})]}),(0,t.jsx)(l.Separator,{}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-medium mb-2",children:"Tools Used (in real attacks)"}),(0,t.jsxs)("ul",{className:"list-disc pl-4 text-muted-foreground space-y-1",children:[(0,t.jsx)("li",{children:"Frida - Dynamic instrumentation toolkit"}),(0,t.jsx)("li",{children:"IDA Pro / Ghidra - Disassemblers for CDM binary analysis"}),(0,t.jsx)("li",{children:"WideVine L3 Decryptor scripts"}),(0,t.jsx)("li",{children:"Custom key extraction scripts"})]})]}),(0,t.jsx)(l.Separator,{}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-medium mb-2",children:"Why L1 is Secure"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"L1 devices use a hardware Trusted Execution Environment (TEE) like ARM TrustZone or Intel SGX. The keys are decrypted inside the TEE and never exposed to the main processor or operating system. Even with root access, the keys cannot be extracted through software means."})]}),(0,t.jsx)(l.Separator,{}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-medium mb-2",children:"Impact of Compromise"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"When an L3 CDM is compromised, attackers can extract keys for any content licensed to that device. These keys can then be shared or used to create pirated copies of protected content. This is why premium 4K content is typically restricted to L1 devices only."})]})]})})]})})]})]})}e.s(["CDMExtractionLab",()=>L],34804)}]);