(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,36783,e=>{"use strict";let t=(0,e.i(27489).default)("key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);e.s(["Key",()=>t],36783)},37171,e=>{"use strict";let t=(0,e.i(27489).default)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);e.s(["Eye",()=>t],37171)},11186,e=>{"use strict";let t=(0,e.i(27489).default)("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);e.s(["ArrowRight",()=>t],11186)},77164,e=>{"use strict";let t=(0,e.i(27489).default)("play",[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]]);e.s(["Play",()=>t],77164)},64346,e=>{"use strict";let t=(0,e.i(27489).default)("cpu",[["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M17 20v2",key:"1rnc9c"}],["path",{d:"M17 2v2",key:"11trls"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M2 17h2",key:"7oei6x"}],["path",{d:"M2 7h2",key:"asdhe0"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"M20 17h2",key:"1fpfkl"}],["path",{d:"M20 7h2",key:"1o8tra"}],["path",{d:"M7 20v2",key:"4gnj0m"}],["path",{d:"M7 2v2",key:"1i4yhu"}],["rect",{x:"4",y:"4",width:"16",height:"16",rx:"2",key:"1vbyd7"}],["rect",{x:"8",y:"8",width:"8",height:"8",rx:"1",key:"z9xiuo"}]]);e.s(["Cpu",()=>t],64346)},12890,e=>{"use strict";let t=(0,e.i(27489).default)("monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);e.s(["Monitor",()=>t],12890)},19539,e=>{"use strict";let t=(0,e.i(27489).default)("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);e.s(["CheckCircle2",()=>t],19539)},1504,e=>{"use strict";let t=(0,e.i(27489).default)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);e.s(["XCircle",()=>t],1504)},94756,e=>{"use strict";var t=e.i(83899);function s(e){let s=t.useRef({value:e,previous:e});return t.useMemo(()=>(s.current.value!==e&&(s.current.previous=s.current.value,s.current.value=e),s.current.previous),[e])}e.s(["usePrevious",()=>s])},89616,e=>{"use strict";var t=e.i(83899),s=e.i(58489);function r(e){let[r,i]=t.useState(void 0);return(0,s.useLayoutEffect)(()=>{if(e){i({width:e.offsetWidth,height:e.offsetHeight});let t=new ResizeObserver(t=>{let s,r;if(!Array.isArray(t)||!t.length)return;let a=t[0];if("borderBoxSize"in a){let e=a.borderBoxSize,t=Array.isArray(e)?e[0]:e;s=t.inlineSize,r=t.blockSize}else s=e.offsetWidth,r=e.offsetHeight;i({width:s,height:r})});return t.observe(e,{box:"border-box"}),()=>t.unobserve(e)}i(void 0)},[e]),r}e.s(["useSize",()=>r])},62297,e=>{"use strict";let t=(0,e.i(27489).default)("server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]);e.s(["Server",()=>t],62297)},81818,e=>{"use strict";let t=(0,e.i(27489).default)("smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);e.s(["Smartphone",()=>t],81818)},69596,99957,e=>{"use strict";var t=e.i(11931);class s{deviceId;securityLevel;asymmetric;sessions;events;manufacturer;model;constructor(e="L3",s={},r){this.securityLevel=e,this.deviceId=(0,t.generateKeyId)(),this.asymmetric=new t.SimpleAsymmetric,this.sessions=new Map,this.events=s,this.manufacturer=r?.manufacturer||"Mock Devices Inc",this.model=r?.model||`MockCDM-${e}`,this.log(`CDM initialized with security level ${e}`)}log(e,t){this.events.onLog?.(`[CDM] ${e}`,t)}getDeviceCertificate(){let e={deviceId:this.deviceId,securityLevel:this.securityLevel,publicKey:this.asymmetric.getPublicKey(),manufacturer:this.manufacturer,model:this.model,timestamp:Date.now()},s=this.asymmetric.sign((0,t.stringToBytes)(JSON.stringify(e)));return{...e,signature:s}}createSession(e){let s=(0,t.generateKeyId)(),r={sessionId:s,keyIds:e,keys:new Map,state:"created",createdAt:Date.now(),expiresAt:null};return this.sessions.set(s,r),this.log(`Session created: ${s}`,{keyIds:e}),this.events.onSessionCreated?.(r),r}generateLicenseChallenge(e){let s=this.sessions.get(e);if(!s)throw Error(`Session not found: ${e}`);s.state="pending",this.events.onSessionUpdated?.(s);let r={version:1,deviceCertificate:this.getDeviceCertificate(),keyIds:s.keyIds,sessionId:e,nonce:(0,t.bytesToHex)((0,t.generateKey)(16)),timestamp:Date.now()},i=this.asymmetric.sign((0,t.stringToBytes)(JSON.stringify(r))),a={...r,signature:i};return this.log("License challenge generated",{sessionId:e,keyIds:s.keyIds}),a}processLicenseResponse(e){let s=this.sessions.get(e.sessionId);if(!s)throw Error(`Session not found: ${e.sessionId}`);for(let r of(this.log("Processing license response",{sessionId:e.sessionId}),e.keys))if("CONTENT"===r.type){let e=(0,t.base64Decode)(r.key);s.keys.set(r.keyId,e),this.log(`Key added: ${r.keyId}`,{keyLength:e.length,keyHex:"L3"===this.securityLevel?(0,t.bytesToHex)(e):"[PROTECTED]"}),this.events.onKeyAdded?.(s.sessionId,r.keyId)}s.state="active",e.policy.licenseDuration>0&&(s.expiresAt=Date.now()+1e3*e.policy.licenseDuration),this.events.onSessionUpdated?.(s),this.log("Session activated",{sessionId:s.sessionId,keyCount:s.keys.size})}decrypt(e,s,r,i){let a=this.sessions.get(e);if(!a)throw Error(`Session not found: ${e}`);if("active"!==a.state)throw Error(`Session not active: ${a.state}`);let n=a.keys.get(s);if(!n)throw Error(`Key not found: ${s}`);this.log("Decrypting content",{sessionId:e,keyId:s,ciphertextLength:r.length});let l=new t.SimpleCipher(n,i).decryptCTR(r);return"L1"===this.securityLevel?this.log("L1: Decryption in hardware TEE - content protected"):"L2"===this.securityLevel?this.log("L2: Keys in hardware, decryption in software - partially protected"):this.log("L3: Full software decryption - content accessible in memory"),l}getSession(e){return this.sessions.get(e)}closeSession(e){let t=this.sessions.get(e);t&&(t.state="closed",t.keys.clear(),this.sessions.delete(e),this.log("Session closed",{sessionId:e}),this.events.onSessionClosed?.(e))}getSessions(){return Array.from(this.sessions.values())}getSecurityLevel(){return this.securityLevel}getDeviceId(){return this.deviceId}simulateMemoryDump(){if("L1"===this.securityLevel)return this.log("Memory dump blocked - L1 hardware protection"),null;if("L2"===this.securityLevel)return this.log("Memory dump partial - keys in hardware, but decrypted content accessible"),null;this.log("VULNERABILITY: L3 memory dump successful - keys extracted!");let e=new Map;for(let s of this.sessions.values())for(let[r,i]of s.keys)e.set(r,(0,t.bytesToHex)(i));return e}}e.s(["MockCDM",()=>s],69596);let r={serverName:"Mock DRM License Server",enableSecurityCheck:!0,enableDeviceRevocation:!0,defaultPolicy:{canPlay:!0,canPersist:!1,licenseDuration:86400,playbackDuration:14400,renewalDelay:3600}};class i{config;content;revokedDevices;issuedLicenses;asymmetric;events;constructor(e={},s={}){this.config={...r,...e},this.content=new Map,this.revokedDevices=new Set,this.issuedLicenses=new Map,this.asymmetric=new t.SimpleAsymmetric,this.events=s,this.log("License server initialized",{serverName:this.config.serverName})}log(e,t){this.events.onLog?.(`[Server] ${e}`,t)}registerContent(e,s,r="L3",i){let a=(0,t.generateKeyId)(),n={contentId:e,title:s,keyId:a,key:(0,t.generateKey)(16),iv:(0,t.generateKey)(16),requiredSecurityLevel:r,policy:{...this.config.defaultPolicy,...i}};return this.content.set(e,n),this.log("Content registered",{contentId:e,title:s,keyId:a,requiredSecurityLevel:r}),n}getContentInfo(e){let t=this.content.get(e);if(!t)return null;let{key:s,...r}=t;return r}getKeyId(e){return this.content.get(e)?.keyId||null}revokeDevice(e){this.revokedDevices.add(e),this.log("Device revoked",{deviceId:e}),this.events.onDeviceRevoked?.(e)}isDeviceRevoked(e){return this.revokedDevices.has(e)}validateChallenge(e){if(Math.abs(Date.now()-e.timestamp)>3e5)return{valid:!1,reason:"Challenge expired"};let t=e.deviceCertificate;return t.deviceId&&t.securityLevel?this.config.enableDeviceRevocation&&this.isDeviceRevoked(t.deviceId)?{valid:!1,reason:"Device revoked"}:e.keyIds&&0!==e.keyIds.length?{valid:!0}:{valid:!1,reason:"No key IDs requested"}:{valid:!1,reason:"Invalid device certificate"}}checkSecurityLevel(e,t){let s={L1:3,L2:2,L3:1};return s[e]>=s[t]}processLicenseRequest(e,s){this.log("Processing license request",{sessionId:e.sessionId,contentId:s,deviceId:e.deviceCertificate.deviceId,securityLevel:e.deviceCertificate.securityLevel}),this.events.onLicenseRequest?.(e);let r=this.validateChallenge(e);if(!r.valid)return this.log("License request denied",{reason:r.reason}),this.events.onLicenseDenied?.(r.reason,e),{error:r.reason};let i=this.content.get(s);if(!i){let t="Content not found";return this.log("License request denied",{reason:t}),this.events.onLicenseDenied?.(t,e),{error:t}}if(this.config.enableSecurityCheck&&!this.checkSecurityLevel(e.deviceCertificate.securityLevel,i.requiredSecurityLevel)){let t=`Security level too low. Required: ${i.requiredSecurityLevel}, Device: ${e.deviceCertificate.securityLevel}`;return this.log("License request denied",{reason:t}),this.events.onLicenseDenied?.(t,e),{error:t}}let a=[{keyId:i.keyId,key:(0,t.base64Encode)(i.key),iv:(0,t.base64Encode)(i.iv),type:"CONTENT"}],n={version:1,sessionId:e.sessionId,keys:a,policy:i.policy,serverNonce:(0,t.bytesToHex)((0,t.generateKey)(16)),timestamp:Date.now()},l=this.asymmetric.sign((0,t.stringToBytes)(JSON.stringify(n))),c={...n,signature:l};return this.issuedLicenses.set(e.sessionId,{challenge:e,response:c,timestamp:Date.now()}),this.log("License issued",{sessionId:e.sessionId,contentId:s,keyId:i.keyId}),this.events.onLicenseIssued?.(c,i),c}getIssuedLicense(e){return this.issuedLicenses.get(e)}getAllContent(){let e=new Map;for(let[t,s]of this.content){let{key:r,...i}=s;e.set(t,i)}return e}getContentWithKey(e){return this.content.get(e)||null}getStats(){return{serverName:this.config.serverName,registeredContent:this.content.size,issuedLicenses:this.issuedLicenses.size,revokedDevices:this.revokedDevices.size}}}e.s(["MockLicenseServer",()=>i],99957)},30305,e=>{"use strict";let t=(0,e.i(27489).default)("rotate-ccw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);e.s(["RotateCcw",()=>t],30305)},84509,e=>{"use strict";let t=(0,e.i(27489).default)("eye-off",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);e.s(["EyeOff",()=>t],84509)},94717,e=>{"use strict";var t=e.i(53811),s=e.i(83899);e.i(94126);var r=e.i(88422),i=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,i)=>{let a=(0,r.createSlot)(`Primitive.${i}`),n=s.forwardRef((e,s)=>{let{asChild:r,...n}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,t.jsx)(r?a:i,{...n,ref:s})});return n.displayName=`Primitive.${i}`,{...e,[i]:n}},{}),a="Progress",[n,l]=function(e,r=[]){let i=[],a=()=>{let t=i.map(e=>s.createContext(e));return function(r){let i=r?.[e]||t;return s.useMemo(()=>({[`__scope${e}`]:{...r,[e]:i}}),[r,i])}};return a.scopeName=e,[function(r,a){let n=s.createContext(a);n.displayName=r+"Context";let l=i.length;i=[...i,a];let c=r=>{let{scope:i,children:a,...c}=r,o=i?.[e]?.[l]||n,d=s.useMemo(()=>c,Object.values(c));return(0,t.jsx)(o.Provider,{value:d,children:a})};return c.displayName=r+"Provider",[c,function(t,i){let c=i?.[e]?.[l]||n,o=s.useContext(c);if(o)return o;if(void 0!==a)return a;throw Error(`\`${t}\` must be used within \`${r}\``)}]},function(...e){let t=e[0];if(1===e.length)return t;let r=()=>{let r=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){let i=r.reduce((t,{useScope:s,scopeName:r})=>{let i=s(e)[`__scope${r}`];return{...t,...i}},{});return s.useMemo(()=>({[`__scope${t.scopeName}`]:i}),[i])}};return r.scopeName=t.scopeName,r}(a,...r)]}(a),[c,o]=n(a),d=s.forwardRef((e,s)=>{var r,a;let{__scopeProgress:n,value:l=null,max:o,getValueLabel:d=x,...u}=e;(o||0===o)&&!p(o)&&console.error((r=`${o}`,`Invalid prop \`max\` of value \`${r}\` supplied to \`Progress\`. Only numbers greater than 0 are valid max values. Defaulting to \`100\`.`));let h=p(o)?o:100;null===l||v(l,h)||console.error((a=`${l}`,`Invalid prop \`value\` of value \`${a}\` supplied to \`Progress\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or 100 if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`));let g=v(l,h)?l:null,f=y(g)?d(g,h):void 0;return(0,t.jsx)(c,{scope:n,value:g,max:h,children:(0,t.jsx)(i.div,{"aria-valuemax":h,"aria-valuemin":0,"aria-valuenow":y(g)?g:void 0,"aria-valuetext":f,role:"progressbar","data-state":m(g,h),"data-value":g??void 0,"data-max":h,...u,ref:s})})});d.displayName=a;var u="ProgressIndicator",h=s.forwardRef((e,s)=>{let{__scopeProgress:r,...a}=e,n=o(u,r);return(0,t.jsx)(i.div,{"data-state":m(n.value,n.max),"data-value":n.value??void 0,"data-max":n.max,...a,ref:s})});function x(e,t){return`${Math.round(e/t*100)}%`}function m(e,t){return null==e?"indeterminate":e===t?"complete":"loading"}function y(e){return"number"==typeof e}function p(e){return y(e)&&!isNaN(e)&&e>0}function v(e,t){return y(e)&&!isNaN(e)&&e<=t&&e>=0}h.displayName=u;var g=e.i(9799);function f({className:e,value:s,...r}){return(0,t.jsx)(d,{"data-slot":"progress",className:(0,g.cn)("bg-primary/20 relative h-2 w-full overflow-hidden rounded-full",e),...r,children:(0,t.jsx)(h,{"data-slot":"progress-indicator",className:"bg-primary h-full w-full flex-1 transition-all",style:{transform:`translateX(-${100-(s||0)}%)`}})})}e.s(["Progress",()=>f],94717)},28883,e=>{"use strict";var t=e.i(53811),s=e.i(83899),r=e.i(12096),i=e.i(60602),a=e.i(73403),n=e.i(74944),l=e.i(94756),c=e.i(89616),o=e.i(63108),d="Switch",[u,h]=(0,a.createContextScope)(d),[x,m]=u(d),y=s.forwardRef((e,a)=>{let{__scopeSwitch:l,name:c,checked:u,defaultChecked:h,required:m,disabled:y,value:p="on",onCheckedChange:v,form:w,...j}=e,[N,b]=s.useState(null),k=(0,i.useComposedRefs)(a,e=>b(e)),C=s.useRef(!1),L=!N||w||!!N.closest("form"),[S,D]=(0,n.useControllableState)({prop:u,defaultProp:h??!1,onChange:v,caller:d});return(0,t.jsxs)(x,{scope:l,checked:S,disabled:y,children:[(0,t.jsx)(o.Primitive.button,{type:"button",role:"switch","aria-checked":S,"aria-required":m,"data-state":f(S),"data-disabled":y?"":void 0,disabled:y,value:p,...j,ref:k,onClick:(0,r.composeEventHandlers)(e.onClick,e=>{D(e=>!e),L&&(C.current=e.isPropagationStopped(),C.current||e.stopPropagation())})}),L&&(0,t.jsx)(g,{control:N,bubbles:!C.current,name:c,value:p,checked:S,required:m,disabled:y,form:w,style:{transform:"translateX(-100%)"}})]})});y.displayName=d;var p="SwitchThumb",v=s.forwardRef((e,s)=>{let{__scopeSwitch:r,...i}=e,a=m(p,r);return(0,t.jsx)(o.Primitive.span,{"data-state":f(a.checked),"data-disabled":a.disabled?"":void 0,...i,ref:s})});v.displayName=p;var g=s.forwardRef(({__scopeSwitch:e,control:r,checked:a,bubbles:n=!0,...o},d)=>{let u=s.useRef(null),h=(0,i.useComposedRefs)(u,d),x=(0,l.usePrevious)(a),m=(0,c.useSize)(r);return s.useEffect(()=>{let e=u.current;if(!e)return;let t=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(x!==a&&t){let s=new Event("click",{bubbles:n});t.call(e,a),e.dispatchEvent(s)}},[x,a,n]),(0,t.jsx)("input",{type:"checkbox","aria-hidden":!0,defaultChecked:a,...o,tabIndex:-1,ref:h,style:{...o.style,...m,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});function f(e){return e?"checked":"unchecked"}g.displayName="SwitchBubbleInput";var w=e.i(9799);function j({className:e,...s}){return(0,t.jsx)(y,{"data-slot":"switch",className:(0,w.cn)("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",e),...s,children:(0,t.jsx)(v,{"data-slot":"switch-thumb",className:(0,w.cn)("bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0")})})}e.s(["Switch",()=>j],28883)},50284,e=>{"use strict";var t=e.i(53811),s=e.i(83899);e.i(94126);var r=e.i(88422),i=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,i)=>{let a=(0,r.createSlot)(`Primitive.${i}`),n=s.forwardRef((e,s)=>{let{asChild:r,...n}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,t.jsx)(r?a:i,{...n,ref:s})});return n.displayName=`Primitive.${i}`,{...e,[i]:n}},{}),a=s.forwardRef((e,s)=>(0,t.jsx)(i.label,{...e,ref:s,onMouseDown:t=>{t.target.closest("button, input, select, textarea")||(e.onMouseDown?.(t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));a.displayName="Label";var n=e.i(9799);function l({className:e,...s}){return(0,t.jsx)(a,{"data-slot":"label",className:(0,n.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",e),...s})}e.s(["Label",()=>l],50284)},32876,e=>{"use strict";var t=e.i(53811),s=e.i(83899),r=e.i(23376),i=e.i(78349),a=e.i(11350),n=e.i(68524),l=e.i(94717),c=e.i(15004),o=e.i(50985),d=e.i(28883),u=e.i(50284),h=e.i(57325),x=e.i(77164),m=e.i(30305),y=e.i(36783),p=e.i(62297),v=e.i(81818),g=e.i(12890),f=e.i(64346),w=e.i(19539),j=e.i(1504),N=e.i(10914),b=e.i(11186),k=e.i(37171),C=e.i(84509),L=e.i(69596),S=e.i(99957);let D={L1:{icon:h.Shield,description:"Hardware TEE - Keys never exposed to software",color:"text-green-500"},L2:{icon:f.Cpu,description:"Hardware crypto, software CDM - Hybrid protection",color:"text-yellow-500"},L3:{icon:g.Monitor,description:"Software only - Vulnerable to extraction",color:"text-red-500"}};function M(){let[e,g]=(0,s.useState)(null),[M]=(0,s.useState)(()=>new S.MockLicenseServer),[I,R]=(0,s.useState)("L1"),[T,$]=(0,s.useState)("uninitialized"),[E,A]=(0,s.useState)([]),[P,z]=(0,s.useState)(0),[K,q]=(0,s.useState)(!1),[H,O]=(0,s.useState)(!1),[B,U]=(0,s.useState)(null),[V,_]=(0,s.useState)(null),X=(e,t,s,r)=>{let i={id:Math.random().toString(36).substr(2,9),timestamp:new Date,type:e,source:t,message:s,details:r};A(e=>[...e,i])},F=()=>{g(null),$("uninitialized"),A([]),z(0),q(!1),U(null),_(null)},W=e=>new Promise(t=>setTimeout(t,e)),J=async()=>{q(!0),F(),await W(500),z(1),X("info","system","Initializing Content Decryption Module...",`Security Level: ${I}`),await W(800);let e=new L.MockCDM(I);g(e),$("initialized"),X("success","cdm","CDM initialized successfully",`Device ID: ${e.getDeviceId()}`),await W(600);let t="demo-content-001",s=M.registerContent(t,"Demo Video","L3");z(2),X("info","cdm","Creating license session..."),await W(500);let r=e.createSession([s.keyId]);_(r.sessionId),$("session-created"),X("success","cdm","Session created",`Session ID: ${r.sessionId}`),await W(600),z(3),X("info","cdm","Generating license request..."),await W(500);let i=e.generateLicenseChallenge(r.sessionId);X("info","cdm","License challenge generated",`Key IDs: ${i.keyIds.join(", ")}`),await W(600),z(4),X("info","system","Sending license request to server..."),await W(800),X("info","server","License request received","Validating device certificate..."),await W(500);let a=i.deviceCertificate;X("success","server","Device certificate validated",`Security Level: ${a.securityLevel}`),await W(500),z(5);let n=M.processLicenseRequest(i,t);if("error"in n){X("error","server","License request denied",n.error),$("error"),q(!1);return}X("success","server","License generated",`Keys: ${n.keys.length}, Duration: ${n.policy.licenseDuration}s`),await W(600),X("info","system","Sending license response to CDM..."),await W(500),z(6),X("info","cdm","Processing license response..."),await W(500);try{if(e.processLicenseResponse(n),$("licensed"),X("success","cdm","License processed successfully"),"L3"===I){let t=e.simulateMemoryDump();if(t&&t.size>0){let e=t.values().next().value;U(e||null),X("warning","cdm","Key extracted from memory","L3 software CDM - keys accessible in memory")}}else"L2"===I?(U("[PARTIAL PROTECTION]"),X("info","cdm","Keys in hardware crypto engine","L2 hybrid - keys protected but decrypted content accessible")):(U("[PROTECTED IN TEE]"),X("success","cdm","Keys stored in hardware TEE","L1 hardware - keys never leave secure enclave"))}catch(e){X("error","cdm","Failed to process license",String(e)),$("error"),q(!1);return}await W(600),z(7),$("ready"),X("success","system","CDM ready for content decryption",`Security Level ${I}: ${D[I].description}`),q(!1)};return D[I].icon,(0,t.jsxs)("div",{className:"container max-w-6xl py-8",children:[(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsxs)("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[(0,t.jsx)(f.Cpu,{className:"w-6 h-6 text-primary"}),"CDM Simulator"]}),(0,t.jsx)("p",{className:"text-muted-foreground mt-1",children:"Simulate Content Decryption Module behavior at different security levels"})]}),(0,t.jsxs)(n.Alert,{className:"mb-6",children:[(0,t.jsx)(h.Shield,{className:"h-4 w-4"}),(0,t.jsx)(n.AlertTitle,{children:"Understanding CDM Security Levels"}),(0,t.jsx)(n.AlertDescription,{children:"The CDM (Content Decryption Module) is the core component that handles license acquisition and content decryption. Security levels determine how well protected the decryption keys are from extraction."})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)(r.Card,{children:[(0,t.jsxs)(r.CardHeader,{children:[(0,t.jsx)(r.CardTitle,{className:"text-lg",children:"Security Level"}),(0,t.jsx)(r.CardDescription,{children:"Select CDM protection level"})]}),(0,t.jsx)(r.CardContent,{className:"space-y-3",children:["L1","L2","L3"].map(e=>{let s=D[e],r=s.icon;return(0,t.jsxs)(i.Button,{variant:I===e?"default":"outline",className:"w-full justify-start h-auto py-3",onClick:()=>{R(e),F()},disabled:K,children:[(0,t.jsx)(r,{className:`w-5 h-5 mr-3 ${s.color}`}),(0,t.jsxs)("div",{className:"text-left",children:[(0,t.jsxs)("div",{className:"font-medium",children:["Level ",e.charAt(1)]}),(0,t.jsx)("div",{className:"text-xs text-muted-foreground font-normal",children:s.description})]})]},e)})})]}),(0,t.jsxs)(r.Card,{children:[(0,t.jsx)(r.CardHeader,{children:(0,t.jsx)(r.CardTitle,{className:"text-lg",children:"Simulation Controls"})}),(0,t.jsxs)(r.CardContent,{className:"space-y-4",children:[(0,t.jsxs)(i.Button,{onClick:J,disabled:K,className:"w-full gap-2",children:[(0,t.jsx)(x.Play,{className:"w-4 h-4"}),"Run Simulation"]}),(0,t.jsxs)(i.Button,{variant:"outline",onClick:F,disabled:K,className:"w-full gap-2",children:[(0,t.jsx)(m.RotateCcw,{className:"w-4 h-4"}),"Reset"]}),(0,t.jsx)(o.Separator,{}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)(u.Label,{className:"text-sm flex items-center gap-2",children:[H?(0,t.jsx)(k.Eye,{className:"w-4 h-4"}):(0,t.jsx)(C.EyeOff,{className:"w-4 h-4"}),"Show Keys"]}),(0,t.jsx)(d.Switch,{checked:H,onCheckedChange:O})]}),"L3"===I&&H&&(0,t.jsxs)(n.Alert,{variant:"destructive",className:"text-xs",children:[(0,t.jsx)(N.AlertTriangle,{className:"h-3 w-3"}),(0,t.jsx)(n.AlertDescription,{children:"L3 keys are vulnerable to memory extraction!"})]})]})]}),(0,t.jsxs)(r.Card,{children:[(0,t.jsx)(r.CardHeader,{children:(0,t.jsx)(r.CardTitle,{className:"text-lg",children:"CDM State"})}),(0,t.jsx)(r.CardContent,{children:(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"State"}),(0,t.jsx)(a.Badge,{variant:"ready"===T?"default":"outline",children:T})]}),V&&(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Session"}),(0,t.jsx)("code",{className:"block text-xs bg-zinc-950 p-2 rounded mt-1 truncate",children:V})]}),B&&H&&(0,t.jsxs)("div",{children:[(0,t.jsxs)("span",{className:"text-sm text-muted-foreground flex items-center gap-1",children:[(0,t.jsx)(y.Key,{className:"w-3 h-3"}),"Content Key"]}),(0,t.jsx)("code",{className:`block text-xs p-2 rounded mt-1 truncate ${"L1"===I?"bg-green-500/10 text-green-400":"L2"===I?"bg-yellow-500/10 text-yellow-400":"bg-red-500/10 text-red-400"}`,children:"L1"===I?"[PROTECTED IN TEE]":B})]}),(0,t.jsx)(l.Progress,{value:P/7*100,className:"mt-4"}),(0,t.jsxs)("div",{className:"text-xs text-center text-muted-foreground",children:["Step ",P," of 7"]})]})})]})]}),(0,t.jsxs)(r.Card,{className:"lg:col-span-2",children:[(0,t.jsxs)(r.CardHeader,{children:[(0,t.jsx)(r.CardTitle,{className:"text-lg",children:"License Acquisition Flow"}),(0,t.jsx)(r.CardDescription,{children:"Watch the complete DRM handshake process"})]}),(0,t.jsxs)(r.CardContent,{children:[(0,t.jsxs)("div",{className:"mb-6 p-4 rounded-lg border bg-zinc-950",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:`p-3 rounded-lg mx-auto mb-2 w-fit ${P>=1?"bg-primary/20":"bg-muted"}`,children:(0,t.jsx)(v.Smartphone,{className:"w-6 h-6"})}),(0,t.jsx)("div",{className:"text-xs font-medium",children:"Client"}),(0,t.jsx)("div",{className:"text-xs text-muted-foreground",children:"CDM"})]}),(0,t.jsxs)("div",{className:"flex-1 flex items-center justify-center gap-1",children:[(0,t.jsx)(b.ArrowRight,{className:`w-4 h-4 ${P>=3?"text-primary":"text-muted"}`}),(0,t.jsx)(b.ArrowRight,{className:`w-4 h-4 ${P>=3?"text-primary":"text-muted"}`}),(0,t.jsx)(a.Badge,{variant:"outline",className:"text-xs",children:"License Request"}),(0,t.jsx)(b.ArrowRight,{className:`w-4 h-4 ${P>=3?"text-primary":"text-muted"}`}),(0,t.jsx)(b.ArrowRight,{className:`w-4 h-4 ${P>=3?"text-primary":"text-muted"}`})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:`p-3 rounded-lg mx-auto mb-2 w-fit ${P>=4?"bg-purple-500/20":"bg-muted"}`,children:(0,t.jsx)(p.Server,{className:"w-6 h-6"})}),(0,t.jsx)("div",{className:"text-xs font-medium",children:"License Server"}),(0,t.jsx)("div",{className:"text-xs text-muted-foreground",children:"DRM"})]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-center gap-1 mt-4",children:[(0,t.jsx)(b.ArrowRight,{className:`w-4 h-4 rotate-180 ${P>=5?"text-green-500":"text-muted"}`}),(0,t.jsx)(b.ArrowRight,{className:`w-4 h-4 rotate-180 ${P>=5?"text-green-500":"text-muted"}`}),(0,t.jsx)(a.Badge,{variant:"outline",className:"text-xs bg-green-500/10",children:"License Response"}),(0,t.jsx)(b.ArrowRight,{className:`w-4 h-4 rotate-180 ${P>=5?"text-green-500":"text-muted"}`}),(0,t.jsx)(b.ArrowRight,{className:`w-4 h-4 rotate-180 ${P>=5?"text-green-500":"text-muted"}`})]})]}),(0,t.jsx)(c.ScrollArea,{className:"h-[350px] pr-4",children:0===E.length?(0,t.jsxs)("div",{className:"text-center py-16 text-muted-foreground",children:[(0,t.jsx)(f.Cpu,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),(0,t.jsx)("p",{children:'Click "Run Simulation" to start'})]}):(0,t.jsx)("div",{className:"space-y-2",children:E.map(e=>(0,t.jsx)("div",{className:`p-3 rounded-lg border ${"error"===e.type?"border-red-500/30 bg-red-500/5":"success"===e.type?"border-green-500/30 bg-green-500/5":"warning"===e.type?"border-yellow-500/30 bg-yellow-500/5":"border-muted bg-muted/30"}`,children:(0,t.jsxs)("div",{className:"flex items-start gap-2",children:[(e=>{switch(e){case"success":return(0,t.jsx)(w.CheckCircle2,{className:"w-4 h-4 text-green-500"});case"warning":return(0,t.jsx)(N.AlertTriangle,{className:"w-4 h-4 text-yellow-500"});case"error":return(0,t.jsx)(j.XCircle,{className:"w-4 h-4 text-red-500"});default:return(0,t.jsx)(b.ArrowRight,{className:"w-4 h-4 text-blue-500"})}})(e.type),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(e=>{switch(e){case"cdm":return(0,t.jsx)(a.Badge,{variant:"outline",className:"text-xs",children:"CDM"});case"server":return(0,t.jsx)(a.Badge,{variant:"outline",className:"text-xs text-purple-400",children:"Server"});default:return(0,t.jsx)(a.Badge,{variant:"outline",className:"text-xs text-blue-400",children:"System"})}})(e.source),(0,t.jsx)("span",{className:"text-xs text-muted-foreground",children:e.timestamp.toLocaleTimeString()})]}),(0,t.jsx)("p",{className:"text-sm",children:e.message}),e.details&&(0,t.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:e.details})]})]})},e.id))})})]})]})]}),(0,t.jsxs)(r.Card,{className:"mt-6",children:[(0,t.jsx)(r.CardHeader,{children:(0,t.jsx)(r.CardTitle,{className:"text-lg",children:"Security Level Comparison"})}),(0,t.jsx)(r.CardContent,{children:(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full text-sm",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"border-b",children:[(0,t.jsx)("th",{className:"text-left py-2 px-4",children:"Feature"}),(0,t.jsx)("th",{className:"text-center py-2 px-4",children:"L1 (Hardware TEE)"}),(0,t.jsx)("th",{className:"text-center py-2 px-4",children:"L2 (Hybrid)"}),(0,t.jsx)("th",{className:"text-center py-2 px-4",children:"L3 (Software)"})]})}),(0,t.jsxs)("tbody",{children:[(0,t.jsxs)("tr",{className:"border-b",children:[(0,t.jsx)("td",{className:"py-2 px-4",children:"Key Storage"}),(0,t.jsx)("td",{className:"text-center py-2 px-4",children:(0,t.jsx)(w.CheckCircle2,{className:"w-4 h-4 text-green-500 mx-auto"})}),(0,t.jsx)("td",{className:"text-center py-2 px-4",children:(0,t.jsx)(N.AlertTriangle,{className:"w-4 h-4 text-yellow-500 mx-auto"})}),(0,t.jsx)("td",{className:"text-center py-2 px-4",children:(0,t.jsx)(j.XCircle,{className:"w-4 h-4 text-red-500 mx-auto"})})]}),(0,t.jsxs)("tr",{className:"border-b",children:[(0,t.jsx)("td",{className:"py-2 px-4",children:"Decryption Location"}),(0,t.jsx)("td",{className:"text-center py-2 px-4 text-xs text-muted-foreground",children:"Hardware TEE"}),(0,t.jsx)("td",{className:"text-center py-2 px-4 text-xs text-muted-foreground",children:"Hardware Engine"}),(0,t.jsx)("td",{className:"text-center py-2 px-4 text-xs text-muted-foreground",children:"Software/Memory"})]}),(0,t.jsxs)("tr",{className:"border-b",children:[(0,t.jsx)("td",{className:"py-2 px-4",children:"Max Resolution"}),(0,t.jsx)("td",{className:"text-center py-2 px-4 text-xs",children:"4K HDR"}),(0,t.jsx)("td",{className:"text-center py-2 px-4 text-xs",children:"1080p"}),(0,t.jsx)("td",{className:"text-center py-2 px-4 text-xs",children:"480p"})]}),(0,t.jsxs)("tr",{className:"border-b",children:[(0,t.jsx)("td",{className:"py-2 px-4",children:"Extraction Risk"}),(0,t.jsx)("td",{className:"text-center py-2 px-4 text-xs text-green-400",children:"Very Low"}),(0,t.jsx)("td",{className:"text-center py-2 px-4 text-xs text-yellow-400",children:"Medium"}),(0,t.jsx)("td",{className:"text-center py-2 px-4 text-xs text-red-400",children:"High"})]}),(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{className:"py-2 px-4",children:"Typical Devices"}),(0,t.jsx)("td",{className:"text-center py-2 px-4 text-xs text-muted-foreground",children:"Smart TVs, Set-top boxes"}),(0,t.jsx)("td",{className:"text-center py-2 px-4 text-xs text-muted-foreground",children:"Some Android devices"}),(0,t.jsx)("td",{className:"text-center py-2 px-4 text-xs text-muted-foreground",children:"Desktop browsers"})]})]})]})})})]})]})}e.s(["default",()=>M])}]);