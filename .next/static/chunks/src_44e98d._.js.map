{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/components/ui/badge.tsx"],"sourcesContent":["import * as React from \"react\";\nimport { Slot } from \"@radix-ui/react-slot\";\nimport { cva, type VariantProps } from \"class-variance-authority\";\nimport { cn } from \"@/lib/utils\";\n\nconst badgeVariants = cva(\n  \"inline-flex items-center justify-center rounded-full border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none transition-colors\",\n  {\n    variants: {\n      variant: {\n        default: \"border-transparent bg-primary text-primary-foreground\",\n        secondary: \"border-transparent bg-secondary text-secondary-foreground\",\n        destructive: \"border-transparent bg-destructive text-white\",\n        outline: \"text-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n);\n\nexport interface BadgeProps\n  extends React.HTMLAttributes<HTMLSpanElement>,\n    VariantProps<typeof badgeVariants> {\n  asChild?: boolean;\n}\n\nfunction Badge({ className, variant, asChild = false, ...props }: BadgeProps) {\n  const Comp = asChild ? Slot : \"span\";\n  return (\n    <Comp\n      data-slot=\"badge\"\n      className={cn(badgeVariants({ variant }), className)}\n      {...props}\n    />\n  );\n}\n\nexport { Badge, badgeVariants };\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAFA;;;;;AAIA,MAAM,gBAAgB,CAAA,GAAA,mKAAA,CAAA,MAAG,AAAD,EACtB,mMACA;IACE,UAAU;QACR,SAAS;YACP,SAAS;YACT,WAAW;YACX,aAAa;YACb,SAAS;QACX;IACF;IACA,iBAAiB;QACf,SAAS;IACX;AACF;AASF,SAAS,MAAM,EAAE,SAAS,EAAE,OAAO,EAAE,UAAU,KAAK,EAAE,GAAG,OAAmB;IAC1E,MAAM,OAAO,UAAU,mKAAA,CAAA,OAAI,GAAG;IAC9B,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EAAE,cAAc;YAAE;QAAQ,IAAI;QACzC,GAAG,KAAK;;;;;;AAGf;KATS"}},
    {"offset": {"line": 53, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 59, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/components/ui/card.tsx"],"sourcesContent":["import * as React from \"react\";\nimport { cn } from \"@/lib/utils\";\n\nfunction Card({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      data-slot=\"card\"\n      className={cn(\n        \"bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm\",\n        className\n      )}\n      {...props}\n    />\n  );\n}\n\nfunction CardHeader({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      data-slot=\"card-header\"\n      className={cn(\"flex flex-col gap-2 px-6\", className)}\n      {...props}\n    />\n  );\n}\n\nfunction CardTitle({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      data-slot=\"card-title\"\n      className={cn(\"leading-none font-semibold\", className)}\n      {...props}\n    />\n  );\n}\n\nfunction CardDescription({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      data-slot=\"card-description\"\n      className={cn(\"text-muted-foreground text-sm\", className)}\n      {...props}\n    />\n  );\n}\n\nfunction CardContent({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      data-slot=\"card-content\"\n      className={cn(\"px-6\", className)}\n      {...props}\n    />\n  );\n}\n\nfunction CardFooter({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      data-slot=\"card-footer\"\n      className={cn(\"flex items-center px-6\", className)}\n      {...props}\n    />\n  );\n}\n\nexport { Card, CardHeader, CardTitle, CardDescription, CardContent, CardFooter };\n"],"names":[],"mappings":";;;;;;;;;AACA;;;AAEA,SAAS,KAAK,EAAE,SAAS,EAAE,GAAG,OAA6C;IACzE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EACV,qFACA;QAED,GAAG,KAAK;;;;;;AAGf;KAXS;AAaT,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAA6C;IAC/E,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EAAE,4BAA4B;QACzC,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,UAAU,EAAE,SAAS,EAAE,GAAG,OAA6C;IAC9E,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EAAE,8BAA8B;QAC3C,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,gBAAgB,EAAE,SAAS,EAAE,GAAG,OAA6C;IACpF,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EAAE,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,YAAY,EAAE,SAAS,EAAE,GAAG,OAA6C;IAChF,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EAAE,QAAQ;QACrB,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAA6C;IAC/E,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,CAAA,GAAA,sHAAA,CAAA,KAAE,AAAD,EAAE,0BAA0B;QACvC,GAAG,KAAK;;;;;;AAGf;MARS"}},
    {"offset": {"line": 154, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 160, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/components/challenges/Base64Challenge.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState, useCallback } from \"react\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { CheckCircle2, XCircle, Eye, EyeOff, Lightbulb } from \"lucide-react\";\n\n// The flag is hidden in a base64 encoded \"license response\"\nconst FLAG = \"DRM{b4s364_1s_n0t_encrypt10n}\";\nconst LICENSE_DATA = {\n  version: 1,\n  keyId: \"a1b2c3d4-e5f6-7890-abcd-ef1234567890\",\n  contentKey: btoa(FLAG), // Base64 encode the flag\n  policy: {\n    expiresAt: Date.now() + 86400000,\n    hdcpRequired: true,\n  },\n};\n\nconst ENCODED_LICENSE = btoa(JSON.stringify(LICENSE_DATA));\n\nexport function Base64Challenge() {\n  const [userAnswer, setUserAnswer] = useState(\"\");\n  const [showHint, setShowHint] = useState(0);\n  const [result, setResult] = useState<\"correct\" | \"incorrect\" | null>(null);\n  const [showSolution, setShowSolution] = useState(false);\n\n  const hints = [\n    \"The license response is Base64 encoded. Try decoding it first.\",\n    \"After decoding, you'll find JSON data. Look for the 'contentKey' field.\",\n    \"The contentKey is also Base64 encoded. Decode it again to find the flag.\",\n  ];\n\n  const checkAnswer = useCallback(() => {\n    if (userAnswer.trim() === FLAG) {\n      setResult(\"correct\");\n    } else {\n      setResult(\"incorrect\");\n    }\n  }, [userAnswer]);\n\n  const revealNextHint = () => {\n    if (showHint < hints.length) {\n      setShowHint(showHint + 1);\n    }\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Challenge Data */}\n      <Card className=\"border-blue-500/30 bg-blue-500/5\">\n        <CardHeader>\n          <CardTitle className=\"text-blue-400\">Intercepted License Response</CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"rounded-lg bg-black/50 p-4 font-mono text-sm break-all\">\n            <code className=\"text-green-400\">{ENCODED_LICENSE}</code>\n          </div>\n          <p className=\"mt-4 text-sm text-muted-foreground\">\n            This Base64-encoded data was captured from a license server response.\n            Decode it to find the hidden flag.\n          </p>\n        </CardContent>\n      </Card>\n\n      {/* Hints */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center justify-between\">\n            <span className=\"flex items-center gap-2\">\n              <Lightbulb className=\"h-5 w-5\" />\n              Hints\n            </span>\n            <Button\n              size=\"sm\"\n              variant=\"outline\"\n              onClick={revealNextHint}\n              disabled={showHint >= hints.length}\n            >\n              Reveal Hint ({showHint}/{hints.length})\n            </Button>\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          {showHint === 0 ? (\n            <p className=\"text-muted-foreground\">Click the button to reveal hints.</p>\n          ) : (\n            <ul className=\"space-y-2\">\n              {hints.slice(0, showHint).map((hint, index) => (\n                <li key={index} className=\"flex items-start gap-2 text-sm\">\n                  <Badge variant=\"secondary\" className=\"shrink-0\">\n                    {index + 1}\n                  </Badge>\n                  <span className=\"text-muted-foreground\">{hint}</span>\n                </li>\n              ))}\n            </ul>\n          )}\n        </CardContent>\n      </Card>\n\n      {/* Answer Submission */}\n      <Card>\n        <CardHeader>\n          <CardTitle>Submit Your Answer</CardTitle>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <div className=\"flex gap-3\">\n            <input\n              type=\"text\"\n              placeholder=\"Enter flag (e.g., DRM{...})\"\n              value={userAnswer}\n              onChange={(e) => setUserAnswer(e.target.value)}\n              className=\"flex-1 rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\"\n            />\n            <Button onClick={checkAnswer}>Submit</Button>\n          </div>\n\n          {result === \"correct\" && (\n            <div className=\"flex items-center gap-2 rounded-lg bg-green-500/10 p-3 text-green-400\">\n              <CheckCircle2 className=\"h-5 w-5\" />\n              <span>Correct! You&apos;ve solved the challenge.</span>\n            </div>\n          )}\n\n          {result === \"incorrect\" && (\n            <div className=\"flex items-center gap-2 rounded-lg bg-red-500/10 p-3 text-red-400\">\n              <XCircle className=\"h-5 w-5\" />\n              <span>Incorrect. Try again or use a hint.</span>\n            </div>\n          )}\n        </CardContent>\n      </Card>\n\n      {/* Solution Toggle (for learning) */}\n      <Card className=\"border-yellow-500/30 bg-yellow-500/5\">\n        <CardContent className=\"pt-6\">\n          <Button\n            variant=\"outline\"\n            className=\"gap-2\"\n            onClick={() => setShowSolution(!showSolution)}\n          >\n            {showSolution ? (\n              <>\n                <EyeOff className=\"h-4 w-4\" />\n                Hide Solution\n              </>\n            ) : (\n              <>\n                <Eye className=\"h-4 w-4\" />\n                Show Solution (Spoiler)\n              </>\n            )}\n          </Button>\n\n          {showSolution && (\n            <div className=\"mt-4 space-y-4\">\n              <div className=\"rounded-lg bg-black/50 p-4 font-mono text-sm\">\n                <p className=\"text-muted-foreground mb-2\">// Step 1: Decode the outer Base64</p>\n                <code className=\"text-blue-400\">\n                  const decoded = atob(&quot;{ENCODED_LICENSE.slice(0, 30)}...&quot;);\n                </code>\n                <p className=\"text-muted-foreground mt-4 mb-2\">// Step 2: Parse the JSON</p>\n                <code className=\"text-blue-400\">\n                  const license = JSON.parse(decoded);\n                </code>\n                <p className=\"text-muted-foreground mt-4 mb-2\">// Step 3: Decode the contentKey</p>\n                <code className=\"text-blue-400\">\n                  const flag = atob(license.contentKey);\n                </code>\n                <p className=\"text-green-400 mt-4\">// Result: {FLAG}</p>\n              </div>\n            </div>\n          )}\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 628, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 634, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/components/challenges/XorChallenge.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState, useCallback } from \"react\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { CheckCircle2, XCircle, Eye, EyeOff, Lightbulb, Calculator } from \"lucide-react\";\n\n// XOR key and flag\nconst XOR_KEY = 0x42; // The key is 0x42 (66 in decimal, 'B' in ASCII)\nconst FLAG = \"DRM{x0r_1s_r3v3rs1bl3}\";\n\n// XOR encrypt the flag\nfunction xorEncrypt(text: string, key: number): string {\n  return Array.from(text)\n    .map((char) => (char.charCodeAt(0) ^ key).toString(16).padStart(2, \"0\"))\n    .join(\"\");\n}\n\nconst ENCRYPTED_FLAG = xorEncrypt(FLAG, XOR_KEY);\n\nexport function XorChallenge() {\n  const [userAnswer, setUserAnswer] = useState(\"\");\n  const [showHint, setShowHint] = useState(0);\n  const [result, setResult] = useState<\"correct\" | \"incorrect\" | null>(null);\n  const [showSolution, setShowSolution] = useState(false);\n  const [workArea, setWorkArea] = useState(\"\");\n\n  const hints = [\n    \"XOR encryption is symmetric - the same key encrypts and decrypts.\",\n    \"The key is a single byte value commonly used in simple obfuscation: 0x42\",\n    \"To decrypt: for each hex pair, convert to number, XOR with 0x42, convert to ASCII.\",\n  ];\n\n  const checkAnswer = useCallback(() => {\n    if (userAnswer.trim() === FLAG) {\n      setResult(\"correct\");\n    } else {\n      setResult(\"incorrect\");\n    }\n  }, [userAnswer]);\n\n  const revealNextHint = () => {\n    if (showHint < hints.length) {\n      setShowHint(showHint + 1);\n    }\n  };\n\n  // Interactive XOR calculator\n  const [calcInput, setCalcInput] = useState(\"\");\n  const [calcKey, setCalcKey] = useState(\"42\");\n  const [calcResult, setCalcResult] = useState(\"\");\n\n  const calculateXor = () => {\n    try {\n      const keyNum = parseInt(calcKey, 16);\n      // Try to parse as hex pairs\n      const hexPairs = calcInput.match(/.{2}/g);\n      if (hexPairs) {\n        const decrypted = hexPairs\n          .map((hex) => String.fromCharCode(parseInt(hex, 16) ^ keyNum))\n          .join(\"\");\n        setCalcResult(decrypted);\n      }\n    } catch {\n      setCalcResult(\"Invalid input\");\n    }\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Challenge Data */}\n      <Card className=\"border-blue-500/30 bg-blue-500/5\">\n        <CardHeader>\n          <CardTitle className=\"text-blue-400\">Encrypted Content Key</CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"rounded-lg bg-black/50 p-4 font-mono text-sm\">\n            <p className=\"text-muted-foreground mb-2\">Encrypted (hex):</p>\n            <code className=\"text-green-400 break-all\">{ENCRYPTED_FLAG}</code>\n          </div>\n          <p className=\"mt-4 text-sm text-muted-foreground\">\n            This content key has been XOR encrypted with a single-byte key.\n            The key is commonly used in simple obfuscation schemes.\n          </p>\n        </CardContent>\n      </Card>\n\n      {/* Interactive XOR Calculator */}\n      <Card className=\"border-purple-500/30 bg-purple-500/5\">\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2 text-purple-400\">\n            <Calculator className=\"h-5 w-5\" />\n            XOR Calculator (Tool)\n          </CardTitle>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <div className=\"grid gap-4 sm:grid-cols-2\">\n            <div>\n              <label className=\"text-sm text-muted-foreground\">Hex Input</label>\n              <input\n                type=\"text\"\n                placeholder=\"Enter hex pairs (e.g., 44524d)\"\n                value={calcInput}\n                onChange={(e) => setCalcInput(e.target.value.replace(/[^0-9a-fA-F]/g, \"\"))}\n                className=\"mt-1 w-full rounded-md border border-input bg-background px-3 py-2 text-sm font-mono\"\n              />\n            </div>\n            <div>\n              <label className=\"text-sm text-muted-foreground\">XOR Key (hex)</label>\n              <input\n                type=\"text\"\n                placeholder=\"Key in hex (e.g., 42)\"\n                value={calcKey}\n                onChange={(e) => setCalcKey(e.target.value.replace(/[^0-9a-fA-F]/g, \"\"))}\n                className=\"mt-1 w-full rounded-md border border-input bg-background px-3 py-2 text-sm font-mono\"\n              />\n            </div>\n          </div>\n          <div className=\"flex gap-2\">\n            <Button onClick={calculateXor} size=\"sm\">\n              Decrypt\n            </Button>\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={() => setCalcInput(ENCRYPTED_FLAG)}\n            >\n              Load Challenge Data\n            </Button>\n          </div>\n          {calcResult && (\n            <div className=\"rounded-lg bg-black/50 p-3\">\n              <p className=\"text-sm text-muted-foreground\">Result:</p>\n              <code className=\"text-green-400 font-mono\">{calcResult}</code>\n            </div>\n          )}\n        </CardContent>\n      </Card>\n\n      {/* Hints */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center justify-between\">\n            <span className=\"flex items-center gap-2\">\n              <Lightbulb className=\"h-5 w-5\" />\n              Hints\n            </span>\n            <Button\n              size=\"sm\"\n              variant=\"outline\"\n              onClick={revealNextHint}\n              disabled={showHint >= hints.length}\n            >\n              Reveal Hint ({showHint}/{hints.length})\n            </Button>\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          {showHint === 0 ? (\n            <p className=\"text-muted-foreground\">Click the button to reveal hints.</p>\n          ) : (\n            <ul className=\"space-y-2\">\n              {hints.slice(0, showHint).map((hint, index) => (\n                <li key={index} className=\"flex items-start gap-2 text-sm\">\n                  <Badge variant=\"secondary\" className=\"shrink-0\">\n                    {index + 1}\n                  </Badge>\n                  <span className=\"text-muted-foreground\">{hint}</span>\n                </li>\n              ))}\n            </ul>\n          )}\n        </CardContent>\n      </Card>\n\n      {/* Answer Submission */}\n      <Card>\n        <CardHeader>\n          <CardTitle>Submit Your Answer</CardTitle>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <div className=\"flex gap-3\">\n            <input\n              type=\"text\"\n              placeholder=\"Enter flag (e.g., DRM{...})\"\n              value={userAnswer}\n              onChange={(e) => setUserAnswer(e.target.value)}\n              className=\"flex-1 rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\"\n            />\n            <Button onClick={checkAnswer}>Submit</Button>\n          </div>\n\n          {result === \"correct\" && (\n            <div className=\"flex items-center gap-2 rounded-lg bg-green-500/10 p-3 text-green-400\">\n              <CheckCircle2 className=\"h-5 w-5\" />\n              <span>Correct! XOR is reversible - that&apos;s why it&apos;s not secure alone.</span>\n            </div>\n          )}\n\n          {result === \"incorrect\" && (\n            <div className=\"flex items-center gap-2 rounded-lg bg-red-500/10 p-3 text-red-400\">\n              <XCircle className=\"h-5 w-5\" />\n              <span>Incorrect. Try using the XOR calculator with key 0x42.</span>\n            </div>\n          )}\n        </CardContent>\n      </Card>\n\n      {/* Solution */}\n      <Card className=\"border-yellow-500/30 bg-yellow-500/5\">\n        <CardContent className=\"pt-6\">\n          <Button\n            variant=\"outline\"\n            className=\"gap-2\"\n            onClick={() => setShowSolution(!showSolution)}\n          >\n            {showSolution ? (\n              <>\n                <EyeOff className=\"h-4 w-4\" />\n                Hide Solution\n              </>\n            ) : (\n              <>\n                <Eye className=\"h-4 w-4\" />\n                Show Solution (Spoiler)\n              </>\n            )}\n          </Button>\n\n          {showSolution && (\n            <div className=\"mt-4 space-y-4\">\n              <div className=\"rounded-lg bg-black/50 p-4 font-mono text-sm\">\n                <p className=\"text-muted-foreground mb-2\">// The XOR key is 0x42 (66 decimal)</p>\n                <code className=\"text-blue-400\">const key = 0x42;</code>\n                <p className=\"text-muted-foreground mt-4 mb-2\">// For each hex pair, XOR with key</p>\n                <code className=\"text-blue-400 block\">\n                  {`encrypted.match(/.{2}/g).map(hex => `}\n                </code>\n                <code className=\"text-blue-400 block ml-4\">\n                  {`String.fromCharCode(parseInt(hex, 16) ^ key)`}\n                </code>\n                <code className=\"text-blue-400 block\">{`).join('')`}</code>\n                <p className=\"text-green-400 mt-4\">// Result: {FLAG}</p>\n              </div>\n              <p className=\"text-sm text-muted-foreground\">\n                XOR encryption is symmetric - XORing twice with the same key returns the original.\n                This is why single-key XOR is trivially broken once the key is known.\n              </p>\n            </div>\n          )}\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1289, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 1295, "column": 0}, "map": {"version":3,"sources":["file:///Users/mike/Projects/Git/drm-security-lab/src/app/challenges/%5Bid%5D/page.tsx"],"sourcesContent":["\"use client\";\n\nimport Link from \"next/link\";\nimport { use } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { ArrowLeft, Star, Flag, Lightbulb } from \"lucide-react\";\nimport { Base64Challenge } from \"@/components/challenges/Base64Challenge\";\nimport { XorChallenge } from \"@/components/challenges/XorChallenge\";\n\nconst challenges: Record<string, {\n  title: string;\n  points: number;\n  difficulty: string;\n  category: string;\n  description: string;\n  hints: string[];\n  resources: string[];\n  hasInteractive?: boolean;\n}> = {\n  \"base64-decode\": {\n    title: \"Base64 License\",\n    points: 50,\n    difficulty: \"Easy\",\n    category: \"Basics\",\n    description: \"A license response has been intercepted. It's Base64 encoded and contains the content key. Decode it to find the hidden flag.\",\n    hints: [\n      \"Base64 is an encoding, not encryption\",\n      \"Use atob() in JavaScript or base64.b64decode() in Python\",\n      \"The decoded data is JSON - look for the content key\",\n    ],\n    resources: [\n      \"Base64 encoding explained\",\n      \"Online Base64 decoder tools\",\n    ],\n    hasInteractive: true,\n  },\n  \"hex-analysis\": {\n    title: \"Hex Key Inspector\",\n    points: 75,\n    difficulty: \"Easy\",\n    category: \"Basics\",\n    description: \"Analyze a hex-encoded content key. Convert it to ASCII to find the embedded message.\",\n    hints: [\n      \"Each pair of hex characters represents one byte\",\n      \"Convert hex to decimal, then to ASCII character\",\n      \"The flag format is DRM{...}\",\n    ],\n    resources: [\n      \"Hex to ASCII conversion\",\n      \"Understanding hexadecimal\",\n    ],\n  },\n  \"license-parser\": {\n    title: \"License Parser\",\n    points: 100,\n    difficulty: \"Easy\",\n    category: \"Cryptography\",\n    description: \"You've intercepted a Widevine license response. Parse and decode it to find the hidden flag. The license is base64 encoded and contains protobuf data.\",\n    hints: [\n      \"Widevine licenses use Protocol Buffers format\",\n      \"Look for the content key in the license\",\n      \"The flag is hidden in the key ID field\",\n    ],\n    resources: [\n      \"Widevine License Protocol documentation\",\n      \"Protocol Buffers decoder\",\n    ],\n  },\n  \"xor-encryption\": {\n    title: \"XOR Decryption\",\n    points: 100,\n    difficulty: \"Easy\",\n    category: \"Cryptography\",\n    description: \"A content key has been XOR encrypted with a single-byte key. The key value is a common hex number. Recover the original key to find the flag.\",\n    hints: [\n      \"XOR encryption is reversible with the same key\",\n      \"Common XOR keys include 0x00, 0x42, 0xFF\",\n      \"Try different keys until you see readable text\",\n    ],\n    resources: [\n      \"XOR cipher explained\",\n      \"Single-byte XOR cracking\",\n    ],\n    hasInteractive: true,\n  },\n  \"key-derivation\": {\n    title: \"Key Derivation\",\n    points: 200,\n    difficulty: \"Medium\",\n    category: \"Cryptography\",\n    description: \"Given a license server's response, derive the content key using the correct key derivation function. The server uses a custom KDF based on HKDF.\",\n    hints: [\n      \"The KDF uses SHA-256 as the hash function\",\n      \"The salt is derived from the session ID\",\n      \"Check the info parameter for the key type\",\n    ],\n    resources: [\n      \"RFC 5869 - HKDF specification\",\n      \"Key derivation in DRM systems\",\n    ],\n  },\n  \"aes-decrypt\": {\n    title: \"AES Content Key\",\n    points: 250,\n    difficulty: \"Medium\",\n    category: \"Cryptography\",\n    description: \"An encrypted content key has been captured along with its IV. Decrypt it using AES-CTR to recover the flag.\",\n    hints: [\n      \"AES-CTR uses a counter mode - no padding needed\",\n      \"The IV (Initialization Vector) is provided\",\n      \"Make sure you're using the correct key size (128-bit)\",\n    ],\n    resources: [\n      \"AES-CTR mode explained\",\n      \"Crypto libraries documentation\",\n    ],\n  },\n  \"pssh-parser\": {\n    title: \"PSSH Box Analysis\",\n    points: 200,\n    difficulty: \"Medium\",\n    category: \"Forensics\",\n    description: \"Parse a PSSH box from an MP4 initialization segment. Extract the System ID and Key IDs to find the flag.\",\n    hints: [\n      \"PSSH boxes start with 'pssh' ASCII bytes\",\n      \"The System ID is a UUID identifying the DRM\",\n      \"Key IDs follow the system-specific data\",\n    ],\n    resources: [\n      \"PSSH box structure\",\n      \"CENC standard documentation\",\n    ],\n  },\n  \"certificate-analysis\": {\n    title: \"Certificate Analysis\",\n    points: 300,\n    difficulty: \"Medium\",\n    category: \"Analysis\",\n    description: \"Analyze a chain of DRM certificates to identify a vulnerability. One of the certificates in the chain has a weakness that could be exploited.\",\n    hints: [\n      \"Check certificate validity periods\",\n      \"Look for weak signature algorithms\",\n      \"Examine the key usage extensions\",\n    ],\n    resources: [\n      \"X.509 certificate format\",\n      \"Certificate chain validation\",\n    ],\n  },\n  \"license-policy\": {\n    title: \"Policy Bypass\",\n    points: 275,\n    difficulty: \"Medium\",\n    category: \"Analysis\",\n    description: \"A license response contains policy restrictions. Analyze the policy structure to find a logical flaw that allows bypassing time restrictions.\",\n    hints: [\n      \"License policies often use Unix timestamps\",\n      \"Check for signed vs unsigned integer issues\",\n      \"What happens with negative or zero values?\",\n    ],\n    resources: [\n      \"DRM license policies\",\n      \"Time-based access control\",\n    ],\n  },\n  \"watermark-extraction\": {\n    title: \"Watermark Extraction\",\n    points: 350,\n    difficulty: \"Medium\",\n    category: \"Forensics\",\n    description: \"A video sample contains a forensic watermark that identifies the source. Extract the watermark to find the flag.\",\n    hints: [\n      \"The watermark is in the luminance channel\",\n      \"Look for patterns in specific frames\",\n      \"The watermark uses A/B segment switching\",\n    ],\n    resources: [\n      \"Forensic watermarking techniques\",\n      \"Video frame analysis\",\n    ],\n  },\n  \"protocol-replay\": {\n    title: \"Protocol Replay\",\n    points: 400,\n    difficulty: \"Hard\",\n    category: \"Protocol\",\n    description: \"A license acquisition protocol has a vulnerability that allows replay attacks. Identify the missing protection and craft a replay attack.\",\n    hints: [\n      \"Look for missing nonce or timestamp\",\n      \"Check if requests are properly signed\",\n      \"The session ID might be reusable\",\n    ],\n    resources: [\n      \"Replay attack prevention\",\n      \"License protocol security\",\n    ],\n  },\n  \"mitm-detection\": {\n    title: \"MITM Resistance\",\n    points: 400,\n    difficulty: \"Hard\",\n    category: \"Protocol\",\n    description: \"Analyze a license acquisition protocol for man-in-the-middle vulnerabilities. Find what protection is missing.\",\n    hints: [\n      \"Check for certificate pinning\",\n      \"Look at how the license response is verified\",\n      \"Is the server's identity properly validated?\",\n    ],\n    resources: [\n      \"MITM attack prevention\",\n      \"TLS certificate validation\",\n    ],\n  },\n  \"session-hijack\": {\n    title: \"Session Takeover\",\n    points: 450,\n    difficulty: \"Hard\",\n    category: \"Protocol\",\n    description: \"A CDM session token has been captured from network traffic. Use it to request a license from the server.\",\n    hints: [\n      \"Session tokens often have limited lifetime\",\n      \"Check if the token is bound to specific content\",\n      \"Some sessions allow multiple license requests\",\n    ],\n    resources: [\n      \"Session management security\",\n      \"Token-based authentication\",\n    ],\n  },\n  \"cdm-emulation\": {\n    title: \"CDM Emulation\",\n    points: 500,\n    difficulty: \"Hard\",\n    category: \"Implementation\",\n    description: \"Build a minimal CDM emulator that can process a license and decrypt a sample encrypted segment. Use the provided test keys and content.\",\n    hints: [\n      \"Start with the license parsing\",\n      \"Use AES-CTR for decryption\",\n      \"The IV is derived from the sample number\",\n    ],\n    resources: [\n      \"CENC encryption specification\",\n      \"AES-CTR mode of operation\",\n    ],\n  },\n  \"key-rotation\": {\n    title: \"Key Rotation Attack\",\n    points: 450,\n    difficulty: \"Hard\",\n    category: \"Implementation\",\n    description: \"Content uses key rotation with predictable key IDs. Find the pattern to predict the next key and decrypt additional content.\",\n    hints: [\n      \"Key IDs are generated using a pattern\",\n      \"Look for sequential or time-based values\",\n      \"The pattern might use a hash function\",\n    ],\n    resources: [\n      \"Key rotation in DRM\",\n      \"Predictable random number generators\",\n    ],\n  },\n  \"device-attestation\": {\n    title: \"Attestation Bypass\",\n    points: 600,\n    difficulty: \"Expert\",\n    category: \"Advanced\",\n    description: \"The license server requires device attestation. Analyze the attestation protocol and find a way to spoof a valid attestation response.\",\n    hints: [\n      \"Attestation often relies on certificate chains\",\n      \"Check for revocation list validation\",\n      \"Some implementations trust cached attestations\",\n    ],\n    resources: [\n      \"Device attestation mechanisms\",\n      \"TEE attestation protocols\",\n    ],\n  },\n};\n\nfunction getDifficultyColor(difficulty: string) {\n  switch (difficulty) {\n    case \"Easy\":\n      return \"bg-green-500/10 text-green-500\";\n    case \"Medium\":\n      return \"bg-yellow-500/10 text-yellow-500\";\n    case \"Hard\":\n      return \"bg-red-500/10 text-red-500\";\n    case \"Expert\":\n      return \"bg-purple-500/10 text-purple-500\";\n    default:\n      return \"bg-gray-500/10 text-gray-500\";\n  }\n}\n\n// Map of challenge IDs to their interactive components\nconst challengeComponents: Record<string, React.ComponentType> = {\n  \"base64-decode\": Base64Challenge,\n  \"xor-encryption\": XorChallenge,\n};\n\nexport default function ChallengePage({\n  params,\n}: {\n  params: Promise<{ id: string }>;\n}) {\n  const { id } = use(params);\n  const challenge = challenges[id];\n  const ChallengeComponent = challengeComponents[id];\n\n  if (!challenge) {\n    return (\n      <div className=\"py-20\">\n        <div className=\"mx-auto max-w-3xl px-4 text-center\">\n          <h1 className=\"text-2xl font-bold\">Challenge Not Found</h1>\n          <p className=\"mt-2 text-muted-foreground\">\n            The challenge you&apos;re looking for doesn&apos;t exist.\n          </p>\n          <Link href=\"/challenges\">\n            <Button className=\"mt-4\">Back to Challenges</Button>\n          </Link>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"py-10\">\n      <div className=\"mx-auto max-w-4xl px-4 sm:px-6 lg:px-8\">\n        <Link href=\"/challenges\">\n          <Button variant=\"ghost\" size=\"sm\" className=\"mb-6 gap-2\">\n            <ArrowLeft className=\"h-4 w-4\" />\n            Back to Challenges\n          </Button>\n        </Link>\n\n        <header className=\"mb-8\">\n          <div className=\"flex items-center gap-3 mb-4\">\n            <Badge variant=\"outline\">{challenge.category}</Badge>\n            <Badge className={getDifficultyColor(challenge.difficulty)}>\n              {challenge.difficulty}\n            </Badge>\n            <div className=\"flex items-center gap-1 text-yellow-500\">\n              <Star className=\"h-4 w-4 fill-current\" />\n              <span className=\"font-medium\">{challenge.points} pts</span>\n            </div>\n          </div>\n          <h1 className=\"text-4xl font-bold tracking-tight\">{challenge.title}</h1>\n          <p className=\"mt-4 text-lg text-muted-foreground\">{challenge.description}</p>\n        </header>\n\n        <div className=\"grid gap-6 md:grid-cols-2 mb-8\">\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <Lightbulb className=\"h-5 w-5\" />\n                Hints\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              <ul className=\"space-y-3\">\n                {challenge.hints.map((hint, index) => (\n                  <li key={index} className=\"flex items-start gap-2 text-sm\">\n                    <span className=\"bg-primary/20 text-primary px-2 py-0.5 rounded text-xs\">\n                      {index + 1}\n                    </span>\n                    <span className=\"text-muted-foreground\">{hint}</span>\n                  </li>\n                ))}\n              </ul>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardHeader>\n              <CardTitle>Resources</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <ul className=\"space-y-2\">\n                {challenge.resources.map((resource, index) => (\n                  <li key={index} className=\"flex items-start gap-2 text-sm\">\n                    <span className=\"text-primary\">â€¢</span>\n                    <span className=\"text-muted-foreground\">{resource}</span>\n                  </li>\n                ))}\n              </ul>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Interactive Challenge Component */}\n        {ChallengeComponent ? (\n          <ChallengeComponent />\n        ) : (\n          <>\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Flag className=\"h-5 w-5\" />\n                  Submit Flag\n                </CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"flex gap-3\">\n                  <input\n                    type=\"text\"\n                    placeholder=\"Enter flag (e.g., DRM{...})\"\n                    className=\"flex-1 rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\"\n                  />\n                  <Button>Submit</Button>\n                </div>\n                <p className=\"mt-4 text-sm text-muted-foreground\">\n                  This challenge requires external tools. Use the hints and resources above to solve it.\n                </p>\n              </CardContent>\n            </Card>\n          </>\n        )}\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AAFA;AAAA;AAAA;AAAA;AAPA;;;;;;;;;;AAWA,MAAM,aASD;IACH,iBAAiB;QACf,OAAO;QACP,QAAQ;QACR,YAAY;QACZ,UAAU;QACV,aAAa;QACb,OAAO;YACL;YACA;YACA;SACD;QACD,WAAW;YACT;YACA;SACD;QACD,gBAAgB;IAClB;IACA,gBAAgB;QACd,OAAO;QACP,QAAQ;QACR,YAAY;QACZ,UAAU;QACV,aAAa;QACb,OAAO;YACL;YACA;YACA;SACD;QACD,WAAW;YACT;YACA;SACD;IACH;IACA,kBAAkB;QAChB,OAAO;QACP,QAAQ;QACR,YAAY;QACZ,UAAU;QACV,aAAa;QACb,OAAO;YACL;YACA;YACA;SACD;QACD,WAAW;YACT;YACA;SACD;IACH;IACA,kBAAkB;QAChB,OAAO;QACP,QAAQ;QACR,YAAY;QACZ,UAAU;QACV,aAAa;QACb,OAAO;YACL;YACA;YACA;SACD;QACD,WAAW;YACT;YACA;SACD;QACD,gBAAgB;IAClB;IACA,kBAAkB;QAChB,OAAO;QACP,QAAQ;QACR,YAAY;QACZ,UAAU;QACV,aAAa;QACb,OAAO;YACL;YACA;YACA;SACD;QACD,WAAW;YACT;YACA;SACD;IACH;IACA,eAAe;QACb,OAAO;QACP,QAAQ;QACR,YAAY;QACZ,UAAU;QACV,aAAa;QACb,OAAO;YACL;YACA;YACA;SACD;QACD,WAAW;YACT;YACA;SACD;IACH;IACA,eAAe;QACb,OAAO;QACP,QAAQ;QACR,YAAY;QACZ,UAAU;QACV,aAAa;QACb,OAAO;YACL;YACA;YACA;SACD;QACD,WAAW;YACT;YACA;SACD;IACH;IACA,wBAAwB;QACtB,OAAO;QACP,QAAQ;QACR,YAAY;QACZ,UAAU;QACV,aAAa;QACb,OAAO;YACL;YACA;YACA;SACD;QACD,WAAW;YACT;YACA;SACD;IACH;IACA,kBAAkB;QAChB,OAAO;QACP,QAAQ;QACR,YAAY;QACZ,UAAU;QACV,aAAa;QACb,OAAO;YACL;YACA;YACA;SACD;QACD,WAAW;YACT;YACA;SACD;IACH;IACA,wBAAwB;QACtB,OAAO;QACP,QAAQ;QACR,YAAY;QACZ,UAAU;QACV,aAAa;QACb,OAAO;YACL;YACA;YACA;SACD;QACD,WAAW;YACT;YACA;SACD;IACH;IACA,mBAAmB;QACjB,OAAO;QACP,QAAQ;QACR,YAAY;QACZ,UAAU;QACV,aAAa;QACb,OAAO;YACL;YACA;YACA;SACD;QACD,WAAW;YACT;YACA;SACD;IACH;IACA,kBAAkB;QAChB,OAAO;QACP,QAAQ;QACR,YAAY;QACZ,UAAU;QACV,aAAa;QACb,OAAO;YACL;YACA;YACA;SACD;QACD,WAAW;YACT;YACA;SACD;IACH;IACA,kBAAkB;QAChB,OAAO;QACP,QAAQ;QACR,YAAY;QACZ,UAAU;QACV,aAAa;QACb,OAAO;YACL;YACA;YACA;SACD;QACD,WAAW;YACT;YACA;SACD;IACH;IACA,iBAAiB;QACf,OAAO;QACP,QAAQ;QACR,YAAY;QACZ,UAAU;QACV,aAAa;QACb,OAAO;YACL;YACA;YACA;SACD;QACD,WAAW;YACT;YACA;SACD;IACH;IACA,gBAAgB;QACd,OAAO;QACP,QAAQ;QACR,YAAY;QACZ,UAAU;QACV,aAAa;QACb,OAAO;YACL;YACA;YACA;SACD;QACD,WAAW;YACT;YACA;SACD;IACH;IACA,sBAAsB;QACpB,OAAO;QACP,QAAQ;QACR,YAAY;QACZ,UAAU;QACV,aAAa;QACb,OAAO;YACL;YACA;YACA;SACD;QACD,WAAW;YACT;YACA;SACD;IACH;AACF;AAEA,SAAS,mBAAmB,UAAkB;IAC5C,OAAQ;QACN,KAAK;YACH,OAAO;QACT,KAAK;YACH,OAAO;QACT,KAAK;YACH,OAAO;QACT,KAAK;YACH,OAAO;QACT;YACE,OAAO;IACX;AACF;AAEA,uDAAuD;AACvD,MAAM,sBAA2D;IAC/D,iBAAiB,sJAAA,CAAA,kBAAe;IAChC,kBAAkB,mJAAA,CAAA,eAAY;AAChC;AAEe,SAAS,cAAc,EACpC,MAAM,EAGP;IACC,MAAM,EAAE,EAAE,EAAE,GAAG,CAAA,GAAA,6JAAA,CAAA,MAAG,AAAD,EAAE;IACnB,MAAM,YAAY,UAAU,CAAC,GAAG;IAChC,MAAM,qBAAqB,mBAAmB,CAAC,GAAG;IAElD,IAAI,CAAC,WAAW;QACd,qBACE,6LAAC;YAAI,WAAU;sBACb,cAAA,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAG,WAAU;kCAAqB;;;;;;kCACnC,6LAAC;wBAAE,WAAU;kCAA6B;;;;;;kCAG1C,6LAAC,+JAAA,CAAA,UAAI;wBAAC,MAAK;kCACT,cAAA,6LAAC,qIAAA,CAAA,SAAM;4BAAC,WAAU;sCAAO;;;;;;;;;;;;;;;;;;;;;;IAKnC;IAEA,qBACE,6LAAC;QAAI,WAAU;kBACb,cAAA,6LAAC;YAAI,WAAU;;8BACb,6LAAC,+JAAA,CAAA,UAAI;oBAAC,MAAK;8BACT,cAAA,6LAAC,qIAAA,CAAA,SAAM;wBAAC,SAAQ;wBAAQ,MAAK;wBAAK,WAAU;;0CAC1C,6LAAC,mNAAA,CAAA,YAAS;gCAAC,WAAU;;;;;;4BAAY;;;;;;;;;;;;8BAKrC,6LAAC;oBAAO,WAAU;;sCAChB,6LAAC;4BAAI,WAAU;;8CACb,6LAAC,oIAAA,CAAA,QAAK;oCAAC,SAAQ;8CAAW,UAAU,QAAQ;;;;;;8CAC5C,6LAAC,oIAAA,CAAA,QAAK;oCAAC,WAAW,mBAAmB,UAAU,UAAU;8CACtD,UAAU,UAAU;;;;;;8CAEvB,6LAAC;oCAAI,WAAU;;sDACb,6LAAC,qMAAA,CAAA,OAAI;4CAAC,WAAU;;;;;;sDAChB,6LAAC;4CAAK,WAAU;;gDAAe,UAAU,MAAM;gDAAC;;;;;;;;;;;;;;;;;;;sCAGpD,6LAAC;4BAAG,WAAU;sCAAqC,UAAU,KAAK;;;;;;sCAClE,6LAAC;4BAAE,WAAU;sCAAsC,UAAU,WAAW;;;;;;;;;;;;8BAG1E,6LAAC;oBAAI,WAAU;;sCACb,6LAAC,mIAAA,CAAA,OAAI;;8CACH,6LAAC,mIAAA,CAAA,aAAU;8CACT,cAAA,6LAAC,mIAAA,CAAA,YAAS;wCAAC,WAAU;;0DACnB,6LAAC,+MAAA,CAAA,YAAS;gDAAC,WAAU;;;;;;4CAAY;;;;;;;;;;;;8CAIrC,6LAAC,mIAAA,CAAA,cAAW;8CACV,cAAA,6LAAC;wCAAG,WAAU;kDACX,UAAU,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,sBAC1B,6LAAC;gDAAe,WAAU;;kEACxB,6LAAC;wDAAK,WAAU;kEACb,QAAQ;;;;;;kEAEX,6LAAC;wDAAK,WAAU;kEAAyB;;;;;;;+CAJlC;;;;;;;;;;;;;;;;;;;;;sCAWjB,6LAAC,mIAAA,CAAA,OAAI;;8CACH,6LAAC,mIAAA,CAAA,aAAU;8CACT,cAAA,6LAAC,mIAAA,CAAA,YAAS;kDAAC;;;;;;;;;;;8CAEb,6LAAC,mIAAA,CAAA,cAAW;8CACV,cAAA,6LAAC;wCAAG,WAAU;kDACX,UAAU,SAAS,CAAC,GAAG,CAAC,CAAC,UAAU,sBAClC,6LAAC;gDAAe,WAAU;;kEACxB,6LAAC;wDAAK,WAAU;kEAAe;;;;;;kEAC/B,6LAAC;wDAAK,WAAU;kEAAyB;;;;;;;+CAFlC;;;;;;;;;;;;;;;;;;;;;;;;;;;gBAWlB,mCACC,6LAAC;;;;yCAED;8BACE,cAAA,6LAAC,mIAAA,CAAA,OAAI;;0CACH,6LAAC,mIAAA,CAAA,aAAU;0CACT,cAAA,6LAAC,mIAAA,CAAA,YAAS;oCAAC,WAAU;;sDACnB,6LAAC,qMAAA,CAAA,OAAI;4CAAC,WAAU;;;;;;wCAAY;;;;;;;;;;;;0CAIhC,6LAAC,mIAAA,CAAA,cAAW;;kDACV,6LAAC;wCAAI,WAAU;;0DACb,6LAAC;gDACC,MAAK;gDACL,aAAY;gDACZ,WAAU;;;;;;0DAEZ,6LAAC,qIAAA,CAAA,SAAM;0DAAC;;;;;;;;;;;;kDAEV,6LAAC;wCAAE,WAAU;kDAAqC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAUlE;KAxHwB"}},
    {"offset": {"line": 1993, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}