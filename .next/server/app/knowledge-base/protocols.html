<!DOCTYPE html><!--il8YMQTdw3gKb2FCiC7cm--><html lang="en" class="dark"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/797e433ab948586e-s.p.dbea232f.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/caa3a2e1cccd8315-s.p.853070df.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/_next/static/chunks/3f4018f1fd8aa9eb.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/2f10d432553c949f.js"/><script src="/_next/static/chunks/14c06e15d1dc0a97.js" async=""></script><script src="/_next/static/chunks/6f841ba11ed02fa6.js" async=""></script><script src="/_next/static/chunks/turbopack-fd00362e19ece5b1.js" async=""></script><script src="/_next/static/chunks/2c7837371b5f0801.js" async=""></script><script src="/_next/static/chunks/6dacee62af9f78ce.js" async=""></script><script src="/_next/static/chunks/ba330557940bdbd1.js" async=""></script><script src="/_next/static/chunks/b0b0e24ff49b787a.js" async=""></script><script src="/_next/static/chunks/e87ae7e30c40f8b9.js" async=""></script><meta name="next-size-adjust" content=""/><title>License Protocols | DRM Security Lab</title><meta name="description" content="Deep dive into DRM license acquisition protocols - how keys are securely requested, delivered, and validated."/><meta name="author" content="DRM Security Lab"/><meta name="keywords" content="DRM,Digital Rights Management,Security Research,Widevine,FairPlay,PlayReady,Encryption,Content Protection,Educational"/><meta property="og:title" content="DRM Security Lab"/><meta property="og:description" content="Educational DRM security research platform"/><meta property="og:type" content="website"/><meta name="twitter:card" content="summary"/><meta name="twitter:title" content="DRM Security Lab"/><meta name="twitter:description" content="Educational DRM security research platform"/><link rel="icon" href="/favicon.ico?favicon.0b3bf435.ico" sizes="256x256" type="image/x-icon"/><script src="/_next/static/chunks/a6dad97d9634a72d.js" noModule=""></script></head><body class="geist_a71539c9-module__T19VSG__variable geist_mono_8d43a2aa-module__8Li5zG__variable min-h-screen bg-background font-sans antialiased scrollbar-dark"><div hidden=""><!--$--><!--/$--></div><div data-perspective="neutral"><div class="min-h-screen bg-background"><header class="sticky top-0 z-40 border-b border-border bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60"><div class="mx-auto flex h-16 max-w-7xl items-center justify-between px-4 sm:px-6 lg:px-8"><a class="flex items-center gap-2" href="/"><div class="flex h-8 w-8 items-center justify-center rounded-lg bg-primary/10"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-shield h-5 w-5 text-primary" aria-hidden="true"><path d="M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z"></path></svg></div><div class="hidden sm:block"><span class="font-bold text-foreground">DRM Security</span><span class="ml-1 text-muted-foreground">Lab</span></div></a><nav class="hidden items-center gap-1 md:flex"><a href="/knowledge-base"><button data-slot="button" data-variant="secondary" data-size="sm" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive bg-secondary text-secondary-foreground hover:bg-secondary/80 h-8 rounded-md px-3 has-[&gt;svg]:px-2.5 gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-book-open h-4 w-4" aria-hidden="true"><path d="M12 7v14"></path><path d="M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z"></path></svg>Knowledge Base</button></a><a href="/labs"><button data-slot="button" data-variant="ghost" data-size="sm" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-8 rounded-md px-3 has-[&gt;svg]:px-2.5 gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-flask-conical h-4 w-4" aria-hidden="true"><path d="M14 2v6a2 2 0 0 0 .245.96l5.51 10.08A2 2 0 0 1 18 22H6a2 2 0 0 1-1.755-2.96l5.51-10.08A2 2 0 0 0 10 8V2"></path><path d="M6.453 15h11.094"></path><path d="M8.5 2h7"></path></svg>Labs</button></a><a href="/challenges"><button data-slot="button" data-variant="ghost" data-size="sm" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-8 rounded-md px-3 has-[&gt;svg]:px-2.5 gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-trophy h-4 w-4" aria-hidden="true"><path d="M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978"></path><path d="M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978"></path><path d="M18 9h1.5a1 1 0 0 0 0-5H18"></path><path d="M4 22h16"></path><path d="M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z"></path><path d="M6 9H4.5a1 1 0 0 1 0-5H6"></path></svg>Challenges</button></a></nav><div class="flex items-center gap-4"><div class="hidden items-center gap-3 text-sm sm:flex"><div class="flex items-center gap-1.5 text-muted-foreground"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-trophy h-4 w-4 text-warning" aria-hidden="true"><path d="M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978"></path><path d="M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978"></path><path d="M18 9h1.5a1 1 0 0 0 0-5H18"></path><path d="M4 22h16"></path><path d="M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z"></path><path d="M6 9H4.5a1 1 0 0 1 0-5H6"></path></svg><span class="font-medium text-foreground">0</span><span>pts</span></div><div class="h-4 w-px bg-border"></div><div class="text-muted-foreground"><span class="font-medium text-foreground">0</span> <!-- -->solved</div></div><div class="flex items-center gap-1 rounded-lg border border-border bg-card p-1 hidden lg:flex"><button data-slot="button" data-variant="ghost" data-size="sm" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:text-accent-foreground dark:hover:bg-accent/50 rounded-md gap-1.5 has-[&gt;svg]:px-2.5 h-8 px-2 text-red-team hover:bg-red-team/10 data-[active=true]:bg-red-team/20 data-[active=true]:text-red-team transition-all" data-active="false"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-sword h-3.5 w-3.5" aria-hidden="true"><path d="m11 19-6-6"></path><path d="m5 21-2-2"></path><path d="m8 16-4 4"></path><path d="M9.5 17.5 21 6V3h-3L6.5 14.5"></path></svg></button><button data-slot="button" data-variant="ghost" data-size="sm" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:text-accent-foreground dark:hover:bg-accent/50 rounded-md gap-1.5 has-[&gt;svg]:px-2.5 h-8 px-2 text-muted-foreground hover:bg-accent data-[active=true]:bg-accent data-[active=true]:text-foreground transition-all" data-active="true"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-eye h-3.5 w-3.5" aria-hidden="true"><path d="M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0"></path><circle cx="12" cy="12" r="3"></circle></svg></button><button data-slot="button" data-variant="ghost" data-size="sm" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:text-accent-foreground dark:hover:bg-accent/50 rounded-md gap-1.5 has-[&gt;svg]:px-2.5 h-8 px-2 text-blue-team hover:bg-blue-team/10 data-[active=true]:bg-blue-team/20 data-[active=true]:text-blue-team transition-all" data-active="false"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-shield h-3.5 w-3.5" aria-hidden="true"><path d="M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z"></path></svg></button></div><button data-slot="button" data-variant="ghost" data-size="sm" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5 md:hidden"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-menu h-5 w-5" aria-hidden="true"><path d="M4 5h16"></path><path d="M4 12h16"></path><path d="M4 19h16"></path></svg></button></div></div></header><div class="flex"><aside class="flex w-64 flex-col border-r border-border bg-sidebar hidden lg:flex"><div class="p-4"><div class="inline-flex items-center gap-1.5 rounded-full border px-2.5 py-1 text-xs font-medium bg-muted text-muted-foreground border-border w-full justify-center"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-eye h-3 w-3" aria-hidden="true"><path d="M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0"></path><circle cx="12" cy="12" r="3"></circle></svg>Neutral (Observer)</div></div><div data-orientation="horizontal" role="none" data-slot="separator" class="bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px"></div><div dir="ltr" data-slot="scroll-area" class="relative flex-1" style="position:relative;--radix-scroll-area-corner-width:0px;--radix-scroll-area-corner-height:0px"><style>[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}</style><div data-radix-scroll-area-viewport="" data-slot="scroll-area-viewport" class="focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1" style="overflow-x:hidden;overflow-y:hidden"><div style="min-width:100%;display:table"><div class="p-2"><div class="py-2"><div class="mb-1 flex items-center justify-between px-3"><h3 class="text-xs font-semibold uppercase tracking-wider text-muted-foreground">Learn</h3></div><div class="space-y-0.5"><a href="/knowledge-base"><button data-slot="button" data-variant="ghost" data-size="sm" class="inline-flex items-center whitespace-nowrap text-sm transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-8 rounded-md has-[&gt;svg]:px-2.5 w-full justify-start gap-2 px-3 font-normal"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-book-open h-4 w-4" aria-hidden="true"><path d="M12 7v14"></path><path d="M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z"></path></svg><span class="flex-1 truncate text-left">Knowledge Base</span></button></a><a href="/diagrams"><button data-slot="button" data-variant="ghost" data-size="sm" class="inline-flex items-center whitespace-nowrap text-sm transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-8 rounded-md has-[&gt;svg]:px-2.5 w-full justify-start gap-2 px-3 font-normal"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-git-branch h-4 w-4" aria-hidden="true"><line x1="6" x2="6" y1="3" y2="15"></line><circle cx="18" cy="6" r="3"></circle><circle cx="6" cy="18" r="3"></circle><path d="M18 9a9 9 0 0 1-9 9"></path></svg><span class="flex-1 truncate text-left">Diagrams</span></button></a><a href="/labs"><button data-slot="button" data-variant="ghost" data-size="sm" class="inline-flex items-center whitespace-nowrap text-sm transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-8 rounded-md has-[&gt;svg]:px-2.5 w-full justify-start gap-2 px-3 font-normal"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-flask-conical h-4 w-4" aria-hidden="true"><path d="M14 2v6a2 2 0 0 0 .245.96l5.51 10.08A2 2 0 0 1 18 22H6a2 2 0 0 1-1.755-2.96l5.51-10.08A2 2 0 0 0 10 8V2"></path><path d="M6.453 15h11.094"></path><path d="M8.5 2h7"></path></svg><span class="flex-1 truncate text-left">Labs</span></button></a><a href="/challenges"><button data-slot="button" data-variant="ghost" data-size="sm" class="inline-flex items-center whitespace-nowrap text-sm transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-8 rounded-md has-[&gt;svg]:px-2.5 w-full justify-start gap-2 px-3 font-normal"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-trophy h-4 w-4" aria-hidden="true"><path d="M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978"></path><path d="M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978"></path><path d="M18 9h1.5a1 1 0 0 0 0-5H18"></path><path d="M4 22h16"></path><path d="M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z"></path><path d="M6 9H4.5a1 1 0 0 1 0-5H6"></path></svg><span class="flex-1 truncate text-left">Challenges</span></button></a></div></div><div data-orientation="horizontal" role="none" data-slot="separator" class="bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px my-2"></div><div class="py-2"><div class="mb-1 flex items-center justify-between px-3"><h3 class="text-xs font-semibold uppercase tracking-wider text-muted-foreground">Topics</h3></div><div class="space-y-0.5"><a href="/knowledge-base/overview"><button data-slot="button" data-variant="ghost" data-size="sm" class="inline-flex items-center whitespace-nowrap text-sm transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-8 rounded-md has-[&gt;svg]:px-2.5 w-full justify-start gap-2 px-3 font-normal"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-book-open h-4 w-4" aria-hidden="true"><path d="M12 7v14"></path><path d="M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z"></path></svg><span class="flex-1 truncate text-left">DRM Overview</span></button></a><a href="/knowledge-base/widevine"><button data-slot="button" data-variant="ghost" data-size="sm" class="inline-flex items-center whitespace-nowrap text-sm transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-8 rounded-md has-[&gt;svg]:px-2.5 w-full justify-start gap-2 px-3 font-normal"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-shield h-4 w-4" aria-hidden="true"><path d="M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z"></path></svg><span class="flex-1 truncate text-left">Widevine</span></button></a><a href="/knowledge-base/fairplay"><button data-slot="button" data-variant="ghost" data-size="sm" class="inline-flex items-center whitespace-nowrap text-sm transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-8 rounded-md has-[&gt;svg]:px-2.5 w-full justify-start gap-2 px-3 font-normal"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-shield h-4 w-4" aria-hidden="true"><path d="M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z"></path></svg><span class="flex-1 truncate text-left">FairPlay</span></button></a><a href="/knowledge-base/playready"><button data-slot="button" data-variant="ghost" data-size="sm" class="inline-flex items-center whitespace-nowrap text-sm transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-8 rounded-md has-[&gt;svg]:px-2.5 w-full justify-start gap-2 px-3 font-normal"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-shield h-4 w-4" aria-hidden="true"><path d="M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z"></path></svg><span class="flex-1 truncate text-left">PlayReady</span></button></a><a href="/knowledge-base/encryption"><button data-slot="button" data-variant="ghost" data-size="sm" class="inline-flex items-center whitespace-nowrap text-sm transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 h-8 rounded-md has-[&gt;svg]:px-2.5 w-full justify-start gap-2 px-3 font-normal"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-lock h-4 w-4" aria-hidden="true"><rect width="18" height="11" x="3" y="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path></svg><span class="flex-1 truncate text-left">Encryption Basics</span></button></a><a href="/knowledge-base/protocols"><button data-slot="button" data-variant="secondary" data-size="sm" class="inline-flex items-center whitespace-nowrap text-sm transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive bg-secondary text-secondary-foreground hover:bg-secondary/80 h-8 rounded-md has-[&gt;svg]:px-2.5 w-full justify-start gap-2 px-3 font-normal"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-network h-4 w-4" aria-hidden="true"><rect x="16" y="16" width="6" height="6" rx="1"></rect><rect x="2" y="16" width="6" height="6" rx="1"></rect><rect x="9" y="2" width="6" height="6" rx="1"></rect><path d="M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3"></path><path d="M12 12V8"></path></svg><span class="flex-1 truncate text-left">License Protocols</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right h-3 w-3 text-muted-foreground" aria-hidden="true"><path d="m9 18 6-6-6-6"></path></svg></button></a></div></div></div></div></div></div><div data-orientation="horizontal" role="none" data-slot="separator" class="bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px"></div><div class="p-4"><div class="rounded-lg border border-border bg-card p-3"><div class="flex items-center gap-2 text-sm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-flask-conical h-4 w-4 text-primary" aria-hidden="true"><path d="M14 2v6a2 2 0 0 0 .245.96l5.51 10.08A2 2 0 0 1 18 22H6a2 2 0 0 1-1.755-2.96l5.51-10.08A2 2 0 0 0 10 8V2"></path><path d="M6.453 15h11.094"></path><path d="M8.5 2h7"></path></svg><span class="font-medium">Quick Start</span></div><p class="mt-1 text-xs text-muted-foreground">New here? Start with the DRM Overview to understand the basics.</p><a href="/knowledge-base/overview"><button data-slot="button" data-variant="secondary" data-size="sm" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive bg-secondary text-secondary-foreground hover:bg-secondary/80 h-8 rounded-md gap-1.5 px-3 has-[&gt;svg]:px-2.5 mt-2 w-full">Get Started</button></a></div></div></aside><main class="flex-1 p-6 lg:p-8"><div class="mx-auto max-w-4xl"><a class="mb-6 inline-flex items-center gap-1 text-sm text-muted-foreground hover:text-foreground transition-colors" href="/knowledge-base"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-left h-4 w-4" aria-hidden="true"><path d="m12 19-7-7 7-7"></path><path d="M19 12H5"></path></svg>Back to Knowledge Base</a><header class="mb-8"><div class="flex flex-wrap items-center gap-2 mb-4"><span data-slot="badge" class="inline-flex items-center justify-center rounded-full border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden text-foreground [a&amp;]:hover:bg-accent [a&amp;]:hover:text-accent-foreground">Protocols</span><span data-slot="badge" class="inline-flex items-center justify-center rounded-full border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden [a&amp;]:hover:bg-accent [a&amp;]:hover:text-accent-foreground bg-orange-500/10 text-orange-500 border-orange-500/30">advanced</span><div class="flex items-center gap-1 text-sm text-muted-foreground"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-clock h-4 w-4" aria-hidden="true"><path d="M12 6v6l4 2"></path><circle cx="12" cy="12" r="10"></circle></svg>35<!-- --> min read</div></div><h1 class="text-4xl font-bold tracking-tight text-foreground mb-4">License Protocols</h1><p class="text-lg text-muted-foreground">Deep dive into DRM license acquisition protocols - how keys are securely requested, delivered, and validated.</p><div class="mt-4 p-4 rounded-lg border border-border bg-card"><div class="flex items-center gap-2 text-sm font-medium text-foreground mb-2"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-book-open h-4 w-4" aria-hidden="true"><path d="M12 7v14"></path><path d="M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z"></path></svg>Prerequisites</div><div class="flex flex-wrap gap-2"><a href="/knowledge-base/encryption"><span data-slot="badge" class="inline-flex items-center justify-center rounded-full border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary text-secondary-foreground [a&amp;]:hover:bg-secondary/90 cursor-pointer hover:bg-secondary/80">encryption</span></a><a href="/knowledge-base/overview"><span data-slot="badge" class="inline-flex items-center justify-center rounded-full border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary text-secondary-foreground [a&amp;]:hover:bg-secondary/90 cursor-pointer hover:bg-secondary/80">overview</span></a></div></div></header><div data-orientation="horizontal" role="none" data-slot="separator" class="bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px mb-8"></div><article class="prose prose-invert max-w-none"><h1 id="license-protocols-in-drm" class="scroll-mt-20 text-3xl font-bold tracking-tight text-foreground mt-8 mb-4">License Protocols in DRM</h1>
<p class="text-muted-foreground leading-7 mb-4">License protocols are the communication layer between clients and license servers. They handle the secure exchange of content decryption keys while preventing interception and replay attacks.</p>
<h2 id="the-license-acquisition-flow" class="scroll-mt-20 text-2xl font-semibold text-foreground mt-8 mb-3 border-b border-border pb-2">The License Acquisition Flow</h2>
<p class="text-muted-foreground leading-7 mb-4">All DRM systems follow a similar high-level flow:</p>
<code class="rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground">┌─────────────────────────────────────────────────────────────────────────────┐
│                    Generic License Acquisition Flow                          │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│   ┌──────────┐         ┌──────────┐         ┌──────────────┐                │
│   │  Client  │         │  Proxy   │         │   License    │                │
│   │  (CDM)   │         │  Server  │         │    Server    │                │
│   └────┬─────┘         └────┬─────┘         └──────┬───────┘                │
│        │                    │                      │                         │
│        │  1. Parse PSSH     │                      │                         │
│        │  (get key IDs)     │                      │                         │
│        │                    │                      │                         │
│        │  2. Generate       │                      │                         │
│        │  License Request   │                      │                         │
│        │                    │                      │                         │
│        │─────────────────────────────────────────────────────────────────►  │
│        │  3. License Request (encrypted challenge)                          │
│        │                    │                      │                         │
│        │                    │                      │  4. Validate            │
│        │                    │                      │  Device                 │
│        │                    │                      │                         │
│        │                    │                      │  5. Check               │
│        │                    │                      │  Entitlements           │
│        │                    │                      │                         │
│        │◄────────────────────────────────────────────────────────────────   │
│        │  6. License Response (encrypted content keys)                      │
│        │                    │                      │                         │
│        │  7. Decrypt        │                      │                         │
│        │  Response          │                      │                         │
│        │                    │                      │                         │
│        │  8. Store Keys     │                      │                         │
│        │  in CDM            │                      │                         │
│        │                    │                      │                         │
│   └────┴─────┘         └────┴─────┘         └──────┴───────┘                │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
</code>
<div class="my-4 rounded-lg border border-border bg-card p-4"><div class="flex items-center gap-2 mb-2"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-lightbulb h-4 w-4 text-yellow-500" aria-hidden="true"><path d="M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5"></path><path d="M9 18h6"></path><path d="M10 22h4"></path></svg><span class="font-semibold text-foreground">License Challenge</span></div><div class="text-sm text-muted-foreground"><p class="text-muted-foreground leading-7 mb-4">The license request (challenge) is an encrypted blob generated by the CDM. It contains device identity, key IDs, and session information - all signed and encrypted to prevent tampering.</p></div></div>
<h2 id="widevine-license-protocol" class="scroll-mt-20 text-2xl font-semibold text-foreground mt-8 mb-3 border-b border-border pb-2">Widevine License Protocol</h2>
<h3 id="protocol-overview" class="scroll-mt-20 text-xl font-semibold text-foreground mt-6 mb-2">Protocol Overview</h3>
<p class="text-muted-foreground leading-7 mb-4">Widevine uses a binary protocol based on Protocol Buffers (protobuf).</p>
<code class="rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground">┌─────────────────────────────────────────────────────────────────────────────┐
│                      Widevine License Protocol                               │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│   License Request Structure:                                                 │
│   ┌────────────────────────────────────────────────────────────────────┐    │
│   │ SignedMessage                                                       │    │
│   ├────────────────────────────────────────────────────────────────────┤    │
│   │ type: LICENSE_REQUEST                                              │    │
│   │ msg: LicenseRequest (protobuf)                                     │    │
│   │   ├── client_id: DeviceCertificate                                 │    │
│   │   ├── content_id: KeyID[]                                          │    │
│   │   ├── type: NEW | RENEWAL | RELEASE                                │    │
│   │   ├── request_time: timestamp                                      │    │
│   │   └── protocol_version: 21                                         │    │
│   │ signature: RSA-PSS signature                                       │    │
│   │ session_key: AES-encrypted session key                             │    │
│   └────────────────────────────────────────────────────────────────────┘    │
│                                                                              │
│   License Response Structure:                                                │
│   ┌────────────────────────────────────────────────────────────────────┐    │
│   │ SignedMessage                                                       │    │
│   ├────────────────────────────────────────────────────────────────────┤    │
│   │ type: LICENSE                                                       │    │
│   │ msg: License (protobuf)                                            │    │
│   │   ├── id: LicenseID                                                │    │
│   │   ├── policy: Policy                                               │    │
│   │   │     ├── can_play: bool                                         │    │
│   │   │     ├── can_persist: bool                                      │    │
│   │   │     ├── can_renew: bool                                        │    │
│   │   │     ├── license_duration_seconds                               │    │
│   │   │     └── playback_duration_seconds                              │    │
│   │   └── key: KeyContainer[]                                          │    │
│   │         ├── id: key_id                                             │    │
│   │         ├── iv: initialization_vector                              │    │
│   │         ├── key: encrypted_content_key                             │    │
│   │         └── type: CONTENT | SIGNING | OPERATOR                     │    │
│   │ signature: RSA-PSS signature                                       │    │
│   └────────────────────────────────────────────────────────────────────┘    │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
</code>
<h3 id="key-derivation-in-widevine" class="scroll-mt-20 text-xl font-semibold text-foreground mt-6 mb-2">Key Derivation in Widevine</h3>
<pre class="my-4 overflow-x-auto rounded-lg border border-border bg-zinc-950 p-4"><code class="text-sm text-zinc-100 language-python"># Conceptual key derivation (simplified)

# 1. Client generates ephemeral key pair
client_private, client_public = generate_rsa_keypair(2048)

# 2. License server encrypts content keys with client&#x27;s public key
encrypted_content_key = rsa_oaep_encrypt(
    public_key=client_public,
    plaintext=content_key
)

# 3. Client decrypts using private key (inside CDM)
content_key = rsa_oaep_decrypt(
    private_key=client_private,
    ciphertext=encrypted_content_key
)
</code></pre>
<div data-slot="alert" role="alert" class="relative w-full rounded-lg border px-4 py-3 text-sm grid has-[&gt;svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[&gt;svg]:gap-x-3 gap-y-0.5 items-start [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:translate-y-0.5 [&amp;&gt;svg]:text-current text-card-foreground my-4 border-red-500/50 bg-red-500/5"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-sword h-4 w-4 text-red-500" aria-hidden="true"><path d="m11 19-6-6"></path><path d="m5 21-2-2"></path><path d="m8 16-4 4"></path><path d="M9.5 17.5 21 6V3h-3L6.5 14.5"></path></svg><div data-slot="alert-title" class="col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight text-red-500">Protocol Attack Surface</div><div data-slot="alert-description" class="col-start-2 grid justify-items-start gap-1 text-sm [&amp;_p]:leading-relaxed text-muted-foreground"><p class="text-muted-foreground leading-7 mb-4">Attack vectors on the license protocol:</p><ul class="my-4 ml-6 list-disc space-y-2 text-muted-foreground">
<li class="leading-7"><strong class="font-semibold text-foreground">Request Forgery</strong>: Crafting fake license requests with elevated privileges</li>
<li class="leading-7"><strong class="font-semibold text-foreground">Response Replay</strong>: Reusing captured license responses for different content</li>
<li class="leading-7"><strong class="font-semibold text-foreground">MITM on Proxy</strong>: If the proxy server doesn&#x27;t validate properly</li>
<li class="leading-7"><strong class="font-semibold text-foreground">Session Key Extraction</strong>: Obtaining session keys to decrypt responses</li>
</ul></div></div>
<div data-slot="alert" role="alert" class="relative w-full rounded-lg border px-4 py-3 text-sm grid has-[&gt;svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[&gt;svg]:gap-x-3 gap-y-0.5 items-start [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:translate-y-0.5 [&amp;&gt;svg]:text-current text-card-foreground my-4 border-cyan-500/50 bg-cyan-500/5"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-shield h-4 w-4 text-cyan-500" aria-hidden="true"><path d="M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z"></path></svg><div data-slot="alert-title" class="col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight text-cyan-500">Protocol Defenses</div><div data-slot="alert-description" class="col-start-2 grid justify-items-start gap-1 text-sm [&amp;_p]:leading-relaxed text-muted-foreground"><p class="text-muted-foreground leading-7 mb-4">Defense mechanisms in the protocol:</p><ul class="my-4 ml-6 list-disc space-y-2 text-muted-foreground">
<li class="leading-7"><strong class="font-semibold text-foreground">Device Binding</strong>: Keys tied to specific device certificates</li>
<li class="leading-7"><strong class="font-semibold text-foreground">Nonce Freshness</strong>: Random values prevent replay attacks</li>
<li class="leading-7"><strong class="font-semibold text-foreground">Timestamp Validation</strong>: Requests must be within acceptable time window</li>
<li class="leading-7"><strong class="font-semibold text-foreground">Certificate Chain Validation</strong>: Full PKI verification of device identity</li>
</ul></div></div>
<h2 id="fairplay-license-protocol-spcckc" class="scroll-mt-20 text-2xl font-semibold text-foreground mt-8 mb-3 border-b border-border pb-2">FairPlay License Protocol (SPC/CKC)</h2>
<h3 id="server-playback-context-spc" class="scroll-mt-20 text-xl font-semibold text-foreground mt-6 mb-2">Server Playback Context (SPC)</h3>
<p class="text-muted-foreground leading-7 mb-4">FairPlay uses a unique challenge-response mechanism:</p>
<code class="rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground">┌─────────────────────────────────────────────────────────────────────────────┐
│                      FairPlay SPC/CKC Flow                                   │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│   ┌─────────────┐                               ┌─────────────────┐         │
│   │   Client    │                               │  Key Server     │         │
│   │  (AVPlayer) │                               │  (Your Server)  │         │
│   └──────┬──────┘                               └────────┬────────┘         │
│          │                                               │                   │
│          │  1. Request Content Key Context               │                   │
│          │      (from playback URL)                      │                   │
│          │                                               │                   │
│          │  2. CDM creates SPC                           │                   │
│          │  ┌─────────────────────────────────┐          │                   │
│          │  │ SPC (Server Playback Context)   │          │                   │
│          │  │ ┌─────────────────────────────┐ │          │                   │
│          │  │ │ Version                     │ │          │                   │
│          │  │ │ Device Certificate          │ │          │                   │
│          │  │ │ Asset ID (Content ID)       │ │          │                   │
│          │  │ │ TLLV (encrypted payload)    │ │          │                   │
│          │  │ │   └── Session key           │ │          │                   │
│          │  │ │   └── Anti-replay data      │ │          │                   │
│          │  │ └─────────────────────────────┘ │          │                   │
│          │  └─────────────────────────────────┘          │                   │
│          │                                               │                   │
│          │  3. Forward SPC ──────────────────────────────►                   │
│          │                                               │                   │
│          │                                  4. Validate SPC                  │
│          │                                  5. Decrypt TLLV                  │
│          │                                  6. Create CKC                    │
│          │                                               │                   │
│          │  ┌─────────────────────────────────┐          │                   │
│          │  │ CKC (Content Key Context)       │          │                   │
│          │  │ ┌─────────────────────────────┐ │          │                   │
│          │  │ │ Content Key (encrypted)     │ │          │                   │
│          │  │ │ Key Duration (rental/buy)   │ │          │                   │
│          │  │ │ HDCP Requirements           │ │          │                   │
│          │  │ │ Persistence allowed?        │ │          │                   │
│          │  │ └─────────────────────────────┘ │◄─────────│                   │
│          │  └─────────────────────────────────┘          │                   │
│          │                                               │                   │
│          │  7. CDM processes CKC                         │                   │
│          │  8. Content key available                     │                   │
│          │                                               │                   │
│   └──────┴──────┘                               └────────┴────────┘         │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
</code>
<h3 id="fairplay-tllv-structure" class="scroll-mt-20 text-xl font-semibold text-foreground mt-6 mb-2">FairPlay TLLV Structure</h3>
<code class="rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground">TLLV = Tag-Length-Length-Value (Apple&#x27;s proprietary format)

┌────────────────────────────────────────────┐
│ TLLV Container                             │
├────────────────────────────────────────────┤
│ Tag (4 bytes)    │ Identifies data type    │
│ Total Length     │ Full TLLV size          │
│ Value Length     │ Payload size            │
│ Value (payload)  │ Actual data             │
└────────────────────────────────────────────┘

Common Tags:
- 0x47a6fc24: Content Key
- 0x6b68f542: Device Certificate
- 0x71b5595a: Session Key (encrypted)
- 0x89c90f5a: Anti-replay hash
</code>
<div data-slot="alert" role="alert" class="relative w-full rounded-lg border px-4 py-3 text-sm grid has-[&gt;svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[&gt;svg]:gap-x-3 gap-y-0.5 items-start [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:translate-y-0.5 [&amp;&gt;svg]:text-current text-card-foreground my-4 border-primary/50 bg-primary/5"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-info h-4 w-4 text-primary" aria-hidden="true"><circle cx="12" cy="12" r="10"></circle><path d="M12 16v-4"></path><path d="M12 8h.01"></path></svg><div data-slot="alert-title" class="col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight text-primary">Apple&#x27;s Unique Approach</div><div data-slot="alert-description" class="col-start-2 grid justify-items-start gap-1 text-sm [&amp;_p]:leading-relaxed text-muted-foreground"><p class="text-muted-foreground leading-7 mb-4">FairPlay is the only major DRM that requires a Key Security Module (KSM) to be deployed on your own infrastructure. Apple provides the KSM as a software package that you integrate into your key server.</p></div></div>
<h2 id="playready-license-protocol" class="scroll-mt-20 text-2xl font-semibold text-foreground mt-8 mb-3 border-b border-border pb-2">PlayReady License Protocol</h2>
<h3 id="soap-based-protocol-legacy" class="scroll-mt-20 text-xl font-semibold text-foreground mt-6 mb-2">SOAP-Based Protocol (Legacy)</h3>
<pre class="my-4 overflow-x-auto rounded-lg border border-border bg-zinc-950 p-4"><code class="text-sm text-zinc-100 language-xml">&lt;!-- PlayReady SOAP License Request --&gt;
&lt;soap:Envelope&gt;
  &lt;soap:Header&gt;
    &lt;PlayReadyHeader&gt;
      &lt;ClientVersion&gt;4.0.0.0&lt;/ClientVersion&gt;
      &lt;DeviceModel&gt;Edge Browser&lt;/DeviceModel&gt;
    &lt;/PlayReadyHeader&gt;
  &lt;/soap:Header&gt;
  &lt;soap:Body&gt;
    &lt;AcquireLicense&gt;
      &lt;challenge&gt;
        &lt;LA xmlns=&quot;http://schemas.microsoft.com/DRM/2007/03/protocols&quot;&gt;
          &lt;ContentHeader&gt;
            &lt;!-- WRMHEADER with KeyIDs --&gt;
          &lt;/ContentHeader&gt;
          &lt;ClientInfo&gt;
            &lt;ClientVersion&gt;4.0&lt;/ClientVersion&gt;
            &lt;SecurityLevel&gt;2000&lt;/SecurityLevel&gt;
          &lt;/ClientInfo&gt;
          &lt;LicenseNonce&gt;randombase64data==&lt;/LicenseNonce&gt;
        &lt;/LA&gt;
      &lt;/challenge&gt;
    &lt;/AcquireLicense&gt;
  &lt;/soap:Body&gt;
&lt;/soap:Envelope&gt;
</code></pre>
<h3 id="rest-based-protocol-modern" class="scroll-mt-20 text-xl font-semibold text-foreground mt-6 mb-2">REST-Based Protocol (Modern)</h3>
<code class="rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground">┌─────────────────────────────────────────────────────────────────────────────┐
│                    PlayReady REST License Protocol                           │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│   License Request (HTTP POST):                                               │
│   ┌────────────────────────────────────────────────────────────────────┐    │
│   │ Headers:                                                            │    │
│   │   Content-Type: application/octet-stream                           │    │
│   │   ms-playready-client-ver: 4.0                                     │    │
│   │                                                                     │    │
│   │ Body: Binary challenge blob                                        │    │
│   │ ┌────────────────────────────────────────────────────────────────┐ │    │
│   │ │ LA Record (License Acquisition)                                 │ │    │
│   │ │ ├── Record Type: 0x0001                                        │ │    │
│   │ │ ├── Record Length                                              │ │    │
│   │ │ ├── Client Certificate                                          │ │    │
│   │ │ ├── Content Header (KeyIDs)                                     │ │    │
│   │ │ └── Nonce (16 bytes)                                           │ │    │
│   │ └────────────────────────────────────────────────────────────────┘ │    │
│   └────────────────────────────────────────────────────────────────────┘    │
│                                                                              │
│   License Response:                                                          │
│   ┌────────────────────────────────────────────────────────────────────┐    │
│   │ XMR License (XML Rights Management)                                │    │
│   │ ├── License Version                                                │    │
│   │ ├── License ID (GUID)                                             │    │
│   │ ├── Rights:                                                        │    │
│   │ │     ├── Play (with output restrictions)                         │    │
│   │ │     ├── Copy (if allowed)                                       │    │
│   │ │     └── Transfer (domain transfers)                             │    │
│   │ ├── Keys:                                                          │    │
│   │ │     ├── Content Key (encrypted)                                 │    │
│   │ │     └── Key ID                                                  │    │
│   │ └── Restrictions:                                                  │    │
│   │       ├── Begin Date                                              │    │
│   │       ├── End Date                                                │    │
│   │       ├── Secure Stop required                                    │    │
│   │       └── Output Protection Level                                 │    │
│   └────────────────────────────────────────────────────────────────────┘    │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
</code>
<h2 id="protocol-security-mechanisms" class="scroll-mt-20 text-2xl font-semibold text-foreground mt-8 mb-3 border-b border-border pb-2">Protocol Security Mechanisms</h2>
<h3 id="anti-replay-protection" class="scroll-mt-20 text-xl font-semibold text-foreground mt-6 mb-2">Anti-Replay Protection</h3>
<code class="rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground">┌─────────────────────────────────────────────────────────────────────────────┐
│                    Anti-Replay Mechanisms                                    │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│   1. NONCE (Number Used Once)                                               │
│   ┌────────────────────────────────────────────────────────────────────┐    │
│   │ Request:  { nonce: &quot;abc123...&quot;, timestamp: 1703001234 }            │    │
│   │ Response: { nonce: &quot;abc123...&quot;, server_nonce: &quot;xyz789...&quot; }        │    │
│   │                                                                     │    │
│   │ Server stores used nonces for expiration window                    │    │
│   │ Reused nonce = Replay attack detected                              │    │
│   └────────────────────────────────────────────────────────────────────┘    │
│                                                                              │
│   2. Timestamp Binding                                                       │
│   ┌────────────────────────────────────────────────────────────────────┐    │
│   │ Request must be within ±5 minutes of server time                   │    │
│   │ Prevents storing requests for later use                            │    │
│   │                                                                     │    │
│   │ if abs(server_time - request_time) &gt; 300:                          │    │
│   │     reject(&quot;Request expired&quot;)                                      │    │
│   └────────────────────────────────────────────────────────────────────┘    │
│                                                                              │
│   3. Session Binding                                                         │
│   ┌────────────────────────────────────────────────────────────────────┐    │
│   │ Each playback session has unique session ID                        │    │
│   │ Response keys are encrypted to session-specific key                │    │
│   │ Response cannot be used in different session                       │    │
│   └────────────────────────────────────────────────────────────────────┘    │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
</code>
<h3 id="device-authentication" class="scroll-mt-20 text-xl font-semibold text-foreground mt-6 mb-2">Device Authentication</h3>
<code class="rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground">┌─────────────────────────────────────────────────────────────────────────────┐
│                    Device Authentication Flow                                │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│   Device Certificate Chain:                                                  │
│                                                                              │
│   ┌────────────────┐                                                        │
│   │   Root CA      │  ← Hardcoded in license server                        │
│   │  (DRM vendor)  │                                                        │
│   └───────┬────────┘                                                        │
│           │ Signs                                                            │
│   ┌───────▼────────┐                                                        │
│   │ Intermediate   │  ← Model-level (OEM/manufacturer)                      │
│   │ Certificate    │                                                        │
│   └───────┬────────┘                                                        │
│           │ Signs                                                            │
│   ┌───────▼────────┐                                                        │
│   │    Device      │  ← Unique per device/browser                           │
│   │  Certificate   │                                                        │
│   └────────────────┘                                                        │
│                                                                              │
│   Validation:                                                                │
│   1. Verify signature chain to trusted root                                 │
│   2. Check certificate not revoked (CRL/OCSP)                              │
│   3. Verify device hasn&#x27;t been blacklisted                                  │
│   4. Check security level meets content requirements                        │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
</code>
<div data-slot="alert" role="alert" class="relative w-full rounded-lg border px-4 py-3 text-sm grid has-[&gt;svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[&gt;svg]:gap-x-3 gap-y-0.5 items-start [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:translate-y-0.5 [&amp;&gt;svg]:text-current text-card-foreground my-4 border-yellow-500/50 bg-yellow-500/5"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-triangle-alert h-4 w-4 text-yellow-500" aria-hidden="true"><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3"></path><path d="M12 9v4"></path><path d="M12 17h.01"></path></svg><div data-slot="alert-title" class="col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight text-yellow-500">Revocation Lists</div><div data-slot="alert-description" class="col-start-2 grid justify-items-start gap-1 text-sm [&amp;_p]:leading-relaxed text-muted-foreground"><p class="text-muted-foreground leading-7 mb-4">DRM vendors maintain revocation lists (CRL) of compromised devices. When a CDM is cracked, all devices using that CDM version can be revoked, breaking playback until users update.</p></div></div>
<h2 id="license-policy-enforcement" class="scroll-mt-20 text-2xl font-semibold text-foreground mt-8 mb-3 border-b border-border pb-2">License Policy Enforcement</h2>
<h3 id="policy-attributes" class="scroll-mt-20 text-xl font-semibold text-foreground mt-6 mb-2">Policy Attributes</h3>
<div class="my-6 overflow-x-auto rounded-lg border border-border"><table class="w-full text-sm"><thead class="bg-muted/50"><tr class="border-b border-border last:border-0"><th class="px-4 py-3 text-left font-semibold text-foreground">Policy</th><th class="px-4 py-3 text-left font-semibold text-foreground">Widevine</th><th class="px-4 py-3 text-left font-semibold text-foreground">FairPlay</th><th class="px-4 py-3 text-left font-semibold text-foreground">PlayReady</th></tr></thead><tbody><tr class="border-b border-border last:border-0"><td class="px-4 py-3 text-muted-foreground">License Duration</td><td class="px-4 py-3 text-muted-foreground"><code class="rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground">license_duration_seconds</code></td><td class="px-4 py-3 text-muted-foreground"><code class="rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground">ckc-duration</code></td><td class="px-4 py-3 text-muted-foreground"><code class="rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground">BeginDate/EndDate</code></td></tr><tr class="border-b border-border last:border-0"><td class="px-4 py-3 text-muted-foreground">Playback Duration</td><td class="px-4 py-3 text-muted-foreground"><code class="rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground">playback_duration_seconds</code></td><td class="px-4 py-3 text-muted-foreground"><code class="rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground">ckc-playback-duration</code></td><td class="px-4 py-3 text-muted-foreground"><code class="rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground">PlayStart/PlayEnd</code></td></tr><tr class="border-b border-border last:border-0"><td class="px-4 py-3 text-muted-foreground">Offline Allowed</td><td class="px-4 py-3 text-muted-foreground"><code class="rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground">can_persist</code></td><td class="px-4 py-3 text-muted-foreground"><code class="rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground">persistence-allowed</code></td><td class="px-4 py-3 text-muted-foreground"><code class="rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground">License.Store</code></td></tr><tr class="border-b border-border last:border-0"><td class="px-4 py-3 text-muted-foreground">HDCP Required</td><td class="px-4 py-3 text-muted-foreground"><code class="rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground">hdcp_version</code></td><td class="px-4 py-3 text-muted-foreground"><code class="rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground">output-protection</code></td><td class="px-4 py-3 text-muted-foreground"><code class="rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground">MinimumCompressedDigitalVideoOPL</code></td></tr><tr class="border-b border-border last:border-0"><td class="px-4 py-3 text-muted-foreground">Max Resolution</td><td class="px-4 py-3 text-muted-foreground"><code class="rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground">resolution_constraints</code></td><td class="px-4 py-3 text-muted-foreground">N/A</td><td class="px-4 py-3 text-muted-foreground"><code class="rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground">MaxRes</code></td></tr><tr class="border-b border-border last:border-0"><td class="px-4 py-3 text-muted-foreground">Secure Stop</td><td class="px-4 py-3 text-muted-foreground">N/A</td><td class="px-4 py-3 text-muted-foreground">N/A</td><td class="px-4 py-3 text-muted-foreground"><code class="rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground">SecureStop</code></td></tr></tbody></table></div>
<h3 id="output-protection-levels" class="scroll-mt-20 text-xl font-semibold text-foreground mt-6 mb-2">Output Protection Levels</h3>
<code class="rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground">┌─────────────────────────────────────────────────────────────────────────────┐
│                    Output Protection Requirements                            │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│   Resolution        HDCP Requirement        Typical Policy                   │
│   ──────────────────────────────────────────────────────────────────────    │
│   SD (480p)         None                    Basic protection                 │
│   HD (720p)         HDCP 1.4               Moderate protection              │
│   Full HD (1080p)   HDCP 2.0               Standard protection              │
│   4K UHD            HDCP 2.2               High protection                  │
│   4K HDR            HDCP 2.2 + HW TEE      Maximum protection               │
│                                                                              │
│   If output protection check fails:                                          │
│   - Downgrade resolution to allowed level                                   │
│   - Block playback entirely                                                 │
│   - Disable specific outputs (e.g., HDMI)                                   │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
</code>
<div data-slot="alert" role="alert" class="relative w-full rounded-lg border px-4 py-3 text-sm grid has-[&gt;svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[&gt;svg]:gap-x-3 gap-y-0.5 items-start [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:translate-y-0.5 [&amp;&gt;svg]:text-current text-card-foreground my-4 border-red-500/50 bg-red-500/5"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-sword h-4 w-4 text-red-500" aria-hidden="true"><path d="m11 19-6-6"></path><path d="m5 21-2-2"></path><path d="m8 16-4 4"></path><path d="M9.5 17.5 21 6V3h-3L6.5 14.5"></path></svg><div data-slot="alert-title" class="col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight text-red-500">Policy Bypass Techniques</div><div data-slot="alert-description" class="col-start-2 grid justify-items-start gap-1 text-sm [&amp;_p]:leading-relaxed text-muted-foreground"><p class="text-muted-foreground leading-7 mb-4">Attackers target policy enforcement:</p><ul class="my-4 ml-6 list-disc space-y-2 text-muted-foreground">
<li class="leading-7"><strong class="font-semibold text-foreground">Modified CDMs</strong>: Patched to ignore output restrictions</li>
<li class="leading-7"><strong class="font-semibold text-foreground">Virtual HDCP</strong>: Fake HDCP handshakes to satisfy checks</li>
<li class="leading-7"><strong class="font-semibold text-foreground">Resolution spoofing</strong>: Report lower resolution to get easier policy</li>
<li class="leading-7"><strong class="font-semibold text-foreground">Clock manipulation</strong>: Change system time for expired licenses</li>
</ul></div></div>
<div data-slot="alert" role="alert" class="relative w-full rounded-lg border px-4 py-3 text-sm grid has-[&gt;svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[&gt;svg]:gap-x-3 gap-y-0.5 items-start [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:translate-y-0.5 [&amp;&gt;svg]:text-current text-card-foreground my-4 border-cyan-500/50 bg-cyan-500/5"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-shield h-4 w-4 text-cyan-500" aria-hidden="true"><path d="M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z"></path></svg><div data-slot="alert-title" class="col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight text-cyan-500">Secure Policy Enforcement</div><div data-slot="alert-description" class="col-start-2 grid justify-items-start gap-1 text-sm [&amp;_p]:leading-relaxed text-muted-foreground"><p class="text-muted-foreground leading-7 mb-4">Robust policy enforcement requires:</p><ul class="my-4 ml-6 list-disc space-y-2 text-muted-foreground">
<li class="leading-7"><strong class="font-semibold text-foreground">Hardware TEE</strong>: Policy checks inside secure enclave</li>
<li class="leading-7"><strong class="font-semibold text-foreground">Attestation</strong>: Verify device hasn&#x27;t been tampered with</li>
<li class="leading-7"><strong class="font-semibold text-foreground">Secure time</strong>: Use secure clock for expiration checks</li>
<li class="leading-7"><strong class="font-semibold text-foreground">Regular updates</strong>: Push CDM updates to close bypasses</li>
</ul></div></div>
<h2 id="multi-key-and-key-rotation" class="scroll-mt-20 text-2xl font-semibold text-foreground mt-8 mb-3 border-b border-border pb-2">Multi-Key and Key Rotation</h2>
<h3 id="multi-key-content" class="scroll-mt-20 text-xl font-semibold text-foreground mt-6 mb-2">Multi-Key Content</h3>
<code class="rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground">┌─────────────────────────────────────────────────────────────────────────────┐
│                    Multi-Key Encryption                                      │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│   Content with multiple quality levels:                                      │
│                                                                              │
│   ┌─────────────────────────────────────────────────────────────────────┐   │
│   │ Video Stream                                                         │   │
│   ├─────────────────────────────────────────────────────────────────────┤   │
│   │ 4K HDR  │ Key ID: abc-001 │ Policy: L1 only, HDCP 2.2              │   │
│   │ 1080p   │ Key ID: abc-002 │ Policy: L1/L2, HDCP 2.0                │   │
│   │ 720p    │ Key ID: abc-003 │ Policy: L1/L2/L3, HDCP 1.4             │   │
│   │ 480p    │ Key ID: abc-004 │ Policy: Any level, no HDCP             │   │
│   └─────────────────────────────────────────────────────────────────────┘   │
│                                                                              │
│   License server provides keys based on device security level               │
│   L3 device only gets key abc-004                                           │
│   L1 device gets all keys                                                   │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
</code>
<h3 id="key-rotation" class="scroll-mt-20 text-xl font-semibold text-foreground mt-6 mb-2">Key Rotation</h3>
<code class="rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground">Time-Based Key Rotation:

Segment 1-100:    Key A (KID: key-001)
Segment 101-200:  Key B (KID: key-002)
Segment 201-300:  Key C (KID: key-003)
...

┌──────────────────────────────────────────────────────────────────────┐
│ Benefits:                                                             │
│ - Limits damage if key is extracted (only that segment range)        │
│ - Enables mid-stream policy changes                                  │
│ - Supports ad insertion with different key policies                  │
│                                                                       │
│ Challenges:                                                           │
│ - More license requests needed                                       │
│ - Client must handle seamless key transitions                        │
│ - Increased server load                                              │
└──────────────────────────────────────────────────────────────────────┘
</code>
<h2 id="protocol-vulnerabilities-and-defenses" class="scroll-mt-20 text-2xl font-semibold text-foreground mt-8 mb-3 border-b border-border pb-2">Protocol Vulnerabilities and Defenses</h2>
<h3 id="common-attack-patterns" class="scroll-mt-20 text-xl font-semibold text-foreground mt-6 mb-2">Common Attack Patterns</h3>
<div class="my-6 overflow-x-auto rounded-lg border border-border"><table class="w-full text-sm"><thead class="bg-muted/50"><tr class="border-b border-border last:border-0"><th class="px-4 py-3 text-left font-semibold text-foreground">Attack</th><th class="px-4 py-3 text-left font-semibold text-foreground">Target</th><th class="px-4 py-3 text-left font-semibold text-foreground">Mitigation</th></tr></thead><tbody><tr class="border-b border-border last:border-0"><td class="px-4 py-3 text-muted-foreground">Request Tampering</td><td class="px-4 py-3 text-muted-foreground">License challenge</td><td class="px-4 py-3 text-muted-foreground">Signature verification</td></tr><tr class="border-b border-border last:border-0"><td class="px-4 py-3 text-muted-foreground">Response Replay</td><td class="px-4 py-3 text-muted-foreground">License response</td><td class="px-4 py-3 text-muted-foreground">Nonce binding, timestamps</td></tr><tr class="border-b border-border last:border-0"><td class="px-4 py-3 text-muted-foreground">Man-in-the-Middle</td><td class="px-4 py-3 text-muted-foreground">Network layer</td><td class="px-4 py-3 text-muted-foreground">TLS pinning, certificate validation</td></tr><tr class="border-b border-border last:border-0"><td class="px-4 py-3 text-muted-foreground">Downgrade Attack</td><td class="px-4 py-3 text-muted-foreground">Protocol version</td><td class="px-4 py-3 text-muted-foreground">Minimum version requirements</td></tr><tr class="border-b border-border last:border-0"><td class="px-4 py-3 text-muted-foreground">Token Theft</td><td class="px-4 py-3 text-muted-foreground">Auth tokens</td><td class="px-4 py-3 text-muted-foreground">Short TTL, IP binding</td></tr></tbody></table></div>
<h3 id="defense-in-depth" class="scroll-mt-20 text-xl font-semibold text-foreground mt-6 mb-2">Defense in Depth</h3>
<code class="rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground">┌─────────────────────────────────────────────────────────────────────────────┐
│                    Multi-Layer Protocol Security                             │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│   Layer 1: Transport Security                                                │
│   ├── TLS 1.3 required                                                      │
│   ├── Certificate pinning                                                   │
│   └── Perfect forward secrecy                                               │
│                                                                              │
│   Layer 2: Application Security                                              │
│   ├── Request signing (RSA/ECDSA)                                          │
│   ├── Response encryption                                                   │
│   └── Integrity verification                                                │
│                                                                              │
│   Layer 3: Business Logic                                                    │
│   ├── Entitlement verification                                              │
│   ├── Rate limiting                                                         │
│   └── Anomaly detection                                                     │
│                                                                              │
│   Layer 4: Device Trust                                                      │
│   ├── Device attestation                                                    │
│   ├── Certificate validation                                                │
│   └── Revocation checking                                                   │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
</code>
<h2 id="summary" class="scroll-mt-20 text-2xl font-semibold text-foreground mt-8 mb-3 border-b border-border pb-2">Summary</h2>
<div class="my-6 overflow-x-auto rounded-lg border border-border"><table class="w-full text-sm"><thead class="bg-muted/50"><tr class="border-b border-border last:border-0"><th class="px-4 py-3 text-left font-semibold text-foreground">Aspect</th><th class="px-4 py-3 text-left font-semibold text-foreground">Widevine</th><th class="px-4 py-3 text-left font-semibold text-foreground">FairPlay</th><th class="px-4 py-3 text-left font-semibold text-foreground">PlayReady</th></tr></thead><tbody><tr class="border-b border-border last:border-0"><td class="px-4 py-3 text-muted-foreground">Protocol Format</td><td class="px-4 py-3 text-muted-foreground">Protobuf (binary)</td><td class="px-4 py-3 text-muted-foreground">TLLV (binary)</td><td class="px-4 py-3 text-muted-foreground">SOAP/REST</td></tr><tr class="border-b border-border last:border-0"><td class="px-4 py-3 text-muted-foreground">Challenge Type</td><td class="px-4 py-3 text-muted-foreground">SignedMessage</td><td class="px-4 py-3 text-muted-foreground">SPC</td><td class="px-4 py-3 text-muted-foreground">LA Record</td></tr><tr class="border-b border-border last:border-0"><td class="px-4 py-3 text-muted-foreground">Response Type</td><td class="px-4 py-3 text-muted-foreground">License</td><td class="px-4 py-3 text-muted-foreground">CKC</td><td class="px-4 py-3 text-muted-foreground">XMR License</td></tr><tr class="border-b border-border last:border-0"><td class="px-4 py-3 text-muted-foreground">Auth Method</td><td class="px-4 py-3 text-muted-foreground">Device certificate</td><td class="px-4 py-3 text-muted-foreground">Device certificate</td><td class="px-4 py-3 text-muted-foreground">Device certificate</td></tr><tr class="border-b border-border last:border-0"><td class="px-4 py-3 text-muted-foreground">Key Encryption</td><td class="px-4 py-3 text-muted-foreground">RSA-OAEP</td><td class="px-4 py-3 text-muted-foreground">AES-CBC</td><td class="px-4 py-3 text-muted-foreground">ECC/AES</td></tr></tbody></table></div>
<h2 id="next-steps" class="scroll-mt-20 text-2xl font-semibold text-foreground mt-8 mb-3 border-b border-border pb-2">Next Steps</h2>
<ul class="my-4 ml-6 list-disc space-y-2 text-muted-foreground">
<li class="leading-7"><strong class="font-semibold text-foreground"><a href="/knowledge-base/widevine" class="text-primary underline underline-offset-4 hover:text-primary/80 transition-colors">Widevine Deep Dive</a></strong> - Protocol specifics for Widevine</li>
<li class="leading-7"><strong class="font-semibold text-foreground"><a href="/knowledge-base/fairplay" class="text-primary underline underline-offset-4 hover:text-primary/80 transition-colors">FairPlay Deep Dive</a></strong> - SPC/CKC protocol details</li>
<li class="leading-7"><strong class="font-semibold text-foreground"><a href="/labs/protocol-analysis" class="text-primary underline underline-offset-4 hover:text-primary/80 transition-colors">Protocol Lab</a></strong> - Hands-on protocol analysis</li>
<li class="leading-7"><strong class="font-semibold text-foreground"><a href="/labs/attacks" class="text-primary underline underline-offset-4 hover:text-primary/80 transition-colors">Attack Scenarios</a></strong> - Common protocol attacks</li>
</ul></article><div data-orientation="horizontal" role="none" data-slot="separator" class="bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px my-8"></div><nav class="grid gap-4 sm:grid-cols-2"><a href="/knowledge-base/encryption"><div data-slot="card" class="bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm h-full transition-all hover:border-primary/50"><div data-slot="card-content" class="flex items-center gap-3 p-4"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-left h-5 w-5 text-muted-foreground" aria-hidden="true"><path d="m15 18-6-6 6-6"></path></svg><div><div class="text-xs text-muted-foreground">Previous</div><div class="font-medium text-foreground">Encryption Basics</div></div></div></div></a></nav><section class="mt-12"><h2 class="text-xl font-semibold text-foreground mb-4">Related Articles</h2><div class="grid gap-4 sm:grid-cols-3"><a href="/knowledge-base/widevine"><div data-slot="card" class="bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm h-full transition-all hover:border-primary/50"><div data-slot="card-header" class="@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6 pb-2"><span data-slot="badge" class="inline-flex items-center justify-center rounded-full border px-2 py-0.5 font-medium whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden text-foreground [a&amp;]:hover:bg-accent [a&amp;]:hover:text-accent-foreground w-fit text-xs">DRM Systems</span><div data-slot="card-title" class="font-semibold text-base mt-2">Widevine DRM</div></div><div data-slot="card-content" class="px-6 text-sm text-muted-foreground">Deep dive into Google&#x27;s Widevine DRM system - architecture, security levels, and how it protects str<!-- -->...</div></div></a><a href="/knowledge-base/fairplay"><div data-slot="card" class="bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm h-full transition-all hover:border-primary/50"><div data-slot="card-header" class="@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6 pb-2"><span data-slot="badge" class="inline-flex items-center justify-center rounded-full border px-2 py-0.5 font-medium whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden text-foreground [a&amp;]:hover:bg-accent [a&amp;]:hover:text-accent-foreground w-fit text-xs">DRM Systems</span><div data-slot="card-title" class="font-semibold text-base mt-2">FairPlay Streaming</div></div><div data-slot="card-content" class="px-6 text-sm text-muted-foreground">Apple&#x27;s proprietary DRM system for iOS, macOS, and Safari - architecture, HLS integration, and secur<!-- -->...</div></div></a><a href="/knowledge-base/playready"><div data-slot="card" class="bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm h-full transition-all hover:border-primary/50"><div data-slot="card-header" class="@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6 pb-2"><span data-slot="badge" class="inline-flex items-center justify-center rounded-full border px-2 py-0.5 font-medium whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden text-foreground [a&amp;]:hover:bg-accent [a&amp;]:hover:text-accent-foreground w-fit text-xs">DRM Systems</span><div data-slot="card-title" class="font-semibold text-base mt-2">PlayReady DRM</div></div><div data-slot="card-content" class="px-6 text-sm text-muted-foreground">Microsoft&#x27;s enterprise DRM solution for Windows, Xbox, and smart devices - architecture, licensing, <!-- -->...</div></div></a></div></section></div></main></div><footer class="border-t border-border bg-background"><div class="mx-auto max-w-7xl px-4 py-8 sm:px-6 lg:px-8"><div class="grid gap-8 md:grid-cols-3"><div><div class="flex items-center gap-2"><div class="flex h-8 w-8 items-center justify-center rounded-lg bg-primary/10"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-shield h-5 w-5 text-primary" aria-hidden="true"><path d="M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z"></path></svg></div><span class="font-bold text-foreground">DRM Security Lab</span></div><p class="mt-3 text-sm text-muted-foreground">An educational platform for understanding Digital Rights Management security concepts, attack vectors, and defense mechanisms.</p></div><div><h3 class="font-semibold text-foreground">Quick Links</h3><ul class="mt-3 space-y-2 text-sm"><li><a class="text-muted-foreground hover:text-foreground transition-colors" href="/knowledge-base">Knowledge Base</a></li><li><a class="text-muted-foreground hover:text-foreground transition-colors" href="/labs">Interactive Labs</a></li><li><a class="text-muted-foreground hover:text-foreground transition-colors" href="/challenges">CTF Challenges</a></li><li><a class="text-muted-foreground hover:text-foreground transition-colors" href="/knowledge-base/overview">Getting Started</a></li></ul></div><div><h3 class="font-semibold text-foreground">Legal &amp; Ethics</h3><ul class="mt-3 space-y-2 text-sm"><li class="flex items-center gap-2 text-muted-foreground"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-scale h-4 w-4" aria-hidden="true"><path d="M12 3v18"></path><path d="m19 8 3 8a5 5 0 0 1-6 0zV7"></path><path d="M3 7h1a17 17 0 0 0 8-2 17 17 0 0 0 8 2h1"></path><path d="m5 8 3 8a5 5 0 0 1-6 0zV7"></path><path d="M7 21h10"></path></svg><span>Educational use only</span></li><li class="flex items-center gap-2 text-muted-foreground"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-book-open h-4 w-4" aria-hidden="true"><path d="M12 7v14"></path><path d="M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z"></path></svg><span>Not for circumvention</span></li></ul><p class="mt-4 text-xs text-muted-foreground">This platform does not provide tools or instructions for circumventing actual DRM systems. All demonstrations use mock systems created for educational purposes.</p></div></div><div class="mt-8 flex flex-col items-center justify-between gap-4 border-t border-border pt-8 sm:flex-row"><p class="text-xs text-muted-foreground">© <!-- -->2025<!-- --> DRM Security Lab. For educational purposes only.</p><div class="flex items-center gap-4"><a target="_blank" rel="noopener noreferrer" class="text-muted-foreground hover:text-foreground transition-colors" href="https://github.com"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-github h-5 w-5" aria-hidden="true"><path d="M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4"></path><path d="M9 18c-4.51 2-5-2-7-2"></path></svg><span class="sr-only">GitHub</span></a></div></div></div></footer></div><!--$--><!--/$--></div><script src="/_next/static/chunks/2f10d432553c949f.js" id="_R_" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[80042,[\"/_next/static/chunks/2c7837371b5f0801.js\"],\"PerspectiveProvider\"]\n3:I[87257,[\"/_next/static/chunks/6dacee62af9f78ce.js\",\"/_next/static/chunks/ba330557940bdbd1.js\"],\"default\"]\n4:I[86547,[\"/_next/static/chunks/6dacee62af9f78ce.js\",\"/_next/static/chunks/ba330557940bdbd1.js\"],\"default\"]\n6:I[9768,[\"/_next/static/chunks/6dacee62af9f78ce.js\",\"/_next/static/chunks/ba330557940bdbd1.js\"],\"OutletBoundary\"]\n7:\"$Sreact.suspense\"\n9:I[9768,[\"/_next/static/chunks/6dacee62af9f78ce.js\",\"/_next/static/chunks/ba330557940bdbd1.js\"],\"ViewportBoundary\"]\nb:I[9768,[\"/_next/static/chunks/6dacee62af9f78ce.js\",\"/_next/static/chunks/ba330557940bdbd1.js\"],\"MetadataBoundary\"]\nd:I[56080,[],\"default\"]\n:HL[\"/_next/static/chunks/3f4018f1fd8aa9eb.css\",\"style\"]\n:HL[\"/_next/static/media/797e433ab948586e-s.p.dbea232f.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/media/caa3a2e1cccd8315-s.p.853070df.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"il8YMQTdw3gKb2FCiC7cm\",\"c\":[\"\",\"knowledge-base\",\"protocols\"],\"q\":\"\",\"i\":false,\"f\":[[[\"\",{\"children\":[\"knowledge-base\",{\"children\":[[\"slug\",\"protocols\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/chunks/3f4018f1fd8aa9eb.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"script\",\"script-0\",{\"src\":\"/_next/static/chunks/2c7837371b5f0801.js\",\"async\":true,\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"className\":\"dark\",\"children\":[\"$\",\"body\",null,{\"className\":\"geist_a71539c9-module__T19VSG__variable geist_mono_8d43a2aa-module__8Li5zG__variable min-h-screen bg-background font-sans antialiased scrollbar-dark\",\"children\":[\"$\",\"$L2\",null,{\"children\":[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]}]}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[\"$L5\",[[\"$\",\"script\",\"script-0\",{\"src\":\"/_next/static/chunks/6dacee62af9f78ce.js\",\"async\":true,\"nonce\":\"$undefined\"}],[\"$\",\"script\",\"script-1\",{\"src\":\"/_next/static/chunks/b0b0e24ff49b787a.js\",\"async\":true,\"nonce\":\"$undefined\"}],[\"$\",\"script\",\"script-2\",{\"src\":\"/_next/static/chunks/e87ae7e30c40f8b9.js\",\"async\":true,\"nonce\":\"$undefined\"}]],[\"$\",\"$L6\",null,{\"children\":[\"$\",\"$7\",null,{\"name\":\"Next.MetadataOutlet\",\"children\":\"$@8\"}]}]]}],{},null,false,false]},null,false,false]},null,false,false]},null,false,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$L9\",null,{\"children\":\"$La\"}],[\"$\",\"div\",null,{\"hidden\":true,\"children\":[\"$\",\"$Lb\",null,{\"children\":[\"$\",\"$7\",null,{\"name\":\"Next.Metadata\",\"children\":\"$Lc\"}]}]}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]]}],false]],\"m\":\"$undefined\",\"G\":[\"$d\",[]],\"S\":true}\n"])</script><script>self.__next_f.push([1,"e:I[2353,[\"/_next/static/chunks/2c7837371b5f0801.js\",\"/_next/static/chunks/6dacee62af9f78ce.js\",\"/_next/static/chunks/b0b0e24ff49b787a.js\",\"/_next/static/chunks/e87ae7e30c40f8b9.js\"],\"Header\"]\nf:I[55920,[\"/_next/static/chunks/2c7837371b5f0801.js\",\"/_next/static/chunks/6dacee62af9f78ce.js\",\"/_next/static/chunks/b0b0e24ff49b787a.js\",\"/_next/static/chunks/e87ae7e30c40f8b9.js\"],\"Sidebar\"]\n10:I[21591,[\"/_next/static/chunks/2c7837371b5f0801.js\",\"/_next/static/chunks/6dacee62af9f78ce.js\",\"/_next/static/chunks/b0b0e24ff49b787a.js\",\"/_next/static/chunks/e87ae7e30c40f8b9.js\"],\"\"]\n"])</script><script>self.__next_f.push([1,"5:[\"$\",\"div\",null,{\"className\":\"min-h-screen bg-background\",\"children\":[[\"$\",\"$Le\",null,{}],[\"$\",\"div\",null,{\"className\":\"flex\",\"children\":[[\"$\",\"$Lf\",null,{\"className\":\"hidden lg:flex\"}],[\"$\",\"main\",null,{\"className\":\"flex-1 p-6 lg:p-8\",\"children\":[\"$\",\"div\",null,{\"className\":\"mx-auto max-w-4xl\",\"children\":[[\"$\",\"$L10\",null,{\"href\":\"/knowledge-base\",\"className\":\"mb-6 inline-flex items-center gap-1 text-sm text-muted-foreground hover:text-foreground transition-colors\",\"children\":[[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide lucide-arrow-left h-4 w-4\",\"aria-hidden\":\"true\",\"children\":[[\"$\",\"path\",\"1l729n\",{\"d\":\"m12 19-7-7 7-7\"}],[\"$\",\"path\",\"x3x0zl\",{\"d\":\"M19 12H5\"}],\"$undefined\"]}],\"Back to Knowledge Base\"]}],[\"$\",\"header\",null,{\"className\":\"mb-8\",\"children\":[[\"$\",\"div\",null,{\"className\":\"flex flex-wrap items-center gap-2 mb-4\",\"children\":[[\"$\",\"span\",null,{\"data-slot\":\"badge\",\"className\":\"inline-flex items-center justify-center rounded-full border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [\u0026\u003esvg]:size-3 gap-1 [\u0026\u003esvg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden text-foreground [a\u0026]:hover:bg-accent [a\u0026]:hover:text-accent-foreground\",\"children\":\"Protocols\"}],[\"$\",\"span\",null,{\"data-slot\":\"badge\",\"className\":\"inline-flex items-center justify-center rounded-full border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [\u0026\u003esvg]:size-3 gap-1 [\u0026\u003esvg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden [a\u0026]:hover:bg-accent [a\u0026]:hover:text-accent-foreground bg-orange-500/10 text-orange-500 border-orange-500/30\",\"children\":\"advanced\"}],[\"$\",\"div\",null,{\"className\":\"flex items-center gap-1 text-sm text-muted-foreground\",\"children\":[[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide lucide-clock h-4 w-4\",\"aria-hidden\":\"true\",\"children\":[[\"$\",\"path\",\"mmk7yg\",{\"d\":\"M12 6v6l4 2\"}],[\"$\",\"circle\",\"1mglay\",{\"cx\":\"12\",\"cy\":\"12\",\"r\":\"10\"}],\"$undefined\"]}],35,\" min read\"]}]]}],[\"$\",\"h1\",null,{\"className\":\"text-4xl font-bold tracking-tight text-foreground mb-4\",\"children\":\"License Protocols\"}],[\"$\",\"p\",null,{\"className\":\"text-lg text-muted-foreground\",\"children\":\"Deep dive into DRM license acquisition protocols - how keys are securely requested, delivered, and validated.\"}],[\"$\",\"div\",null,{\"className\":\"mt-4 p-4 rounded-lg border border-border bg-card\",\"children\":[[\"$\",\"div\",null,{\"className\":\"flex items-center gap-2 text-sm font-medium text-foreground mb-2\",\"children\":[[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide lucide-book-open h-4 w-4\",\"aria-hidden\":\"true\",\"children\":[[\"$\",\"path\",\"1akyts\",{\"d\":\"M12 7v14\"}],[\"$\",\"path\",\"ruj8y\",{\"d\":\"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z\"}],\"$undefined\"]}],\"Prerequisites\"]}],[\"$\",\"div\",null,{\"className\":\"flex flex-wrap gap-2\",\"children\":[[\"$\",\"$L10\",\"encryption\",{\"href\":\"/knowledge-base/encryption\",\"children\":[\"$\",\"span\",null,{\"data-slot\":\"badge\",\"className\":\"inline-flex items-center justify-center rounded-full border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [\u0026\u003esvg]:size-3 gap-1 [\u0026\u003esvg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary text-secondary-foreground [a\u0026]:hover:bg-secondary/90 cursor-pointer hover:bg-secondary/80\",\"children\":\"encryption\"}]}],\"$L11\"]}]]}]]}],\"$L12\",\"$L13\",\"$L14\",\"$L15\",\"$L16\"]}]}]]}],\"$L17\"]}]\n"])</script><script>self.__next_f.push([1,"18:I[50985,[\"/_next/static/chunks/2c7837371b5f0801.js\",\"/_next/static/chunks/6dacee62af9f78ce.js\",\"/_next/static/chunks/b0b0e24ff49b787a.js\",\"/_next/static/chunks/e87ae7e30c40f8b9.js\"],\"Separator\"]\n1c:I[92191,[\"/_next/static/chunks/2c7837371b5f0801.js\",\"/_next/static/chunks/6dacee62af9f78ce.js\",\"/_next/static/chunks/b0b0e24ff49b787a.js\",\"/_next/static/chunks/e87ae7e30c40f8b9.js\"],\"Footer\"]\n11:[\"$\",\"$L10\",\"overview\",{\"href\":\"/knowledge-base/overview\",\"children\":[\"$\",\"span\",null,{\"data-slot\":\"badge\",\"className\":\"inline-flex items-center justify-center rounded-full border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [\u0026\u003esvg]:size-3 gap-1 [\u0026\u003esvg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary text-secondary-foreground [a\u0026]:hover:bg-secondary/90 cursor-pointer hover:bg-secondary/80\",\"children\":\"overview\"}]}]\n12:[\"$\",\"$L18\",null,{\"className\":\"mb-8\"}]\n13:[\"$\",\"article\",null,{\"className\":\"prose prose-invert max-w-none\",\"children\":\"$L19\"}]\n14:[\"$\",\"$L18\",null,{\"className\":\"my-8\"}]\n15:[\"$\",\"nav\",null,{\"className\":\"grid gap-4 sm:grid-cols-2\",\"children\":[[\"$\",\"$L10\",null,{\"href\":\"/knowledge-base/encryption\",\"children\":[\"$\",\"div\",null,{\"data-slot\":\"card\",\"className\":\"bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm h-full transition-all hover:border-primary/50\",\"children\":[\"$\",\"div\",null,{\"data-slot\":\"card-content\",\"className\":\"flex items-center gap-3 p-4\",\"children\":[[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide lucide-chevron-left h-5 w-5 text-muted-foreground\",\"aria-hidden\":\"true\",\"children\":[[\"$\",\"path\",\"1wnfg3\",{\"d\":\"m15 18-6-6 6-6\"}],\"$undefined\"]}],[\"$\",\"div\",null,{\"children\":[[\"$\",\"div\",null,{\"className\":\"text-xs text-muted-foreground\",\"children\":\"Previous\"}],[\"$\",\"div\",null,{\"className\":\"font-medium text-foreground\",\"children\":\"Encryption Basics\"}]]}]]}]}]}],null]}]\n"])</script><script>self.__next_f.push([1,"16:[\"$\",\"section\",null,{\"className\":\"mt-12\",\"children\":[[\"$\",\"h2\",null,{\"className\":\"text-xl font-semibold text-foreground mb-4\",\"children\":\"Related Articles\"}],[\"$\",\"div\",null,{\"className\":\"grid gap-4 sm:grid-cols-3\",\"children\":[[\"$\",\"$L10\",\"widevine\",{\"href\":\"/knowledge-base/widevine\",\"children\":[\"$\",\"div\",null,{\"data-slot\":\"card\",\"className\":\"bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm h-full transition-all hover:border-primary/50\",\"children\":[[\"$\",\"div\",null,{\"data-slot\":\"card-header\",\"className\":\"@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6 pb-2\",\"children\":[[\"$\",\"span\",null,{\"data-slot\":\"badge\",\"className\":\"inline-flex items-center justify-center rounded-full border px-2 py-0.5 font-medium whitespace-nowrap shrink-0 [\u0026\u003esvg]:size-3 gap-1 [\u0026\u003esvg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden text-foreground [a\u0026]:hover:bg-accent [a\u0026]:hover:text-accent-foreground w-fit text-xs\",\"children\":\"DRM Systems\"}],[\"$\",\"div\",null,{\"data-slot\":\"card-title\",\"className\":\"font-semibold text-base mt-2\",\"children\":\"Widevine DRM\"}]]}],[\"$\",\"div\",null,{\"data-slot\":\"card-content\",\"className\":\"px-6 text-sm text-muted-foreground\",\"children\":[\"Deep dive into Google's Widevine DRM system - architecture, security levels, and how it protects str\",\"...\"]}]]}]}],[\"$\",\"$L10\",\"fairplay\",{\"href\":\"/knowledge-base/fairplay\",\"children\":[\"$\",\"div\",null,{\"data-slot\":\"card\",\"className\":\"bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm h-full transition-all hover:border-primary/50\",\"children\":[[\"$\",\"div\",null,{\"data-slot\":\"card-header\",\"className\":\"@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6 pb-2\",\"children\":[[\"$\",\"span\",null,{\"data-slot\":\"badge\",\"className\":\"inline-flex items-center justify-center rounded-full border px-2 py-0.5 font-medium whitespace-nowrap shrink-0 [\u0026\u003esvg]:size-3 gap-1 [\u0026\u003esvg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden text-foreground [a\u0026]:hover:bg-accent [a\u0026]:hover:text-accent-foreground w-fit text-xs\",\"children\":\"DRM Systems\"}],[\"$\",\"div\",null,{\"data-slot\":\"card-title\",\"className\":\"font-semibold text-base mt-2\",\"children\":\"FairPlay Streaming\"}]]}],[\"$\",\"div\",null,{\"data-slot\":\"card-content\",\"className\":\"px-6 text-sm text-muted-foreground\",\"children\":[\"Apple's proprietary DRM system for iOS, macOS, and Safari - architecture, HLS integration, and secur\",\"...\"]}]]}]}],[\"$\",\"$L10\",\"playready\",{\"href\":\"/knowledge-base/playready\",\"children\":[\"$\",\"div\",null,{\"data-slot\":\"card\",\"className\":\"bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm h-full transition-all hover:border-primary/50\",\"children\":[[\"$\",\"div\",null,{\"data-slot\":\"card-header\",\"className\":\"@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6 pb-2\",\"children\":[[\"$\",\"span\",null,{\"data-slot\":\"badge\",\"className\":\"inline-flex items-center justify-center rounded-full border px-2 py-0.5 font-medium whitespace-nowrap shrink-0 [\u0026\u003esvg]:size-3 gap-1 [\u0026\u003esvg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden text-foreground [a\u0026]:hover:bg-accent [a\u0026]:hover:text-accent-foreground w-fit text-xs\",\"children\":\"DRM Systems\"}],\"$L1a\"]}],\"$L1b\"]}]}]]}]]}]\n"])</script><script>self.__next_f.push([1,"17:[\"$\",\"$L1c\",null,{}]\n"])</script><script>self.__next_f.push([1,"1a:[\"$\",\"div\",null,{\"data-slot\":\"card-title\",\"className\":\"font-semibold text-base mt-2\",\"children\":\"PlayReady DRM\"}]\n1b:[\"$\",\"div\",null,{\"data-slot\":\"card-content\",\"className\":\"px-6 text-sm text-muted-foreground\",\"children\":[\"Microsoft's enterprise DRM solution for Windows, Xbox, and smart devices - architecture, licensing, \",\"...\"]}]\n"])</script><script>self.__next_f.push([1,"1d:T104a,"])</script><script>self.__next_f.push([1,"┌─────────────────────────────────────────────────────────────────────────────┐\n│                    Generic License Acquisition Flow                          │\n├─────────────────────────────────────────────────────────────────────────────┤\n│                                                                              │\n│   ┌──────────┐         ┌──────────┐         ┌──────────────┐                │\n│   │  Client  │         │  Proxy   │         │   License    │                │\n│   │  (CDM)   │         │  Server  │         │    Server    │                │\n│   └────┬─────┘         └────┬─────┘         └──────┬───────┘                │\n│        │                    │                      │                         │\n│        │  1. Parse PSSH     │                      │                         │\n│        │  (get key IDs)     │                      │                         │\n│        │                    │                      │                         │\n│        │  2. Generate       │                      │                         │\n│        │  License Request   │                      │                         │\n│        │                    │                      │                         │\n│        │─────────────────────────────────────────────────────────────────►  │\n│        │  3. License Request (encrypted challenge)                          │\n│        │                    │                      │                         │\n│        │                    │                      │  4. Validate            │\n│        │                    │                      │  Device                 │\n│        │                    │                      │                         │\n│        │                    │                      │  5. Check               │\n│        │                    │                      │  Entitlements           │\n│        │                    │                      │                         │\n│        │◄────────────────────────────────────────────────────────────────   │\n│        │  6. License Response (encrypted content keys)                      │\n│        │                    │                      │                         │\n│        │  7. Decrypt        │                      │                         │\n│        │  Response          │                      │                         │\n│        │                    │                      │                         │\n│        │  8. Store Keys     │                      │                         │\n│        │  in CDM            │                      │                         │\n│        │                    │                      │                         │\n│   └────┴─────┘         └────┴─────┘         └──────┴───────┘                │\n│                                                                              │\n└─────────────────────────────────────────────────────────────────────────────┘\n"])</script><script>self.__next_f.push([1,"19:[[\"$\",\"h1\",null,{\"id\":\"license-protocols-in-drm\",\"className\":\"scroll-mt-20 text-3xl font-bold tracking-tight text-foreground mt-8 mb-4\",\"children\":\"License Protocols in DRM\"}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"text-muted-foreground leading-7 mb-4\",\"children\":\"License protocols are the communication layer between clients and license servers. They handle the secure exchange of content decryption keys while preventing interception and replay attacks.\"}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"the-license-acquisition-flow\",\"className\":\"scroll-mt-20 text-2xl font-semibold text-foreground mt-8 mb-3 border-b border-border pb-2\",\"children\":\"The License Acquisition Flow\"}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"text-muted-foreground leading-7 mb-4\",\"children\":\"All DRM systems follow a similar high-level flow:\"}],\"\\n\",[\"$\",\"code\",null,{\"className\":\"rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground\",\"children\":\"$1d\"}],\"\\n\",\"$L1e\",\"\\n\",\"$L1f\",\"\\n\",\"$L20\",\"\\n\",\"$L21\",\"\\n\",\"$L22\",\"\\n\",\"$L23\",\"\\n\",\"$L24\",\"\\n\",\"$L25\",\"\\n\",\"$L26\",\"\\n\",\"$L27\",\"\\n\",\"$L28\",\"\\n\",\"$L29\",\"\\n\",\"$L2a\",\"\\n\",\"$L2b\",\"\\n\",\"$L2c\",\"\\n\",\"$L2d\",\"\\n\",\"$L2e\",\"\\n\",\"$L2f\",\"\\n\",\"$L30\",\"\\n\",\"$L31\",\"\\n\",\"$L32\",\"\\n\",\"$L33\",\"\\n\",\"$L34\",\"\\n\",\"$L35\",\"\\n\",\"$L36\",\"\\n\",\"$L37\",\"\\n\",\"$L38\",\"\\n\",\"$L39\",\"\\n\",\"$L3a\",\"\\n\",\"$L3b\",\"\\n\",\"$L3c\",\"\\n\",\"$L3d\",\"\\n\",\"$L3e\",\"\\n\",\"$L3f\",\"\\n\",\"$L40\",\"\\n\",\"$L41\",\"\\n\",\"$L42\",\"\\n\",\"$L43\",\"\\n\",\"$L44\",\"\\n\",\"$L45\",\"\\n\",\"$L46\",\"\\n\",\"$L47\",\"\\n\",\"$L48\",\"\\n\",\"$L49\",\"\\n\",\"$L4a\",\"\\n\",\"$L4b\",\"\\n\",\"$L4c\",\"\\n\",\"$L4d\"]\n"])</script><script>self.__next_f.push([1,"1e:[\"$\",\"div\",null,{\"className\":\"my-4 rounded-lg border border-border bg-card p-4\",\"children\":[[\"$\",\"div\",null,{\"className\":\"flex items-center gap-2 mb-2\",\"children\":[[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide lucide-lightbulb h-4 w-4 text-yellow-500\",\"aria-hidden\":\"true\",\"children\":[[\"$\",\"path\",\"1gvzjb\",{\"d\":\"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5\"}],[\"$\",\"path\",\"x1upvd\",{\"d\":\"M9 18h6\"}],[\"$\",\"path\",\"ceow96\",{\"d\":\"M10 22h4\"}],\"$undefined\"]}],[\"$\",\"span\",null,{\"className\":\"font-semibold text-foreground\",\"children\":\"License Challenge\"}]]}],[\"$\",\"div\",null,{\"className\":\"text-sm text-muted-foreground\",\"children\":[\"$\",\"p\",null,{\"className\":\"text-muted-foreground leading-7 mb-4\",\"children\":\"The license request (challenge) is an encrypted blob generated by the CDM. It contains device identity, key IDs, and session information - all signed and encrypted to prevent tampering.\"}]}]]}]\n1f:[\"$\",\"h2\",null,{\"id\":\"widevine-license-protocol\",\"className\":\"scroll-mt-20 text-2xl font-semibold text-foreground mt-8 mb-3 border-b border-border pb-2\",\"children\":\"Widevine License Protocol\"}]\n20:[\"$\",\"h3\",null,{\"id\":\"protocol-overview\",\"className\":\"scroll-mt-20 text-xl font-semibold text-foreground mt-6 mb-2\",\"children\":\"Protocol Overview\"}]\n21:[\"$\",\"p\",null,{\"className\":\"text-muted-foreground leading-7 mb-4\",\"children\":\"Widevine uses a binary protocol based on Protocol Buffers (protobuf).\"}]\n4e:T136b,"])</script><script>self.__next_f.push([1,"┌─────────────────────────────────────────────────────────────────────────────┐\n│                      Widevine License Protocol                               │\n├─────────────────────────────────────────────────────────────────────────────┤\n│                                                                              │\n│   License Request Structure:                                                 │\n│   ┌────────────────────────────────────────────────────────────────────┐    │\n│   │ SignedMessage                                                       │    │\n│   ├────────────────────────────────────────────────────────────────────┤    │\n│   │ type: LICENSE_REQUEST                                              │    │\n│   │ msg: LicenseRequest (protobuf)                                     │    │\n│   │   ├── client_id: DeviceCertificate                                 │    │\n│   │   ├── content_id: KeyID[]                                          │    │\n│   │   ├── type: NEW | RENEWAL | RELEASE                                │    │\n│   │   ├── request_time: timestamp                                      │    │\n│   │   └── protocol_version: 21                                         │    │\n│   │ signature: RSA-PSS signature                                       │    │\n│   │ session_key: AES-encrypted session key                             │    │\n│   └────────────────────────────────────────────────────────────────────┘    │\n│                                                                              │\n│   License Response Structure:                                                │\n│   ┌────────────────────────────────────────────────────────────────────┐    │\n│   │ SignedMessage                                                       │    │\n│   ├────────────────────────────────────────────────────────────────────┤    │\n│   │ type: LICENSE                                                       │    │\n│   │ msg: License (protobuf)                                            │    │\n│   │   ├── id: LicenseID                                                │    │\n│   │   ├── policy: Policy                                               │    │\n│   │   │     ├── can_play: bool                                         │    │\n│   │   │     ├── can_persist: bool                                      │    │\n│   │   │     ├── can_renew: bool                                        │    │\n│   │   │     ├── license_duration_seconds                               │    │\n│   │   │     └── playback_duration_seconds                              │    │\n│   │   └── key: KeyContainer[]                                          │    │\n│   │         ├── id: key_id                                             │    │\n│   │         ├── iv: initialization_vector                              │    │\n│   │         ├── key: encrypted_content_key                             │    │\n│   │         └── type: CONTENT | SIGNING | OPERATOR                     │    │\n│   │ signature: RSA-PSS signature                                       │    │\n│   └────────────────────────────────────────────────────────────────────┘    │\n│                                                                              │\n└─────────────────────────────────────────────────────────────────────────────┘\n"])</script><script>self.__next_f.push([1,"22:[\"$\",\"code\",null,{\"className\":\"rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground\",\"children\":\"$4e\"}]\n23:[\"$\",\"h3\",null,{\"id\":\"key-derivation-in-widevine\",\"className\":\"scroll-mt-20 text-xl font-semibold text-foreground mt-6 mb-2\",\"children\":\"Key Derivation in Widevine\"}]\n24:[\"$\",\"pre\",null,{\"className\":\"my-4 overflow-x-auto rounded-lg border border-border bg-zinc-950 p-4\",\"children\":[\"$\",\"code\",null,{\"className\":\"text-sm text-zinc-100 language-python\",\"children\":\"# Conceptual key derivation (simplified)\\n\\n# 1. Client generates ephemeral key pair\\nclient_private, client_public = generate_rsa_keypair(2048)\\n\\n# 2. License server encrypts content keys with client's public key\\nencrypted_content_key = rsa_oaep_encrypt(\\n    public_key=client_public,\\n    plaintext=content_key\\n)\\n\\n# 3. Client decrypts using private key (inside CDM)\\ncontent_key = rsa_oaep_decrypt(\\n    private_key=client_private,\\n    ciphertext=encrypted_content_key\\n)\\n\"}]}]\n"])</script><script>self.__next_f.push([1,"25:[\"$\",\"div\",null,{\"data-slot\":\"alert\",\"role\":\"alert\",\"className\":\"relative w-full rounded-lg border px-4 py-3 text-sm grid has-[\u003esvg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[\u003esvg]:gap-x-3 gap-y-0.5 items-start [\u0026\u003esvg]:size-4 [\u0026\u003esvg]:translate-y-0.5 [\u0026\u003esvg]:text-current text-card-foreground my-4 border-red-500/50 bg-red-500/5\",\"children\":[[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide lucide-sword h-4 w-4 text-red-500\",\"aria-hidden\":\"true\",\"children\":[[\"$\",\"path\",\"s7kpr\",{\"d\":\"m11 19-6-6\"}],[\"$\",\"path\",\"1kw20b\",{\"d\":\"m5 21-2-2\"}],[\"$\",\"path\",\"1oqv8h\",{\"d\":\"m8 16-4 4\"}],[\"$\",\"path\",\"pkxemp\",{\"d\":\"M9.5 17.5 21 6V3h-3L6.5 14.5\"}],\"$undefined\"]}],[\"$\",\"div\",null,{\"data-slot\":\"alert-title\",\"className\":\"col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight text-red-500\",\"children\":\"Protocol Attack Surface\"}],[\"$\",\"div\",null,{\"data-slot\":\"alert-description\",\"className\":\"col-start-2 grid justify-items-start gap-1 text-sm [\u0026_p]:leading-relaxed text-muted-foreground\",\"children\":[[\"$\",\"p\",null,{\"className\":\"text-muted-foreground leading-7 mb-4\",\"children\":\"Attack vectors on the license protocol:\"}],[\"$\",\"ul\",null,{\"className\":\"my-4 ml-6 list-disc space-y-2 text-muted-foreground\",\"children\":[\"\\n\",[\"$\",\"li\",null,{\"className\":\"leading-7\",\"children\":[[\"$\",\"strong\",null,{\"className\":\"font-semibold text-foreground\",\"children\":\"Request Forgery\"}],\": Crafting fake license requests with elevated privileges\"]}],\"\\n\",[\"$\",\"li\",null,{\"className\":\"leading-7\",\"children\":[[\"$\",\"strong\",null,{\"className\":\"font-semibold text-foreground\",\"children\":\"Response Replay\"}],\": Reusing captured license responses for different content\"]}],\"\\n\",[\"$\",\"li\",null,{\"className\":\"leading-7\",\"children\":[[\"$\",\"strong\",null,{\"className\":\"font-semibold text-foreground\",\"children\":\"MITM on Proxy\"}],\": If the proxy server doesn't validate properly\"]}],\"\\n\",[\"$\",\"li\",null,{\"className\":\"leading-7\",\"children\":[[\"$\",\"strong\",null,{\"className\":\"font-semibold text-foreground\",\"children\":\"Session Key Extraction\"}],\": Obtaining session keys to decrypt responses\"]}],\"\\n\"]}]]}]]}]\n"])</script><script>self.__next_f.push([1,"26:[\"$\",\"div\",null,{\"data-slot\":\"alert\",\"role\":\"alert\",\"className\":\"relative w-full rounded-lg border px-4 py-3 text-sm grid has-[\u003esvg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[\u003esvg]:gap-x-3 gap-y-0.5 items-start [\u0026\u003esvg]:size-4 [\u0026\u003esvg]:translate-y-0.5 [\u0026\u003esvg]:text-current text-card-foreground my-4 border-cyan-500/50 bg-cyan-500/5\",\"children\":[[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide lucide-shield h-4 w-4 text-cyan-500\",\"aria-hidden\":\"true\",\"children\":[[\"$\",\"path\",\"oel41y\",{\"d\":\"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z\"}],\"$undefined\"]}],[\"$\",\"div\",null,{\"data-slot\":\"alert-title\",\"className\":\"col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight text-cyan-500\",\"children\":\"Protocol Defenses\"}],[\"$\",\"div\",null,{\"data-slot\":\"alert-description\",\"className\":\"col-start-2 grid justify-items-start gap-1 text-sm [\u0026_p]:leading-relaxed text-muted-foreground\",\"children\":[[\"$\",\"p\",null,{\"className\":\"text-muted-foreground leading-7 mb-4\",\"children\":\"Defense mechanisms in the protocol:\"}],[\"$\",\"ul\",null,{\"className\":\"my-4 ml-6 list-disc space-y-2 text-muted-foreground\",\"children\":[\"\\n\",[\"$\",\"li\",null,{\"className\":\"leading-7\",\"children\":[[\"$\",\"strong\",null,{\"className\":\"font-semibold text-foreground\",\"children\":\"Device Binding\"}],\": Keys tied to specific device certificates\"]}],\"\\n\",[\"$\",\"li\",null,{\"className\":\"leading-7\",\"children\":[[\"$\",\"strong\",null,{\"className\":\"font-semibold text-foreground\",\"children\":\"Nonce Freshness\"}],\": Random values prevent replay attacks\"]}],\"\\n\",[\"$\",\"li\",null,{\"className\":\"leading-7\",\"children\":[[\"$\",\"strong\",null,{\"className\":\"font-semibold text-foreground\",\"children\":\"Timestamp Validation\"}],\": Requests must be within acceptable time window\"]}],\"\\n\",[\"$\",\"li\",null,{\"className\":\"leading-7\",\"children\":[[\"$\",\"strong\",null,{\"className\":\"font-semibold text-foreground\",\"children\":\"Certificate Chain Validation\"}],\": Full PKI verification of device identity\"]}],\"\\n\"]}]]}]]}]\n"])</script><script>self.__next_f.push([1,"27:[\"$\",\"h2\",null,{\"id\":\"fairplay-license-protocol-spcckc\",\"className\":\"scroll-mt-20 text-2xl font-semibold text-foreground mt-8 mb-3 border-b border-border pb-2\",\"children\":\"FairPlay License Protocol (SPC/CKC)\"}]\n28:[\"$\",\"h3\",null,{\"id\":\"server-playback-context-spc\",\"className\":\"scroll-mt-20 text-xl font-semibold text-foreground mt-6 mb-2\",\"children\":\"Server Playback Context (SPC)\"}]\n29:[\"$\",\"p\",null,{\"className\":\"text-muted-foreground leading-7 mb-4\",\"children\":\"FairPlay uses a unique challenge-response mechanism:\"}]\n4f:T159b,"])</script><script>self.__next_f.push([1,"┌─────────────────────────────────────────────────────────────────────────────┐\n│                      FairPlay SPC/CKC Flow                                   │\n├─────────────────────────────────────────────────────────────────────────────┤\n│                                                                              │\n│   ┌─────────────┐                               ┌─────────────────┐         │\n│   │   Client    │                               │  Key Server     │         │\n│   │  (AVPlayer) │                               │  (Your Server)  │         │\n│   └──────┬──────┘                               └────────┬────────┘         │\n│          │                                               │                   │\n│          │  1. Request Content Key Context               │                   │\n│          │      (from playback URL)                      │                   │\n│          │                                               │                   │\n│          │  2. CDM creates SPC                           │                   │\n│          │  ┌─────────────────────────────────┐          │                   │\n│          │  │ SPC (Server Playback Context)   │          │                   │\n│          │  │ ┌─────────────────────────────┐ │          │                   │\n│          │  │ │ Version                     │ │          │                   │\n│          │  │ │ Device Certificate          │ │          │                   │\n│          │  │ │ Asset ID (Content ID)       │ │          │                   │\n│          │  │ │ TLLV (encrypted payload)    │ │          │                   │\n│          │  │ │   └── Session key           │ │          │                   │\n│          │  │ │   └── Anti-replay data      │ │          │                   │\n│          │  │ └─────────────────────────────┘ │          │                   │\n│          │  └─────────────────────────────────┘          │                   │\n│          │                                               │                   │\n│          │  3. Forward SPC ──────────────────────────────►                   │\n│          │                                               │                   │\n│          │                                  4. Validate SPC                  │\n│          │                                  5. Decrypt TLLV                  │\n│          │                                  6. Create CKC                    │\n│          │                                               │                   │\n│          │  ┌─────────────────────────────────┐          │                   │\n│          │  │ CKC (Content Key Context)       │          │                   │\n│          │  │ ┌─────────────────────────────┐ │          │                   │\n│          │  │ │ Content Key (encrypted)     │ │          │                   │\n│          │  │ │ Key Duration (rental/buy)   │ │          │                   │\n│          │  │ │ HDCP Requirements           │ │          │                   │\n│          │  │ │ Persistence allowed?        │ │          │                   │\n│          │  │ └─────────────────────────────┘ │◄─────────│                   │\n│          │  └─────────────────────────────────┘          │                   │\n│          │                                               │                   │\n│          │  7. CDM processes CKC                         │                   │\n│          │  8. Content key available                     │                   │\n│          │                                               │                   │\n│   └──────┴──────┘                               └────────┴────────┘         │\n│                                                                              │\n└─────────────────────────────────────────────────────────────────────────────┘\n"])</script><script>self.__next_f.push([1,"2a:[\"$\",\"code\",null,{\"className\":\"rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground\",\"children\":\"$4f\"}]\n2b:[\"$\",\"h3\",null,{\"id\":\"fairplay-tllv-structure\",\"className\":\"scroll-mt-20 text-xl font-semibold text-foreground mt-6 mb-2\",\"children\":\"FairPlay TLLV Structure\"}]\n2c:[\"$\",\"code\",null,{\"className\":\"rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground\",\"children\":\"TLLV = Tag-Length-Length-Value (Apple's proprietary format)\\n\\n┌────────────────────────────────────────────┐\\n│ TLLV Container                             │\\n├────────────────────────────────────────────┤\\n│ Tag (4 bytes)    │ Identifies data type    │\\n│ Total Length     │ Full TLLV size          │\\n│ Value Length     │ Payload size            │\\n│ Value (payload)  │ Actual data             │\\n└────────────────────────────────────────────┘\\n\\nCommon Tags:\\n- 0x47a6fc24: Content Key\\n- 0x6b68f542: Device Certificate\\n- 0x71b5595a: Session Key (encrypted)\\n- 0x89c90f5a: Anti-replay hash\\n\"}]\n"])</script><script>self.__next_f.push([1,"2d:[\"$\",\"div\",null,{\"data-slot\":\"alert\",\"role\":\"alert\",\"className\":\"relative w-full rounded-lg border px-4 py-3 text-sm grid has-[\u003esvg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[\u003esvg]:gap-x-3 gap-y-0.5 items-start [\u0026\u003esvg]:size-4 [\u0026\u003esvg]:translate-y-0.5 [\u0026\u003esvg]:text-current text-card-foreground my-4 border-primary/50 bg-primary/5\",\"children\":[[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide lucide-info h-4 w-4 text-primary\",\"aria-hidden\":\"true\",\"children\":[[\"$\",\"circle\",\"1mglay\",{\"cx\":\"12\",\"cy\":\"12\",\"r\":\"10\"}],[\"$\",\"path\",\"1dtifu\",{\"d\":\"M12 16v-4\"}],[\"$\",\"path\",\"e9boi3\",{\"d\":\"M12 8h.01\"}],\"$undefined\"]}],[\"$\",\"div\",null,{\"data-slot\":\"alert-title\",\"className\":\"col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight text-primary\",\"children\":\"Apple's Unique Approach\"}],[\"$\",\"div\",null,{\"data-slot\":\"alert-description\",\"className\":\"col-start-2 grid justify-items-start gap-1 text-sm [\u0026_p]:leading-relaxed text-muted-foreground\",\"children\":[\"$\",\"p\",null,{\"className\":\"text-muted-foreground leading-7 mb-4\",\"children\":\"FairPlay is the only major DRM that requires a Key Security Module (KSM) to be deployed on your own infrastructure. Apple provides the KSM as a software package that you integrate into your key server.\"}]}]]}]\n"])</script><script>self.__next_f.push([1,"2e:[\"$\",\"h2\",null,{\"id\":\"playready-license-protocol\",\"className\":\"scroll-mt-20 text-2xl font-semibold text-foreground mt-8 mb-3 border-b border-border pb-2\",\"children\":\"PlayReady License Protocol\"}]\n2f:[\"$\",\"h3\",null,{\"id\":\"soap-based-protocol-legacy\",\"className\":\"scroll-mt-20 text-xl font-semibold text-foreground mt-6 mb-2\",\"children\":\"SOAP-Based Protocol (Legacy)\"}]\n30:[\"$\",\"pre\",null,{\"className\":\"my-4 overflow-x-auto rounded-lg border border-border bg-zinc-950 p-4\",\"children\":[\"$\",\"code\",null,{\"className\":\"text-sm text-zinc-100 language-xml\",\"children\":\"\u003c!-- PlayReady SOAP License Request --\u003e\\n\u003csoap:Envelope\u003e\\n  \u003csoap:Header\u003e\\n    \u003cPlayReadyHeader\u003e\\n      \u003cClientVersion\u003e4.0.0.0\u003c/ClientVersion\u003e\\n      \u003cDeviceModel\u003eEdge Browser\u003c/DeviceModel\u003e\\n    \u003c/PlayReadyHeader\u003e\\n  \u003c/soap:Header\u003e\\n  \u003csoap:Body\u003e\\n    \u003cAcquireLicense\u003e\\n      \u003cchallenge\u003e\\n        \u003cLA xmlns=\\\"http://schemas.microsoft.com/DRM/2007/03/protocols\\\"\u003e\\n          \u003cContentHeader\u003e\\n            \u003c!-- WRMHEADER with KeyIDs --\u003e\\n          \u003c/ContentHeader\u003e\\n          \u003cClientInfo\u003e\\n            \u003cClientVersion\u003e4.0\u003c/ClientVersion\u003e\\n            \u003cSecurityLevel\u003e2000\u003c/SecurityLevel\u003e\\n          \u003c/ClientInfo\u003e\\n          \u003cLicenseNonce\u003erandombase64data==\u003c/LicenseNonce\u003e\\n        \u003c/LA\u003e\\n      \u003c/challenge\u003e\\n    \u003c/AcquireLicense\u003e\\n  \u003c/soap:Body\u003e\\n\u003c/soap:Envelope\u003e\\n\"}]}]\n31:[\"$\",\"h3\",null,{\"id\":\"rest-based-protocol-modern\",\"className\":\"scroll-mt-20 text-xl font-semibold text-foreground mt-6 mb-2\",\"children\":\"REST-Based Protocol (Modern)\"}]\n50:T137f,"])</script><script>self.__next_f.push([1,"┌─────────────────────────────────────────────────────────────────────────────┐\n│                    PlayReady REST License Protocol                           │\n├─────────────────────────────────────────────────────────────────────────────┤\n│                                                                              │\n│   License Request (HTTP POST):                                               │\n│   ┌────────────────────────────────────────────────────────────────────┐    │\n│   │ Headers:                                                            │    │\n│   │   Content-Type: application/octet-stream                           │    │\n│   │   ms-playready-client-ver: 4.0                                     │    │\n│   │                                                                     │    │\n│   │ Body: Binary challenge blob                                        │    │\n│   │ ┌────────────────────────────────────────────────────────────────┐ │    │\n│   │ │ LA Record (License Acquisition)                                 │ │    │\n│   │ │ ├── Record Type: 0x0001                                        │ │    │\n│   │ │ ├── Record Length                                              │ │    │\n│   │ │ ├── Client Certificate                                          │ │    │\n│   │ │ ├── Content Header (KeyIDs)                                     │ │    │\n│   │ │ └── Nonce (16 bytes)                                           │ │    │\n│   │ └────────────────────────────────────────────────────────────────┘ │    │\n│   └────────────────────────────────────────────────────────────────────┘    │\n│                                                                              │\n│   License Response:                                                          │\n│   ┌────────────────────────────────────────────────────────────────────┐    │\n│   │ XMR License (XML Rights Management)                                │    │\n│   │ ├── License Version                                                │    │\n│   │ ├── License ID (GUID)                                             │    │\n│   │ ├── Rights:                                                        │    │\n│   │ │     ├── Play (with output restrictions)                         │    │\n│   │ │     ├── Copy (if allowed)                                       │    │\n│   │ │     └── Transfer (domain transfers)                             │    │\n│   │ ├── Keys:                                                          │    │\n│   │ │     ├── Content Key (encrypted)                                 │    │\n│   │ │     └── Key ID                                                  │    │\n│   │ └── Restrictions:                                                  │    │\n│   │       ├── Begin Date                                              │    │\n│   │       ├── End Date                                                │    │\n│   │       ├── Secure Stop required                                    │    │\n│   │       └── Output Protection Level                                 │    │\n│   └────────────────────────────────────────────────────────────────────┘    │\n│                                                                              │\n└─────────────────────────────────────────────────────────────────────────────┘\n"])</script><script>self.__next_f.push([1,"32:[\"$\",\"code\",null,{\"className\":\"rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground\",\"children\":\"$50\"}]\n33:[\"$\",\"h2\",null,{\"id\":\"protocol-security-mechanisms\",\"className\":\"scroll-mt-20 text-2xl font-semibold text-foreground mt-8 mb-3 border-b border-border pb-2\",\"children\":\"Protocol Security Mechanisms\"}]\n34:[\"$\",\"h3\",null,{\"id\":\"anti-replay-protection\",\"className\":\"scroll-mt-20 text-xl font-semibold text-foreground mt-6 mb-2\",\"children\":\"Anti-Replay Protection\"}]\n51:Tf2c,"])</script><script>self.__next_f.push([1,"┌─────────────────────────────────────────────────────────────────────────────┐\n│                    Anti-Replay Mechanisms                                    │\n├─────────────────────────────────────────────────────────────────────────────┤\n│                                                                              │\n│   1. NONCE (Number Used Once)                                               │\n│   ┌────────────────────────────────────────────────────────────────────┐    │\n│   │ Request:  { nonce: \"abc123...\", timestamp: 1703001234 }            │    │\n│   │ Response: { nonce: \"abc123...\", server_nonce: \"xyz789...\" }        │    │\n│   │                                                                     │    │\n│   │ Server stores used nonces for expiration window                    │    │\n│   │ Reused nonce = Replay attack detected                              │    │\n│   └────────────────────────────────────────────────────────────────────┘    │\n│                                                                              │\n│   2. Timestamp Binding                                                       │\n│   ┌────────────────────────────────────────────────────────────────────┐    │\n│   │ Request must be within ±5 minutes of server time                   │    │\n│   │ Prevents storing requests for later use                            │    │\n│   │                                                                     │    │\n│   │ if abs(server_time - request_time) \u003e 300:                          │    │\n│   │     reject(\"Request expired\")                                      │    │\n│   └────────────────────────────────────────────────────────────────────┘    │\n│                                                                              │\n│   3. Session Binding                                                         │\n│   ┌────────────────────────────────────────────────────────────────────┐    │\n│   │ Each playback session has unique session ID                        │    │\n│   │ Response keys are encrypted to session-specific key                │    │\n│   │ Response cannot be used in different session                       │    │\n│   └────────────────────────────────────────────────────────────────────┘    │\n│                                                                              │\n└─────────────────────────────────────────────────────────────────────────────┘\n"])</script><script>self.__next_f.push([1,"35:[\"$\",\"code\",null,{\"className\":\"rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground\",\"children\":\"$51\"}]\n36:[\"$\",\"h3\",null,{\"id\":\"device-authentication\",\"className\":\"scroll-mt-20 text-xl font-semibold text-foreground mt-6 mb-2\",\"children\":\"Device Authentication\"}]\n52:Tbff,"])</script><script>self.__next_f.push([1,"┌─────────────────────────────────────────────────────────────────────────────┐\n│                    Device Authentication Flow                                │\n├─────────────────────────────────────────────────────────────────────────────┤\n│                                                                              │\n│   Device Certificate Chain:                                                  │\n│                                                                              │\n│   ┌────────────────┐                                                        │\n│   │   Root CA      │  ← Hardcoded in license server                        │\n│   │  (DRM vendor)  │                                                        │\n│   └───────┬────────┘                                                        │\n│           │ Signs                                                            │\n│   ┌───────▼────────┐                                                        │\n│   │ Intermediate   │  ← Model-level (OEM/manufacturer)                      │\n│   │ Certificate    │                                                        │\n│   └───────┬────────┘                                                        │\n│           │ Signs                                                            │\n│   ┌───────▼────────┐                                                        │\n│   │    Device      │  ← Unique per device/browser                           │\n│   │  Certificate   │                                                        │\n│   └────────────────┘                                                        │\n│                                                                              │\n│   Validation:                                                                │\n│   1. Verify signature chain to trusted root                                 │\n│   2. Check certificate not revoked (CRL/OCSP)                              │\n│   3. Verify device hasn't been blacklisted                                  │\n│   4. Check security level meets content requirements                        │\n│                                                                              │\n└─────────────────────────────────────────────────────────────────────────────┘\n"])</script><script>self.__next_f.push([1,"37:[\"$\",\"code\",null,{\"className\":\"rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground\",\"children\":\"$52\"}]\n"])</script><script>self.__next_f.push([1,"38:[\"$\",\"div\",null,{\"data-slot\":\"alert\",\"role\":\"alert\",\"className\":\"relative w-full rounded-lg border px-4 py-3 text-sm grid has-[\u003esvg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[\u003esvg]:gap-x-3 gap-y-0.5 items-start [\u0026\u003esvg]:size-4 [\u0026\u003esvg]:translate-y-0.5 [\u0026\u003esvg]:text-current text-card-foreground my-4 border-yellow-500/50 bg-yellow-500/5\",\"children\":[[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide lucide-triangle-alert h-4 w-4 text-yellow-500\",\"aria-hidden\":\"true\",\"children\":[[\"$\",\"path\",\"wmoenq\",{\"d\":\"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3\"}],[\"$\",\"path\",\"juzpu7\",{\"d\":\"M12 9v4\"}],[\"$\",\"path\",\"p32p05\",{\"d\":\"M12 17h.01\"}],\"$undefined\"]}],[\"$\",\"div\",null,{\"data-slot\":\"alert-title\",\"className\":\"col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight text-yellow-500\",\"children\":\"Revocation Lists\"}],[\"$\",\"div\",null,{\"data-slot\":\"alert-description\",\"className\":\"col-start-2 grid justify-items-start gap-1 text-sm [\u0026_p]:leading-relaxed text-muted-foreground\",\"children\":[\"$\",\"p\",null,{\"className\":\"text-muted-foreground leading-7 mb-4\",\"children\":\"DRM vendors maintain revocation lists (CRL) of compromised devices. When a CDM is cracked, all devices using that CDM version can be revoked, breaking playback until users update.\"}]}]]}]\n"])</script><script>self.__next_f.push([1,"39:[\"$\",\"h2\",null,{\"id\":\"license-policy-enforcement\",\"className\":\"scroll-mt-20 text-2xl font-semibold text-foreground mt-8 mb-3 border-b border-border pb-2\",\"children\":\"License Policy Enforcement\"}]\n3a:[\"$\",\"h3\",null,{\"id\":\"policy-attributes\",\"className\":\"scroll-mt-20 text-xl font-semibold text-foreground mt-6 mb-2\",\"children\":\"Policy Attributes\"}]\n"])</script><script>self.__next_f.push([1,"3b:[\"$\",\"div\",null,{\"className\":\"my-6 overflow-x-auto rounded-lg border border-border\",\"children\":[\"$\",\"table\",null,{\"className\":\"w-full text-sm\",\"children\":[[\"$\",\"thead\",null,{\"className\":\"bg-muted/50\",\"children\":[\"$\",\"tr\",null,{\"className\":\"border-b border-border last:border-0\",\"children\":[[\"$\",\"th\",null,{\"className\":\"px-4 py-3 text-left font-semibold text-foreground\",\"children\":\"Policy\"}],[\"$\",\"th\",null,{\"className\":\"px-4 py-3 text-left font-semibold text-foreground\",\"children\":\"Widevine\"}],[\"$\",\"th\",null,{\"className\":\"px-4 py-3 text-left font-semibold text-foreground\",\"children\":\"FairPlay\"}],[\"$\",\"th\",null,{\"className\":\"px-4 py-3 text-left font-semibold text-foreground\",\"children\":\"PlayReady\"}]]}]}],[\"$\",\"tbody\",null,{\"children\":[[\"$\",\"tr\",null,{\"className\":\"border-b border-border last:border-0\",\"children\":[[\"$\",\"td\",null,{\"className\":\"px-4 py-3 text-muted-foreground\",\"children\":\"License Duration\"}],[\"$\",\"td\",null,{\"className\":\"px-4 py-3 text-muted-foreground\",\"children\":[\"$\",\"code\",null,{\"className\":\"rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground\",\"children\":\"license_duration_seconds\"}]}],[\"$\",\"td\",null,{\"className\":\"px-4 py-3 text-muted-foreground\",\"children\":[\"$\",\"code\",null,{\"className\":\"rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground\",\"children\":\"ckc-duration\"}]}],[\"$\",\"td\",null,{\"className\":\"px-4 py-3 text-muted-foreground\",\"children\":[\"$\",\"code\",null,{\"className\":\"rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground\",\"children\":\"BeginDate/EndDate\"}]}]]}],[\"$\",\"tr\",null,{\"className\":\"border-b border-border last:border-0\",\"children\":[[\"$\",\"td\",null,{\"className\":\"px-4 py-3 text-muted-foreground\",\"children\":\"Playback Duration\"}],[\"$\",\"td\",null,{\"className\":\"px-4 py-3 text-muted-foreground\",\"children\":[\"$\",\"code\",null,{\"className\":\"rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground\",\"children\":\"playback_duration_seconds\"}]}],[\"$\",\"td\",null,{\"className\":\"px-4 py-3 text-muted-foreground\",\"children\":[\"$\",\"code\",null,{\"className\":\"rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground\",\"children\":\"ckc-playback-duration\"}]}],[\"$\",\"td\",null,{\"className\":\"px-4 py-3 text-muted-foreground\",\"children\":[\"$\",\"code\",null,{\"className\":\"rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground\",\"children\":\"PlayStart/PlayEnd\"}]}]]}],[\"$\",\"tr\",null,{\"className\":\"border-b border-border last:border-0\",\"children\":[[\"$\",\"td\",null,{\"className\":\"px-4 py-3 text-muted-foreground\",\"children\":\"Offline Allowed\"}],[\"$\",\"td\",null,{\"className\":\"px-4 py-3 text-muted-foreground\",\"children\":[\"$\",\"code\",null,{\"className\":\"rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground\",\"children\":\"can_persist\"}]}],[\"$\",\"td\",null,{\"className\":\"px-4 py-3 text-muted-foreground\",\"children\":[\"$\",\"code\",null,{\"className\":\"rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground\",\"children\":\"persistence-allowed\"}]}],[\"$\",\"td\",null,{\"className\":\"px-4 py-3 text-muted-foreground\",\"children\":[\"$\",\"code\",null,{\"className\":\"rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground\",\"children\":\"License.Store\"}]}]]}],[\"$\",\"tr\",null,{\"className\":\"border-b border-border last:border-0\",\"children\":[[\"$\",\"td\",null,{\"className\":\"px-4 py-3 text-muted-foreground\",\"children\":\"HDCP Required\"}],[\"$\",\"td\",null,{\"className\":\"px-4 py-3 text-muted-foreground\",\"children\":[\"$\",\"code\",null,{\"className\":\"rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground\",\"children\":\"hdcp_version\"}]}],[\"$\",\"td\",null,{\"className\":\"px-4 py-3 text-muted-foreground\",\"children\":[\"$\",\"code\",null,{\"className\":\"rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground\",\"children\":\"output-protection\"}]}],[\"$\",\"td\",null,{\"className\":\"px-4 py-3 text-muted-foreground\",\"children\":[\"$\",\"code\",null,{\"className\":\"rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground\",\"children\":\"MinimumCompressedDigitalVideoOPL\"}]}]]}],[\"$\",\"tr\",null,{\"className\":\"border-b border-border last:border-0\",\"children\":[[\"$\",\"td\",null,{\"className\":\"px-4 py-3 text-muted-foreground\",\"children\":\"Max Resolution\"}],[\"$\",\"td\",null,{\"className\":\"px-4 py-3 text-muted-foreground\",\"children\":\"$L53\"}],\"$L54\",\"$L55\"]}],\"$L56\"]}]]}]}]\n"])</script><script>self.__next_f.push([1,"3c:[\"$\",\"h3\",null,{\"id\":\"output-protection-levels\",\"className\":\"scroll-mt-20 text-xl font-semibold text-foreground mt-6 mb-2\",\"children\":\"Output Protection Levels\"}]\n57:T849,"])</script><script>self.__next_f.push([1,"┌─────────────────────────────────────────────────────────────────────────────┐\n│                    Output Protection Requirements                            │\n├─────────────────────────────────────────────────────────────────────────────┤\n│                                                                              │\n│   Resolution        HDCP Requirement        Typical Policy                   │\n│   ──────────────────────────────────────────────────────────────────────    │\n│   SD (480p)         None                    Basic protection                 │\n│   HD (720p)         HDCP 1.4               Moderate protection              │\n│   Full HD (1080p)   HDCP 2.0               Standard protection              │\n│   4K UHD            HDCP 2.2               High protection                  │\n│   4K HDR            HDCP 2.2 + HW TEE      Maximum protection               │\n│                                                                              │\n│   If output protection check fails:                                          │\n│   - Downgrade resolution to allowed level                                   │\n│   - Block playback entirely                                                 │\n│   - Disable specific outputs (e.g., HDMI)                                   │\n│                                                                              │\n└─────────────────────────────────────────────────────────────────────────────┘\n"])</script><script>self.__next_f.push([1,"3d:[\"$\",\"code\",null,{\"className\":\"rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground\",\"children\":\"$57\"}]\n"])</script><script>self.__next_f.push([1,"3e:[\"$\",\"div\",null,{\"data-slot\":\"alert\",\"role\":\"alert\",\"className\":\"relative w-full rounded-lg border px-4 py-3 text-sm grid has-[\u003esvg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[\u003esvg]:gap-x-3 gap-y-0.5 items-start [\u0026\u003esvg]:size-4 [\u0026\u003esvg]:translate-y-0.5 [\u0026\u003esvg]:text-current text-card-foreground my-4 border-red-500/50 bg-red-500/5\",\"children\":[[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide lucide-sword h-4 w-4 text-red-500\",\"aria-hidden\":\"true\",\"children\":[[\"$\",\"path\",\"s7kpr\",{\"d\":\"m11 19-6-6\"}],[\"$\",\"path\",\"1kw20b\",{\"d\":\"m5 21-2-2\"}],[\"$\",\"path\",\"1oqv8h\",{\"d\":\"m8 16-4 4\"}],[\"$\",\"path\",\"pkxemp\",{\"d\":\"M9.5 17.5 21 6V3h-3L6.5 14.5\"}],\"$undefined\"]}],[\"$\",\"div\",null,{\"data-slot\":\"alert-title\",\"className\":\"col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight text-red-500\",\"children\":\"Policy Bypass Techniques\"}],[\"$\",\"div\",null,{\"data-slot\":\"alert-description\",\"className\":\"col-start-2 grid justify-items-start gap-1 text-sm [\u0026_p]:leading-relaxed text-muted-foreground\",\"children\":[[\"$\",\"p\",null,{\"className\":\"text-muted-foreground leading-7 mb-4\",\"children\":\"Attackers target policy enforcement:\"}],[\"$\",\"ul\",null,{\"className\":\"my-4 ml-6 list-disc space-y-2 text-muted-foreground\",\"children\":[\"\\n\",[\"$\",\"li\",null,{\"className\":\"leading-7\",\"children\":[[\"$\",\"strong\",null,{\"className\":\"font-semibold text-foreground\",\"children\":\"Modified CDMs\"}],\": Patched to ignore output restrictions\"]}],\"\\n\",[\"$\",\"li\",null,{\"className\":\"leading-7\",\"children\":[[\"$\",\"strong\",null,{\"className\":\"font-semibold text-foreground\",\"children\":\"Virtual HDCP\"}],\": Fake HDCP handshakes to satisfy checks\"]}],\"\\n\",[\"$\",\"li\",null,{\"className\":\"leading-7\",\"children\":[[\"$\",\"strong\",null,{\"className\":\"font-semibold text-foreground\",\"children\":\"Resolution spoofing\"}],\": Report lower resolution to get easier policy\"]}],\"\\n\",[\"$\",\"li\",null,{\"className\":\"leading-7\",\"children\":[[\"$\",\"strong\",null,{\"className\":\"font-semibold text-foreground\",\"children\":\"Clock manipulation\"}],\": Change system time for expired licenses\"]}],\"\\n\"]}]]}]]}]\n"])</script><script>self.__next_f.push([1,"3f:[\"$\",\"div\",null,{\"data-slot\":\"alert\",\"role\":\"alert\",\"className\":\"relative w-full rounded-lg border px-4 py-3 text-sm grid has-[\u003esvg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[\u003esvg]:gap-x-3 gap-y-0.5 items-start [\u0026\u003esvg]:size-4 [\u0026\u003esvg]:translate-y-0.5 [\u0026\u003esvg]:text-current text-card-foreground my-4 border-cyan-500/50 bg-cyan-500/5\",\"children\":[[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide lucide-shield h-4 w-4 text-cyan-500\",\"aria-hidden\":\"true\",\"children\":[[\"$\",\"path\",\"oel41y\",{\"d\":\"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z\"}],\"$undefined\"]}],[\"$\",\"div\",null,{\"data-slot\":\"alert-title\",\"className\":\"col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight text-cyan-500\",\"children\":\"Secure Policy Enforcement\"}],[\"$\",\"div\",null,{\"data-slot\":\"alert-description\",\"className\":\"col-start-2 grid justify-items-start gap-1 text-sm [\u0026_p]:leading-relaxed text-muted-foreground\",\"children\":[[\"$\",\"p\",null,{\"className\":\"text-muted-foreground leading-7 mb-4\",\"children\":\"Robust policy enforcement requires:\"}],[\"$\",\"ul\",null,{\"className\":\"my-4 ml-6 list-disc space-y-2 text-muted-foreground\",\"children\":[\"\\n\",[\"$\",\"li\",null,{\"className\":\"leading-7\",\"children\":[[\"$\",\"strong\",null,{\"className\":\"font-semibold text-foreground\",\"children\":\"Hardware TEE\"}],\": Policy checks inside secure enclave\"]}],\"\\n\",[\"$\",\"li\",null,{\"className\":\"leading-7\",\"children\":[[\"$\",\"strong\",null,{\"className\":\"font-semibold text-foreground\",\"children\":\"Attestation\"}],\": Verify device hasn't been tampered with\"]}],\"\\n\",[\"$\",\"li\",null,{\"className\":\"leading-7\",\"children\":[[\"$\",\"strong\",null,{\"className\":\"font-semibold text-foreground\",\"children\":\"Secure time\"}],\": Use secure clock for expiration checks\"]}],\"\\n\",[\"$\",\"li\",null,{\"className\":\"leading-7\",\"children\":[[\"$\",\"strong\",null,{\"className\":\"font-semibold text-foreground\",\"children\":\"Regular updates\"}],\": Push CDM updates to close bypasses\"]}],\"\\n\"]}]]}]]}]\n"])</script><script>self.__next_f.push([1,"40:[\"$\",\"h2\",null,{\"id\":\"multi-key-and-key-rotation\",\"className\":\"scroll-mt-20 text-2xl font-semibold text-foreground mt-8 mb-3 border-b border-border pb-2\",\"children\":\"Multi-Key and Key Rotation\"}]\n41:[\"$\",\"h3\",null,{\"id\":\"multi-key-content\",\"className\":\"scroll-mt-20 text-xl font-semibold text-foreground mt-6 mb-2\",\"children\":\"Multi-Key Content\"}]\n58:Ta2f,"])</script><script>self.__next_f.push([1,"┌─────────────────────────────────────────────────────────────────────────────┐\n│                    Multi-Key Encryption                                      │\n├─────────────────────────────────────────────────────────────────────────────┤\n│                                                                              │\n│   Content with multiple quality levels:                                      │\n│                                                                              │\n│   ┌─────────────────────────────────────────────────────────────────────┐   │\n│   │ Video Stream                                                         │   │\n│   ├─────────────────────────────────────────────────────────────────────┤   │\n│   │ 4K HDR  │ Key ID: abc-001 │ Policy: L1 only, HDCP 2.2              │   │\n│   │ 1080p   │ Key ID: abc-002 │ Policy: L1/L2, HDCP 2.0                │   │\n│   │ 720p    │ Key ID: abc-003 │ Policy: L1/L2/L3, HDCP 1.4             │   │\n│   │ 480p    │ Key ID: abc-004 │ Policy: Any level, no HDCP             │   │\n│   └─────────────────────────────────────────────────────────────────────┘   │\n│                                                                              │\n│   License server provides keys based on device security level               │\n│   L3 device only gets key abc-004                                           │\n│   L1 device gets all keys                                                   │\n│                                                                              │\n└─────────────────────────────────────────────────────────────────────────────┘\n"])</script><script>self.__next_f.push([1,"42:[\"$\",\"code\",null,{\"className\":\"rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground\",\"children\":\"$58\"}]\n43:[\"$\",\"h3\",null,{\"id\":\"key-rotation\",\"className\":\"scroll-mt-20 text-xl font-semibold text-foreground mt-6 mb-2\",\"children\":\"Key Rotation\"}]\n44:[\"$\",\"code\",null,{\"className\":\"rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground\",\"children\":\"Time-Based Key Rotation:\\n\\nSegment 1-100:    Key A (KID: key-001)\\nSegment 101-200:  Key B (KID: key-002)\\nSegment 201-300:  Key C (KID: key-003)\\n...\\n\\n┌──────────────────────────────────────────────────────────────────────┐\\n│ Benefits:                                                             │\\n│ - Limits damage if key is extracted (only that segment range)        │\\n│ - Enables mid-stream policy changes                                  │\\n│ - Supports ad insertion with different key policies                  │\\n│                                                                       │\\n│ Challenges:                                                           │\\n│ - More license requests needed                                       │\\n│ - Client must handle seamless key transitions                        │\\n│ - Increased server load                                              │\\n└──────────────────────────────────────────────────────────────────────┘\\n\"}]\n45:[\"$\",\"h2\",null,{\"id\":\"protocol-vulnerabilities-and-defenses\",\"className\":\"scroll-mt-20 text-2xl font-semibold text-foreground mt-8 mb-3 border-b border-border pb-2\",\"children\":\"Protocol Vulnerabilities and Defenses\"}]\n46:[\"$\",\"h3\",null,{\"id\":\"common-attack-patterns\",\"className\":\"scroll-mt-20 text-xl font-semibold text-foreground mt-6 mb-2\",\"children\":\"Common Attack Patterns\"}]\n"])</script><script>self.__next_f.push([1,"47:[\"$\",\"div\",null,{\"className\":\"my-6 overflow-x-auto rounded-lg border border-border\",\"children\":[\"$\",\"table\",null,{\"className\":\"w-full text-sm\",\"children\":[[\"$\",\"thead\",null,{\"className\":\"bg-muted/50\",\"children\":[\"$\",\"tr\",null,{\"className\":\"border-b border-border last:border-0\",\"children\":[[\"$\",\"th\",null,{\"className\":\"px-4 py-3 text-left font-semibold text-foreground\",\"children\":\"Attack\"}],[\"$\",\"th\",null,{\"className\":\"px-4 py-3 text-left font-semibold text-foreground\",\"children\":\"Target\"}],[\"$\",\"th\",null,{\"className\":\"px-4 py-3 text-left font-semibold text-foreground\",\"children\":\"Mitigation\"}]]}]}],[\"$\",\"tbody\",null,{\"children\":[[\"$\",\"tr\",null,{\"className\":\"border-b border-border last:border-0\",\"children\":[[\"$\",\"td\",null,{\"className\":\"px-4 py-3 text-muted-foreground\",\"children\":\"Request Tampering\"}],[\"$\",\"td\",null,{\"className\":\"px-4 py-3 text-muted-foreground\",\"children\":\"License challenge\"}],[\"$\",\"td\",null,{\"className\":\"px-4 py-3 text-muted-foreground\",\"children\":\"Signature verification\"}]]}],[\"$\",\"tr\",null,{\"className\":\"border-b border-border last:border-0\",\"children\":[[\"$\",\"td\",null,{\"className\":\"px-4 py-3 text-muted-foreground\",\"children\":\"Response Replay\"}],[\"$\",\"td\",null,{\"className\":\"px-4 py-3 text-muted-foreground\",\"children\":\"License response\"}],[\"$\",\"td\",null,{\"className\":\"px-4 py-3 text-muted-foreground\",\"children\":\"Nonce binding, timestamps\"}]]}],[\"$\",\"tr\",null,{\"className\":\"border-b border-border last:border-0\",\"children\":[[\"$\",\"td\",null,{\"className\":\"px-4 py-3 text-muted-foreground\",\"children\":\"Man-in-the-Middle\"}],[\"$\",\"td\",null,{\"className\":\"px-4 py-3 text-muted-foreground\",\"children\":\"Network layer\"}],[\"$\",\"td\",null,{\"className\":\"px-4 py-3 text-muted-foreground\",\"children\":\"TLS pinning, certificate validation\"}]]}],[\"$\",\"tr\",null,{\"className\":\"border-b border-border last:border-0\",\"children\":[[\"$\",\"td\",null,{\"className\":\"px-4 py-3 text-muted-foreground\",\"children\":\"Downgrade Attack\"}],[\"$\",\"td\",null,{\"className\":\"px-4 py-3 text-muted-foreground\",\"children\":\"Protocol version\"}],[\"$\",\"td\",null,{\"className\":\"px-4 py-3 text-muted-foreground\",\"children\":\"Minimum version requirements\"}]]}],[\"$\",\"tr\",null,{\"className\":\"border-b border-border last:border-0\",\"children\":[[\"$\",\"td\",null,{\"className\":\"px-4 py-3 text-muted-foreground\",\"children\":\"Token Theft\"}],[\"$\",\"td\",null,{\"className\":\"px-4 py-3 text-muted-foreground\",\"children\":\"Auth tokens\"}],[\"$\",\"td\",null,{\"className\":\"px-4 py-3 text-muted-foreground\",\"children\":\"Short TTL, IP binding\"}]]}]]}]]}]}]\n"])</script><script>self.__next_f.push([1,"48:[\"$\",\"h3\",null,{\"id\":\"defense-in-depth\",\"className\":\"scroll-mt-20 text-xl font-semibold text-foreground mt-6 mb-2\",\"children\":\"Defense in Depth\"}]\n59:Ta53,"])</script><script>self.__next_f.push([1,"┌─────────────────────────────────────────────────────────────────────────────┐\n│                    Multi-Layer Protocol Security                             │\n├─────────────────────────────────────────────────────────────────────────────┤\n│                                                                              │\n│   Layer 1: Transport Security                                                │\n│   ├── TLS 1.3 required                                                      │\n│   ├── Certificate pinning                                                   │\n│   └── Perfect forward secrecy                                               │\n│                                                                              │\n│   Layer 2: Application Security                                              │\n│   ├── Request signing (RSA/ECDSA)                                          │\n│   ├── Response encryption                                                   │\n│   └── Integrity verification                                                │\n│                                                                              │\n│   Layer 3: Business Logic                                                    │\n│   ├── Entitlement verification                                              │\n│   ├── Rate limiting                                                         │\n│   └── Anomaly detection                                                     │\n│                                                                              │\n│   Layer 4: Device Trust                                                      │\n│   ├── Device attestation                                                    │\n│   ├── Certificate validation                                                │\n│   └── Revocation checking                                                   │\n│                                                                              │\n└─────────────────────────────────────────────────────────────────────────────┘\n"])</script><script>self.__next_f.push([1,"49:[\"$\",\"code\",null,{\"className\":\"rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground\",\"children\":\"$59\"}]\n4a:[\"$\",\"h2\",null,{\"id\":\"summary\",\"className\":\"scroll-mt-20 text-2xl font-semibold text-foreground mt-8 mb-3 border-b border-border pb-2\",\"children\":\"Summary\"}]\n"])</script><script>self.__next_f.push([1,"4b:[\"$\",\"div\",null,{\"className\":\"my-6 overflow-x-auto rounded-lg border border-border\",\"children\":[\"$\",\"table\",null,{\"className\":\"w-full text-sm\",\"children\":[[\"$\",\"thead\",null,{\"className\":\"bg-muted/50\",\"children\":[\"$\",\"tr\",null,{\"className\":\"border-b border-border last:border-0\",\"children\":[[\"$\",\"th\",null,{\"className\":\"px-4 py-3 text-left font-semibold text-foreground\",\"children\":\"Aspect\"}],[\"$\",\"th\",null,{\"className\":\"px-4 py-3 text-left font-semibold text-foreground\",\"children\":\"Widevine\"}],[\"$\",\"th\",null,{\"className\":\"px-4 py-3 text-left font-semibold text-foreground\",\"children\":\"FairPlay\"}],[\"$\",\"th\",null,{\"className\":\"px-4 py-3 text-left font-semibold text-foreground\",\"children\":\"PlayReady\"}]]}]}],[\"$\",\"tbody\",null,{\"children\":[[\"$\",\"tr\",null,{\"className\":\"border-b border-border last:border-0\",\"children\":[[\"$\",\"td\",null,{\"className\":\"px-4 py-3 text-muted-foreground\",\"children\":\"Protocol Format\"}],[\"$\",\"td\",null,{\"className\":\"px-4 py-3 text-muted-foreground\",\"children\":\"Protobuf (binary)\"}],[\"$\",\"td\",null,{\"className\":\"px-4 py-3 text-muted-foreground\",\"children\":\"TLLV (binary)\"}],[\"$\",\"td\",null,{\"className\":\"px-4 py-3 text-muted-foreground\",\"children\":\"SOAP/REST\"}]]}],[\"$\",\"tr\",null,{\"className\":\"border-b border-border last:border-0\",\"children\":[[\"$\",\"td\",null,{\"className\":\"px-4 py-3 text-muted-foreground\",\"children\":\"Challenge Type\"}],[\"$\",\"td\",null,{\"className\":\"px-4 py-3 text-muted-foreground\",\"children\":\"SignedMessage\"}],[\"$\",\"td\",null,{\"className\":\"px-4 py-3 text-muted-foreground\",\"children\":\"SPC\"}],[\"$\",\"td\",null,{\"className\":\"px-4 py-3 text-muted-foreground\",\"children\":\"LA Record\"}]]}],[\"$\",\"tr\",null,{\"className\":\"border-b border-border last:border-0\",\"children\":[[\"$\",\"td\",null,{\"className\":\"px-4 py-3 text-muted-foreground\",\"children\":\"Response Type\"}],[\"$\",\"td\",null,{\"className\":\"px-4 py-3 text-muted-foreground\",\"children\":\"License\"}],[\"$\",\"td\",null,{\"className\":\"px-4 py-3 text-muted-foreground\",\"children\":\"CKC\"}],[\"$\",\"td\",null,{\"className\":\"px-4 py-3 text-muted-foreground\",\"children\":\"XMR License\"}]]}],[\"$\",\"tr\",null,{\"className\":\"border-b border-border last:border-0\",\"children\":[[\"$\",\"td\",null,{\"className\":\"px-4 py-3 text-muted-foreground\",\"children\":\"Auth Method\"}],[\"$\",\"td\",null,{\"className\":\"px-4 py-3 text-muted-foreground\",\"children\":\"Device certificate\"}],[\"$\",\"td\",null,{\"className\":\"px-4 py-3 text-muted-foreground\",\"children\":\"Device certificate\"}],[\"$\",\"td\",null,{\"className\":\"px-4 py-3 text-muted-foreground\",\"children\":\"Device certificate\"}]]}],[\"$\",\"tr\",null,{\"className\":\"border-b border-border last:border-0\",\"children\":[[\"$\",\"td\",null,{\"className\":\"px-4 py-3 text-muted-foreground\",\"children\":\"Key Encryption\"}],[\"$\",\"td\",null,{\"className\":\"px-4 py-3 text-muted-foreground\",\"children\":\"RSA-OAEP\"}],[\"$\",\"td\",null,{\"className\":\"px-4 py-3 text-muted-foreground\",\"children\":\"AES-CBC\"}],[\"$\",\"td\",null,{\"className\":\"px-4 py-3 text-muted-foreground\",\"children\":\"ECC/AES\"}]]}]]}]]}]}]\n"])</script><script>self.__next_f.push([1,"4c:[\"$\",\"h2\",null,{\"id\":\"next-steps\",\"className\":\"scroll-mt-20 text-2xl font-semibold text-foreground mt-8 mb-3 border-b border-border pb-2\",\"children\":\"Next Steps\"}]\n"])</script><script>self.__next_f.push([1,"4d:[\"$\",\"ul\",null,{\"className\":\"my-4 ml-6 list-disc space-y-2 text-muted-foreground\",\"children\":[\"\\n\",[\"$\",\"li\",null,{\"className\":\"leading-7\",\"children\":[[\"$\",\"strong\",null,{\"className\":\"font-semibold text-foreground\",\"children\":[\"$\",\"a\",null,{\"href\":\"/knowledge-base/widevine\",\"className\":\"text-primary underline underline-offset-4 hover:text-primary/80 transition-colors\",\"target\":\"$undefined\",\"rel\":\"$undefined\",\"children\":\"Widevine Deep Dive\"}]}],\" - Protocol specifics for Widevine\"]}],\"\\n\",[\"$\",\"li\",null,{\"className\":\"leading-7\",\"children\":[[\"$\",\"strong\",null,{\"className\":\"font-semibold text-foreground\",\"children\":[\"$\",\"a\",null,{\"href\":\"/knowledge-base/fairplay\",\"className\":\"text-primary underline underline-offset-4 hover:text-primary/80 transition-colors\",\"target\":\"$undefined\",\"rel\":\"$undefined\",\"children\":\"FairPlay Deep Dive\"}]}],\" - SPC/CKC protocol details\"]}],\"\\n\",[\"$\",\"li\",null,{\"className\":\"leading-7\",\"children\":[[\"$\",\"strong\",null,{\"className\":\"font-semibold text-foreground\",\"children\":[\"$\",\"a\",null,{\"href\":\"/labs/protocol-analysis\",\"className\":\"text-primary underline underline-offset-4 hover:text-primary/80 transition-colors\",\"target\":\"$undefined\",\"rel\":\"$undefined\",\"children\":\"Protocol Lab\"}]}],\" - Hands-on protocol analysis\"]}],\"\\n\",[\"$\",\"li\",null,{\"className\":\"leading-7\",\"children\":[[\"$\",\"strong\",null,{\"className\":\"font-semibold text-foreground\",\"children\":[\"$\",\"a\",null,{\"href\":\"/labs/attacks\",\"className\":\"text-primary underline underline-offset-4 hover:text-primary/80 transition-colors\",\"target\":\"$undefined\",\"rel\":\"$undefined\",\"children\":\"Attack Scenarios\"}]}],\" - Common protocol attacks\"]}],\"\\n\"]}]\n"])</script><script>self.__next_f.push([1,"53:[\"$\",\"code\",null,{\"className\":\"rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground\",\"children\":\"resolution_constraints\"}]\n54:[\"$\",\"td\",null,{\"className\":\"px-4 py-3 text-muted-foreground\",\"children\":\"N/A\"}]\n55:[\"$\",\"td\",null,{\"className\":\"px-4 py-3 text-muted-foreground\",\"children\":[\"$\",\"code\",null,{\"className\":\"rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground\",\"children\":\"MaxRes\"}]}]\n56:[\"$\",\"tr\",null,{\"className\":\"border-b border-border last:border-0\",\"children\":[[\"$\",\"td\",null,{\"className\":\"px-4 py-3 text-muted-foreground\",\"children\":\"Secure Stop\"}],[\"$\",\"td\",null,{\"className\":\"px-4 py-3 text-muted-foreground\",\"children\":\"N/A\"}],[\"$\",\"td\",null,{\"className\":\"px-4 py-3 text-muted-foreground\",\"children\":\"N/A\"}],[\"$\",\"td\",null,{\"className\":\"px-4 py-3 text-muted-foreground\",\"children\":[\"$\",\"code\",null,{\"className\":\"rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground\",\"children\":\"SecureStop\"}]}]]}]\n"])</script><script>self.__next_f.push([1,"a:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n"])</script><script>self.__next_f.push([1,"5a:I[94798,[\"/_next/static/chunks/6dacee62af9f78ce.js\",\"/_next/static/chunks/ba330557940bdbd1.js\"],\"IconMark\"]\n8:null\nc:[[\"$\",\"title\",\"0\",{\"children\":\"License Protocols | DRM Security Lab\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"Deep dive into DRM license acquisition protocols - how keys are securely requested, delivered, and validated.\"}],[\"$\",\"meta\",\"2\",{\"name\":\"author\",\"content\":\"DRM Security Lab\"}],[\"$\",\"meta\",\"3\",{\"name\":\"keywords\",\"content\":\"DRM,Digital Rights Management,Security Research,Widevine,FairPlay,PlayReady,Encryption,Content Protection,Educational\"}],[\"$\",\"meta\",\"4\",{\"property\":\"og:title\",\"content\":\"DRM Security Lab\"}],[\"$\",\"meta\",\"5\",{\"property\":\"og:description\",\"content\":\"Educational DRM security research platform\"}],[\"$\",\"meta\",\"6\",{\"property\":\"og:type\",\"content\":\"website\"}],[\"$\",\"meta\",\"7\",{\"name\":\"twitter:card\",\"content\":\"summary\"}],[\"$\",\"meta\",\"8\",{\"name\":\"twitter:title\",\"content\":\"DRM Security Lab\"}],[\"$\",\"meta\",\"9\",{\"name\":\"twitter:description\",\"content\":\"Educational DRM security research platform\"}],[\"$\",\"link\",\"10\",{\"rel\":\"icon\",\"href\":\"/favicon.ico?favicon.0b3bf435.ico\",\"sizes\":\"256x256\",\"type\":\"image/x-icon\"}],[\"$\",\"$L5a\",\"11\",{}]]\n"])</script></body></html>