1:"$Sreact.fragment"
2:I[2353,["/_next/static/chunks/2c7837371b5f0801.js","/_next/static/chunks/6dacee62af9f78ce.js","/_next/static/chunks/b0b0e24ff49b787a.js","/_next/static/chunks/e87ae7e30c40f8b9.js"],"Header"]
3:I[55920,["/_next/static/chunks/2c7837371b5f0801.js","/_next/static/chunks/6dacee62af9f78ce.js","/_next/static/chunks/b0b0e24ff49b787a.js","/_next/static/chunks/e87ae7e30c40f8b9.js"],"Sidebar"]
4:I[21591,["/_next/static/chunks/2c7837371b5f0801.js","/_next/static/chunks/6dacee62af9f78ce.js","/_next/static/chunks/b0b0e24ff49b787a.js","/_next/static/chunks/e87ae7e30c40f8b9.js"],""]
10:I[50985,["/_next/static/chunks/2c7837371b5f0801.js","/_next/static/chunks/6dacee62af9f78ce.js","/_next/static/chunks/b0b0e24ff49b787a.js","/_next/static/chunks/e87ae7e30c40f8b9.js"],"Separator"]
44:I[92191,["/_next/static/chunks/2c7837371b5f0801.js","/_next/static/chunks/6dacee62af9f78ce.js","/_next/static/chunks/b0b0e24ff49b787a.js","/_next/static/chunks/e87ae7e30c40f8b9.js"],"Footer"]
45:I[9768,["/_next/static/chunks/6dacee62af9f78ce.js","/_next/static/chunks/ba330557940bdbd1.js"],"OutletBoundary"]
46:"$Sreact.suspense"
0:{"buildId":"il8YMQTdw3gKb2FCiC7cm","rsc":["$","$1","c",{"children":[["$","div",null,{"className":"min-h-screen bg-background","children":[["$","$L2",null,{}],["$","div",null,{"className":"flex","children":[["$","$L3",null,{"className":"hidden lg:flex"}],["$","main",null,{"className":"flex-1 p-6 lg:p-8","children":["$","div",null,{"className":"mx-auto max-w-4xl","children":[["$","$L4",null,{"href":"/knowledge-base","className":"mb-6 inline-flex items-center gap-1 text-sm text-muted-foreground hover:text-foreground transition-colors","children":[["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","width":24,"height":24,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-arrow-left h-4 w-4","aria-hidden":"true","children":[["$","path","1l729n",{"d":"m12 19-7-7 7-7"}],["$","path","x3x0zl",{"d":"M19 12H5"}],"$undefined"]}],"Back to Knowledge Base"]}],["$","header",null,{"className":"mb-8","children":[["$","div",null,{"className":"flex flex-wrap items-center gap-2 mb-4","children":[["$","span",null,{"data-slot":"badge","className":"inline-flex items-center justify-center rounded-full border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground","children":"Protocols"}],["$","span",null,{"data-slot":"badge","className":"inline-flex items-center justify-center rounded-full border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden [a&]:hover:bg-accent [a&]:hover:text-accent-foreground bg-orange-500/10 text-orange-500 border-orange-500/30","children":"advanced"}],["$","div",null,{"className":"flex items-center gap-1 text-sm text-muted-foreground","children":[["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","width":24,"height":24,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-clock h-4 w-4","aria-hidden":"true","children":[["$","path","mmk7yg",{"d":"M12 6v6l4 2"}],["$","circle","1mglay",{"cx":"12","cy":"12","r":"10"}],"$undefined"]}],35," min read"]}]]}],["$","h1",null,{"className":"text-4xl font-bold tracking-tight text-foreground mb-4","children":"License Protocols"}],["$","p",null,{"className":"text-lg text-muted-foreground","children":"Deep dive into DRM license acquisition protocols - how keys are securely requested, delivered, and validated."}],["$","div",null,{"className":"mt-4 p-4 rounded-lg border border-border bg-card","children":[["$","div",null,{"className":"flex items-center gap-2 text-sm font-medium text-foreground mb-2","children":[["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","width":24,"height":24,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-book-open h-4 w-4","aria-hidden":"true","children":[["$","path","1akyts",{"d":"M12 7v14"}],["$","path","ruj8y",{"d":"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z"}],"$undefined"]}],"Prerequisites"]}],["$","div",null,{"className":"flex flex-wrap gap-2","children":[["$","$L4","encryption",{"href":"/knowledge-base/encryption","children":["$","span",null,{"data-slot":"badge","className":"inline-flex items-center justify-center rounded-full border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90 cursor-pointer hover:bg-secondary/80","children":"encryption"}]}],"$L5"]}]]}]]}],"$L6","$L7","$L8","$L9","$La"]}]}]]}],"$Lb"]}],["$Lc","$Ld","$Le"],"$Lf"]}],"loading":null,"isPartial":false}
5:["$","$L4","overview",{"href":"/knowledge-base/overview","children":["$","span",null,{"data-slot":"badge","className":"inline-flex items-center justify-center rounded-full border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90 cursor-pointer hover:bg-secondary/80","children":"overview"}]}]
6:["$","$L10",null,{"className":"mb-8"}]
11:T104a,┌─────────────────────────────────────────────────────────────────────────────┐
│                    Generic License Acquisition Flow                          │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│   ┌──────────┐         ┌──────────┐         ┌──────────────┐                │
│   │  Client  │         │  Proxy   │         │   License    │                │
│   │  (CDM)   │         │  Server  │         │    Server    │                │
│   └────┬─────┘         └────┬─────┘         └──────┬───────┘                │
│        │                    │                      │                         │
│        │  1. Parse PSSH     │                      │                         │
│        │  (get key IDs)     │                      │                         │
│        │                    │                      │                         │
│        │  2. Generate       │                      │                         │
│        │  License Request   │                      │                         │
│        │                    │                      │                         │
│        │─────────────────────────────────────────────────────────────────►  │
│        │  3. License Request (encrypted challenge)                          │
│        │                    │                      │                         │
│        │                    │                      │  4. Validate            │
│        │                    │                      │  Device                 │
│        │                    │                      │                         │
│        │                    │                      │  5. Check               │
│        │                    │                      │  Entitlements           │
│        │                    │                      │                         │
│        │◄────────────────────────────────────────────────────────────────   │
│        │  6. License Response (encrypted content keys)                      │
│        │                    │                      │                         │
│        │  7. Decrypt        │                      │                         │
│        │  Response          │                      │                         │
│        │                    │                      │                         │
│        │  8. Store Keys     │                      │                         │
│        │  in CDM            │                      │                         │
│        │                    │                      │                         │
│   └────┴─────┘         └────┴─────┘         └──────┴───────┘                │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
7:["$","article",null,{"className":"prose prose-invert max-w-none","children":[["$","h1",null,{"id":"license-protocols-in-drm","className":"scroll-mt-20 text-3xl font-bold tracking-tight text-foreground mt-8 mb-4","children":"License Protocols in DRM"}],"\n",["$","p",null,{"className":"text-muted-foreground leading-7 mb-4","children":"License protocols are the communication layer between clients and license servers. They handle the secure exchange of content decryption keys while preventing interception and replay attacks."}],"\n",["$","h2",null,{"id":"the-license-acquisition-flow","className":"scroll-mt-20 text-2xl font-semibold text-foreground mt-8 mb-3 border-b border-border pb-2","children":"The License Acquisition Flow"}],"\n",["$","p",null,{"className":"text-muted-foreground leading-7 mb-4","children":"All DRM systems follow a similar high-level flow:"}],"\n",["$","code",null,{"className":"rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground","children":"$11"}],"\n","$L12","\n","$L13","\n","$L14","\n","$L15","\n","$L16","\n","$L17","\n","$L18","\n","$L19","\n","$L1a","\n","$L1b","\n","$L1c","\n","$L1d","\n","$L1e","\n","$L1f","\n","$L20","\n","$L21","\n","$L22","\n","$L23","\n","$L24","\n","$L25","\n","$L26","\n","$L27","\n","$L28","\n","$L29","\n","$L2a","\n","$L2b","\n","$L2c","\n","$L2d","\n","$L2e","\n","$L2f","\n","$L30","\n","$L31","\n","$L32","\n","$L33","\n","$L34","\n","$L35","\n","$L36","\n","$L37","\n","$L38","\n","$L39","\n","$L3a","\n","$L3b","\n","$L3c","\n","$L3d","\n","$L3e","\n","$L3f","\n","$L40","\n","$L41"]}]
8:["$","$L10",null,{"className":"my-8"}]
9:["$","nav",null,{"className":"grid gap-4 sm:grid-cols-2","children":[["$","$L4",null,{"href":"/knowledge-base/encryption","children":["$","div",null,{"data-slot":"card","className":"bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm h-full transition-all hover:border-primary/50","children":["$","div",null,{"data-slot":"card-content","className":"flex items-center gap-3 p-4","children":[["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","width":24,"height":24,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-chevron-left h-5 w-5 text-muted-foreground","aria-hidden":"true","children":[["$","path","1wnfg3",{"d":"m15 18-6-6 6-6"}],"$undefined"]}],["$","div",null,{"children":[["$","div",null,{"className":"text-xs text-muted-foreground","children":"Previous"}],["$","div",null,{"className":"font-medium text-foreground","children":"Encryption Basics"}]]}]]}]}]}],null]}]
a:["$","section",null,{"className":"mt-12","children":[["$","h2",null,{"className":"text-xl font-semibold text-foreground mb-4","children":"Related Articles"}],["$","div",null,{"className":"grid gap-4 sm:grid-cols-3","children":[["$","$L4","widevine",{"href":"/knowledge-base/widevine","children":["$","div",null,{"data-slot":"card","className":"bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm h-full transition-all hover:border-primary/50","children":[["$","div",null,{"data-slot":"card-header","className":"@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6 pb-2","children":[["$","span",null,{"data-slot":"badge","className":"inline-flex items-center justify-center rounded-full border px-2 py-0.5 font-medium whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground w-fit text-xs","children":"DRM Systems"}],["$","div",null,{"data-slot":"card-title","className":"font-semibold text-base mt-2","children":"Widevine DRM"}]]}],["$","div",null,{"data-slot":"card-content","className":"px-6 text-sm text-muted-foreground","children":["Deep dive into Google's Widevine DRM system - architecture, security levels, and how it protects str","..."]}]]}]}],["$","$L4","fairplay",{"href":"/knowledge-base/fairplay","children":["$","div",null,{"data-slot":"card","className":"bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm h-full transition-all hover:border-primary/50","children":[["$","div",null,{"data-slot":"card-header","className":"@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6 pb-2","children":[["$","span",null,{"data-slot":"badge","className":"inline-flex items-center justify-center rounded-full border px-2 py-0.5 font-medium whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground w-fit text-xs","children":"DRM Systems"}],["$","div",null,{"data-slot":"card-title","className":"font-semibold text-base mt-2","children":"FairPlay Streaming"}]]}],["$","div",null,{"data-slot":"card-content","className":"px-6 text-sm text-muted-foreground","children":["Apple's proprietary DRM system for iOS, macOS, and Safari - architecture, HLS integration, and secur","..."]}]]}]}],["$","$L4","playready",{"href":"/knowledge-base/playready","children":["$","div",null,{"data-slot":"card","className":"bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm h-full transition-all hover:border-primary/50","children":[["$","div",null,{"data-slot":"card-header","className":"@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6 pb-2","children":[["$","span",null,{"data-slot":"badge","className":"inline-flex items-center justify-center rounded-full border px-2 py-0.5 font-medium whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground w-fit text-xs","children":"DRM Systems"}],"$L42"]}],"$L43"]}]}]]}]]}]
b:["$","$L44",null,{}]
c:["$","script","script-0",{"src":"/_next/static/chunks/6dacee62af9f78ce.js","async":true}]
d:["$","script","script-1",{"src":"/_next/static/chunks/b0b0e24ff49b787a.js","async":true}]
e:["$","script","script-2",{"src":"/_next/static/chunks/e87ae7e30c40f8b9.js","async":true}]
f:["$","$L45",null,{"children":["$","$46",null,{"name":"Next.MetadataOutlet","children":"$@47"}]}]
12:["$","div",null,{"className":"my-4 rounded-lg border border-border bg-card p-4","children":[["$","div",null,{"className":"flex items-center gap-2 mb-2","children":[["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","width":24,"height":24,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-lightbulb h-4 w-4 text-yellow-500","aria-hidden":"true","children":[["$","path","1gvzjb",{"d":"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5"}],["$","path","x1upvd",{"d":"M9 18h6"}],["$","path","ceow96",{"d":"M10 22h4"}],"$undefined"]}],["$","span",null,{"className":"font-semibold text-foreground","children":"License Challenge"}]]}],["$","div",null,{"className":"text-sm text-muted-foreground","children":["$","p",null,{"className":"text-muted-foreground leading-7 mb-4","children":"The license request (challenge) is an encrypted blob generated by the CDM. It contains device identity, key IDs, and session information - all signed and encrypted to prevent tampering."}]}]]}]
13:["$","h2",null,{"id":"widevine-license-protocol","className":"scroll-mt-20 text-2xl font-semibold text-foreground mt-8 mb-3 border-b border-border pb-2","children":"Widevine License Protocol"}]
14:["$","h3",null,{"id":"protocol-overview","className":"scroll-mt-20 text-xl font-semibold text-foreground mt-6 mb-2","children":"Protocol Overview"}]
15:["$","p",null,{"className":"text-muted-foreground leading-7 mb-4","children":"Widevine uses a binary protocol based on Protocol Buffers (protobuf)."}]
48:T136b,┌─────────────────────────────────────────────────────────────────────────────┐
│                      Widevine License Protocol                               │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│   License Request Structure:                                                 │
│   ┌────────────────────────────────────────────────────────────────────┐    │
│   │ SignedMessage                                                       │    │
│   ├────────────────────────────────────────────────────────────────────┤    │
│   │ type: LICENSE_REQUEST                                              │    │
│   │ msg: LicenseRequest (protobuf)                                     │    │
│   │   ├── client_id: DeviceCertificate                                 │    │
│   │   ├── content_id: KeyID[]                                          │    │
│   │   ├── type: NEW | RENEWAL | RELEASE                                │    │
│   │   ├── request_time: timestamp                                      │    │
│   │   └── protocol_version: 21                                         │    │
│   │ signature: RSA-PSS signature                                       │    │
│   │ session_key: AES-encrypted session key                             │    │
│   └────────────────────────────────────────────────────────────────────┘    │
│                                                                              │
│   License Response Structure:                                                │
│   ┌────────────────────────────────────────────────────────────────────┐    │
│   │ SignedMessage                                                       │    │
│   ├────────────────────────────────────────────────────────────────────┤    │
│   │ type: LICENSE                                                       │    │
│   │ msg: License (protobuf)                                            │    │
│   │   ├── id: LicenseID                                                │    │
│   │   ├── policy: Policy                                               │    │
│   │   │     ├── can_play: bool                                         │    │
│   │   │     ├── can_persist: bool                                      │    │
│   │   │     ├── can_renew: bool                                        │    │
│   │   │     ├── license_duration_seconds                               │    │
│   │   │     └── playback_duration_seconds                              │    │
│   │   └── key: KeyContainer[]                                          │    │
│   │         ├── id: key_id                                             │    │
│   │         ├── iv: initialization_vector                              │    │
│   │         ├── key: encrypted_content_key                             │    │
│   │         └── type: CONTENT | SIGNING | OPERATOR                     │    │
│   │ signature: RSA-PSS signature                                       │    │
│   └────────────────────────────────────────────────────────────────────┘    │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
16:["$","code",null,{"className":"rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground","children":"$48"}]
17:["$","h3",null,{"id":"key-derivation-in-widevine","className":"scroll-mt-20 text-xl font-semibold text-foreground mt-6 mb-2","children":"Key Derivation in Widevine"}]
18:["$","pre",null,{"className":"my-4 overflow-x-auto rounded-lg border border-border bg-zinc-950 p-4","children":["$","code",null,{"className":"text-sm text-zinc-100 language-python","children":"# Conceptual key derivation (simplified)\n\n# 1. Client generates ephemeral key pair\nclient_private, client_public = generate_rsa_keypair(2048)\n\n# 2. License server encrypts content keys with client's public key\nencrypted_content_key = rsa_oaep_encrypt(\n    public_key=client_public,\n    plaintext=content_key\n)\n\n# 3. Client decrypts using private key (inside CDM)\ncontent_key = rsa_oaep_decrypt(\n    private_key=client_private,\n    ciphertext=encrypted_content_key\n)\n"}]}]
19:["$","div",null,{"data-slot":"alert","role":"alert","className":"relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current text-card-foreground my-4 border-red-500/50 bg-red-500/5","children":[["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","width":24,"height":24,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-sword h-4 w-4 text-red-500","aria-hidden":"true","children":[["$","path","s7kpr",{"d":"m11 19-6-6"}],["$","path","1kw20b",{"d":"m5 21-2-2"}],["$","path","1oqv8h",{"d":"m8 16-4 4"}],["$","path","pkxemp",{"d":"M9.5 17.5 21 6V3h-3L6.5 14.5"}],"$undefined"]}],["$","div",null,{"data-slot":"alert-title","className":"col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight text-red-500","children":"Protocol Attack Surface"}],["$","div",null,{"data-slot":"alert-description","className":"col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed text-muted-foreground","children":[["$","p",null,{"className":"text-muted-foreground leading-7 mb-4","children":"Attack vectors on the license protocol:"}],["$","ul",null,{"className":"my-4 ml-6 list-disc space-y-2 text-muted-foreground","children":["\n",["$","li",null,{"className":"leading-7","children":[["$","strong",null,{"className":"font-semibold text-foreground","children":"Request Forgery"}],": Crafting fake license requests with elevated privileges"]}],"\n",["$","li",null,{"className":"leading-7","children":[["$","strong",null,{"className":"font-semibold text-foreground","children":"Response Replay"}],": Reusing captured license responses for different content"]}],"\n",["$","li",null,{"className":"leading-7","children":[["$","strong",null,{"className":"font-semibold text-foreground","children":"MITM on Proxy"}],": If the proxy server doesn't validate properly"]}],"\n",["$","li",null,{"className":"leading-7","children":[["$","strong",null,{"className":"font-semibold text-foreground","children":"Session Key Extraction"}],": Obtaining session keys to decrypt responses"]}],"\n"]}]]}]]}]
1a:["$","div",null,{"data-slot":"alert","role":"alert","className":"relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current text-card-foreground my-4 border-cyan-500/50 bg-cyan-500/5","children":[["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","width":24,"height":24,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-shield h-4 w-4 text-cyan-500","aria-hidden":"true","children":[["$","path","oel41y",{"d":"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z"}],"$undefined"]}],["$","div",null,{"data-slot":"alert-title","className":"col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight text-cyan-500","children":"Protocol Defenses"}],["$","div",null,{"data-slot":"alert-description","className":"col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed text-muted-foreground","children":[["$","p",null,{"className":"text-muted-foreground leading-7 mb-4","children":"Defense mechanisms in the protocol:"}],["$","ul",null,{"className":"my-4 ml-6 list-disc space-y-2 text-muted-foreground","children":["\n",["$","li",null,{"className":"leading-7","children":[["$","strong",null,{"className":"font-semibold text-foreground","children":"Device Binding"}],": Keys tied to specific device certificates"]}],"\n",["$","li",null,{"className":"leading-7","children":[["$","strong",null,{"className":"font-semibold text-foreground","children":"Nonce Freshness"}],": Random values prevent replay attacks"]}],"\n",["$","li",null,{"className":"leading-7","children":[["$","strong",null,{"className":"font-semibold text-foreground","children":"Timestamp Validation"}],": Requests must be within acceptable time window"]}],"\n",["$","li",null,{"className":"leading-7","children":[["$","strong",null,{"className":"font-semibold text-foreground","children":"Certificate Chain Validation"}],": Full PKI verification of device identity"]}],"\n"]}]]}]]}]
1b:["$","h2",null,{"id":"fairplay-license-protocol-spcckc","className":"scroll-mt-20 text-2xl font-semibold text-foreground mt-8 mb-3 border-b border-border pb-2","children":"FairPlay License Protocol (SPC/CKC)"}]
1c:["$","h3",null,{"id":"server-playback-context-spc","className":"scroll-mt-20 text-xl font-semibold text-foreground mt-6 mb-2","children":"Server Playback Context (SPC)"}]
1d:["$","p",null,{"className":"text-muted-foreground leading-7 mb-4","children":"FairPlay uses a unique challenge-response mechanism:"}]
49:T159b,┌─────────────────────────────────────────────────────────────────────────────┐
│                      FairPlay SPC/CKC Flow                                   │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│   ┌─────────────┐                               ┌─────────────────┐         │
│   │   Client    │                               │  Key Server     │         │
│   │  (AVPlayer) │                               │  (Your Server)  │         │
│   └──────┬──────┘                               └────────┬────────┘         │
│          │                                               │                   │
│          │  1. Request Content Key Context               │                   │
│          │      (from playback URL)                      │                   │
│          │                                               │                   │
│          │  2. CDM creates SPC                           │                   │
│          │  ┌─────────────────────────────────┐          │                   │
│          │  │ SPC (Server Playback Context)   │          │                   │
│          │  │ ┌─────────────────────────────┐ │          │                   │
│          │  │ │ Version                     │ │          │                   │
│          │  │ │ Device Certificate          │ │          │                   │
│          │  │ │ Asset ID (Content ID)       │ │          │                   │
│          │  │ │ TLLV (encrypted payload)    │ │          │                   │
│          │  │ │   └── Session key           │ │          │                   │
│          │  │ │   └── Anti-replay data      │ │          │                   │
│          │  │ └─────────────────────────────┘ │          │                   │
│          │  └─────────────────────────────────┘          │                   │
│          │                                               │                   │
│          │  3. Forward SPC ──────────────────────────────►                   │
│          │                                               │                   │
│          │                                  4. Validate SPC                  │
│          │                                  5. Decrypt TLLV                  │
│          │                                  6. Create CKC                    │
│          │                                               │                   │
│          │  ┌─────────────────────────────────┐          │                   │
│          │  │ CKC (Content Key Context)       │          │                   │
│          │  │ ┌─────────────────────────────┐ │          │                   │
│          │  │ │ Content Key (encrypted)     │ │          │                   │
│          │  │ │ Key Duration (rental/buy)   │ │          │                   │
│          │  │ │ HDCP Requirements           │ │          │                   │
│          │  │ │ Persistence allowed?        │ │          │                   │
│          │  │ └─────────────────────────────┘ │◄─────────│                   │
│          │  └─────────────────────────────────┘          │                   │
│          │                                               │                   │
│          │  7. CDM processes CKC                         │                   │
│          │  8. Content key available                     │                   │
│          │                                               │                   │
│   └──────┴──────┘                               └────────┴────────┘         │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
1e:["$","code",null,{"className":"rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground","children":"$49"}]
1f:["$","h3",null,{"id":"fairplay-tllv-structure","className":"scroll-mt-20 text-xl font-semibold text-foreground mt-6 mb-2","children":"FairPlay TLLV Structure"}]
20:["$","code",null,{"className":"rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground","children":"TLLV = Tag-Length-Length-Value (Apple's proprietary format)\n\n┌────────────────────────────────────────────┐\n│ TLLV Container                             │\n├────────────────────────────────────────────┤\n│ Tag (4 bytes)    │ Identifies data type    │\n│ Total Length     │ Full TLLV size          │\n│ Value Length     │ Payload size            │\n│ Value (payload)  │ Actual data             │\n└────────────────────────────────────────────┘\n\nCommon Tags:\n- 0x47a6fc24: Content Key\n- 0x6b68f542: Device Certificate\n- 0x71b5595a: Session Key (encrypted)\n- 0x89c90f5a: Anti-replay hash\n"}]
21:["$","div",null,{"data-slot":"alert","role":"alert","className":"relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current text-card-foreground my-4 border-primary/50 bg-primary/5","children":[["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","width":24,"height":24,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-info h-4 w-4 text-primary","aria-hidden":"true","children":[["$","circle","1mglay",{"cx":"12","cy":"12","r":"10"}],["$","path","1dtifu",{"d":"M12 16v-4"}],["$","path","e9boi3",{"d":"M12 8h.01"}],"$undefined"]}],["$","div",null,{"data-slot":"alert-title","className":"col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight text-primary","children":"Apple's Unique Approach"}],["$","div",null,{"data-slot":"alert-description","className":"col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed text-muted-foreground","children":["$","p",null,{"className":"text-muted-foreground leading-7 mb-4","children":"FairPlay is the only major DRM that requires a Key Security Module (KSM) to be deployed on your own infrastructure. Apple provides the KSM as a software package that you integrate into your key server."}]}]]}]
22:["$","h2",null,{"id":"playready-license-protocol","className":"scroll-mt-20 text-2xl font-semibold text-foreground mt-8 mb-3 border-b border-border pb-2","children":"PlayReady License Protocol"}]
23:["$","h3",null,{"id":"soap-based-protocol-legacy","className":"scroll-mt-20 text-xl font-semibold text-foreground mt-6 mb-2","children":"SOAP-Based Protocol (Legacy)"}]
24:["$","pre",null,{"className":"my-4 overflow-x-auto rounded-lg border border-border bg-zinc-950 p-4","children":["$","code",null,{"className":"text-sm text-zinc-100 language-xml","children":"<!-- PlayReady SOAP License Request -->\n<soap:Envelope>\n  <soap:Header>\n    <PlayReadyHeader>\n      <ClientVersion>4.0.0.0</ClientVersion>\n      <DeviceModel>Edge Browser</DeviceModel>\n    </PlayReadyHeader>\n  </soap:Header>\n  <soap:Body>\n    <AcquireLicense>\n      <challenge>\n        <LA xmlns=\"http://schemas.microsoft.com/DRM/2007/03/protocols\">\n          <ContentHeader>\n            <!-- WRMHEADER with KeyIDs -->\n          </ContentHeader>\n          <ClientInfo>\n            <ClientVersion>4.0</ClientVersion>\n            <SecurityLevel>2000</SecurityLevel>\n          </ClientInfo>\n          <LicenseNonce>randombase64data==</LicenseNonce>\n        </LA>\n      </challenge>\n    </AcquireLicense>\n  </soap:Body>\n</soap:Envelope>\n"}]}]
25:["$","h3",null,{"id":"rest-based-protocol-modern","className":"scroll-mt-20 text-xl font-semibold text-foreground mt-6 mb-2","children":"REST-Based Protocol (Modern)"}]
4a:T137f,┌─────────────────────────────────────────────────────────────────────────────┐
│                    PlayReady REST License Protocol                           │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│   License Request (HTTP POST):                                               │
│   ┌────────────────────────────────────────────────────────────────────┐    │
│   │ Headers:                                                            │    │
│   │   Content-Type: application/octet-stream                           │    │
│   │   ms-playready-client-ver: 4.0                                     │    │
│   │                                                                     │    │
│   │ Body: Binary challenge blob                                        │    │
│   │ ┌────────────────────────────────────────────────────────────────┐ │    │
│   │ │ LA Record (License Acquisition)                                 │ │    │
│   │ │ ├── Record Type: 0x0001                                        │ │    │
│   │ │ ├── Record Length                                              │ │    │
│   │ │ ├── Client Certificate                                          │ │    │
│   │ │ ├── Content Header (KeyIDs)                                     │ │    │
│   │ │ └── Nonce (16 bytes)                                           │ │    │
│   │ └────────────────────────────────────────────────────────────────┘ │    │
│   └────────────────────────────────────────────────────────────────────┘    │
│                                                                              │
│   License Response:                                                          │
│   ┌────────────────────────────────────────────────────────────────────┐    │
│   │ XMR License (XML Rights Management)                                │    │
│   │ ├── License Version                                                │    │
│   │ ├── License ID (GUID)                                             │    │
│   │ ├── Rights:                                                        │    │
│   │ │     ├── Play (with output restrictions)                         │    │
│   │ │     ├── Copy (if allowed)                                       │    │
│   │ │     └── Transfer (domain transfers)                             │    │
│   │ ├── Keys:                                                          │    │
│   │ │     ├── Content Key (encrypted)                                 │    │
│   │ │     └── Key ID                                                  │    │
│   │ └── Restrictions:                                                  │    │
│   │       ├── Begin Date                                              │    │
│   │       ├── End Date                                                │    │
│   │       ├── Secure Stop required                                    │    │
│   │       └── Output Protection Level                                 │    │
│   └────────────────────────────────────────────────────────────────────┘    │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
26:["$","code",null,{"className":"rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground","children":"$4a"}]
27:["$","h2",null,{"id":"protocol-security-mechanisms","className":"scroll-mt-20 text-2xl font-semibold text-foreground mt-8 mb-3 border-b border-border pb-2","children":"Protocol Security Mechanisms"}]
28:["$","h3",null,{"id":"anti-replay-protection","className":"scroll-mt-20 text-xl font-semibold text-foreground mt-6 mb-2","children":"Anti-Replay Protection"}]
4b:Tf2c,┌─────────────────────────────────────────────────────────────────────────────┐
│                    Anti-Replay Mechanisms                                    │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│   1. NONCE (Number Used Once)                                               │
│   ┌────────────────────────────────────────────────────────────────────┐    │
│   │ Request:  { nonce: "abc123...", timestamp: 1703001234 }            │    │
│   │ Response: { nonce: "abc123...", server_nonce: "xyz789..." }        │    │
│   │                                                                     │    │
│   │ Server stores used nonces for expiration window                    │    │
│   │ Reused nonce = Replay attack detected                              │    │
│   └────────────────────────────────────────────────────────────────────┘    │
│                                                                              │
│   2. Timestamp Binding                                                       │
│   ┌────────────────────────────────────────────────────────────────────┐    │
│   │ Request must be within ±5 minutes of server time                   │    │
│   │ Prevents storing requests for later use                            │    │
│   │                                                                     │    │
│   │ if abs(server_time - request_time) > 300:                          │    │
│   │     reject("Request expired")                                      │    │
│   └────────────────────────────────────────────────────────────────────┘    │
│                                                                              │
│   3. Session Binding                                                         │
│   ┌────────────────────────────────────────────────────────────────────┐    │
│   │ Each playback session has unique session ID                        │    │
│   │ Response keys are encrypted to session-specific key                │    │
│   │ Response cannot be used in different session                       │    │
│   └────────────────────────────────────────────────────────────────────┘    │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
29:["$","code",null,{"className":"rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground","children":"$4b"}]
2a:["$","h3",null,{"id":"device-authentication","className":"scroll-mt-20 text-xl font-semibold text-foreground mt-6 mb-2","children":"Device Authentication"}]
4c:Tbff,┌─────────────────────────────────────────────────────────────────────────────┐
│                    Device Authentication Flow                                │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│   Device Certificate Chain:                                                  │
│                                                                              │
│   ┌────────────────┐                                                        │
│   │   Root CA      │  ← Hardcoded in license server                        │
│   │  (DRM vendor)  │                                                        │
│   └───────┬────────┘                                                        │
│           │ Signs                                                            │
│   ┌───────▼────────┐                                                        │
│   │ Intermediate   │  ← Model-level (OEM/manufacturer)                      │
│   │ Certificate    │                                                        │
│   └───────┬────────┘                                                        │
│           │ Signs                                                            │
│   ┌───────▼────────┐                                                        │
│   │    Device      │  ← Unique per device/browser                           │
│   │  Certificate   │                                                        │
│   └────────────────┘                                                        │
│                                                                              │
│   Validation:                                                                │
│   1. Verify signature chain to trusted root                                 │
│   2. Check certificate not revoked (CRL/OCSP)                              │
│   3. Verify device hasn't been blacklisted                                  │
│   4. Check security level meets content requirements                        │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
2b:["$","code",null,{"className":"rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground","children":"$4c"}]
2c:["$","div",null,{"data-slot":"alert","role":"alert","className":"relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current text-card-foreground my-4 border-yellow-500/50 bg-yellow-500/5","children":[["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","width":24,"height":24,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-triangle-alert h-4 w-4 text-yellow-500","aria-hidden":"true","children":[["$","path","wmoenq",{"d":"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3"}],["$","path","juzpu7",{"d":"M12 9v4"}],["$","path","p32p05",{"d":"M12 17h.01"}],"$undefined"]}],["$","div",null,{"data-slot":"alert-title","className":"col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight text-yellow-500","children":"Revocation Lists"}],["$","div",null,{"data-slot":"alert-description","className":"col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed text-muted-foreground","children":["$","p",null,{"className":"text-muted-foreground leading-7 mb-4","children":"DRM vendors maintain revocation lists (CRL) of compromised devices. When a CDM is cracked, all devices using that CDM version can be revoked, breaking playback until users update."}]}]]}]
2d:["$","h2",null,{"id":"license-policy-enforcement","className":"scroll-mt-20 text-2xl font-semibold text-foreground mt-8 mb-3 border-b border-border pb-2","children":"License Policy Enforcement"}]
2e:["$","h3",null,{"id":"policy-attributes","className":"scroll-mt-20 text-xl font-semibold text-foreground mt-6 mb-2","children":"Policy Attributes"}]
2f:["$","div",null,{"className":"my-6 overflow-x-auto rounded-lg border border-border","children":["$","table",null,{"className":"w-full text-sm","children":[["$","thead",null,{"className":"bg-muted/50","children":["$","tr",null,{"className":"border-b border-border last:border-0","children":[["$","th",null,{"className":"px-4 py-3 text-left font-semibold text-foreground","children":"Policy"}],["$","th",null,{"className":"px-4 py-3 text-left font-semibold text-foreground","children":"Widevine"}],["$","th",null,{"className":"px-4 py-3 text-left font-semibold text-foreground","children":"FairPlay"}],["$","th",null,{"className":"px-4 py-3 text-left font-semibold text-foreground","children":"PlayReady"}]]}]}],["$","tbody",null,{"children":[["$","tr",null,{"className":"border-b border-border last:border-0","children":[["$","td",null,{"className":"px-4 py-3 text-muted-foreground","children":"License Duration"}],["$","td",null,{"className":"px-4 py-3 text-muted-foreground","children":["$","code",null,{"className":"rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground","children":"license_duration_seconds"}]}],["$","td",null,{"className":"px-4 py-3 text-muted-foreground","children":["$","code",null,{"className":"rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground","children":"ckc-duration"}]}],["$","td",null,{"className":"px-4 py-3 text-muted-foreground","children":["$","code",null,{"className":"rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground","children":"BeginDate/EndDate"}]}]]}],["$","tr",null,{"className":"border-b border-border last:border-0","children":[["$","td",null,{"className":"px-4 py-3 text-muted-foreground","children":"Playback Duration"}],["$","td",null,{"className":"px-4 py-3 text-muted-foreground","children":["$","code",null,{"className":"rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground","children":"playback_duration_seconds"}]}],["$","td",null,{"className":"px-4 py-3 text-muted-foreground","children":["$","code",null,{"className":"rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground","children":"ckc-playback-duration"}]}],["$","td",null,{"className":"px-4 py-3 text-muted-foreground","children":["$","code",null,{"className":"rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground","children":"PlayStart/PlayEnd"}]}]]}],["$","tr",null,{"className":"border-b border-border last:border-0","children":[["$","td",null,{"className":"px-4 py-3 text-muted-foreground","children":"Offline Allowed"}],["$","td",null,{"className":"px-4 py-3 text-muted-foreground","children":["$","code",null,{"className":"rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground","children":"can_persist"}]}],["$","td",null,{"className":"px-4 py-3 text-muted-foreground","children":["$","code",null,{"className":"rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground","children":"persistence-allowed"}]}],["$","td",null,{"className":"px-4 py-3 text-muted-foreground","children":["$","code",null,{"className":"rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground","children":"License.Store"}]}]]}],["$","tr",null,{"className":"border-b border-border last:border-0","children":[["$","td",null,{"className":"px-4 py-3 text-muted-foreground","children":"HDCP Required"}],["$","td",null,{"className":"px-4 py-3 text-muted-foreground","children":["$","code",null,{"className":"rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground","children":"hdcp_version"}]}],["$","td",null,{"className":"px-4 py-3 text-muted-foreground","children":["$","code",null,{"className":"rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground","children":"output-protection"}]}],["$","td",null,{"className":"px-4 py-3 text-muted-foreground","children":["$","code",null,{"className":"rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground","children":"MinimumCompressedDigitalVideoOPL"}]}]]}],["$","tr",null,{"className":"border-b border-border last:border-0","children":[["$","td",null,{"className":"px-4 py-3 text-muted-foreground","children":"Max Resolution"}],["$","td",null,{"className":"px-4 py-3 text-muted-foreground","children":"$L4d"}],"$L4e","$L4f"]}],"$L50"]}]]}]}]
30:["$","h3",null,{"id":"output-protection-levels","className":"scroll-mt-20 text-xl font-semibold text-foreground mt-6 mb-2","children":"Output Protection Levels"}]
51:T849,┌─────────────────────────────────────────────────────────────────────────────┐
│                    Output Protection Requirements                            │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│   Resolution        HDCP Requirement        Typical Policy                   │
│   ──────────────────────────────────────────────────────────────────────    │
│   SD (480p)         None                    Basic protection                 │
│   HD (720p)         HDCP 1.4               Moderate protection              │
│   Full HD (1080p)   HDCP 2.0               Standard protection              │
│   4K UHD            HDCP 2.2               High protection                  │
│   4K HDR            HDCP 2.2 + HW TEE      Maximum protection               │
│                                                                              │
│   If output protection check fails:                                          │
│   - Downgrade resolution to allowed level                                   │
│   - Block playback entirely                                                 │
│   - Disable specific outputs (e.g., HDMI)                                   │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
31:["$","code",null,{"className":"rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground","children":"$51"}]
32:["$","div",null,{"data-slot":"alert","role":"alert","className":"relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current text-card-foreground my-4 border-red-500/50 bg-red-500/5","children":[["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","width":24,"height":24,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-sword h-4 w-4 text-red-500","aria-hidden":"true","children":[["$","path","s7kpr",{"d":"m11 19-6-6"}],["$","path","1kw20b",{"d":"m5 21-2-2"}],["$","path","1oqv8h",{"d":"m8 16-4 4"}],["$","path","pkxemp",{"d":"M9.5 17.5 21 6V3h-3L6.5 14.5"}],"$undefined"]}],["$","div",null,{"data-slot":"alert-title","className":"col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight text-red-500","children":"Policy Bypass Techniques"}],["$","div",null,{"data-slot":"alert-description","className":"col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed text-muted-foreground","children":[["$","p",null,{"className":"text-muted-foreground leading-7 mb-4","children":"Attackers target policy enforcement:"}],["$","ul",null,{"className":"my-4 ml-6 list-disc space-y-2 text-muted-foreground","children":["\n",["$","li",null,{"className":"leading-7","children":[["$","strong",null,{"className":"font-semibold text-foreground","children":"Modified CDMs"}],": Patched to ignore output restrictions"]}],"\n",["$","li",null,{"className":"leading-7","children":[["$","strong",null,{"className":"font-semibold text-foreground","children":"Virtual HDCP"}],": Fake HDCP handshakes to satisfy checks"]}],"\n",["$","li",null,{"className":"leading-7","children":[["$","strong",null,{"className":"font-semibold text-foreground","children":"Resolution spoofing"}],": Report lower resolution to get easier policy"]}],"\n",["$","li",null,{"className":"leading-7","children":[["$","strong",null,{"className":"font-semibold text-foreground","children":"Clock manipulation"}],": Change system time for expired licenses"]}],"\n"]}]]}]]}]
33:["$","div",null,{"data-slot":"alert","role":"alert","className":"relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current text-card-foreground my-4 border-cyan-500/50 bg-cyan-500/5","children":[["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","width":24,"height":24,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-shield h-4 w-4 text-cyan-500","aria-hidden":"true","children":[["$","path","oel41y",{"d":"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z"}],"$undefined"]}],["$","div",null,{"data-slot":"alert-title","className":"col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight text-cyan-500","children":"Secure Policy Enforcement"}],["$","div",null,{"data-slot":"alert-description","className":"col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed text-muted-foreground","children":[["$","p",null,{"className":"text-muted-foreground leading-7 mb-4","children":"Robust policy enforcement requires:"}],["$","ul",null,{"className":"my-4 ml-6 list-disc space-y-2 text-muted-foreground","children":["\n",["$","li",null,{"className":"leading-7","children":[["$","strong",null,{"className":"font-semibold text-foreground","children":"Hardware TEE"}],": Policy checks inside secure enclave"]}],"\n",["$","li",null,{"className":"leading-7","children":[["$","strong",null,{"className":"font-semibold text-foreground","children":"Attestation"}],": Verify device hasn't been tampered with"]}],"\n",["$","li",null,{"className":"leading-7","children":[["$","strong",null,{"className":"font-semibold text-foreground","children":"Secure time"}],": Use secure clock for expiration checks"]}],"\n",["$","li",null,{"className":"leading-7","children":[["$","strong",null,{"className":"font-semibold text-foreground","children":"Regular updates"}],": Push CDM updates to close bypasses"]}],"\n"]}]]}]]}]
34:["$","h2",null,{"id":"multi-key-and-key-rotation","className":"scroll-mt-20 text-2xl font-semibold text-foreground mt-8 mb-3 border-b border-border pb-2","children":"Multi-Key and Key Rotation"}]
35:["$","h3",null,{"id":"multi-key-content","className":"scroll-mt-20 text-xl font-semibold text-foreground mt-6 mb-2","children":"Multi-Key Content"}]
52:Ta2f,┌─────────────────────────────────────────────────────────────────────────────┐
│                    Multi-Key Encryption                                      │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│   Content with multiple quality levels:                                      │
│                                                                              │
│   ┌─────────────────────────────────────────────────────────────────────┐   │
│   │ Video Stream                                                         │   │
│   ├─────────────────────────────────────────────────────────────────────┤   │
│   │ 4K HDR  │ Key ID: abc-001 │ Policy: L1 only, HDCP 2.2              │   │
│   │ 1080p   │ Key ID: abc-002 │ Policy: L1/L2, HDCP 2.0                │   │
│   │ 720p    │ Key ID: abc-003 │ Policy: L1/L2/L3, HDCP 1.4             │   │
│   │ 480p    │ Key ID: abc-004 │ Policy: Any level, no HDCP             │   │
│   └─────────────────────────────────────────────────────────────────────┘   │
│                                                                              │
│   License server provides keys based on device security level               │
│   L3 device only gets key abc-004                                           │
│   L1 device gets all keys                                                   │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
36:["$","code",null,{"className":"rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground","children":"$52"}]
37:["$","h3",null,{"id":"key-rotation","className":"scroll-mt-20 text-xl font-semibold text-foreground mt-6 mb-2","children":"Key Rotation"}]
38:["$","code",null,{"className":"rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground","children":"Time-Based Key Rotation:\n\nSegment 1-100:    Key A (KID: key-001)\nSegment 101-200:  Key B (KID: key-002)\nSegment 201-300:  Key C (KID: key-003)\n...\n\n┌──────────────────────────────────────────────────────────────────────┐\n│ Benefits:                                                             │\n│ - Limits damage if key is extracted (only that segment range)        │\n│ - Enables mid-stream policy changes                                  │\n│ - Supports ad insertion with different key policies                  │\n│                                                                       │\n│ Challenges:                                                           │\n│ - More license requests needed                                       │\n│ - Client must handle seamless key transitions                        │\n│ - Increased server load                                              │\n└──────────────────────────────────────────────────────────────────────┘\n"}]
39:["$","h2",null,{"id":"protocol-vulnerabilities-and-defenses","className":"scroll-mt-20 text-2xl font-semibold text-foreground mt-8 mb-3 border-b border-border pb-2","children":"Protocol Vulnerabilities and Defenses"}]
3a:["$","h3",null,{"id":"common-attack-patterns","className":"scroll-mt-20 text-xl font-semibold text-foreground mt-6 mb-2","children":"Common Attack Patterns"}]
3b:["$","div",null,{"className":"my-6 overflow-x-auto rounded-lg border border-border","children":["$","table",null,{"className":"w-full text-sm","children":[["$","thead",null,{"className":"bg-muted/50","children":["$","tr",null,{"className":"border-b border-border last:border-0","children":[["$","th",null,{"className":"px-4 py-3 text-left font-semibold text-foreground","children":"Attack"}],["$","th",null,{"className":"px-4 py-3 text-left font-semibold text-foreground","children":"Target"}],["$","th",null,{"className":"px-4 py-3 text-left font-semibold text-foreground","children":"Mitigation"}]]}]}],["$","tbody",null,{"children":[["$","tr",null,{"className":"border-b border-border last:border-0","children":[["$","td",null,{"className":"px-4 py-3 text-muted-foreground","children":"Request Tampering"}],["$","td",null,{"className":"px-4 py-3 text-muted-foreground","children":"License challenge"}],["$","td",null,{"className":"px-4 py-3 text-muted-foreground","children":"Signature verification"}]]}],["$","tr",null,{"className":"border-b border-border last:border-0","children":[["$","td",null,{"className":"px-4 py-3 text-muted-foreground","children":"Response Replay"}],["$","td",null,{"className":"px-4 py-3 text-muted-foreground","children":"License response"}],["$","td",null,{"className":"px-4 py-3 text-muted-foreground","children":"Nonce binding, timestamps"}]]}],["$","tr",null,{"className":"border-b border-border last:border-0","children":[["$","td",null,{"className":"px-4 py-3 text-muted-foreground","children":"Man-in-the-Middle"}],["$","td",null,{"className":"px-4 py-3 text-muted-foreground","children":"Network layer"}],["$","td",null,{"className":"px-4 py-3 text-muted-foreground","children":"TLS pinning, certificate validation"}]]}],["$","tr",null,{"className":"border-b border-border last:border-0","children":[["$","td",null,{"className":"px-4 py-3 text-muted-foreground","children":"Downgrade Attack"}],["$","td",null,{"className":"px-4 py-3 text-muted-foreground","children":"Protocol version"}],["$","td",null,{"className":"px-4 py-3 text-muted-foreground","children":"Minimum version requirements"}]]}],["$","tr",null,{"className":"border-b border-border last:border-0","children":[["$","td",null,{"className":"px-4 py-3 text-muted-foreground","children":"Token Theft"}],["$","td",null,{"className":"px-4 py-3 text-muted-foreground","children":"Auth tokens"}],["$","td",null,{"className":"px-4 py-3 text-muted-foreground","children":"Short TTL, IP binding"}]]}]]}]]}]}]
3c:["$","h3",null,{"id":"defense-in-depth","className":"scroll-mt-20 text-xl font-semibold text-foreground mt-6 mb-2","children":"Defense in Depth"}]
53:Ta53,┌─────────────────────────────────────────────────────────────────────────────┐
│                    Multi-Layer Protocol Security                             │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│   Layer 1: Transport Security                                                │
│   ├── TLS 1.3 required                                                      │
│   ├── Certificate pinning                                                   │
│   └── Perfect forward secrecy                                               │
│                                                                              │
│   Layer 2: Application Security                                              │
│   ├── Request signing (RSA/ECDSA)                                          │
│   ├── Response encryption                                                   │
│   └── Integrity verification                                                │
│                                                                              │
│   Layer 3: Business Logic                                                    │
│   ├── Entitlement verification                                              │
│   ├── Rate limiting                                                         │
│   └── Anomaly detection                                                     │
│                                                                              │
│   Layer 4: Device Trust                                                      │
│   ├── Device attestation                                                    │
│   ├── Certificate validation                                                │
│   └── Revocation checking                                                   │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
3d:["$","code",null,{"className":"rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground","children":"$53"}]
3e:["$","h2",null,{"id":"summary","className":"scroll-mt-20 text-2xl font-semibold text-foreground mt-8 mb-3 border-b border-border pb-2","children":"Summary"}]
3f:["$","div",null,{"className":"my-6 overflow-x-auto rounded-lg border border-border","children":["$","table",null,{"className":"w-full text-sm","children":[["$","thead",null,{"className":"bg-muted/50","children":["$","tr",null,{"className":"border-b border-border last:border-0","children":[["$","th",null,{"className":"px-4 py-3 text-left font-semibold text-foreground","children":"Aspect"}],["$","th",null,{"className":"px-4 py-3 text-left font-semibold text-foreground","children":"Widevine"}],["$","th",null,{"className":"px-4 py-3 text-left font-semibold text-foreground","children":"FairPlay"}],["$","th",null,{"className":"px-4 py-3 text-left font-semibold text-foreground","children":"PlayReady"}]]}]}],["$","tbody",null,{"children":[["$","tr",null,{"className":"border-b border-border last:border-0","children":[["$","td",null,{"className":"px-4 py-3 text-muted-foreground","children":"Protocol Format"}],["$","td",null,{"className":"px-4 py-3 text-muted-foreground","children":"Protobuf (binary)"}],["$","td",null,{"className":"px-4 py-3 text-muted-foreground","children":"TLLV (binary)"}],["$","td",null,{"className":"px-4 py-3 text-muted-foreground","children":"SOAP/REST"}]]}],["$","tr",null,{"className":"border-b border-border last:border-0","children":[["$","td",null,{"className":"px-4 py-3 text-muted-foreground","children":"Challenge Type"}],["$","td",null,{"className":"px-4 py-3 text-muted-foreground","children":"SignedMessage"}],["$","td",null,{"className":"px-4 py-3 text-muted-foreground","children":"SPC"}],["$","td",null,{"className":"px-4 py-3 text-muted-foreground","children":"LA Record"}]]}],["$","tr",null,{"className":"border-b border-border last:border-0","children":[["$","td",null,{"className":"px-4 py-3 text-muted-foreground","children":"Response Type"}],["$","td",null,{"className":"px-4 py-3 text-muted-foreground","children":"License"}],["$","td",null,{"className":"px-4 py-3 text-muted-foreground","children":"CKC"}],["$","td",null,{"className":"px-4 py-3 text-muted-foreground","children":"XMR License"}]]}],["$","tr",null,{"className":"border-b border-border last:border-0","children":[["$","td",null,{"className":"px-4 py-3 text-muted-foreground","children":"Auth Method"}],["$","td",null,{"className":"px-4 py-3 text-muted-foreground","children":"Device certificate"}],["$","td",null,{"className":"px-4 py-3 text-muted-foreground","children":"Device certificate"}],["$","td",null,{"className":"px-4 py-3 text-muted-foreground","children":"Device certificate"}]]}],["$","tr",null,{"className":"border-b border-border last:border-0","children":[["$","td",null,{"className":"px-4 py-3 text-muted-foreground","children":"Key Encryption"}],["$","td",null,{"className":"px-4 py-3 text-muted-foreground","children":"RSA-OAEP"}],["$","td",null,{"className":"px-4 py-3 text-muted-foreground","children":"AES-CBC"}],["$","td",null,{"className":"px-4 py-3 text-muted-foreground","children":"ECC/AES"}]]}]]}]]}]}]
40:["$","h2",null,{"id":"next-steps","className":"scroll-mt-20 text-2xl font-semibold text-foreground mt-8 mb-3 border-b border-border pb-2","children":"Next Steps"}]
41:["$","ul",null,{"className":"my-4 ml-6 list-disc space-y-2 text-muted-foreground","children":["\n",["$","li",null,{"className":"leading-7","children":[["$","strong",null,{"className":"font-semibold text-foreground","children":["$","a",null,{"href":"/knowledge-base/widevine","className":"text-primary underline underline-offset-4 hover:text-primary/80 transition-colors","children":"Widevine Deep Dive"}]}]," - Protocol specifics for Widevine"]}],"\n",["$","li",null,{"className":"leading-7","children":[["$","strong",null,{"className":"font-semibold text-foreground","children":["$","a",null,{"href":"/knowledge-base/fairplay","className":"text-primary underline underline-offset-4 hover:text-primary/80 transition-colors","children":"FairPlay Deep Dive"}]}]," - SPC/CKC protocol details"]}],"\n",["$","li",null,{"className":"leading-7","children":[["$","strong",null,{"className":"font-semibold text-foreground","children":["$","a",null,{"href":"/labs/protocol-analysis","className":"text-primary underline underline-offset-4 hover:text-primary/80 transition-colors","children":"Protocol Lab"}]}]," - Hands-on protocol analysis"]}],"\n",["$","li",null,{"className":"leading-7","children":[["$","strong",null,{"className":"font-semibold text-foreground","children":["$","a",null,{"href":"/labs/attacks","className":"text-primary underline underline-offset-4 hover:text-primary/80 transition-colors","children":"Attack Scenarios"}]}]," - Common protocol attacks"]}],"\n"]}]
42:["$","div",null,{"data-slot":"card-title","className":"font-semibold text-base mt-2","children":"PlayReady DRM"}]
43:["$","div",null,{"data-slot":"card-content","className":"px-6 text-sm text-muted-foreground","children":["Microsoft's enterprise DRM solution for Windows, Xbox, and smart devices - architecture, licensing, ","..."]}]
47:null
4d:["$","code",null,{"className":"rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground","children":"resolution_constraints"}]
4e:["$","td",null,{"className":"px-4 py-3 text-muted-foreground","children":"N/A"}]
4f:["$","td",null,{"className":"px-4 py-3 text-muted-foreground","children":["$","code",null,{"className":"rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground","children":"MaxRes"}]}]
50:["$","tr",null,{"className":"border-b border-border last:border-0","children":[["$","td",null,{"className":"px-4 py-3 text-muted-foreground","children":"Secure Stop"}],["$","td",null,{"className":"px-4 py-3 text-muted-foreground","children":"N/A"}],["$","td",null,{"className":"px-4 py-3 text-muted-foreground","children":"N/A"}],["$","td",null,{"className":"px-4 py-3 text-muted-foreground","children":["$","code",null,{"className":"rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground","children":"SecureStop"}]}]]}]
