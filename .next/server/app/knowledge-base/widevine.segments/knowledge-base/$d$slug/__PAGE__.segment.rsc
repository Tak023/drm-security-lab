1:"$Sreact.fragment"
2:I[2353,["/_next/static/chunks/2c7837371b5f0801.js","/_next/static/chunks/6dacee62af9f78ce.js","/_next/static/chunks/b0b0e24ff49b787a.js","/_next/static/chunks/e87ae7e30c40f8b9.js"],"Header"]
3:I[55920,["/_next/static/chunks/2c7837371b5f0801.js","/_next/static/chunks/6dacee62af9f78ce.js","/_next/static/chunks/b0b0e24ff49b787a.js","/_next/static/chunks/e87ae7e30c40f8b9.js"],"Sidebar"]
4:I[21591,["/_next/static/chunks/2c7837371b5f0801.js","/_next/static/chunks/6dacee62af9f78ce.js","/_next/static/chunks/b0b0e24ff49b787a.js","/_next/static/chunks/e87ae7e30c40f8b9.js"],""]
5:I[50985,["/_next/static/chunks/2c7837371b5f0801.js","/_next/static/chunks/6dacee62af9f78ce.js","/_next/static/chunks/b0b0e24ff49b787a.js","/_next/static/chunks/e87ae7e30c40f8b9.js"],"Separator"]
55:I[92191,["/_next/static/chunks/2c7837371b5f0801.js","/_next/static/chunks/6dacee62af9f78ce.js","/_next/static/chunks/b0b0e24ff49b787a.js","/_next/static/chunks/e87ae7e30c40f8b9.js"],"Footer"]
56:I[9768,["/_next/static/chunks/6dacee62af9f78ce.js","/_next/static/chunks/ba330557940bdbd1.js"],"OutletBoundary"]
57:"$Sreact.suspense"
6:T8a5,┌─────────────────────────────────────────────────────────────────┐
│                    Widevine Architecture                         │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  ┌──────────────┐    ┌──────────────┐    ┌──────────────┐       │
│  │   Widevine   │    │   License    │    │   Content    │       │
│  │     CDM      │◄──►│    Server    │◄──►│   Backend    │       │
│  └──────────────┘    └──────────────┘    └──────────────┘       │
│         │                                                        │
│         ▼                                                        │
│  ┌──────────────┐                                               │
│  │    OEMCrypto │  (Hardware abstraction layer)                 │
│  └──────────────┘                                               │
│         │                                                        │
│         ▼                                                        │
│  ┌──────────────┐                                               │
│  │     TEE      │  (Trusted Execution Environment)              │
│  └──────────────┘                                               │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
0:{"buildId":"il8YMQTdw3gKb2FCiC7cm","rsc":["$","$1","c",{"children":[["$","div",null,{"className":"min-h-screen bg-background","children":[["$","$L2",null,{}],["$","div",null,{"className":"flex","children":[["$","$L3",null,{"className":"hidden lg:flex"}],["$","main",null,{"className":"flex-1 p-6 lg:p-8","children":["$","div",null,{"className":"mx-auto max-w-4xl","children":[["$","$L4",null,{"href":"/knowledge-base","className":"mb-6 inline-flex items-center gap-1 text-sm text-muted-foreground hover:text-foreground transition-colors","children":[["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","width":24,"height":24,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-arrow-left h-4 w-4","aria-hidden":"true","children":[["$","path","1l729n",{"d":"m12 19-7-7 7-7"}],["$","path","x3x0zl",{"d":"M19 12H5"}],"$undefined"]}],"Back to Knowledge Base"]}],["$","header",null,{"className":"mb-8","children":[["$","div",null,{"className":"flex flex-wrap items-center gap-2 mb-4","children":[["$","span",null,{"data-slot":"badge","className":"inline-flex items-center justify-center rounded-full border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground","children":"DRM Systems"}],["$","span",null,{"data-slot":"badge","className":"inline-flex items-center justify-center rounded-full border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden [a&]:hover:bg-accent [a&]:hover:text-accent-foreground bg-yellow-500/10 text-yellow-500 border-yellow-500/30","children":"intermediate"}],["$","div",null,{"className":"flex items-center gap-1 text-sm text-muted-foreground","children":[["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","width":24,"height":24,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-clock h-4 w-4","aria-hidden":"true","children":[["$","path","mmk7yg",{"d":"M12 6v6l4 2"}],["$","circle","1mglay",{"cx":"12","cy":"12","r":"10"}],"$undefined"]}],25," min read"]}]]}],["$","h1",null,{"className":"text-4xl font-bold tracking-tight text-foreground mb-4","children":"Widevine DRM"}],["$","p",null,{"className":"text-lg text-muted-foreground","children":"Deep dive into Google's Widevine DRM system - architecture, security levels, and how it protects streaming content."}],"$undefined"]}],["$","$L5",null,{"className":"mb-8"}],["$","article",null,{"className":"prose prose-invert max-w-none","children":[["$","h1",null,{"id":"widevine-drm","className":"scroll-mt-20 text-3xl font-bold tracking-tight text-foreground mt-8 mb-4","children":"Widevine DRM"}],"\n",["$","p",null,{"className":"text-muted-foreground leading-7 mb-4","children":"Widevine is Google's DRM technology, acquired in 2010 and now integrated across the Android ecosystem, Chrome browser, and countless smart TVs and streaming devices. It's the most widely deployed DRM system globally."}],"\n",["$","h2",null,{"id":"architecture-overview","className":"scroll-mt-20 text-2xl font-semibold text-foreground mt-8 mb-3 border-b border-border pb-2","children":"Architecture Overview"}],"\n",["$","p",null,{"className":"text-muted-foreground leading-7 mb-4","children":"Widevine consists of three main components:"}],"\n",["$","code",null,{"className":"rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground","children":"$6"}],"\n","$L7","\n","$L8","\n","$L9","\n","$La","\n","$Lb","\n","$Lc","\n","$Ld","\n","$Le","\n","$Lf","\n","$L10","\n","$L11","\n","$L12","\n","$L13","\n","$L14","\n","$L15","\n","$L16","\n","$L17","\n","$L18","\n","$L19","\n","$L1a","\n","$L1b","\n","$L1c","\n","$L1d","\n","$L1e","\n","$L1f","\n","$L20","\n","$L21","\n","$L22","\n","$L23","\n","$L24","\n","$L25","\n","$L26","\n","$L27","\n","$L28","\n","$L29","\n","$L2a","\n","$L2b","\n","$L2c","\n","$L2d","\n","$L2e","\n","$L2f","\n","$L30","\n","$L31","\n","$L32","\n","$L33","\n","$L34","\n","$L35","\n","$L36","\n","$L37","\n","$L38","\n","$L39","\n","$L3a","\n","$L3b","\n","$L3c","\n","$L3d","\n","$L3e","\n","$L3f","\n","$L40","\n","$L41","\n","$L42","\n","$L43","\n","$L44","\n","$L45","\n","$L46","\n","$L47","\n","$L48","\n","$L49","\n","$L4a"]}],"$L4b","$L4c","$L4d"]}]}]]}],"$L4e"]}],["$L4f","$L50","$L51"],"$L52"]}],"loading":null,"isPartial":false}
7:["$","h3",null,{"id":"content-decryption-module-cdm","className":"scroll-mt-20 text-xl font-semibold text-foreground mt-6 mb-2","children":"Content Decryption Module (CDM)"}]
8:["$","p",null,{"className":"text-muted-foreground leading-7 mb-4","children":"The CDM is a software module that handles:"}]
9:["$","ul",null,{"className":"my-4 ml-6 list-disc space-y-2 text-muted-foreground","children":["\n",["$","li",null,{"className":"leading-7","children":"License request generation"}],"\n",["$","li",null,{"className":"leading-7","children":"License response processing"}],"\n",["$","li",null,{"className":"leading-7","children":"Key management"}],"\n",["$","li",null,{"className":"leading-7","children":"Decryption operations (L3) or delegation to hardware (L1/L2)"}],"\n"]}]
a:["$","div",null,{"className":"my-4 rounded-lg border border-border bg-card p-4","children":[["$","div",null,{"className":"flex items-center gap-2 mb-2","children":[["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","width":24,"height":24,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-lightbulb h-4 w-4 text-yellow-500","aria-hidden":"true","children":[["$","path","1gvzjb",{"d":"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5"}],["$","path","x1upvd",{"d":"M9 18h6"}],["$","path","ceow96",{"d":"M10 22h4"}],"$undefined"]}],["$","span",null,{"className":"font-semibold text-foreground","children":"CDM"}]]}],["$","div",null,{"className":"text-sm text-muted-foreground","children":["$","p",null,{"className":"text-muted-foreground leading-7 mb-4","children":"The Content Decryption Module is a binary component provided by Google that implements the Widevine protocol. In Chrome, it's embedded in the browser. On Android, it's part of the system."}]}]]}]
b:["$","h3",null,{"id":"oemcrypto","className":"scroll-mt-20 text-xl font-semibold text-foreground mt-6 mb-2","children":"OEMCrypto"}]
c:["$","p",null,{"className":"text-muted-foreground leading-7 mb-4","children":"OEMCrypto is a hardware abstraction layer (HAL) that provides:"}]
d:["$","ul",null,{"className":"my-4 ml-6 list-disc space-y-2 text-muted-foreground","children":["\n",["$","li",null,{"className":"leading-7","children":"Secure key storage"}],"\n",["$","li",null,{"className":"leading-7","children":"Hardware-accelerated cryptography"}],"\n",["$","li",null,{"className":"leading-7","children":"Trusted execution environment access"}],"\n"]}]
e:["$","p",null,{"className":"text-muted-foreground leading-7 mb-4","children":"Device manufacturers implement OEMCrypto to interface with their specific security hardware."}]
f:["$","h2",null,{"id":"security-levels","className":"scroll-mt-20 text-2xl font-semibold text-foreground mt-8 mb-3 border-b border-border pb-2","children":"Security Levels"}]
10:["$","p",null,{"className":"text-muted-foreground leading-7 mb-4","children":"Widevine defines three security levels:"}]
11:["$","h3",null,{"id":"level-1-l1---hardware-security","className":"scroll-mt-20 text-xl font-semibold text-foreground mt-6 mb-2","children":"Level 1 (L1) - Hardware Security"}]
12:["$","div",null,{"className":"my-2 flex items-start gap-3 rounded-lg border p-3 bg-green-500/10 text-green-500 border-green-500/30","children":[["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","width":24,"height":24,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-circle-check h-5 w-5 mt-0.5","aria-hidden":"true","children":[["$","circle","1mglay",{"cx":"12","cy":"12","r":"10"}],["$","path","dzmm74",{"d":"m9 12 2 2 4-4"}],"$undefined"]}],["$","div",null,{"children":[["$","div",null,{"className":"font-semibold","children":["L1"," - Security Level ","1"]}],["$","div",null,{"className":"text-sm opacity-90","children":"All cryptographic operations and content decryption occur within a hardware Trusted Execution Environment (TEE)."}]]}]]}]
13:["$","p",null,{"className":"text-muted-foreground leading-7 mb-4","children":["$","strong",null,{"className":"font-semibold text-foreground","children":"Characteristics:"}]}]
14:["$","ul",null,{"className":"my-4 ml-6 list-disc space-y-2 text-muted-foreground","children":["\n",["$","li",null,{"className":"leading-7","children":"Keys never leave the TEE"}],"\n",["$","li",null,{"className":"leading-7","children":"Decrypted video stays in secure memory"}],"\n",["$","li",null,{"className":"leading-7","children":"Required for HD (720p+) and 4K content"}],"\n",["$","li",null,{"className":"leading-7","children":"Hardware root of trust"}],"\n"]}]
15:["$","p",null,{"className":"text-muted-foreground leading-7 mb-4","children":[["$","strong",null,{"className":"font-semibold text-foreground","children":"Platforms:"}]," Most Android phones/tablets, Android TV, Chromecast"]}]
16:["$","code",null,{"className":"rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground","children":"┌─────────────────────────────────────────┐\n│           L1 Security Model             │\n├─────────────────────────────────────────┤\n│                                         │\n│  ┌─────────────────────────────────┐    │\n│  │      Normal World (Android)     │    │\n│  │  ┌─────────────────────────┐    │    │\n│  │  │    Application/CDM       │    │    │\n│  │  └───────────┬─────────────┘    │    │\n│  └──────────────┼──────────────────┘    │\n│                 │ (Secure call)         │\n│  ┌──────────────▼──────────────────┐    │\n│  │    Secure World (TEE/TrustZone) │    │\n│  │  ┌─────────────────────────┐    │    │\n│  │  │  Key Storage + Decrypt  │    │    │\n│  │  └─────────────────────────┘    │    │\n│  └─────────────────────────────────┘    │\n│                                         │\n└─────────────────────────────────────────┘\n"}]
17:["$","div",null,{"data-slot":"alert","role":"alert","className":"relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current text-card-foreground my-4 border-cyan-500/50 bg-cyan-500/5","children":[["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","width":24,"height":24,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-shield h-4 w-4 text-cyan-500","aria-hidden":"true","children":[["$","path","oel41y",{"d":"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z"}],"$undefined"]}],["$","div",null,{"data-slot":"alert-title","className":"col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight text-cyan-500","children":"Blue Team Defense"}],["$","div",null,{"data-slot":"alert-description","className":"col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed text-muted-foreground","children":["$","p",null,{"className":"text-muted-foreground leading-7 mb-4","children":"L1 devices provide the strongest protection because keys are never exposed to the application processor. Even with root access, extracting keys is extremely difficult."}]}]]}]
18:["$","h3",null,{"id":"level-2-l2---partial-hardware","className":"scroll-mt-20 text-xl font-semibold text-foreground mt-6 mb-2","children":"Level 2 (L2) - Partial Hardware"}]
19:["$","div",null,{"className":"my-2 flex items-start gap-3 rounded-lg border p-3 bg-yellow-500/10 text-yellow-500 border-yellow-500/30","children":[["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","width":24,"height":24,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-triangle-alert h-5 w-5 mt-0.5","aria-hidden":"true","children":[["$","path","wmoenq",{"d":"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3"}],["$","path","juzpu7",{"d":"M12 9v4"}],["$","path","p32p05",{"d":"M12 17h.01"}],"$undefined"]}],["$","div",null,{"children":[["$","div",null,{"className":"font-semibold","children":["L2"," - Security Level ","2"]}],["$","div",null,{"className":"text-sm opacity-90","children":"Cryptographic operations occur in hardware, but content decryption is done in software."}]]}]]}]
1a:["$","p",null,{"className":"text-muted-foreground leading-7 mb-4","children":["$","strong",null,{"className":"font-semibold text-foreground","children":"Characteristics:"}]}]
1b:["$","ul",null,{"className":"my-4 ml-6 list-disc space-y-2 text-muted-foreground","children":["\n",["$","li",null,{"className":"leading-7","children":"Keys protected in TEE"}],"\n",["$","li",null,{"className":"leading-7","children":"Decryption happens in application processor"}],"\n",["$","li",null,{"className":"leading-7","children":"Limited to SD quality on most services"}],"\n",["$","li",null,{"className":"leading-7","children":"Vulnerable to memory attacks"}],"\n"]}]
1c:["$","p",null,{"className":"text-muted-foreground leading-7 mb-4","children":[["$","strong",null,{"className":"font-semibold text-foreground","children":"Use case:"}]," Devices with secure elements but no secure video path"]}]
1d:["$","h3",null,{"id":"level-3-l3---software-only","className":"scroll-mt-20 text-xl font-semibold text-foreground mt-6 mb-2","children":"Level 3 (L3) - Software Only"}]
1e:["$","div",null,{"className":"my-2 flex items-start gap-3 rounded-lg border p-3 bg-red-500/10 text-red-500 border-red-500/30","children":[["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","width":24,"height":24,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-circle-x h-5 w-5 mt-0.5","aria-hidden":"true","children":[["$","circle","1mglay",{"cx":"12","cy":"12","r":"10"}],["$","path","1uzhvr",{"d":"m15 9-6 6"}],["$","path","z0biqf",{"d":"m9 9 6 6"}],"$undefined"]}],["$","div",null,{"children":[["$","div",null,{"className":"font-semibold","children":["L3"," - Security Level ","3"]}],["$","div",null,{"className":"text-sm opacity-90","children":"All operations occur in software with no hardware protection. Most vulnerable to attacks."}]]}]]}]
1f:["$","p",null,{"className":"text-muted-foreground leading-7 mb-4","children":["$","strong",null,{"className":"font-semibold text-foreground","children":"Characteristics:"}]}]
20:["$","ul",null,{"className":"my-4 ml-6 list-disc space-y-2 text-muted-foreground","children":["\n",["$","li",null,{"className":"leading-7","children":"Keys stored in software"}],"\n",["$","li",null,{"className":"leading-7","children":"All operations in application memory"}],"\n",["$","li",null,{"className":"leading-7","children":"Limited to SD or lowest quality"}],"\n",["$","li",null,{"className":"leading-7","children":"Chrome desktop browser uses L3"}],"\n"]}]
21:["$","div",null,{"data-slot":"alert","role":"alert","className":"relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current text-card-foreground my-4 border-red-500/50 bg-red-500/5","children":[["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","width":24,"height":24,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-sword h-4 w-4 text-red-500","aria-hidden":"true","children":[["$","path","s7kpr",{"d":"m11 19-6-6"}],["$","path","1kw20b",{"d":"m5 21-2-2"}],["$","path","1oqv8h",{"d":"m8 16-4 4"}],["$","path","pkxemp",{"d":"M9.5 17.5 21 6V3h-3L6.5 14.5"}],"$undefined"]}],["$","div",null,{"data-slot":"alert-title","className":"col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight text-red-500","children":"Red Team Insight"}],["$","div",null,{"data-slot":"alert-description","className":"col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed text-muted-foreground","children":["$","p",null,{"className":"text-muted-foreground leading-7 mb-4","children":"L3 implementations have been repeatedly compromised. The CDM can be reverse-engineered to extract the private keys, allowing license requests to be forged."}]}]]}]
22:["$","h2",null,{"id":"license-protocol","className":"scroll-mt-20 text-2xl font-semibold text-foreground mt-8 mb-3 border-b border-border pb-2","children":"License Protocol"}]
23:["$","p",null,{"className":"text-muted-foreground leading-7 mb-4","children":"Widevine uses a binary protocol over HTTP(S):"}]
24:["$","h3",null,{"id":"1-license-request-challenge","className":"scroll-mt-20 text-xl font-semibold text-foreground mt-6 mb-2","children":"1. License Request (Challenge)"}]
25:["$","code",null,{"className":"rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground","children":"Client → Server:\n{\n  \"signed_request\": {\n    \"msg\": <base64 encoded protobuf>,\n    \"signature\": <client signature>\n  }\n}\n"}]
26:["$","p",null,{"className":"text-muted-foreground leading-7 mb-4","children":"The request contains:"}]
27:["$","ul",null,{"className":"my-4 ml-6 list-disc space-y-2 text-muted-foreground","children":["\n",["$","li",null,{"className":"leading-7","children":"Device certificate chain"}],"\n",["$","li",null,{"className":"leading-7","children":"Content Key ID(s)"}],"\n",["$","li",null,{"className":"leading-7","children":"Session ID"}],"\n",["$","li",null,{"className":"leading-7","children":"Client capabilities"}],"\n"]}]
28:["$","h3",null,{"id":"2-license-response","className":"scroll-mt-20 text-xl font-semibold text-foreground mt-6 mb-2","children":"2. License Response"}]
29:["$","code",null,{"className":"rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground","children":"Server → Client:\n{\n  \"license\": <base64 encoded protobuf>,\n  \"signature\": <server signature>\n}\n"}]
2a:["$","p",null,{"className":"text-muted-foreground leading-7 mb-4","children":"The response contains:"}]
2b:["$","ul",null,{"className":"my-4 ml-6 list-disc space-y-2 text-muted-foreground","children":["\n",["$","li",null,{"className":"leading-7","children":"Encrypted content keys"}],"\n",["$","li",null,{"className":"leading-7","children":"License policy (duration, restrictions)"}],"\n",["$","li",null,{"className":"leading-7","children":"HDCP requirements"}],"\n"]}]
2c:["$","div",null,{"data-slot":"alert","role":"alert","className":"relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current text-card-foreground my-4 border-primary/50 bg-primary/5","children":[["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","width":24,"height":24,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-info h-4 w-4 text-primary","aria-hidden":"true","children":[["$","circle","1mglay",{"cx":"12","cy":"12","r":"10"}],["$","path","1dtifu",{"d":"M12 16v-4"}],["$","path","e9boi3",{"d":"M12 8h.01"}],"$undefined"]}],["$","div",null,{"data-slot":"alert-title","className":"col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight text-primary","children":"Protobuf Format"}],["$","div",null,{"data-slot":"alert-description","className":"col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed text-muted-foreground","children":["$","p",null,{"className":"text-muted-foreground leading-7 mb-4","children":"Widevine uses Protocol Buffers (protobuf) for message serialization. The schema is not publicly documented, but has been reverse-engineered by researchers."}]}]]}]
2d:["$","h2",null,{"id":"device-provisioning","className":"scroll-mt-20 text-2xl font-semibold text-foreground mt-8 mb-3 border-b border-border pb-2","children":"Device Provisioning"}]
2e:["$","p",null,{"className":"text-muted-foreground leading-7 mb-4","children":"Before a device can request licenses, it must be provisioned with a device certificate:"}]
2f:["$","code",null,{"className":"rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground","children":"┌────────────┐         ┌──────────────┐         ┌────────────┐\n│   Device   │         │  Provisioning │         │   Google   │\n│            │         │    Server     │         │            │\n└─────┬──────┘         └───────┬──────┘         └─────┬──────┘\n      │                        │                      │\n      │ 1. Request Cert        │                      │\n      │───────────────────────►│                      │\n      │                        │                      │\n      │                        │ 2. Forward to Google │\n      │                        │─────────────────────►│\n      │                        │                      │\n      │                        │ 3. Signed Certificate│\n      │                        │◄─────────────────────│\n      │                        │                      │\n      │ 4. Store Certificate   │                      │\n      │◄───────────────────────│                      │\n"}]
30:["$","div",null,{"data-slot":"alert","role":"alert","className":"relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current text-card-foreground my-4 border-red-500/50 bg-red-500/5","children":[["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","width":24,"height":24,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-sword h-4 w-4 text-red-500","aria-hidden":"true","children":[["$","path","s7kpr",{"d":"m11 19-6-6"}],["$","path","1kw20b",{"d":"m5 21-2-2"}],["$","path","1oqv8h",{"d":"m8 16-4 4"}],["$","path","pkxemp",{"d":"M9.5 17.5 21 6V3h-3L6.5 14.5"}],"$undefined"]}],["$","div",null,{"data-slot":"alert-title","className":"col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight text-red-500","children":"Device Certificate Extraction"}],["$","div",null,{"data-slot":"alert-description","className":"col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed text-muted-foreground","children":["$","p",null,{"className":"text-muted-foreground leading-7 mb-4","children":"On compromised L3 devices, attackers can extract the device private key and certificate, allowing them to impersonate that device type for license requests."}]}]]}]
31:["$","h2",null,{"id":"common-attack-vectors","className":"scroll-mt-20 text-2xl font-semibold text-foreground mt-8 mb-3 border-b border-border pb-2","children":"Common Attack Vectors"}]
32:["$","h3",null,{"id":"1-cdm-reverse-engineering","className":"scroll-mt-20 text-xl font-semibold text-foreground mt-6 mb-2","children":"1. CDM Reverse Engineering"}]
33:["$","p",null,{"className":"text-muted-foreground leading-7 mb-4","children":"Software CDMs (L3) can be analyzed to:"}]
34:["$","ul",null,{"className":"my-4 ml-6 list-disc space-y-2 text-muted-foreground","children":["\n",["$","li",null,{"className":"leading-7","children":"Extract the client private key"}],"\n",["$","li",null,{"className":"leading-7","children":"Understand the license protocol"}],"\n",["$","li",null,{"className":"leading-7","children":"Create unofficial clients"}],"\n"]}]
35:["$","h3",null,{"id":"2-key-extraction","className":"scroll-mt-20 text-xl font-semibold text-foreground mt-6 mb-2","children":"2. Key Extraction"}]
36:["$","p",null,{"className":"text-muted-foreground leading-7 mb-4","children":"Methods include:"}]
37:["$","ul",null,{"className":"my-4 ml-6 list-disc space-y-2 text-muted-foreground","children":["\n",["$","li",null,{"className":"leading-7","children":"Memory dumping during playback"}],"\n",["$","li",null,{"className":"leading-7","children":"Hooking decryption functions"}],"\n",["$","li",null,{"className":"leading-7","children":"Exploiting software vulnerabilities"}],"\n"]}]
38:["$","h3",null,{"id":"3-session-sharing","className":"scroll-mt-20 text-xl font-semibold text-foreground mt-6 mb-2","children":"3. Session Sharing"}]
39:["$","p",null,{"className":"text-muted-foreground leading-7 mb-4","children":"Valid license responses can potentially be:"}]
3a:["$","ul",null,{"className":"my-4 ml-6 list-disc space-y-2 text-muted-foreground","children":["\n",["$","li",null,{"className":"leading-7","children":"Captured and replayed"}],"\n",["$","li",null,{"className":"leading-7","children":"Shared between devices"}],"\n",["$","li",null,{"className":"leading-7","children":"Used with extracted keys"}],"\n"]}]
3b:["$","div",null,{"data-slot":"alert","role":"alert","className":"relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current text-card-foreground my-4 border-cyan-500/50 bg-cyan-500/5","children":[["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","width":24,"height":24,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-shield h-4 w-4 text-cyan-500","aria-hidden":"true","children":[["$","path","oel41y",{"d":"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z"}],"$undefined"]}],["$","div",null,{"data-slot":"alert-title","className":"col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight text-cyan-500","children":"Defense Strategies"}],["$","div",null,{"data-slot":"alert-description","className":"col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed text-muted-foreground","children":[["$","p",null,{"className":"text-muted-foreground leading-7 mb-4","children":"Content providers defend against these attacks using:"}],["$","ul",null,{"className":"my-4 ml-6 list-disc space-y-2 text-muted-foreground","children":["\n",["$","li",null,{"className":"leading-7","children":"Device attestation (SafetyNet/Play Integrity)"}],"\n",["$","li",null,{"className":"leading-7","children":"Server-side session binding"}],"\n",["$","li",null,{"className":"leading-7","children":"Anomaly detection for unusual patterns"}],"\n",["$","li",null,{"className":"leading-7","children":"Rate limiting and geo-verification"}],"\n"]}]]}]]}]
3c:["$","h2",null,{"id":"output-protection","className":"scroll-mt-20 text-2xl font-semibold text-foreground mt-8 mb-3 border-b border-border pb-2","children":"Output Protection"}]
3d:["$","p",null,{"className":"text-muted-foreground leading-7 mb-4","children":"Widevine enforces output restrictions through HDCP:"}]
3e:["$","div",null,{"className":"my-6 overflow-x-auto rounded-lg border border-border","children":["$","table",null,{"className":"w-full text-sm","children":[["$","thead",null,{"className":"bg-muted/50","children":["$","tr",null,{"className":"border-b border-border last:border-0","children":[["$","th",null,{"className":"px-4 py-3 text-left font-semibold text-foreground","children":"Content Quality"}],["$","th",null,{"className":"px-4 py-3 text-left font-semibold text-foreground","children":"Minimum HDCP"}]]}]}],["$","tbody",null,{"children":[["$","tr",null,{"className":"border-b border-border last:border-0","children":[["$","td",null,{"className":"px-4 py-3 text-muted-foreground","children":"SD (480p)"}],["$","td",null,{"className":"px-4 py-3 text-muted-foreground","children":"None required"}]]}],["$","tr",null,{"className":"border-b border-border last:border-0","children":[["$","td",null,{"className":"px-4 py-3 text-muted-foreground","children":"HD (720p/1080p)"}],["$","td",null,{"className":"px-4 py-3 text-muted-foreground","children":"HDCP 1.4"}]]}],["$","tr",null,{"className":"border-b border-border last:border-0","children":[["$","td",null,{"className":"px-4 py-3 text-muted-foreground","children":"UHD (4K)"}],["$","td",null,{"className":"px-4 py-3 text-muted-foreground","children":"HDCP 2.2"}]]}]]}]]}]}]
3f:["$","div",null,{"className":"my-4 rounded-lg border border-border bg-card p-4","children":[["$","div",null,{"className":"flex items-center gap-2 mb-2","children":[["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","width":24,"height":24,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-lightbulb h-4 w-4 text-yellow-500","aria-hidden":"true","children":[["$","path","1gvzjb",{"d":"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5"}],["$","path","x1upvd",{"d":"M9 18h6"}],["$","path","ceow96",{"d":"M10 22h4"}],"$undefined"]}],["$","span",null,{"className":"font-semibold text-foreground","children":"HDCP"}]]}],["$","div",null,{"className":"text-sm text-muted-foreground","children":["$","p",null,{"className":"text-muted-foreground leading-7 mb-4","children":"High-bandwidth Digital Content Protection (HDCP) encrypts the video signal between the device and display, preventing capture of the decrypted video."}]}]]}]
40:["$","h2",null,{"id":"implementation-in-browsers","className":"scroll-mt-20 text-2xl font-semibold text-foreground mt-8 mb-3 border-b border-border pb-2","children":"Implementation in Browsers"}]
41:["$","h3",null,{"id":"chrome","className":"scroll-mt-20 text-xl font-semibold text-foreground mt-6 mb-2","children":"Chrome"}]
42:["$","p",null,{"className":"text-muted-foreground leading-7 mb-4","children":"Chrome includes the Widevine CDM as a binary component (Level 3):"}]
43:["$","code",null,{"className":"rounded bg-muted px-1.5 py-0.5 text-sm font-mono text-foreground","children":"Chrome\n├── CDM (Widevine) - L3\n│   ├── License handling\n│   ├── Key management\n│   └── Decryption\n└── Encrypted Media Extensions (EME)\n    └── JavaScript API\n"}]
44:["$","h3",null,{"id":"eme-integration","className":"scroll-mt-20 text-xl font-semibold text-foreground mt-6 mb-2","children":"EME Integration"}]
45:["$","p",null,{"className":"text-muted-foreground leading-7 mb-4","children":"Websites use the Encrypted Media Extensions API:"}]
46:["$","pre",null,{"className":"my-4 overflow-x-auto rounded-lg border border-border bg-zinc-950 p-4","children":["$","code",null,{"className":"text-sm text-zinc-100 language-javascript","children":"// Simplified EME flow\nconst video = document.querySelector('video');\nconst config = [{\n  initDataTypes: ['cenc'],\n  videoCapabilities: [{\n    contentType: 'video/mp4; codecs=\"avc1.42E01E\"'\n  }],\n  audioCapabilities: [{\n    contentType: 'audio/mp4; codecs=\"mp4a.40.2\"'\n  }]\n}];\n\nnavigator.requestMediaKeySystemAccess('com.widevine.alpha', config)\n  .then(access => access.createMediaKeys())\n  .then(keys => video.setMediaKeys(keys))\n  .then(() => {\n    // Create session and handle license exchange\n  });\n"}]}]
47:["$","h2",null,{"id":"summary","className":"scroll-mt-20 text-2xl font-semibold text-foreground mt-8 mb-3 border-b border-border pb-2","children":"Summary"}]
48:["$","ul",null,{"className":"my-4 ml-6 list-disc space-y-2 text-muted-foreground","children":["\n",["$","li",null,{"className":"leading-7","children":"Widevine is the most widely deployed DRM, covering Android, Chrome, and smart devices"}],"\n",["$","li",null,{"className":"leading-7","children":"Three security levels (L1-L3) determine content quality restrictions"}],"\n",["$","li",null,{"className":"leading-7","children":"L1 provides hardware protection; L3 is software-only and more vulnerable"}],"\n",["$","li",null,{"className":"leading-7","children":"The license protocol uses protobuf messages over HTTPS"}],"\n",["$","li",null,{"className":"leading-7","children":"Device provisioning establishes trust before content access"}],"\n",["$","li",null,{"className":"leading-7","children":"HDCP enforces output protection requirements"}],"\n"]}]
49:["$","h2",null,{"id":"next-steps","className":"scroll-mt-20 text-2xl font-semibold text-foreground mt-8 mb-3 border-b border-border pb-2","children":"Next Steps"}]
4a:["$","ul",null,{"className":"my-4 ml-6 list-disc space-y-2 text-muted-foreground","children":["\n",["$","li",null,{"className":"leading-7","children":[["$","strong",null,{"className":"font-semibold text-foreground","children":["$","a",null,{"href":"/knowledge-base/encryption","className":"text-primary underline underline-offset-4 hover:text-primary/80 transition-colors","children":"Encryption Basics"}]}]," - Understand the cryptography"]}],"\n",["$","li",null,{"className":"leading-7","children":[["$","strong",null,{"className":"font-semibold text-foreground","children":["$","a",null,{"href":"/labs/license-server","className":"text-primary underline underline-offset-4 hover:text-primary/80 transition-colors","children":"License Server Lab"}]}]," - Interact with a mock Widevine server"]}],"\n",["$","li",null,{"className":"leading-7","children":[["$","strong",null,{"className":"font-semibold text-foreground","children":["$","a",null,{"href":"/labs/attacks/cdm-extraction","className":"text-primary underline underline-offset-4 hover:text-primary/80 transition-colors","children":"CDM Extraction"}]}]," - Learn about L3 vulnerabilities"]}],"\n"]}]
4b:["$","$L5",null,{"className":"my-8"}]
4c:["$","nav",null,{"className":"grid gap-4 sm:grid-cols-2","children":[["$","$L4",null,{"href":"/knowledge-base/overview","children":["$","div",null,{"data-slot":"card","className":"bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm h-full transition-all hover:border-primary/50","children":["$","div",null,{"data-slot":"card-content","className":"flex items-center gap-3 p-4","children":[["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","width":24,"height":24,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-chevron-left h-5 w-5 text-muted-foreground","aria-hidden":"true","children":[["$","path","1wnfg3",{"d":"m15 18-6-6 6-6"}],"$undefined"]}],["$","div",null,{"children":[["$","div",null,{"className":"text-xs text-muted-foreground","children":"Previous"}],["$","div",null,{"className":"font-medium text-foreground","children":"DRM Overview"}]]}]]}]}]}],["$","$L4",null,{"href":"/knowledge-base/fairplay","children":["$","div",null,{"data-slot":"card","className":"bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm h-full transition-all hover:border-primary/50","children":["$","div",null,{"data-slot":"card-content","className":"flex items-center justify-end gap-3 p-4 text-right","children":[["$","div",null,{"children":[["$","div",null,{"className":"text-xs text-muted-foreground","children":"Next"}],["$","div",null,{"className":"font-medium text-foreground","children":"FairPlay Streaming"}]]}],["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","width":24,"height":24,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-chevron-right h-5 w-5 text-muted-foreground","aria-hidden":"true","children":[["$","path","mthhwq",{"d":"m9 18 6-6-6-6"}],"$undefined"]}]]}]}]}]]}]
4d:["$","section",null,{"className":"mt-12","children":[["$","h2",null,{"className":"text-xl font-semibold text-foreground mb-4","children":"Related Articles"}],["$","div",null,{"className":"grid gap-4 sm:grid-cols-3","children":[["$","$L4","overview",{"href":"/knowledge-base/overview","children":["$","div",null,{"data-slot":"card","className":"bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm h-full transition-all hover:border-primary/50","children":[["$","div",null,{"data-slot":"card-header","className":"@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6 pb-2","children":[["$","span",null,{"data-slot":"badge","className":"inline-flex items-center justify-center rounded-full border px-2 py-0.5 font-medium whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground w-fit text-xs","children":"Fundamentals"}],["$","div",null,{"data-slot":"card-title","className":"font-semibold text-base mt-2","children":"DRM Overview"}]]}],["$","div",null,{"data-slot":"card-content","className":"px-6 text-sm text-muted-foreground","children":["Understanding Digital Rights Management fundamentals, history, and the streaming ecosystem.","..."]}]]}]}],["$","$L4","fairplay",{"href":"/knowledge-base/fairplay","children":["$","div",null,{"data-slot":"card","className":"bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm h-full transition-all hover:border-primary/50","children":[["$","div",null,{"data-slot":"card-header","className":"@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6 pb-2","children":[["$","span",null,{"data-slot":"badge","className":"inline-flex items-center justify-center rounded-full border px-2 py-0.5 font-medium whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground w-fit text-xs","children":"DRM Systems"}],["$","div",null,{"data-slot":"card-title","className":"font-semibold text-base mt-2","children":"FairPlay Streaming"}]]}],["$","div",null,{"data-slot":"card-content","className":"px-6 text-sm text-muted-foreground","children":["Apple's proprietary DRM system for iOS, macOS, and Safari - architecture, HLS integration, and secur","..."]}]]}]}],["$","$L4","playready",{"href":"/knowledge-base/playready","children":["$","div",null,{"data-slot":"card","className":"bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm h-full transition-all hover:border-primary/50","children":[["$","div",null,{"data-slot":"card-header","className":"@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6 pb-2","children":[["$","span",null,{"data-slot":"badge","className":"inline-flex items-center justify-center rounded-full border px-2 py-0.5 font-medium whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground w-fit text-xs","children":"DRM Systems"}],"$L53"]}],"$L54"]}]}]]}]]}]
4e:["$","$L55",null,{}]
4f:["$","script","script-0",{"src":"/_next/static/chunks/6dacee62af9f78ce.js","async":true}]
50:["$","script","script-1",{"src":"/_next/static/chunks/b0b0e24ff49b787a.js","async":true}]
51:["$","script","script-2",{"src":"/_next/static/chunks/e87ae7e30c40f8b9.js","async":true}]
52:["$","$L56",null,{"children":["$","$57",null,{"name":"Next.MetadataOutlet","children":"$@58"}]}]
53:["$","div",null,{"data-slot":"card-title","className":"font-semibold text-base mt-2","children":"PlayReady DRM"}]
54:["$","div",null,{"data-slot":"card-content","className":"px-6 text-sm text-muted-foreground","children":["Microsoft's enterprise DRM solution for Windows, Xbox, and smart devices - architecture, licensing, ","..."]}]
58:null
