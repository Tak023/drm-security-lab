module.exports=[44159,a=>{"use strict";var b=a.i(21350),c=a.i(25126),d=a.i(11878),e=a.i(50920),f=a.i(12056),g=a.i(24817),h=a.i(7208),i=a.i(89344),j=a.i(25626),k=a.i(53016),l=a.i(29946),m=a.i(7108),n=a.i(66305),o=a.i(47061),p=a.i(71758),q=a.i(70911),r=a.i(73893),s=a.i(7378),t=a.i(93502);let u=(0,a.i(58691).default)("shield-check",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);var v=a.i(47445),w=a.i(86347),x=a.i(87917),y=a.i(85165);function z(){let{perspective:a}=(0,x.usePerspective)(),[z,A]=(0,c.useState)({id:(0,y.bytesToHex)((0,y.generateKey)(8)),manufacturer:"Google",model:"Pixel 8 Pro",osVersion:"Android 14",securityPatchLevel:"2024-01-05",bootloaderLocked:!0,rootDetected:!1,debuggingEnabled:!1,emulatorDetected:!1,tamperDetected:!1,certificateValid:!0,teePresent:!0}),[B,C]=(0,c.useState)(null),[D,E]=(0,c.useState)([]),[F,G]=(0,c.useState)(!1),H=(0,c.useCallback)(a=>{E(b=>[...b,`[${new Date().toLocaleTimeString()}] ${a}`])},[]),I=a=>new Promise(b=>setTimeout(b,a)),J=async()=>{G(!0),E([]),C(null);let a=(0,y.bytesToHex)((0,y.generateKey)(16));H("Starting device attestation..."),H(`Nonce: ${a}`),await I(500);let b=[],c=[],d="L1";H("Checking bootloader status..."),await I(300),z.bootloaderLocked?H("PASS: Bootloader locked"):(c.push("Bootloader is unlocked"),d="rejected",H("FAIL: Bootloader unlocked - device compromised")),H("Checking for root/superuser..."),await I(300),z.rootDetected?(c.push("Root access detected"),d="rejected",H("FAIL: Root detected - cannot trust device")):H("PASS: No root detected"),H("Checking debugging status..."),await I(300),z.debuggingEnabled?(b.push("USB debugging enabled"),"L1"===d&&(d="L2"),H("WARN: Debugging enabled - reduced security level")):H("PASS: Debugging disabled"),H("Checking for emulator..."),await I(300),z.emulatorDetected?(c.push("Emulator detected"),d="rejected",H("FAIL: Emulator detected - not a real device")):H("PASS: Real device confirmed"),H("Checking app integrity..."),await I(300),z.tamperDetected?(c.push("App tampering detected"),d="rejected",H("FAIL: App tampering detected")):H("PASS: App integrity verified"),H("Verifying device certificate..."),await I(300),z.certificateValid?H("PASS: Device certificate valid"):(c.push("Invalid device certificate"),d="rejected",H("FAIL: Device certificate invalid or revoked")),H("Checking TEE availability..."),await I(300),z.teePresent?H("PASS: Hardware TEE present"):(b.push("No hardware security module"),"L1"===d&&(d="L2"),"L2"===d&&(d="L3"),H("WARN: No TEE - software-only security"));let e=JSON.stringify({nonce:a,device:z.id,timestamp:Date.now(),securityLevel:d}),f=(0,y.simpleHash)((0,y.stringToBytes)(e));H("Generating attestation signature..."),await I(400),H(`Signature: ${f.substring(0,32)}...`);let g={success:"rejected"!==d,securityLevel:d,warnings:b,errors:c,timestamp:Date.now(),nonce:a,signature:f};C(g),g.success?H(`Attestation PASSED - Security Level: ${d}`):H("Attestation FAILED - Device rejected"),G(!1)},K=a=>{A(b=>({...b,[a]:!b[a]})),C(null)};return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[(0,b.jsx)(m.Fingerprint,{className:"w-6 h-6 text-blue-500"}),"Device Attestation"]}),(0,b.jsx)("p",{className:"text-muted-foreground mt-1",children:"Simulate device integrity verification for DRM security"})]}),(0,b.jsx)(f.Badge,{variant:"blue-team"===a?"default":"secondary",children:"blue-team"===a?"Defense Mode":"Analysis Mode"})]}),(0,b.jsxs)(g.Alert,{children:[(0,b.jsx)(l.Shield,{className:"h-4 w-4"}),(0,b.jsx)(g.AlertTitle,{children:"Blue Team Defense"}),(0,b.jsx)(g.AlertDescription,{children:"Device attestation verifies that a device is genuine, unmodified, and meets security requirements before issuing DRM licenses."})]}),(0,b.jsxs)(h.Tabs,{defaultValue:"simulation",className:"space-y-4",children:[(0,b.jsxs)(h.TabsList,{children:[(0,b.jsxs)(h.TabsTrigger,{value:"simulation",className:"gap-2",children:[(0,b.jsx)(q.Smartphone,{className:"w-4 h-4"}),"Simulation"]}),(0,b.jsxs)(h.TabsTrigger,{value:"implementation",className:"gap-2",children:[(0,b.jsx)(w.Cpu,{className:"w-4 h-4"}),"Implementation"]}),(0,b.jsxs)(h.TabsTrigger,{value:"attacks",className:"gap-2",children:[(0,b.jsx)(p.AlertTriangle,{className:"w-4 h-4"}),"Attack Resistance"]})]}),(0,b.jsx)(h.TabsContent,{value:"simulation",className:"space-y-4",children:(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsxs)(d.CardTitle,{className:"text-lg flex items-center gap-2",children:[(0,b.jsx)(q.Smartphone,{className:"w-5 h-5"}),"Device Configuration"]}),(0,b.jsx)(d.CardDescription,{children:"Toggle device properties to test"})]}),(0,b.jsxs)(d.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(s.Lock,{className:`w-4 h-4 ${z.bootloaderLocked?"text-green-500":"text-red-500"}`}),(0,b.jsx)("span",{className:"text-sm",children:"Bootloader Locked"})]}),(0,b.jsx)(k.Switch,{checked:z.bootloaderLocked,onCheckedChange:()=>K("bootloaderLocked")})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(t.Key,{className:`w-4 h-4 ${!z.rootDetected?"text-green-500":"text-red-500"}`}),(0,b.jsx)("span",{className:"text-sm",children:"Root Detected"})]}),(0,b.jsx)(k.Switch,{checked:z.rootDetected,onCheckedChange:()=>K("rootDetected")})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(p.AlertTriangle,{className:`w-4 h-4 ${!z.debuggingEnabled?"text-green-500":"text-yellow-500"}`}),(0,b.jsx)("span",{className:"text-sm",children:"Debugging Enabled"})]}),(0,b.jsx)(k.Switch,{checked:z.debuggingEnabled,onCheckedChange:()=>K("debuggingEnabled")})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(w.Cpu,{className:`w-4 h-4 ${!z.emulatorDetected?"text-green-500":"text-red-500"}`}),(0,b.jsx)("span",{className:"text-sm",children:"Emulator Detected"})]}),(0,b.jsx)(k.Switch,{checked:z.emulatorDetected,onCheckedChange:()=>K("emulatorDetected")})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(l.Shield,{className:`w-4 h-4 ${!z.tamperDetected?"text-green-500":"text-red-500"}`}),(0,b.jsx)("span",{className:"text-sm",children:"Tampering Detected"})]}),(0,b.jsx)(k.Switch,{checked:z.tamperDetected,onCheckedChange:()=>K("tamperDetected")})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(n.CheckCircle2,{className:`w-4 h-4 ${z.certificateValid?"text-green-500":"text-red-500"}`}),(0,b.jsx)("span",{className:"text-sm",children:"Certificate Valid"})]}),(0,b.jsx)(k.Switch,{checked:z.certificateValid,onCheckedChange:()=>K("certificateValid")})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(m.Fingerprint,{className:`w-4 h-4 ${z.teePresent?"text-green-500":"text-yellow-500"}`}),(0,b.jsx)("span",{className:"text-sm",children:"TEE Present"})]}),(0,b.jsx)(k.Switch,{checked:z.teePresent,onCheckedChange:()=>K("teePresent")})]})]}),(0,b.jsx)(j.Separator,{}),(0,b.jsxs)(e.Button,{onClick:J,disabled:F,className:"w-full gap-2",children:[(0,b.jsx)(m.Fingerprint,{className:"w-4 h-4"}),F?"Attesting...":"Run Attestation"]})]})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsxs)(d.CardTitle,{className:"text-lg flex items-center gap-2",children:[(0,b.jsx)(r.Server,{className:"w-5 h-5"}),"Attestation Result"]}),(0,b.jsx)(d.CardDescription,{children:"Server-side verification result"})]}),(0,b.jsx)(d.CardContent,{children:B?(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:`p-4 rounded-lg border ${B.success?"border-green-500 bg-green-500/10":"border-red-500 bg-red-500/10"}`,children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[B.success?(0,b.jsx)(u,{className:"w-6 h-6 text-green-500"}):(0,b.jsx)(v.ShieldX,{className:"w-6 h-6 text-red-500"}),(0,b.jsx)("span",{className:`font-bold ${B.success?"text-green-400":"text-red-400"}`,children:B.success?"ATTESTATION PASSED":"ATTESTATION FAILED"})]}),B.success&&(0,b.jsxs)(f.Badge,{className:"mt-2",variant:"L1"===B.securityLevel?"default":"L2"===B.securityLevel?"secondary":"outline",children:["Security Level: ",B.securityLevel]})]}),B.errors.length>0&&(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("span",{className:"text-sm font-medium text-red-400",children:"Errors:"}),B.errors.map((a,c)=>(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm text-red-400",children:[(0,b.jsx)(o.XCircle,{className:"w-3 h-3"}),a]},c))]}),B.warnings.length>0&&(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("span",{className:"text-sm font-medium text-yellow-400",children:"Warnings:"}),B.warnings.map((a,c)=>(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm text-yellow-400",children:[(0,b.jsx)(p.AlertTriangle,{className:"w-3 h-3"}),a]},c))]}),(0,b.jsxs)("div",{className:"text-xs text-muted-foreground space-y-1 mt-4",children:[(0,b.jsxs)("div",{children:["Nonce: ",(0,b.jsxs)("code",{children:[B.nonce.substring(0,16),"..."]})]}),(0,b.jsxs)("div",{children:["Signature: ",(0,b.jsxs)("code",{children:[B.signature.substring(0,16),"..."]})]})]})]}):(0,b.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,b.jsx)(m.Fingerprint,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),(0,b.jsx)("p",{className:"text-sm",children:"Run attestation to see results"})]})})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsx)(d.CardTitle,{className:"text-lg",children:"Attestation Log"}),(0,b.jsx)(d.CardDescription,{children:"Step-by-step verification"})]}),(0,b.jsx)(d.CardContent,{children:(0,b.jsx)(i.ScrollArea,{className:"h-[350px] rounded-lg border bg-zinc-950 p-3",children:0===D.length?(0,b.jsx)("div",{className:"text-center text-muted-foreground text-sm py-8",children:"Run attestation to see log..."}):(0,b.jsx)("div",{className:"space-y-1 font-mono text-xs",children:D.map((a,c)=>(0,b.jsx)("div",{className:a.includes("PASS")?"text-green-400":a.includes("FAIL")?"text-red-400":a.includes("WARN")?"text-yellow-400":a.includes("PASSED")?"text-green-400 font-bold":a.includes("FAILED")?"text-red-400 font-bold":"text-muted-foreground",children:a},c))})})})]})]})}),(0,b.jsx)(h.TabsContent,{value:"implementation",className:"space-y-4",children:(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsx)(d.CardTitle,{children:"Android SafetyNet / Play Integrity"})}),(0,b.jsx)(d.CardContent,{className:"prose prose-invert max-w-none",children:(0,b.jsxs)("div",{className:"space-y-3 text-sm text-muted-foreground",children:[(0,b.jsx)("p",{children:"Google's Play Integrity API provides three verdicts:"}),(0,b.jsxs)("ul",{className:"list-disc pl-4 space-y-1",children:[(0,b.jsxs)("li",{children:[(0,b.jsx)("strong",{children:"Device Recognition:"})," Is this a genuine Android device?"]}),(0,b.jsxs)("li",{children:[(0,b.jsx)("strong",{children:"App Integrity:"})," Is this the genuine, unmodified app?"]}),(0,b.jsxs)("li",{children:[(0,b.jsx)("strong",{children:"License Status:"})," Is the user entitled to use the app?"]})]}),(0,b.jsx)("p",{children:"For DRM, the device integrity verdict determines security level eligibility. Devices that fail attestation are denied high-quality content."})]})})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsx)(d.CardTitle,{children:"iOS DeviceCheck / App Attest"})}),(0,b.jsx)(d.CardContent,{className:"prose prose-invert max-w-none",children:(0,b.jsxs)("div",{className:"space-y-3 text-sm text-muted-foreground",children:[(0,b.jsx)("p",{children:"Apple provides similar attestation through:"}),(0,b.jsxs)("ul",{className:"list-disc pl-4 space-y-1",children:[(0,b.jsxs)("li",{children:[(0,b.jsx)("strong",{children:"DeviceCheck:"})," Per-device tokens without device identification"]}),(0,b.jsxs)("li",{children:[(0,b.jsx)("strong",{children:"App Attest:"})," Hardware-backed cryptographic attestation"]}),(0,b.jsxs)("li",{children:[(0,b.jsx)("strong",{children:"Secure Enclave:"})," Hardware protection for keys and attestation"]})]}),(0,b.jsx)("p",{children:"FairPlay DRM leverages these mechanisms to verify device integrity before issuing content keys."})]})})]})]})}),(0,b.jsx)(h.TabsContent,{value:"attacks",className:"space-y-4",children:(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsx)(d.CardTitle,{children:"Attestation Bypass Attempts"}),(0,b.jsx)(d.CardDescription,{children:"How attackers try to defeat attestation"})]}),(0,b.jsx)(d.CardContent,{children:(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"p-3 rounded-lg border border-red-500/30 bg-red-500/10",children:[(0,b.jsx)("h4",{className:"font-medium text-red-400 mb-2",children:"Magisk Hide / Zygisk"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Attempts to hide root access from detection. Modern attestation uses hardware-backed checks that are harder to bypass."})]}),(0,b.jsxs)("div",{className:"p-3 rounded-lg border border-red-500/30 bg-red-500/10",children:[(0,b.jsx)("h4",{className:"font-medium text-red-400 mb-2",children:"Key Attestation Spoofing"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Attempting to provide fake attestation certificates. Hardware attestation with certificate chains makes this very difficult."})]}),(0,b.jsxs)("div",{className:"p-3 rounded-lg border border-green-500/30 bg-green-500/10",children:[(0,b.jsx)("h4",{className:"font-medium text-green-400 mb-2",children:"Defense: Nonce Challenges"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Server-provided nonces prevent replay attacks. Each attestation request requires a fresh challenge."})]}),(0,b.jsxs)("div",{className:"p-3 rounded-lg border border-green-500/30 bg-green-500/10",children:[(0,b.jsx)("h4",{className:"font-medium text-green-400 mb-2",children:"Defense: Certificate Chains"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Verify attestation certificates chain to Google/Apple roots. Check certificate validity and revocation status."})]})]})})]})})]})]})}a.s(["AttestationLab",()=>z],44159)}];

//# sourceMappingURL=7e210_Git_drm-security-lab_src_components_labs_defense_AttestationLab_tsx_19bc538a._.js.map