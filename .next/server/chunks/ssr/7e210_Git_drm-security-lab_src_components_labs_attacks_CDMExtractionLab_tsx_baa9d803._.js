module.exports=[54106,a=>{"use strict";var b=a.i(21350),c=a.i(25126),d=a.i(11878),e=a.i(50920),f=a.i(12056),g=a.i(24817),h=a.i(7208),i=a.i(89344),j=a.i(25626),k=a.i(31406),l=a.i(71758),m=a.i(29946),n=a.i(4966),o=a.i(86347),p=a.i(58691);let q=(0,p.default)("hard-drive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]);var r=a.i(93502),s=a.i(7378),t=a.i(39623),u=a.i(66305),v=a.i(47061),w=a.i(44050);let x=(0,p.default)("bug",[["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M14 7a4 4 0 0 1 4 4v3a6 6 0 0 1-12 0v-3a4 4 0 0 1 4-4z",key:"uouzyp"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M21 21a4 4 0 0 0-3.81-4",key:"1b0z45"}],["path",{d:"M21 5a4 4 0 0 1-3.55 3.97",key:"5cxbf6"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M3 21a4 4 0 0 1 3.81-4",key:"1fjd4g"}],["path",{d:"M3 5a4 4 0 0 0 3.55 3.97",key:"1d7oge"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M9 7.13V6a3 3 0 1 1 6 0v1.13",key:"1vgav8"}]]);var y=a.i(87917),z=a.i(90629),A=a.i(67710);function B(){let{perspective:a}=(0,y.usePerspective)(),[p,B]=(0,c.useState)("L3"),[C,D]=(0,c.useState)([{id:"identify",title:"Identify CDM Type",description:"Detect Widevine CDM version and security level",status:"pending"},{id:"locate",title:"Locate CDM Binary",description:"Find CDM library in browser/device memory",status:"pending"},{id:"attach",title:"Attach Debugger",description:"Attach to process and set breakpoints",status:"pending"},{id:"intercept",title:"Intercept License",description:"Capture license response before processing",status:"pending"},{id:"extract",title:"Extract Keys",description:"Dump decryption keys from memory",status:"pending"},{id:"verify",title:"Verify Keys",description:"Test extracted keys against encrypted content",status:"pending"}]),[E,F]=(0,c.useState)([]),[G,H]=(0,c.useState)(!1),[I,J]=(0,c.useState)(null),K=(0,c.useCallback)((a,b,c)=>{F(d=>[...d,{timestamp:Date.now(),type:a,message:b,data:c}])},[]),L=(0,c.useCallback)((a,b,c)=>{D(d=>d.map(d=>d.id===a?{...d,status:b,details:c}:d))},[]),M=a=>new Promise(b=>setTimeout(b,a)),N=async()=>{H(!0),J(null),D(a=>a.map(a=>({...a,status:"pending",details:void 0}))),F([]),K("info",`Starting CDM extraction attack against ${p} device...`),K("warning","This is a simulation for educational purposes only");let a=new z.MockCDM(p,{onLog:(a,b)=>K("info",a,b)}),b=new A.MockLicenseServer({},{onLog:(a,b)=>K("info",a,b)}),c=b.registerContent("test-movie","Test Movie",p);if(K("info",`Target content: ${c.title} (KeyID: ${c.keyId})`),L("identify","running"),await M(1e3),K("attack",`Detected CDM: Widevine ${p}`),K("info",`Device ID: ${a.getDeviceId()}`),L("identify","success",`Widevine ${p} detected`),L("locate","running"),await M(1200),"L1"===p){K("error","CDM binary protected by hardware TEE - cannot locate in memory"),L("locate","blocked","Hardware TEE protection active"),K("warning","Attack blocked: L1 hardware protection prevents memory access"),H(!1);return}K("attack","Located libwidevinecdm.so in process memory"),K("info","Base address: 0x7f4a8c000000"),L("locate","success","CDM library located at 0x7f4a8c000000"),L("attach","running"),await M(800),"L2"===p&&(K("warning","L2 protection: Keys stored in hardware, but decryption in software"),K("info","Can intercept decrypted content, but not extract raw keys")),K("attack","Debugger attached to CDM process"),K("info","Set breakpoint at Cdm_Decrypt function"),L("attach","success","Debugger attached, breakpoints set"),L("intercept","running"),await M(1500);let d=a.createSession([c.keyId]),e=a.generateLicenseChallenge(d.sessionId);K("attack","Intercepted license challenge");let f=b.processLicenseRequest(e,c.contentId);if("error"in f){K("error",`License request failed: ${f.error}`),L("intercept","failed",f.error),H(!1);return}a.processLicenseResponse(f),K("attack","Intercepted license response with encrypted keys"),K("info",`Session ID: ${d.sessionId}`),L("intercept","success","License response captured"),L("extract","running"),await M(1e3);let g=a.simulateMemoryDump();if(!g){K("error","Memory dump blocked by hardware protection"),L("extract","blocked","Hardware protection active"),"L2"===p&&(K("warning","L2: Keys protected in hardware security module"),K("info","Alternative: Intercept decrypted frames instead of keys")),H(!1);return}K("attack",`VULNERABILITY EXPLOITED: ${g.size} key(s) extracted from memory!`),g.forEach((a,b)=>{K("success",`Key ID: ${b}`),K("success",`Key: ${a}`)}),J(g),L("extract","success",`${g.size} key(s) extracted`),L("verify","running"),await M(800),K("attack","Testing extracted keys against encrypted content..."),K("success","Keys verified - content can be decrypted!"),L("verify","success","Keys working"),K("success","Attack completed successfully"),K("warning","This demonstrates why L3 devices are vulnerable to key extraction"),H(!1)};return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[(0,b.jsx)(o.Cpu,{className:"w-6 h-6 text-red-500"}),"CDM Extraction Attack"]}),(0,b.jsx)("p",{className:"text-muted-foreground mt-1",children:"Simulate Content Decryption Module key extraction attack"})]}),(0,b.jsx)(f.Badge,{variant:"red-team"===a?"destructive":"default",children:"red-team"===a?"Attack Mode":"Defense Analysis"})]}),(0,b.jsxs)(g.Alert,{variant:"destructive",children:[(0,b.jsx)(l.AlertTriangle,{className:"h-4 w-4"}),(0,b.jsx)(g.AlertTitle,{children:"Educational Simulation Only"}),(0,b.jsx)(g.AlertDescription,{children:"This simulates a CDM memory dump attack for educational purposes. Actual attacks against production DRM systems are illegal."})]}),(0,b.jsxs)(h.Tabs,{defaultValue:"attack",className:"space-y-4",children:[(0,b.jsxs)(h.TabsList,{children:[(0,b.jsxs)(h.TabsTrigger,{value:"attack",className:"gap-2",children:[(0,b.jsx)(n.Sword,{className:"w-4 h-4"}),"Attack Simulation"]}),(0,b.jsxs)(h.TabsTrigger,{value:"defense",className:"gap-2",children:[(0,b.jsx)(m.Shield,{className:"w-4 h-4"}),"Defense Analysis"]}),(0,b.jsxs)(h.TabsTrigger,{value:"technical",className:"gap-2",children:[(0,b.jsx)(w.Terminal,{className:"w-4 h-4"}),"Technical Details"]})]}),(0,b.jsxs)(h.TabsContent,{value:"attack",className:"space-y-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsx)(d.CardTitle,{className:"text-lg",children:"Target Configuration"}),(0,b.jsx)(d.CardDescription,{children:"Select target device security level"})]}),(0,b.jsxs)(d.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-sm font-medium",children:"Security Level"}),(0,b.jsx)("div",{className:"flex gap-2",children:["L1","L2","L3"].map(a=>(0,b.jsx)(e.Button,{variant:p===a?"default":"outline",size:"sm",onClick:()=>B(a),disabled:G,className:"flex-1",children:a},a))})]}),(0,b.jsxs)("div",{className:"rounded-lg border p-3 bg-muted/50",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:["L1"===p&&(0,b.jsx)(s.Lock,{className:"w-4 h-4 text-green-500"}),"L2"===p&&(0,b.jsx)(r.Key,{className:"w-4 h-4 text-yellow-500"}),"L3"===p&&(0,b.jsx)(t.Unlock,{className:"w-4 h-4 text-red-500"}),(0,b.jsxs)("span",{className:"font-medium",children:[p," Protection"]})]}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:["L1"===p&&"Hardware TEE protection - keys never exposed","L2"===p&&"Keys in hardware, decryption in software","L3"===p&&"Full software - vulnerable to memory attacks"]})]}),(0,b.jsxs)(e.Button,{onClick:N,disabled:G,className:"w-full gap-2",variant:"destructive",children:[(0,b.jsx)(k.Play,{className:"w-4 h-4"}),G?"Attack Running...":"Launch Attack"]})]})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsx)(d.CardTitle,{className:"text-lg",children:"Attack Progress"}),(0,b.jsx)(d.CardDescription,{children:"Step-by-step extraction process"})]}),(0,b.jsx)(d.CardContent,{children:(0,b.jsx)("div",{className:"space-y-3",children:C.map((a,c)=>(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)("div",{className:"mt-0.5",children:(a=>{switch(a){case"pending":return(0,b.jsx)("div",{className:"w-4 h-4 rounded-full border-2 border-muted-foreground"});case"running":return(0,b.jsx)("div",{className:"w-4 h-4 rounded-full border-2 border-primary animate-pulse bg-primary/20"});case"success":return(0,b.jsx)(u.CheckCircle2,{className:"w-4 h-4 text-green-500"});case"failed":return(0,b.jsx)(v.XCircle,{className:"w-4 h-4 text-red-500"});case"blocked":return(0,b.jsx)(m.Shield,{className:"w-4 h-4 text-blue-500"})}})(a.status)}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)("span",{className:"text-xs text-muted-foreground",children:[c+1,"."]}),(0,b.jsx)("span",{className:"font-medium text-sm",children:a.title})]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:a.description}),a.details&&(0,b.jsx)("p",{className:"text-xs mt-1 text-primary",children:a.details})]})]},a.id))})})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsx)(d.CardTitle,{className:"text-lg",children:"Extracted Keys"}),(0,b.jsx)(d.CardDescription,{children:"Keys recovered from memory"})]}),(0,b.jsx)(d.CardContent,{children:I?(0,b.jsxs)("div",{className:"space-y-3",children:[Array.from(I.entries()).map(([a,c])=>(0,b.jsxs)("div",{className:"rounded-lg border border-red-500/50 bg-red-500/10 p-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,b.jsx)(r.Key,{className:"w-4 h-4 text-red-500"}),(0,b.jsx)("span",{className:"text-sm font-medium text-red-400",children:"Key Extracted"})]}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsxs)("div",{className:"text-xs",children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Key ID: "}),(0,b.jsx)("code",{className:"text-xs bg-background px-1 rounded",children:a})]}),(0,b.jsxs)("div",{className:"text-xs",children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Key: "}),(0,b.jsx)("code",{className:"text-xs bg-background px-1 rounded break-all",children:c})]})]})]},a)),(0,b.jsxs)(g.Alert,{variant:"destructive",className:"mt-4",children:[(0,b.jsx)(l.AlertTriangle,{className:"h-4 w-4"}),(0,b.jsx)(g.AlertDescription,{className:"text-xs",children:"In a real attack, these keys could decrypt all protected content."})]})]}):(0,b.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,b.jsx)(q,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),(0,b.jsx)("p",{className:"text-sm",children:"No keys extracted yet"}),(0,b.jsx)("p",{className:"text-xs",children:"Run the attack to attempt extraction"})]})})]})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsx)(d.CardTitle,{className:"text-lg",children:"Attack Log"}),(0,b.jsx)(d.CardDescription,{children:"Real-time attack output"})]}),(0,b.jsx)(d.CardContent,{children:(0,b.jsx)(i.ScrollArea,{className:"h-[200px] rounded-lg border bg-zinc-950 p-3",children:0===E.length?(0,b.jsx)("div",{className:"text-center text-muted-foreground text-sm py-8",children:"Launch attack to see output..."}):(0,b.jsx)("div",{className:"space-y-1 font-mono text-xs",children:E.map((a,c)=>(0,b.jsxs)("div",{className:"flex items-start gap-2",children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:new Date(a.timestamp).toLocaleTimeString()}),(a=>{switch(a){case"info":return(0,b.jsx)(w.Terminal,{className:"w-3 h-3 text-muted-foreground"});case"warning":return(0,b.jsx)(l.AlertTriangle,{className:"w-3 h-3 text-yellow-500"});case"success":return(0,b.jsx)(u.CheckCircle2,{className:"w-3 h-3 text-green-500"});case"error":return(0,b.jsx)(v.XCircle,{className:"w-3 h-3 text-red-500"});case"attack":return(0,b.jsx)(x,{className:"w-3 h-3 text-red-400"})}})(a.type),(0,b.jsx)("span",{className:"error"===a.type?"text-red-400":"warning"===a.type?"text-yellow-400":"success"===a.type?"text-green-400":"attack"===a.type?"text-red-400":"text-muted-foreground",children:a.message})]},c))})})})]})]}),(0,b.jsx)(h.TabsContent,{value:"defense",className:"space-y-4",children:(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsxs)(d.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(m.Shield,{className:"w-5 h-5 text-blue-500"}),"Prevention Strategies"]})}),(0,b.jsx)(d.CardContent,{className:"space-y-4",children:(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"p-3 rounded-lg border bg-green-500/10 border-green-500/30",children:[(0,b.jsx)("h4",{className:"font-medium text-green-400 mb-1",children:"Use L1 Security Level"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Hardware TEE protection prevents any software-based key extraction. Keys never exist in accessible memory."})]}),(0,b.jsxs)("div",{className:"p-3 rounded-lg border bg-blue-500/10 border-blue-500/30",children:[(0,b.jsx)("h4",{className:"font-medium text-blue-400 mb-1",children:"Anti-Debugging Measures"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Implement ptrace detection, timing checks, and integrity verification to detect and prevent debugger attachment."})]}),(0,b.jsxs)("div",{className:"p-3 rounded-lg border bg-purple-500/10 border-purple-500/30",children:[(0,b.jsx)("h4",{className:"font-medium text-purple-400 mb-1",children:"Code Obfuscation"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Obfuscate CDM code paths and key handling routines to make reverse engineering more difficult."})]})]})})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsxs)(d.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(l.AlertTriangle,{className:"w-5 h-5 text-yellow-500"}),"Detection Methods"]})}),(0,b.jsx)(d.CardContent,{className:"space-y-4",children:(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"p-3 rounded-lg border",children:[(0,b.jsx)("h4",{className:"font-medium mb-1",children:"Device Attestation"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Verify device integrity before issuing licenses. Detect rooted/jailbroken devices that may have compromised CDMs."})]}),(0,b.jsxs)("div",{className:"p-3 rounded-lg border",children:[(0,b.jsx)("h4",{className:"font-medium mb-1",children:"Anomaly Detection"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Monitor for unusual patterns: same device ID requesting many different content licenses, impossible playback speeds, etc."})]}),(0,b.jsxs)("div",{className:"p-3 rounded-lg border",children:[(0,b.jsx)("h4",{className:"font-medium mb-1",children:"Forensic Watermarking"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Embed unique identifiers in content that survive re-encoding, enabling leak source identification."})]})]})})]})]})}),(0,b.jsx)(h.TabsContent,{value:"technical",className:"space-y-4",children:(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsx)(d.CardTitle,{children:"Technical Background"}),(0,b.jsx)(d.CardDescription,{children:"How CDM extraction attacks work"})]}),(0,b.jsx)(d.CardContent,{className:"prose prose-invert max-w-none",children:(0,b.jsxs)("div",{className:"space-y-4 text-sm",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"font-medium mb-2",children:"Attack Vector"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"CDM extraction attacks target the Content Decryption Module, which is responsible for receiving encrypted keys from a license server and using them to decrypt protected content. In L3 (software-only) implementations, these keys exist unprotected in process memory during playback."})]}),(0,b.jsx)(j.Separator,{}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"font-medium mb-2",children:"Tools Used (in real attacks)"}),(0,b.jsxs)("ul",{className:"list-disc pl-4 text-muted-foreground space-y-1",children:[(0,b.jsx)("li",{children:"Frida - Dynamic instrumentation toolkit"}),(0,b.jsx)("li",{children:"IDA Pro / Ghidra - Disassemblers for CDM binary analysis"}),(0,b.jsx)("li",{children:"WideVine L3 Decryptor scripts"}),(0,b.jsx)("li",{children:"Custom key extraction scripts"})]})]}),(0,b.jsx)(j.Separator,{}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"font-medium mb-2",children:"Why L1 is Secure"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"L1 devices use a hardware Trusted Execution Environment (TEE) like ARM TrustZone or Intel SGX. The keys are decrypted inside the TEE and never exposed to the main processor or operating system. Even with root access, the keys cannot be extracted through software means."})]}),(0,b.jsx)(j.Separator,{}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"font-medium mb-2",children:"Impact of Compromise"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"When an L3 CDM is compromised, attackers can extract keys for any content licensed to that device. These keys can then be shared or used to create pirated copies of protected content. This is why premium 4K content is typically restricted to L1 devices only."})]})]})})]})})]})]})}a.s(["CDMExtractionLab",()=>B],54106)}];

//# sourceMappingURL=7e210_Git_drm-security-lab_src_components_labs_attacks_CDMExtractionLab_tsx_baa9d803._.js.map