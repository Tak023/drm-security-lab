module.exports=[98843,a=>{"use strict";var b=a.i(21350),c=a.i(25126),d=a.i(11878),e=a.i(50920),f=a.i(12056),g=a.i(24817),h=a.i(7208),i=a.i(6260),j=a.i(89344),k=a.i(25626),l=a.i(53016),m=a.i(13782),n=a.i(7378),o=a.i(39623),p=a.i(93502),q=a.i(29946),r=a.i(40779),s=a.i(94887),t=a.i(50685),u=a.i(58691);let v=(0,u.default)("binary",[["rect",{x:"14",y:"14",width:"4",height:"6",rx:"2",key:"p02svl"}],["rect",{x:"6",y:"4",width:"4",height:"6",rx:"2",key:"xm4xkj"}],["path",{d:"M6 20h4",key:"1i6q5t"}],["path",{d:"M14 10h4",key:"ru81e7"}],["path",{d:"M6 14h2v6",key:"16z9wg"}],["path",{d:"M14 4h2v6",key:"1idq9u"}]]),w=(0,u.default)("blocks",[["path",{d:"M10 22V7a1 1 0 0 0-1-1H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-5a1 1 0 0 0-1-1H2",key:"1ah6g2"}],["rect",{x:"14",y:"2",width:"8",height:"8",rx:"1",key:"88lufb"}]]),x=(0,u.default)("shuffle",[["path",{d:"m18 14 4 4-4 4",key:"10pe0f"}],["path",{d:"m18 2 4 4-4 4",key:"pucp1d"}],["path",{d:"M2 18h1.973a4 4 0 0 0 3.3-1.7l5.454-8.6a4 4 0 0 1 3.3-1.7H22",key:"1ailkh"}],["path",{d:"M2 6h1.972a4 4 0 0 1 3.6 2.2",key:"km57vx"}],["path",{d:"M22 18h-6.041a4 4 0 0 1-3.3-1.8l-.359-.45",key:"os18l9"}]]);var y=a.i(85165);function z(){let[a,u]=(0,c.useState)("Hello, DRM World!"),[z,A]=(0,c.useState)("ctr"),[B,C]=(0,c.useState)((0,y.generateKey)(16)),[D,E]=(0,c.useState)((0,y.generateKey)(16)),[F,G]=(0,c.useState)(""),[H,I]=(0,c.useState)(""),[J,K]=(0,c.useState)([]),[L,M]=(0,c.useState)(!1),[N,O]=(0,c.useState)(!1),P=a=>new Promise(b=>setTimeout(b,a)),Q=(a,b)=>(0,y.xorBytes)(a,b.slice(0,a.length)),R=a=>new TextDecoder().decode(a),S=async a=>{let b=[],c=Math.ceil(a.length/16),d=new Uint8Array(a.length),e=new Uint8Array(D);b.push({id:"0",label:"Initialization",input:`Plaintext: "${R(a)}" (${a.length} bytes)`,output:`IV/Nonce: ${(0,y.bytesToHex)(D).substring(0,32)}...`,operation:"Set up counter from IV"}),await P(400),K([...b]);for(let f=0;f<c;f++){if(f>0)for(let a=e.length-1;a>=0&&(e[a]++,0===e[a]);a--);let c=Q(e,B),g=16*f,h=Math.min(g+16,a.length),i=a.slice(g,h);for(let a=0;a<i.length;a++)d[g+a]=i[a]^c[a];b.push({id:String(f+1),label:`Block ${f+1}`,input:`Counter: ${(0,y.bytesToHex)(e).substring(0,16)}... → Keystream`,output:`Plaintext XOR Keystream = ${(0,y.bytesToHex)(d.slice(g,h))}`,operation:`E(K, Counter${f}) ⊕ P${f}`}),await P(300),K([...b])}return{ciphertext:d,steps:b}},T=async a=>{let b=[],c=((a,b)=>{let c=16-a.length%16,d=new Uint8Array(a.length+c);d.set(a);for(let b=a.length;b<d.length;b++)d[b]=c;return d})(a,0),d=c.length/16,e=new Uint8Array(c.length),f=new Uint8Array(D.buffer.slice(0));b.push({id:"0",label:"Initialization",input:`Plaintext: "${R(a)}" → Padded to ${c.length} bytes`,output:`IV: ${(0,y.bytesToHex)(D).substring(0,32)}...`,operation:"PKCS#7 padding applied"}),await P(400),K([...b]);for(let a=0;a<d;a++){let d=16*a,g=c.slice(d,d+16),h=(0,y.xorBytes)(g,f),i=Q(h,B);e.set(i,d),f=new Uint8Array(i.buffer.slice(0)),b.push({id:String(a+1),label:`Block ${a+1}`,input:`P${a} ⊕ ${0===a?"IV":`C${a-1}`} = ${(0,y.bytesToHex)(h).substring(0,16)}...`,output:`C${a} = ${(0,y.bytesToHex)(i).substring(0,16)}...`,operation:`E(K, P${a} ⊕ ${0===a?"IV":`C${a-1}`})`}),await P(300),K([...b])}return{ciphertext:e,steps:b}},U=async()=>{O(!0),K([]),G(""),I("");try{let b=new TextEncoder().encode(a),c="ctr"===z?await S(b):await T(b);G((0,y.bytesToHex)(c.ciphertext)),await P(500),I(a)}catch(a){console.error("Encryption error:",a)}O(!1)},V=a=>{navigator.clipboard.writeText(a)};return(0,b.jsxs)("div",{className:"container max-w-6xl py-8",children:[(0,b.jsxs)("div",{className:"mb-8",children:[(0,b.jsxs)("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[(0,b.jsx)(n.Lock,{className:"w-6 h-6 text-primary"}),"Encryption Lab"]}),(0,b.jsx)("p",{className:"text-muted-foreground mt-1",children:"Explore AES encryption modes used in DRM content protection"})]}),(0,b.jsxs)(g.Alert,{className:"mb-6",children:[(0,b.jsx)(q.Shield,{className:"h-4 w-4"}),(0,b.jsx)(g.AlertTitle,{children:"DRM Content Encryption"}),(0,b.jsx)(g.AlertDescription,{children:"DRM systems typically use AES-128 in CTR or CBC mode. CTR mode enables random access for streaming, while CBC provides stronger diffusion. This lab demonstrates the core concepts with simplified operations."})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsx)(d.CardTitle,{className:"text-lg",children:"Encryption Mode"}),(0,b.jsx)(d.CardDescription,{children:"Select AES operation mode"})]}),(0,b.jsxs)(d.CardContent,{children:[(0,b.jsx)(h.Tabs,{value:z,onValueChange:a=>A(a),children:(0,b.jsxs)(h.TabsList,{className:"grid w-full grid-cols-2",children:[(0,b.jsxs)(h.TabsTrigger,{value:"ctr",className:"gap-2",children:[(0,b.jsx)(v,{className:"w-4 h-4"}),"CTR"]}),(0,b.jsxs)(h.TabsTrigger,{value:"cbc",className:"gap-2",children:[(0,b.jsx)(w,{className:"w-4 h-4"}),"CBC"]})]})}),(0,b.jsx)("div",{className:"mt-4 p-3 rounded-lg bg-muted/50 text-sm",children:"ctr"===z?(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium text-primary",children:"Counter Mode (CTR)"}),(0,b.jsxs)("ul",{className:"mt-2 space-y-1 text-muted-foreground text-xs",children:[(0,b.jsx)("li",{children:"• Parallel encryption/decryption"}),(0,b.jsx)("li",{children:"• Random access to encrypted data"}),(0,b.jsx)("li",{children:"• Used in DASH/HLS streaming"}),(0,b.jsx)("li",{children:"• No padding required"})]})]}):(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium text-primary",children:"Cipher Block Chaining (CBC)"}),(0,b.jsxs)("ul",{className:"mt-2 space-y-1 text-muted-foreground text-xs",children:[(0,b.jsx)("li",{children:"• Each block depends on previous"}),(0,b.jsx)("li",{children:"• Better error propagation"}),(0,b.jsx)("li",{children:"• PKCS#7 padding required"}),(0,b.jsx)("li",{children:"• Sequential processing only"})]})]})})]})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsxs)(d.CardTitle,{className:"text-lg flex items-center gap-2",children:[(0,b.jsx)(p.Key,{className:"w-4 h-4"}),"Cryptographic Parameters"]})}),(0,b.jsxs)(d.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsx)(m.Label,{className:"text-sm",children:"AES-128 Key"}),(0,b.jsx)(e.Button,{variant:"ghost",size:"sm",onClick:()=>{C((0,y.generateKey)(16)),G(""),I(""),K([])},children:(0,b.jsx)(r.RefreshCw,{className:"w-3 h-3"})})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)("code",{className:"flex-1 text-xs bg-zinc-950 p-2 rounded overflow-hidden text-ellipsis",children:[(0,y.bytesToHex)(B).substring(0,24),"..."]}),(0,b.jsx)(e.Button,{variant:"outline",size:"sm",onClick:()=>V((0,y.bytesToHex)(B)),children:(0,b.jsx)(s.Copy,{className:"w-3 h-3"})})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsx)(m.Label,{className:"text-sm",children:"ctr"===z?"Nonce/Counter":"IV"}),(0,b.jsx)(e.Button,{variant:"ghost",size:"sm",onClick:()=>{E((0,y.generateKey)(16)),G(""),I(""),K([])},children:(0,b.jsx)(r.RefreshCw,{className:"w-3 h-3"})})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)("code",{className:"flex-1 text-xs bg-zinc-950 p-2 rounded overflow-hidden text-ellipsis",children:[(0,y.bytesToHex)(D).substring(0,24),"..."]}),(0,b.jsx)(e.Button,{variant:"outline",size:"sm",onClick:()=>V((0,y.bytesToHex)(D)),children:(0,b.jsx)(s.Copy,{className:"w-3 h-3"})})]})]}),(0,b.jsx)(k.Separator,{}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)(m.Label,{className:"text-sm",children:"Show Binary"}),(0,b.jsx)(l.Switch,{checked:L,onCheckedChange:M})]})]})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsx)(d.CardTitle,{className:"text-lg",children:"Input"})}),(0,b.jsxs)(d.CardContent,{className:"space-y-4",children:[(0,b.jsx)(i.Textarea,{placeholder:"Enter plaintext...",value:a,onChange:a=>u(a.target.value),className:"font-mono text-sm",rows:3}),(0,b.jsxs)(e.Button,{onClick:U,disabled:N||!a,className:"w-full gap-2",children:[N?(0,b.jsx)(r.RefreshCw,{className:"w-4 h-4 animate-spin"}):(0,b.jsx)(n.Lock,{className:"w-4 h-4"}),N?"Encrypting...":"Encrypt"]})]})]})]}),(0,b.jsxs)(d.Card,{className:"lg:col-span-2",children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsxs)(d.CardTitle,{className:"text-lg flex items-center gap-2",children:[(0,b.jsx)(x,{className:"w-5 h-5"}),"ctr"===z?"CTR Mode":"CBC Mode"," Encryption Process"]}),(0,b.jsx)(d.CardDescription,{children:"Step-by-step visualization of the encryption process"})]}),(0,b.jsx)(d.CardContent,{children:0===J.length?(0,b.jsxs)("div",{className:"text-center py-16 text-muted-foreground",children:[(0,b.jsx)(n.Lock,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),(0,b.jsx)("p",{children:"Enter plaintext and click Encrypt to see the process"})]}):(0,b.jsx)(j.ScrollArea,{className:"h-[400px] pr-4",children:(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"p-4 rounded-lg border bg-zinc-950",children:[(0,b.jsx)("div",{className:"text-xs text-muted-foreground mb-2",children:"ctr"===z?"CTR Mode Structure":"CBC Mode Structure"}),(0,b.jsx)("div",{className:"flex items-center justify-center gap-2 text-sm font-mono",children:"ctr"===z?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(f.Badge,{variant:"outline",children:"Counter"}),(0,b.jsx)(t.ArrowRight,{className:"w-4 h-4"}),(0,b.jsx)(f.Badge,{variant:"secondary",children:"E(K)"}),(0,b.jsx)(t.ArrowRight,{className:"w-4 h-4"}),(0,b.jsx)(f.Badge,{variant:"outline",children:"Keystream"}),(0,b.jsx)("span",{className:"text-primary",children:"⊕"}),(0,b.jsx)(f.Badge,{variant:"outline",children:"Plaintext"}),(0,b.jsx)(t.ArrowRight,{className:"w-4 h-4"}),(0,b.jsx)(f.Badge,{className:"bg-primary",children:"Ciphertext"})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(f.Badge,{variant:"outline",children:"Plaintext"}),(0,b.jsx)("span",{className:"text-primary",children:"⊕"}),(0,b.jsx)(f.Badge,{variant:"outline",children:"IV/Prev"}),(0,b.jsx)(t.ArrowRight,{className:"w-4 h-4"}),(0,b.jsx)(f.Badge,{variant:"secondary",children:"E(K)"}),(0,b.jsx)(t.ArrowRight,{className:"w-4 h-4"}),(0,b.jsx)(f.Badge,{className:"bg-primary",children:"Ciphertext"})]})})]}),J.map((a,c)=>(0,b.jsxs)("div",{className:"p-4 rounded-lg border bg-muted/30",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,b.jsx)(f.Badge,{variant:"outline",children:a.label}),(0,b.jsx)("span",{className:"text-xs text-muted-foreground font-mono",children:a.operation})]}),(0,b.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Input: "}),(0,b.jsx)("code",{className:"text-xs bg-background px-2 py-1 rounded",children:a.input})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Output: "}),(0,b.jsx)("code",{className:"text-xs bg-primary/10 text-primary px-2 py-1 rounded",children:a.output})]})]})]},a.id)),F&&(0,b.jsxs)("div",{className:"p-4 rounded-lg border border-primary/50 bg-primary/5",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,b.jsx)(n.Lock,{className:"w-4 h-4 text-primary"}),(0,b.jsx)("span",{className:"font-medium",children:"Encryption Complete"})]}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(m.Label,{className:"text-xs text-muted-foreground",children:"Ciphertext (hex)"}),(0,b.jsxs)("div",{className:"flex gap-2 mt-1",children:[(0,b.jsx)("code",{className:"flex-1 text-xs bg-zinc-950 p-2 rounded break-all",children:F}),(0,b.jsx)(e.Button,{variant:"outline",size:"sm",onClick:()=>V(F),children:(0,b.jsx)(s.Copy,{className:"w-3 h-3"})})]})]}),L&&(0,b.jsxs)("div",{children:[(0,b.jsx)(m.Label,{className:"text-xs text-muted-foreground",children:"Ciphertext (binary)"}),(0,b.jsx)("code",{className:"block text-xs bg-zinc-950 p-2 rounded break-all mt-1",children:Array.from((0,y.hexToBytes)(F)).map(a=>a.toString(2).padStart(8,"0")).join(" ")})]}),H&&(0,b.jsxs)("div",{className:"pt-2 border-t",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,b.jsx)(o.Unlock,{className:"w-4 h-4 text-green-500"}),(0,b.jsx)(m.Label,{className:"text-xs text-green-400",children:"Decrypted"})]}),(0,b.jsx)("code",{className:"block text-sm bg-green-500/10 text-green-400 p-2 rounded",children:H})]})]})]})]})})})]})]}),(0,b.jsxs)(d.Card,{className:"mt-6",children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsx)(d.CardTitle,{className:"text-lg",children:"DRM Encryption in Practice"})}),(0,b.jsx)(d.CardContent,{children:(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[(0,b.jsxs)("div",{className:"p-4 rounded-lg bg-muted/30",children:[(0,b.jsx)("h4",{className:"font-medium mb-2",children:"Widevine"}),(0,b.jsx)("p",{className:"text-muted-foreground text-xs",children:"Uses AES-128 CTR for video encryption. Each segment has a unique IV derived from segment number, enabling efficient seeking in encrypted streams."})]}),(0,b.jsxs)("div",{className:"p-4 rounded-lg bg-muted/30",children:[(0,b.jsx)("h4",{className:"font-medium mb-2",children:"FairPlay"}),(0,b.jsx)("p",{className:"text-muted-foreground text-xs",children:"Apple's system uses AES-128 CBC for HLS content. Keys are rotated periodically and delivered via secure session with the device."})]}),(0,b.jsxs)("div",{className:"p-4 rounded-lg bg-muted/30",children:[(0,b.jsx)("h4",{className:"font-medium mb-2",children:"PlayReady"}),(0,b.jsx)("p",{className:"text-muted-foreground text-xs",children:"Microsoft's DRM supports both CTR and CBC modes. Often uses AES-128 CTR for DASH streams with per-sample encryption."})]})]})})]})]})}a.s(["default",()=>z],98843)}];

//# sourceMappingURL=Projects_Git_drm-security-lab_src_app_labs_encryption_page_tsx_86c22a60._.js.map