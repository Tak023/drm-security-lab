module.exports=[91703,(a,b,c)=>{"use strict";b.exports=a.r(22922).vendored["react-ssr"].ReactDOM},56704,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},20635,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},56985,(a,b,c)=>{"use strict";b.exports=a.r(22922).vendored.contexts.AppRouterContext},10294,(a,b,c)=>{"use strict";b.exports=a.r(22922).vendored["react-ssr"].ReactServerDOMTurbopackClient},67811,(a,b,c)=>{"use strict";b.exports=a.r(22922).vendored.contexts.HooksClientContext},20588,(a,b,c)=>{"use strict";b.exports=a.r(22922).vendored.contexts.ServerInsertedHtml},39623,a=>{"use strict";let b=(0,a.i(58691).default)("lock-open",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]);a.s(["Unlock",()=>b],39623)},40779,a=>{"use strict";let b=(0,a.i(58691).default)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);a.s(["RefreshCw",()=>b],40779)},47445,a=>{"use strict";let b=(0,a.i(58691).default)("shield-x",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m14.5 9.5-5 5",key:"17q4r4"}],["path",{d:"m9.5 9.5 5 5",key:"18nt4w"}]]);a.s(["ShieldX",()=>b],47445)},45425,a=>{"use strict";let b=(0,a.i(58691).default)("shield-alert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]);a.s(["ShieldAlert",()=>b],45425)},66305,a=>{"use strict";let b=(0,a.i(58691).default)("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);a.s(["CheckCircle2",()=>b],66305)},24817,a=>{"use strict";var b=a.i(21350),c=a.i(48680),d=a.i(45705);let e=(0,c.cva)("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function f({className:a,variant:c,...f}){return(0,b.jsx)("div",{"data-slot":"alert",role:"alert",className:(0,d.cn)(e({variant:c}),a),...f})}function g({className:a,...c}){return(0,b.jsx)("div",{"data-slot":"alert-title",className:(0,d.cn)("col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight",a),...c})}function h({className:a,...c}){return(0,b.jsx)("div",{"data-slot":"alert-description",className:(0,d.cn)("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",a),...c})}a.s(["Alert",()=>f,"AlertDescription",()=>h,"AlertTitle",()=>g])},85165,a=>{"use strict";function b(a,b){let c=Math.min(a.length,b.length),d=new Uint8Array(c);for(let e=0;e<c;e++)d[e]=a[e]^b[e];return d}function c(a=16){let b=new Uint8Array(a);for(let c=0;c<a;c++)b[c]=Math.floor(256*Math.random());return b}function d(a){return Array.from(a).map(a=>a.toString(16).padStart(2,"0")).join("")}function e(a){let b=new Uint8Array(a.length/2);for(let c=0;c<b.length;c++)b[c]=parseInt(a.substr(2*c,2),16);return b}function f(a){return new TextEncoder().encode(a)}function g(a){return Buffer.from(a).toString("base64")}function h(a){return new Uint8Array(Buffer.from(a,"base64"))}function i(a){let b=0;for(let c=0;c<a.length;c++)b=(b<<5)-b+a[c]|0;return Math.abs(b).toString(16).padStart(8,"0")}function j(){let a=d(c(16));return`${a.slice(0,8)}-${a.slice(8,12)}-${a.slice(12,16)}-${a.slice(16,20)}-${a.slice(20,32)}`}class k{key;iv;constructor(a,b){this.key=a,this.iv=b||c(16)}encryptCTR(a){let b=new Uint8Array(a.length);for(let c=0;c<a.length;c+=16){let d=new Uint8Array(16);d.set(this.iv.slice(0,8),0);let e=Math.floor(c/16);for(let a=0;a<8;a++)d[8+a]=e>>8*(7-a)&255;let f=function(a,b){let c=new Uint8Array(a.length);for(let d=0;d<a.length;d++)c[d]=a[d]^b[d%b.length];return c}(d,this.key),g=Math.min(c+16,a.length);for(let d=c;d<g;d++)b[d]=a[d]^f[d-c]}return{ciphertext:b,iv:this.iv}}decryptCTR(a){return this.encryptCTR(a).ciphertext}getIV(){return this.iv}}class l{privateKey;publicKey;modulus;constructor(){this.modulus=3233,this.publicKey=17,this.privateKey=this.modInverse(this.publicKey,3120)}modInverse(a,b){let[c,d]=[a,b],[e,f]=[1,0];for(;0!==d;){let a=Math.floor(c/d);[c,d]=[d,c-a*d],[e,f]=[f,e-a*f]}return(e%b+b)%b}modPow(a,b,c){let d=1;for(a%=c;b>0;)b%2==1&&(d=d*a%c),b=Math.floor(b/2),a=a*a%c;return d}encrypt(a){return this.modPow(a,this.publicKey,this.modulus)}decrypt(a){return this.modPow(a,this.privateKey,this.modulus)}encryptBytes(a){return Array.from(a).map(a=>this.encrypt(a))}decryptBytes(a){return new Uint8Array(a.map(a=>this.decrypt(a)))}getPublicKey(){return{e:this.publicKey,n:this.modulus}}sign(a){return Array.from(f(i(a))).map(a=>this.modPow(a,this.privateKey,this.modulus)).join(",")}verify(a,b){var c;let d=i(a);return c=new Uint8Array(b.split(",").map(Number).map(a=>this.modPow(a,this.publicKey,this.modulus))),new TextDecoder().decode(c)===d}}a.s(["SimpleAsymmetric",()=>l,"SimpleCipher",()=>k,"base64Decode",()=>h,"base64Encode",()=>g,"bytesToHex",()=>d,"generateKey",()=>c,"generateKeyId",()=>j,"hexToBytes",()=>e,"simpleHash",()=>i,"stringToBytes",()=>f,"xorBytes",()=>b])},47061,a=>{"use strict";let b=(0,a.i(58691).default)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);a.s(["XCircle",()=>b],47061)},99705,a=>{"use strict";var b=a.i(25126),c=a.i(46788);function d(a){let[d,e]=b.useState(void 0);return(0,c.useLayoutEffect)(()=>{if(a){e({width:a.offsetWidth,height:a.offsetHeight});let b=new ResizeObserver(b=>{let c,d;if(!Array.isArray(b)||!b.length)return;let f=b[0];if("borderBoxSize"in f){let a=f.borderBoxSize,b=Array.isArray(a)?a[0]:a;c=b.inlineSize,d=b.blockSize}else c=a.offsetWidth,d=a.offsetHeight;e({width:c,height:d})});return b.observe(a,{box:"border-box"}),()=>b.unobserve(a)}e(void 0)},[a]),d}a.s(["useSize",()=>d])},2643,a=>{"use strict";var b=a.i(25126);function c(a){let c=b.useRef({value:a,previous:a});return b.useMemo(()=>(c.current.value!==a&&(c.current.previous=c.current.value,c.current.value=a),c.current.previous),[a])}a.s(["usePrevious",()=>c])},73893,a=>{"use strict";let b=(0,a.i(58691).default)("server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]);a.s(["Server",()=>b],73893)},70911,a=>{"use strict";let b=(0,a.i(58691).default)("smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);a.s(["Smartphone",()=>b],70911)},36812,a=>{"use strict";let b=(0,a.i(58691).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);a.s(["ArrowLeft",()=>b],36812)},34288,40724,a=>{"use strict";var b=a.i(58691);let c=(0,b.default)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);a.s(["default",()=>c],34288);let d=(0,b.default)("chevron-up",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);a.s(["default",()=>d],40724)},90629,67710,a=>{"use strict";var b=a.i(85165);class c{deviceId;securityLevel;asymmetric;sessions;events;manufacturer;model;constructor(a="L3",c={},d){this.securityLevel=a,this.deviceId=(0,b.generateKeyId)(),this.asymmetric=new b.SimpleAsymmetric,this.sessions=new Map,this.events=c,this.manufacturer=d?.manufacturer||"Mock Devices Inc",this.model=d?.model||`MockCDM-${a}`,this.log(`CDM initialized with security level ${a}`)}log(a,b){this.events.onLog?.(`[CDM] ${a}`,b)}getDeviceCertificate(){let a={deviceId:this.deviceId,securityLevel:this.securityLevel,publicKey:this.asymmetric.getPublicKey(),manufacturer:this.manufacturer,model:this.model,timestamp:Date.now()},c=this.asymmetric.sign((0,b.stringToBytes)(JSON.stringify(a)));return{...a,signature:c}}createSession(a){let c=(0,b.generateKeyId)(),d={sessionId:c,keyIds:a,keys:new Map,state:"created",createdAt:Date.now(),expiresAt:null};return this.sessions.set(c,d),this.log(`Session created: ${c}`,{keyIds:a}),this.events.onSessionCreated?.(d),d}generateLicenseChallenge(a){let c=this.sessions.get(a);if(!c)throw Error(`Session not found: ${a}`);c.state="pending",this.events.onSessionUpdated?.(c);let d={version:1,deviceCertificate:this.getDeviceCertificate(),keyIds:c.keyIds,sessionId:a,nonce:(0,b.bytesToHex)((0,b.generateKey)(16)),timestamp:Date.now()},e=this.asymmetric.sign((0,b.stringToBytes)(JSON.stringify(d))),f={...d,signature:e};return this.log("License challenge generated",{sessionId:a,keyIds:c.keyIds}),f}processLicenseResponse(a){let c=this.sessions.get(a.sessionId);if(!c)throw Error(`Session not found: ${a.sessionId}`);for(let d of(this.log("Processing license response",{sessionId:a.sessionId}),a.keys))if("CONTENT"===d.type){let a=(0,b.base64Decode)(d.key);c.keys.set(d.keyId,a),this.log(`Key added: ${d.keyId}`,{keyLength:a.length,keyHex:"L3"===this.securityLevel?(0,b.bytesToHex)(a):"[PROTECTED]"}),this.events.onKeyAdded?.(c.sessionId,d.keyId)}c.state="active",a.policy.licenseDuration>0&&(c.expiresAt=Date.now()+1e3*a.policy.licenseDuration),this.events.onSessionUpdated?.(c),this.log("Session activated",{sessionId:c.sessionId,keyCount:c.keys.size})}decrypt(a,c,d,e){let f=this.sessions.get(a);if(!f)throw Error(`Session not found: ${a}`);if("active"!==f.state)throw Error(`Session not active: ${f.state}`);let g=f.keys.get(c);if(!g)throw Error(`Key not found: ${c}`);this.log("Decrypting content",{sessionId:a,keyId:c,ciphertextLength:d.length});let h=new b.SimpleCipher(g,e).decryptCTR(d);return"L1"===this.securityLevel?this.log("L1: Decryption in hardware TEE - content protected"):"L2"===this.securityLevel?this.log("L2: Keys in hardware, decryption in software - partially protected"):this.log("L3: Full software decryption - content accessible in memory"),h}getSession(a){return this.sessions.get(a)}closeSession(a){let b=this.sessions.get(a);b&&(b.state="closed",b.keys.clear(),this.sessions.delete(a),this.log("Session closed",{sessionId:a}),this.events.onSessionClosed?.(a))}getSessions(){return Array.from(this.sessions.values())}getSecurityLevel(){return this.securityLevel}getDeviceId(){return this.deviceId}simulateMemoryDump(){if("L1"===this.securityLevel)return this.log("Memory dump blocked - L1 hardware protection"),null;if("L2"===this.securityLevel)return this.log("Memory dump partial - keys in hardware, but decrypted content accessible"),null;this.log("VULNERABILITY: L3 memory dump successful - keys extracted!");let a=new Map;for(let c of this.sessions.values())for(let[d,e]of c.keys)a.set(d,(0,b.bytesToHex)(e));return a}}a.s(["MockCDM",()=>c],90629);let d={serverName:"Mock DRM License Server",enableSecurityCheck:!0,enableDeviceRevocation:!0,defaultPolicy:{canPlay:!0,canPersist:!1,licenseDuration:86400,playbackDuration:14400,renewalDelay:3600}};class e{config;content;revokedDevices;issuedLicenses;asymmetric;events;constructor(a={},c={}){this.config={...d,...a},this.content=new Map,this.revokedDevices=new Set,this.issuedLicenses=new Map,this.asymmetric=new b.SimpleAsymmetric,this.events=c,this.log("License server initialized",{serverName:this.config.serverName})}log(a,b){this.events.onLog?.(`[Server] ${a}`,b)}registerContent(a,c,d="L3",e){let f=(0,b.generateKeyId)(),g={contentId:a,title:c,keyId:f,key:(0,b.generateKey)(16),iv:(0,b.generateKey)(16),requiredSecurityLevel:d,policy:{...this.config.defaultPolicy,...e}};return this.content.set(a,g),this.log("Content registered",{contentId:a,title:c,keyId:f,requiredSecurityLevel:d}),g}getContentInfo(a){let b=this.content.get(a);if(!b)return null;let{key:c,...d}=b;return d}getKeyId(a){return this.content.get(a)?.keyId||null}revokeDevice(a){this.revokedDevices.add(a),this.log("Device revoked",{deviceId:a}),this.events.onDeviceRevoked?.(a)}isDeviceRevoked(a){return this.revokedDevices.has(a)}validateChallenge(a){if(Math.abs(Date.now()-a.timestamp)>3e5)return{valid:!1,reason:"Challenge expired"};let b=a.deviceCertificate;return b.deviceId&&b.securityLevel?this.config.enableDeviceRevocation&&this.isDeviceRevoked(b.deviceId)?{valid:!1,reason:"Device revoked"}:a.keyIds&&0!==a.keyIds.length?{valid:!0}:{valid:!1,reason:"No key IDs requested"}:{valid:!1,reason:"Invalid device certificate"}}checkSecurityLevel(a,b){let c={L1:3,L2:2,L3:1};return c[a]>=c[b]}processLicenseRequest(a,c){this.log("Processing license request",{sessionId:a.sessionId,contentId:c,deviceId:a.deviceCertificate.deviceId,securityLevel:a.deviceCertificate.securityLevel}),this.events.onLicenseRequest?.(a);let d=this.validateChallenge(a);if(!d.valid)return this.log("License request denied",{reason:d.reason}),this.events.onLicenseDenied?.(d.reason,a),{error:d.reason};let e=this.content.get(c);if(!e){let b="Content not found";return this.log("License request denied",{reason:b}),this.events.onLicenseDenied?.(b,a),{error:b}}if(this.config.enableSecurityCheck&&!this.checkSecurityLevel(a.deviceCertificate.securityLevel,e.requiredSecurityLevel)){let b=`Security level too low. Required: ${e.requiredSecurityLevel}, Device: ${a.deviceCertificate.securityLevel}`;return this.log("License request denied",{reason:b}),this.events.onLicenseDenied?.(b,a),{error:b}}let f=[{keyId:e.keyId,key:(0,b.base64Encode)(e.key),iv:(0,b.base64Encode)(e.iv),type:"CONTENT"}],g={version:1,sessionId:a.sessionId,keys:f,policy:e.policy,serverNonce:(0,b.bytesToHex)((0,b.generateKey)(16)),timestamp:Date.now()},h=this.asymmetric.sign((0,b.stringToBytes)(JSON.stringify(g))),i={...g,signature:h};return this.issuedLicenses.set(a.sessionId,{challenge:a,response:i,timestamp:Date.now()}),this.log("License issued",{sessionId:a.sessionId,contentId:c,keyId:e.keyId}),this.events.onLicenseIssued?.(i,e),i}getIssuedLicense(a){return this.issuedLicenses.get(a)}getAllContent(){let a=new Map;for(let[b,c]of this.content){let{key:d,...e}=c;a.set(b,e)}return a}getContentWithKey(a){return this.content.get(a)||null}getStats(){return{serverName:this.config.serverName,registeredContent:this.content.size,issuedLicenses:this.issuedLicenses.size,revokedDevices:this.revokedDevices.size}}}a.s(["MockLicenseServer",()=>e],67710)},44050,a=>{"use strict";let b=(0,a.i(58691).default)("terminal",[["path",{d:"M12 19h8",key:"baeox8"}],["path",{d:"m4 17 6-6-6-6",key:"1yngyt"}]]);a.s(["Terminal",()=>b],44050)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__def93227._.js.map