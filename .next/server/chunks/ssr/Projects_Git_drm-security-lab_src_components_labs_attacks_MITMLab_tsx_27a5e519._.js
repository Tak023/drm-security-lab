module.exports=[19490,a=>{"use strict";var b=a.i(21350),c=a.i(25126),d=a.i(11878),e=a.i(50920),f=a.i(12056),g=a.i(24817),h=a.i(7208),i=a.i(89344),j=a.i(25626),k=a.i(71758),l=a.i(29946),m=a.i(4966),n=a.i(3892),o=a.i(73893),p=a.i(21790),q=a.i(7378),r=a.i(39623),s=a.i(31165),t=a.i(50685),u=a.i(36812),v=a.i(40779),w=a.i(87917),x=a.i(85165);function y(){let{perspective:a}=(0,w.usePerspective)(),[y,z]=(0,c.useState)([]),[A,B]=(0,c.useState)({proxyActive:!1,tlsIntercepted:!1,licenseModified:!1,keysExtracted:!1}),[C,D]=(0,c.useState)([]),[E,F]=(0,c.useState)(!1),[G,H]=(0,c.useState)(!0),[I,J]=(0,c.useState)(!1),K=(0,c.useCallback)((a,b="info")=>{let c={info:"[INFO]",attack:"[ATTACK]",defense:"[DEFENSE]",success:"[SUCCESS]",error:"[ERROR]"};D(d=>[...d,`${new Date().toLocaleTimeString()} ${c[b]} ${a}`])},[]),L=(0,c.useCallback)(a=>{z(b=>[...b,{...a,id:(0,x.bytesToHex)((0,x.generateKey)(4)),timestamp:Date.now()}])},[]),M=a=>new Promise(b=>setTimeout(b,a)),N=async()=>{if(F(!0),z([]),D([]),B({proxyActive:!1,tlsIntercepted:!1,licenseModified:!1,keysExtracted:!1}),K("Setting up MITM proxy on local network...","attack"),await M(800),B(a=>({...a,proxyActive:!0})),K("Proxy active - intercepting traffic","attack"),K("Attempting to intercept TLS connection...","attack"),await M(1e3),I){K("Certificate pinning detected!","defense"),K("Client rejected proxy certificate - attack blocked","error"),F(!1);return}G?(K("Installing custom CA certificate...","attack"),await M(500),K("TLS interception successful - can read encrypted traffic","attack"),B(a=>({...a,tlsIntercepted:!0}))):(K("WARNING: Connection not using TLS!","attack"),K("Traffic visible in plaintext","attack"),B(a=>({...a,tlsIntercepted:!0}))),K("Client requesting content manifest...","info"),await M(600),L({direction:"request",from:"Client",to:"CDN",type:"manifest",encrypted:G,intercepted:!0,modified:!1,data:"GET /manifest.mpd"}),L({direction:"response",from:"CDN",to:"Client",type:"manifest",encrypted:G,intercepted:!0,modified:!1,data:"MPD manifest with PSSH data"}),K("Client sending license request...","info"),await M(800),L({direction:"request",from:"Client",to:"License Server",type:"license_request",encrypted:G,intercepted:!0,modified:!1,data:"Encrypted challenge with device certificate"}),K("Intercepted license request - analyzing...","attack"),await M(500),K("License server responding...","info"),await M(1e3),L({direction:"response",from:"License Server",to:"Client",type:"license_response",encrypted:G,intercepted:!0,modified:!1,data:"Encrypted license with content keys"}),K("Intercepted license response!","attack"),K("Attempting to extract keys from response...","attack"),await M(1200),G?(K("License response is encrypted with device-specific key","info"),K("Cannot decrypt without device private key","error"),K("Keys protected by CDM encryption layer","defense")):(K("LICENSE RESPONSE IN PLAINTEXT!","attack"),K("Extracting content keys...","attack"),await M(500),B(a=>({...a,keysExtracted:!0})),K(`Key extracted: ${(0,x.bytesToHex)((0,x.generateKey)(16))}`,"success")),K("Content segments being requested...","info");for(let a=1;a<=3;a++)await M(400),L({direction:"request",from:"Client",to:"CDN",type:"content",encrypted:!0,intercepted:!0,modified:!1,data:`GET /segment_${a}.m4s (encrypted)`});K("Attack simulation complete","info"),F(!1)};return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[(0,b.jsx)(n.Network,{className:"w-6 h-6 text-red-500"}),"Man-in-the-Middle Attack"]}),(0,b.jsx)("p",{className:"text-muted-foreground mt-1",children:"Simulate network interception attacks on DRM license exchange"})]}),(0,b.jsx)(f.Badge,{variant:"red-team"===a?"destructive":"default",children:"red-team"===a?"Attack Mode":"Defense Analysis"})]}),(0,b.jsxs)(g.Alert,{variant:"destructive",children:[(0,b.jsx)(k.AlertTriangle,{className:"h-4 w-4"}),(0,b.jsx)(g.AlertTitle,{children:"Educational Simulation Only"}),(0,b.jsx)(g.AlertDescription,{children:"This simulates MITM attacks for educational purposes. Intercepting network traffic without authorization is illegal."})]}),(0,b.jsxs)(h.Tabs,{defaultValue:"simulation",className:"space-y-4",children:[(0,b.jsxs)(h.TabsList,{children:[(0,b.jsxs)(h.TabsTrigger,{value:"simulation",className:"gap-2",children:[(0,b.jsx)(n.Network,{className:"w-4 h-4"}),"Simulation"]}),(0,b.jsxs)(h.TabsTrigger,{value:"defense",className:"gap-2",children:[(0,b.jsx)(l.Shield,{className:"w-4 h-4"}),"Defense"]}),(0,b.jsxs)(h.TabsTrigger,{value:"technical",className:"gap-2",children:[(0,b.jsx)(o.Server,{className:"w-4 h-4"}),"Technical"]})]}),(0,b.jsxs)(h.TabsContent,{value:"simulation",className:"space-y-4",children:[(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsx)(d.CardTitle,{className:"text-lg",children:"Network Topology"}),(0,b.jsx)(d.CardDescription,{children:"Simulated DRM network with MITM proxy"})]}),(0,b.jsxs)(d.CardContent,{children:[(0,b.jsxs)("div",{className:"flex items-center justify-center gap-4 py-4",children:[(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:`w-16 h-16 rounded-lg border-2 flex items-center justify-center ${A.proxyActive?"border-blue-500 bg-blue-500/20":"border-border bg-muted"}`,children:(0,b.jsx)(p.Monitor,{className:"w-8 h-8"})}),(0,b.jsx)("span",{className:"text-sm mt-2 block",children:"Client"})]}),(0,b.jsx)(t.ArrowRight,{className:`w-6 h-6 ${A.tlsIntercepted?"text-red-500":"text-muted-foreground"}`}),(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:`w-16 h-16 rounded-lg border-2 flex items-center justify-center ${A.proxyActive?"border-red-500 bg-red-500/20":"border-border bg-muted"}`,children:(0,b.jsx)(s.Eye,{className:`w-8 h-8 ${A.proxyActive?"text-red-500":""}`})}),(0,b.jsx)("span",{className:"text-sm mt-2 block text-red-500",children:"MITM Proxy"})]}),(0,b.jsx)(t.ArrowRight,{className:`w-6 h-6 ${A.tlsIntercepted?"text-red-500":"text-muted-foreground"}`}),(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"w-16 h-16 rounded-lg border-2 border-purple-500 bg-purple-500/20 flex items-center justify-center",children:(0,b.jsx)(o.Server,{className:"w-8 h-8"})}),(0,b.jsx)("span",{className:"text-sm mt-2 block",children:"License Server"})]})]}),(0,b.jsxs)("div",{className:"flex justify-center gap-4 mt-4",children:[(0,b.jsxs)(f.Badge,{variant:A.proxyActive?"destructive":"outline",children:["Proxy: ",A.proxyActive?"Active":"Inactive"]}),(0,b.jsxs)(f.Badge,{variant:A.tlsIntercepted?"destructive":"outline",children:["TLS: ",A.tlsIntercepted?"Intercepted":"Secure"]}),(0,b.jsxs)(f.Badge,{variant:A.keysExtracted?"destructive":"outline",children:["Keys: ",A.keysExtracted?"Extracted!":"Protected"]})]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsx)(d.CardTitle,{className:"text-lg",children:"Attack Configuration"}),(0,b.jsx)(d.CardDescription,{children:"Configure target security settings"})]}),(0,b.jsxs)(d.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg border",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[G?(0,b.jsx)(q.Lock,{className:"w-4 h-4 text-green-500"}):(0,b.jsx)(r.Unlock,{className:"w-4 h-4 text-red-500"}),(0,b.jsx)("span",{className:"font-medium",children:"TLS Encryption"})]}),(0,b.jsx)(e.Button,{variant:G?"default":"destructive",size:"sm",onClick:()=>H(!G),disabled:E,children:G?"Enabled":"Disabled"})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg border",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(l.Shield,{className:`w-4 h-4 ${I?"text-green-500":"text-muted-foreground"}`}),(0,b.jsx)("span",{className:"font-medium",children:"Certificate Pinning"})]}),(0,b.jsx)(e.Button,{variant:I?"default":"outline",size:"sm",onClick:()=>J(!I),disabled:E,children:I?"Enabled":"Disabled"})]}),(0,b.jsx)(j.Separator,{}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)(e.Button,{onClick:N,disabled:E,variant:"destructive",className:"flex-1 gap-2",children:[(0,b.jsx)(m.Sword,{className:"w-4 h-4"}),E?"Running...":"Launch MITM Attack"]}),(0,b.jsx)(e.Button,{onClick:()=>{z([]),D([]),B({proxyActive:!1,tlsIntercepted:!1,licenseModified:!1,keysExtracted:!1})},variant:"outline",disabled:E,children:(0,b.jsx)(v.RefreshCw,{className:"w-4 h-4"})})]})]})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsx)(d.CardTitle,{className:"text-lg",children:"Intercepted Traffic"}),(0,b.jsx)(d.CardDescription,{children:"Network packets captured by proxy"})]}),(0,b.jsx)(d.CardContent,{children:(0,b.jsx)(i.ScrollArea,{className:"h-[200px]",children:0===y.length?(0,b.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,b.jsx)(n.Network,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),(0,b.jsx)("p",{className:"text-sm",children:"No packets captured"})]}):(0,b.jsx)("div",{className:"space-y-2",children:y.map(a=>(0,b.jsxs)("div",{className:`p-2 rounded border text-xs ${"license_response"===a.type&&!G?"border-red-500 bg-red-500/10":"border-border"}`,children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:["request"===a.direction?(0,b.jsx)(t.ArrowRight,{className:"w-3 h-3 text-blue-500"}):(0,b.jsx)(u.ArrowLeft,{className:"w-3 h-3 text-green-500"}),(0,b.jsxs)("span",{className:"font-medium",children:[a.from," â†’ ",a.to]}),(0,b.jsx)(f.Badge,{variant:"outline",className:"text-[10px]",children:a.type.replace("_"," ")}),a.encrypted&&(0,b.jsx)(q.Lock,{className:"w-3 h-3 text-green-500"})]}),(0,b.jsx)("code",{className:"text-muted-foreground",children:a.data})]},a.id))})})})]})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsx)(d.CardTitle,{className:"text-lg",children:"Attack Log"})}),(0,b.jsx)(d.CardContent,{children:(0,b.jsx)(i.ScrollArea,{className:"h-[150px] rounded-lg border bg-zinc-950 p-3",children:0===C.length?(0,b.jsx)("div",{className:"text-center text-muted-foreground text-sm py-8",children:"Launch attack to see output..."}):(0,b.jsx)("div",{className:"space-y-1 font-mono text-xs",children:C.map((a,c)=>(0,b.jsx)("div",{className:a.includes("[ATTACK]")?"text-red-400":a.includes("[DEFENSE]")?"text-blue-400":a.includes("[SUCCESS]")?"text-green-400":a.includes("[ERROR]")?"text-yellow-400":"text-muted-foreground",children:a},c))})})})]})]}),(0,b.jsx)(h.TabsContent,{value:"defense",className:"space-y-4",children:(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsxs)(d.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(l.Shield,{className:"w-5 h-5 text-blue-500"}),"Prevention"]})}),(0,b.jsxs)(d.CardContent,{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"p-3 rounded-lg border bg-green-500/10 border-green-500/30",children:[(0,b.jsx)("h4",{className:"font-medium text-green-400 mb-1",children:"TLS Everywhere"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"All DRM communication must use TLS 1.3 with strong cipher suites. Never transmit license data over unencrypted connections."})]}),(0,b.jsxs)("div",{className:"p-3 rounded-lg border bg-blue-500/10 border-blue-500/30",children:[(0,b.jsx)("h4",{className:"font-medium text-blue-400 mb-1",children:"Certificate Pinning"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Pin the license server certificate in the client application. Reject connections to servers with different certificates."})]}),(0,b.jsxs)("div",{className:"p-3 rounded-lg border bg-purple-500/10 border-purple-500/30",children:[(0,b.jsx)("h4",{className:"font-medium text-purple-400 mb-1",children:"End-to-End Encryption"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Encrypt license data with device-specific keys before TLS. Even if TLS is compromised, keys remain protected."})]})]})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsxs)(d.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(s.Eye,{className:"w-5 h-5 text-yellow-500"}),"Detection"]})}),(0,b.jsxs)(d.CardContent,{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"p-3 rounded-lg border",children:[(0,b.jsx)("h4",{className:"font-medium mb-1",children:"Certificate Validation"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Verify full certificate chain. Detect and reject self-signed or unauthorized CA certificates."})]}),(0,b.jsxs)("div",{className:"p-3 rounded-lg border",children:[(0,b.jsx)("h4",{className:"font-medium mb-1",children:"Connection Monitoring"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Monitor for unusual connection patterns, latency spikes, or certificate changes that indicate interception."})]}),(0,b.jsxs)("div",{className:"p-3 rounded-lg border",children:[(0,b.jsx)("h4",{className:"font-medium mb-1",children:"Request Fingerprinting"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Compare request characteristics against known client signatures to detect modified or replayed requests."})]})]})]})]})}),(0,b.jsx)(h.TabsContent,{value:"technical",className:"space-y-4",children:(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsx)(d.CardTitle,{children:"MITM Attack Mechanics"}),(0,b.jsx)(d.CardDescription,{children:"How network interception attacks work"})]}),(0,b.jsx)(d.CardContent,{className:"prose prose-invert max-w-none",children:(0,b.jsxs)("div",{className:"space-y-4 text-sm",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"font-medium mb-2",children:"Attack Phases"}),(0,b.jsxs)("ol",{className:"list-decimal pl-4 text-muted-foreground space-y-2",children:[(0,b.jsxs)("li",{children:[(0,b.jsx)("strong",{children:"Network Position:"})," Attacker gains position between client and server (ARP spoofing, rogue AP, DNS hijacking)"]}),(0,b.jsxs)("li",{children:[(0,b.jsx)("strong",{children:"TLS Interception:"})," Present fake certificate to client, establish separate TLS session with server"]}),(0,b.jsxs)("li",{children:[(0,b.jsx)("strong",{children:"Traffic Analysis:"})," Decrypt, analyze, and potentially modify traffic in real-time"]}),(0,b.jsxs)("li",{children:[(0,b.jsx)("strong",{children:"Data Extraction:"})," Extract sensitive data like session tokens, keys, or credentials"]})]})]}),(0,b.jsx)(j.Separator,{}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"font-medium mb-2",children:"Why Certificate Pinning Works"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Certificate pinning stores the expected certificate or public key hash in the application. When connecting, the app compares the server's certificate against the pinned value. If they don't match (as with a MITM proxy certificate), the connection is rejected."})]}),(0,b.jsx)(j.Separator,{}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"font-medium mb-2",children:"DRM-Specific Protections"}),(0,b.jsxs)("ul",{className:"list-disc pl-4 text-muted-foreground space-y-1",children:[(0,b.jsx)("li",{children:"License responses encrypted with device public key"}),(0,b.jsx)("li",{children:"Challenge-response protocols prevent replay attacks"}),(0,b.jsx)("li",{children:"Nonces and timestamps detect stale requests"}),(0,b.jsx)("li",{children:"Device attestation verifies client integrity"})]})]})]})})]})})]})]})}a.s(["MITMLab",()=>y])}];

//# sourceMappingURL=Projects_Git_drm-security-lab_src_components_labs_attacks_MITMLab_tsx_27a5e519._.js.map