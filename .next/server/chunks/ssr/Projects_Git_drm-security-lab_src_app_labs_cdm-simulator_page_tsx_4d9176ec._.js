module.exports=[70740,a=>{"use strict";var b=a.i(21350),c=a.i(25126),d=a.i(11878),e=a.i(50920),f=a.i(12056),g=a.i(24817),h=a.i(95514),i=a.i(89344),j=a.i(25626),k=a.i(53016),l=a.i(13782),m=a.i(29946),n=a.i(31406),o=a.i(19822),p=a.i(93502),q=a.i(73893),r=a.i(70911),s=a.i(21790),t=a.i(86347),u=a.i(66305),v=a.i(47061),w=a.i(71758),x=a.i(50685),y=a.i(31165),z=a.i(4983),A=a.i(90629),B=a.i(67710);let C={L1:{icon:m.Shield,description:"Hardware TEE - Keys never exposed to software",color:"text-green-500"},L2:{icon:t.Cpu,description:"Hardware crypto, software CDM - Hybrid protection",color:"text-yellow-500"},L3:{icon:s.Monitor,description:"Software only - Vulnerable to extraction",color:"text-red-500"}};function D(){let[a,s]=(0,c.useState)(null),[D]=(0,c.useState)(()=>new B.MockLicenseServer),[E,F]=(0,c.useState)("L1"),[G,H]=(0,c.useState)("uninitialized"),[I,J]=(0,c.useState)([]),[K,L]=(0,c.useState)(0),[M,N]=(0,c.useState)(!1),[O,P]=(0,c.useState)(!1),[Q,R]=(0,c.useState)(null),[S,T]=(0,c.useState)(null),U=(a,b,c,d)=>{let e={id:Math.random().toString(36).substr(2,9),timestamp:new Date,type:a,source:b,message:c,details:d};J(a=>[...a,e])},V=()=>{s(null),H("uninitialized"),J([]),L(0),N(!1),R(null),T(null)},W=a=>new Promise(b=>setTimeout(b,a)),X=async()=>{N(!0),V(),await W(500),L(1),U("info","system","Initializing Content Decryption Module...",`Security Level: ${E}`),await W(800);let a=new A.MockCDM(E);s(a),H("initialized"),U("success","cdm","CDM initialized successfully",`Device ID: ${a.getDeviceId()}`),await W(600);let b="demo-content-001",c=D.registerContent(b,"Demo Video","L3");L(2),U("info","cdm","Creating license session..."),await W(500);let d=a.createSession([c.keyId]);T(d.sessionId),H("session-created"),U("success","cdm","Session created",`Session ID: ${d.sessionId}`),await W(600),L(3),U("info","cdm","Generating license request..."),await W(500);let e=a.generateLicenseChallenge(d.sessionId);U("info","cdm","License challenge generated",`Key IDs: ${e.keyIds.join(", ")}`),await W(600),L(4),U("info","system","Sending license request to server..."),await W(800),U("info","server","License request received","Validating device certificate..."),await W(500);let f=e.deviceCertificate;U("success","server","Device certificate validated",`Security Level: ${f.securityLevel}`),await W(500),L(5);let g=D.processLicenseRequest(e,b);if("error"in g){U("error","server","License request denied",g.error),H("error"),N(!1);return}U("success","server","License generated",`Keys: ${g.keys.length}, Duration: ${g.policy.licenseDuration}s`),await W(600),U("info","system","Sending license response to CDM..."),await W(500),L(6),U("info","cdm","Processing license response..."),await W(500);try{if(a.processLicenseResponse(g),H("licensed"),U("success","cdm","License processed successfully"),"L3"===E){let b=a.simulateMemoryDump();if(b&&b.size>0){let a=b.values().next().value;R(a||null),U("warning","cdm","Key extracted from memory","L3 software CDM - keys accessible in memory")}}else"L2"===E?(R("[PARTIAL PROTECTION]"),U("info","cdm","Keys in hardware crypto engine","L2 hybrid - keys protected but decrypted content accessible")):(R("[PROTECTED IN TEE]"),U("success","cdm","Keys stored in hardware TEE","L1 hardware - keys never leave secure enclave"))}catch(a){U("error","cdm","Failed to process license",String(a)),H("error"),N(!1);return}await W(600),L(7),H("ready"),U("success","system","CDM ready for content decryption",`Security Level ${E}: ${C[E].description}`),N(!1)};return C[E].icon,(0,b.jsxs)("div",{className:"container max-w-6xl py-8",children:[(0,b.jsxs)("div",{className:"mb-8",children:[(0,b.jsxs)("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[(0,b.jsx)(t.Cpu,{className:"w-6 h-6 text-primary"}),"CDM Simulator"]}),(0,b.jsx)("p",{className:"text-muted-foreground mt-1",children:"Simulate Content Decryption Module behavior at different security levels"})]}),(0,b.jsxs)(g.Alert,{className:"mb-6",children:[(0,b.jsx)(m.Shield,{className:"h-4 w-4"}),(0,b.jsx)(g.AlertTitle,{children:"Understanding CDM Security Levels"}),(0,b.jsx)(g.AlertDescription,{children:"The CDM (Content Decryption Module) is the core component that handles license acquisition and content decryption. Security levels determine how well protected the decryption keys are from extraction."})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsx)(d.CardTitle,{className:"text-lg",children:"Security Level"}),(0,b.jsx)(d.CardDescription,{children:"Select CDM protection level"})]}),(0,b.jsx)(d.CardContent,{className:"space-y-3",children:["L1","L2","L3"].map(a=>{let c=C[a],d=c.icon;return(0,b.jsxs)(e.Button,{variant:E===a?"default":"outline",className:"w-full justify-start h-auto py-3",onClick:()=>{F(a),V()},disabled:M,children:[(0,b.jsx)(d,{className:`w-5 h-5 mr-3 ${c.color}`}),(0,b.jsxs)("div",{className:"text-left",children:[(0,b.jsxs)("div",{className:"font-medium",children:["Level ",a.charAt(1)]}),(0,b.jsx)("div",{className:"text-xs text-muted-foreground font-normal",children:c.description})]})]},a)})})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsx)(d.CardTitle,{className:"text-lg",children:"Simulation Controls"})}),(0,b.jsxs)(d.CardContent,{className:"space-y-4",children:[(0,b.jsxs)(e.Button,{onClick:X,disabled:M,className:"w-full gap-2",children:[(0,b.jsx)(n.Play,{className:"w-4 h-4"}),"Run Simulation"]}),(0,b.jsxs)(e.Button,{variant:"outline",onClick:V,disabled:M,className:"w-full gap-2",children:[(0,b.jsx)(o.RotateCcw,{className:"w-4 h-4"}),"Reset"]}),(0,b.jsx)(j.Separator,{}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)(l.Label,{className:"text-sm flex items-center gap-2",children:[O?(0,b.jsx)(y.Eye,{className:"w-4 h-4"}):(0,b.jsx)(z.EyeOff,{className:"w-4 h-4"}),"Show Keys"]}),(0,b.jsx)(k.Switch,{checked:O,onCheckedChange:P})]}),"L3"===E&&O&&(0,b.jsxs)(g.Alert,{variant:"destructive",className:"text-xs",children:[(0,b.jsx)(w.AlertTriangle,{className:"h-3 w-3"}),(0,b.jsx)(g.AlertDescription,{children:"L3 keys are vulnerable to memory extraction!"})]})]})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsx)(d.CardTitle,{className:"text-lg",children:"CDM State"})}),(0,b.jsx)(d.CardContent,{children:(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"State"}),(0,b.jsx)(f.Badge,{variant:"ready"===G?"default":"outline",children:G})]}),S&&(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"Session"}),(0,b.jsx)("code",{className:"block text-xs bg-zinc-950 p-2 rounded mt-1 truncate",children:S})]}),Q&&O&&(0,b.jsxs)("div",{children:[(0,b.jsxs)("span",{className:"text-sm text-muted-foreground flex items-center gap-1",children:[(0,b.jsx)(p.Key,{className:"w-3 h-3"}),"Content Key"]}),(0,b.jsx)("code",{className:`block text-xs p-2 rounded mt-1 truncate ${"L1"===E?"bg-green-500/10 text-green-400":"L2"===E?"bg-yellow-500/10 text-yellow-400":"bg-red-500/10 text-red-400"}`,children:"L1"===E?"[PROTECTED IN TEE]":Q})]}),(0,b.jsx)(h.Progress,{value:K/7*100,className:"mt-4"}),(0,b.jsxs)("div",{className:"text-xs text-center text-muted-foreground",children:["Step ",K," of 7"]})]})})]})]}),(0,b.jsxs)(d.Card,{className:"lg:col-span-2",children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsx)(d.CardTitle,{className:"text-lg",children:"License Acquisition Flow"}),(0,b.jsx)(d.CardDescription,{children:"Watch the complete DRM handshake process"})]}),(0,b.jsxs)(d.CardContent,{children:[(0,b.jsxs)("div",{className:"mb-6 p-4 rounded-lg border bg-zinc-950",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:`p-3 rounded-lg mx-auto mb-2 w-fit ${K>=1?"bg-primary/20":"bg-muted"}`,children:(0,b.jsx)(r.Smartphone,{className:"w-6 h-6"})}),(0,b.jsx)("div",{className:"text-xs font-medium",children:"Client"}),(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:"CDM"})]}),(0,b.jsxs)("div",{className:"flex-1 flex items-center justify-center gap-1",children:[(0,b.jsx)(x.ArrowRight,{className:`w-4 h-4 ${K>=3?"text-primary":"text-muted"}`}),(0,b.jsx)(x.ArrowRight,{className:`w-4 h-4 ${K>=3?"text-primary":"text-muted"}`}),(0,b.jsx)(f.Badge,{variant:"outline",className:"text-xs",children:"License Request"}),(0,b.jsx)(x.ArrowRight,{className:`w-4 h-4 ${K>=3?"text-primary":"text-muted"}`}),(0,b.jsx)(x.ArrowRight,{className:`w-4 h-4 ${K>=3?"text-primary":"text-muted"}`})]}),(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:`p-3 rounded-lg mx-auto mb-2 w-fit ${K>=4?"bg-purple-500/20":"bg-muted"}`,children:(0,b.jsx)(q.Server,{className:"w-6 h-6"})}),(0,b.jsx)("div",{className:"text-xs font-medium",children:"License Server"}),(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:"DRM"})]})]}),(0,b.jsxs)("div",{className:"flex items-center justify-center gap-1 mt-4",children:[(0,b.jsx)(x.ArrowRight,{className:`w-4 h-4 rotate-180 ${K>=5?"text-green-500":"text-muted"}`}),(0,b.jsx)(x.ArrowRight,{className:`w-4 h-4 rotate-180 ${K>=5?"text-green-500":"text-muted"}`}),(0,b.jsx)(f.Badge,{variant:"outline",className:"text-xs bg-green-500/10",children:"License Response"}),(0,b.jsx)(x.ArrowRight,{className:`w-4 h-4 rotate-180 ${K>=5?"text-green-500":"text-muted"}`}),(0,b.jsx)(x.ArrowRight,{className:`w-4 h-4 rotate-180 ${K>=5?"text-green-500":"text-muted"}`})]})]}),(0,b.jsx)(i.ScrollArea,{className:"h-[350px] pr-4",children:0===I.length?(0,b.jsxs)("div",{className:"text-center py-16 text-muted-foreground",children:[(0,b.jsx)(t.Cpu,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),(0,b.jsx)("p",{children:'Click "Run Simulation" to start'})]}):(0,b.jsx)("div",{className:"space-y-2",children:I.map(a=>(0,b.jsx)("div",{className:`p-3 rounded-lg border ${"error"===a.type?"border-red-500/30 bg-red-500/5":"success"===a.type?"border-green-500/30 bg-green-500/5":"warning"===a.type?"border-yellow-500/30 bg-yellow-500/5":"border-muted bg-muted/30"}`,children:(0,b.jsxs)("div",{className:"flex items-start gap-2",children:[(a=>{switch(a){case"success":return(0,b.jsx)(u.CheckCircle2,{className:"w-4 h-4 text-green-500"});case"warning":return(0,b.jsx)(w.AlertTriangle,{className:"w-4 h-4 text-yellow-500"});case"error":return(0,b.jsx)(v.XCircle,{className:"w-4 h-4 text-red-500"});default:return(0,b.jsx)(x.ArrowRight,{className:"w-4 h-4 text-blue-500"})}})(a.type),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(a=>{switch(a){case"cdm":return(0,b.jsx)(f.Badge,{variant:"outline",className:"text-xs",children:"CDM"});case"server":return(0,b.jsx)(f.Badge,{variant:"outline",className:"text-xs text-purple-400",children:"Server"});default:return(0,b.jsx)(f.Badge,{variant:"outline",className:"text-xs text-blue-400",children:"System"})}})(a.source),(0,b.jsx)("span",{className:"text-xs text-muted-foreground",children:a.timestamp.toLocaleTimeString()})]}),(0,b.jsx)("p",{className:"text-sm",children:a.message}),a.details&&(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:a.details})]})]})},a.id))})})]})]})]}),(0,b.jsxs)(d.Card,{className:"mt-6",children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsx)(d.CardTitle,{className:"text-lg",children:"Security Level Comparison"})}),(0,b.jsx)(d.CardContent,{children:(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"w-full text-sm",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"border-b",children:[(0,b.jsx)("th",{className:"text-left py-2 px-4",children:"Feature"}),(0,b.jsx)("th",{className:"text-center py-2 px-4",children:"L1 (Hardware TEE)"}),(0,b.jsx)("th",{className:"text-center py-2 px-4",children:"L2 (Hybrid)"}),(0,b.jsx)("th",{className:"text-center py-2 px-4",children:"L3 (Software)"})]})}),(0,b.jsxs)("tbody",{children:[(0,b.jsxs)("tr",{className:"border-b",children:[(0,b.jsx)("td",{className:"py-2 px-4",children:"Key Storage"}),(0,b.jsx)("td",{className:"text-center py-2 px-4",children:(0,b.jsx)(u.CheckCircle2,{className:"w-4 h-4 text-green-500 mx-auto"})}),(0,b.jsx)("td",{className:"text-center py-2 px-4",children:(0,b.jsx)(w.AlertTriangle,{className:"w-4 h-4 text-yellow-500 mx-auto"})}),(0,b.jsx)("td",{className:"text-center py-2 px-4",children:(0,b.jsx)(v.XCircle,{className:"w-4 h-4 text-red-500 mx-auto"})})]}),(0,b.jsxs)("tr",{className:"border-b",children:[(0,b.jsx)("td",{className:"py-2 px-4",children:"Decryption Location"}),(0,b.jsx)("td",{className:"text-center py-2 px-4 text-xs text-muted-foreground",children:"Hardware TEE"}),(0,b.jsx)("td",{className:"text-center py-2 px-4 text-xs text-muted-foreground",children:"Hardware Engine"}),(0,b.jsx)("td",{className:"text-center py-2 px-4 text-xs text-muted-foreground",children:"Software/Memory"})]}),(0,b.jsxs)("tr",{className:"border-b",children:[(0,b.jsx)("td",{className:"py-2 px-4",children:"Max Resolution"}),(0,b.jsx)("td",{className:"text-center py-2 px-4 text-xs",children:"4K HDR"}),(0,b.jsx)("td",{className:"text-center py-2 px-4 text-xs",children:"1080p"}),(0,b.jsx)("td",{className:"text-center py-2 px-4 text-xs",children:"480p"})]}),(0,b.jsxs)("tr",{className:"border-b",children:[(0,b.jsx)("td",{className:"py-2 px-4",children:"Extraction Risk"}),(0,b.jsx)("td",{className:"text-center py-2 px-4 text-xs text-green-400",children:"Very Low"}),(0,b.jsx)("td",{className:"text-center py-2 px-4 text-xs text-yellow-400",children:"Medium"}),(0,b.jsx)("td",{className:"text-center py-2 px-4 text-xs text-red-400",children:"High"})]}),(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:"py-2 px-4",children:"Typical Devices"}),(0,b.jsx)("td",{className:"text-center py-2 px-4 text-xs text-muted-foreground",children:"Smart TVs, Set-top boxes"}),(0,b.jsx)("td",{className:"text-center py-2 px-4 text-xs text-muted-foreground",children:"Some Android devices"}),(0,b.jsx)("td",{className:"text-center py-2 px-4 text-xs text-muted-foreground",children:"Desktop browsers"})]})]})]})})})]})]})}a.s(["default",()=>D])}];

//# sourceMappingURL=Projects_Git_drm-security-lab_src_app_labs_cdm-simulator_page_tsx_4d9176ec._.js.map