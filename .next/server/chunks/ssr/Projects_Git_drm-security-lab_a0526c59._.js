module.exports=[7378,a=>{"use strict";let b=(0,a.i(58691).default)("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);a.s(["Lock",()=>b],7378)},93502,a=>{"use strict";let b=(0,a.i(58691).default)("key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);a.s(["Key",()=>b],93502)},40779,a=>{"use strict";let b=(0,a.i(58691).default)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);a.s(["RefreshCw",()=>b],40779)},66305,a=>{"use strict";let b=(0,a.i(58691).default)("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);a.s(["CheckCircle2",()=>b],66305)},11878,a=>{"use strict";var b=a.i(21350),c=a.i(45705);function d({className:a,...d}){return(0,b.jsx)("div",{"data-slot":"card",className:(0,c.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",a),...d})}function e({className:a,...d}){return(0,b.jsx)("div",{"data-slot":"card-header",className:(0,c.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",a),...d})}function f({className:a,...d}){return(0,b.jsx)("div",{"data-slot":"card-title",className:(0,c.cn)("leading-none font-semibold",a),...d})}function g({className:a,...d}){return(0,b.jsx)("div",{"data-slot":"card-description",className:(0,c.cn)("text-muted-foreground text-sm",a),...d})}function h({className:a,...d}){return(0,b.jsx)("div",{"data-slot":"card-content",className:(0,c.cn)("px-6",a),...d})}a.s(["Card",()=>d,"CardContent",()=>h,"CardDescription",()=>g,"CardHeader",()=>e,"CardTitle",()=>f])},29946,a=>{"use strict";let b=(0,a.i(58691).default)("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);a.s(["Shield",()=>b],29946)},91703,(a,b,c)=>{"use strict";b.exports=a.r(22922).vendored["react-ssr"].ReactDOM},25626,a=>{"use strict";var b=a.i(21350),c=a.i(25126);a.i(91703);var d=a.i(37810),e=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((a,e)=>{let f=(0,d.createSlot)(`Primitive.${e}`),g=c.forwardRef((a,c)=>{let{asChild:d,...g}=a;return(0,b.jsx)(d?f:e,{...g,ref:c})});return g.displayName=`Primitive.${e}`,{...a,[e]:g}},{}),f="horizontal",g=["horizontal","vertical"],h=c.forwardRef((a,c)=>{var d;let{decorative:h,orientation:i=f,...j}=a,k=(d=i,g.includes(d))?i:f;return(0,b.jsx)(e.div,{"data-orientation":k,...h?{role:"none"}:{"aria-orientation":"vertical"===k?k:void 0,role:"separator"},...j,ref:c})});h.displayName="Separator";var i=a.i(45705);function j({className:a,orientation:c="horizontal",decorative:d=!0,...e}){return(0,b.jsx)(h,{"data-slot":"separator",decorative:d,orientation:c,className:(0,i.cn)("bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",a),...e})}a.s(["Separator",()=>j],25626)},24817,a=>{"use strict";var b=a.i(21350),c=a.i(48680),d=a.i(45705);let e=(0,c.cva)("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function f({className:a,variant:c,...f}){return(0,b.jsx)("div",{"data-slot":"alert",role:"alert",className:(0,d.cn)(e({variant:c}),a),...f})}function g({className:a,...c}){return(0,b.jsx)("div",{"data-slot":"alert-title",className:(0,d.cn)("col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight",a),...c})}function h({className:a,...c}){return(0,b.jsx)("div",{"data-slot":"alert-description",className:(0,d.cn)("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",a),...c})}a.s(["Alert",()=>f,"AlertDescription",()=>h,"AlertTitle",()=>g])},85165,a=>{"use strict";function b(a,b){let c=Math.min(a.length,b.length),d=new Uint8Array(c);for(let e=0;e<c;e++)d[e]=a[e]^b[e];return d}function c(a=16){let b=new Uint8Array(a);for(let c=0;c<a;c++)b[c]=Math.floor(256*Math.random());return b}function d(a){return Array.from(a).map(a=>a.toString(16).padStart(2,"0")).join("")}function e(a){let b=new Uint8Array(a.length/2);for(let c=0;c<b.length;c++)b[c]=parseInt(a.substr(2*c,2),16);return b}function f(a){return new TextEncoder().encode(a)}function g(a){return Buffer.from(a).toString("base64")}function h(a){return new Uint8Array(Buffer.from(a,"base64"))}function i(a){let b=0;for(let c=0;c<a.length;c++)b=(b<<5)-b+a[c]|0;return Math.abs(b).toString(16).padStart(8,"0")}function j(){let a=d(c(16));return`${a.slice(0,8)}-${a.slice(8,12)}-${a.slice(12,16)}-${a.slice(16,20)}-${a.slice(20,32)}`}class k{key;iv;constructor(a,b){this.key=a,this.iv=b||c(16)}encryptCTR(a){let b=new Uint8Array(a.length);for(let c=0;c<a.length;c+=16){let d=new Uint8Array(16);d.set(this.iv.slice(0,8),0);let e=Math.floor(c/16);for(let a=0;a<8;a++)d[8+a]=e>>8*(7-a)&255;let f=function(a,b){let c=new Uint8Array(a.length);for(let d=0;d<a.length;d++)c[d]=a[d]^b[d%b.length];return c}(d,this.key),g=Math.min(c+16,a.length);for(let d=c;d<g;d++)b[d]=a[d]^f[d-c]}return{ciphertext:b,iv:this.iv}}decryptCTR(a){return this.encryptCTR(a).ciphertext}getIV(){return this.iv}}class l{privateKey;publicKey;modulus;constructor(){this.modulus=3233,this.publicKey=17,this.privateKey=this.modInverse(this.publicKey,3120)}modInverse(a,b){let[c,d]=[a,b],[e,f]=[1,0];for(;0!==d;){let a=Math.floor(c/d);[c,d]=[d,c-a*d],[e,f]=[f,e-a*f]}return(e%b+b)%b}modPow(a,b,c){let d=1;for(a%=c;b>0;)b%2==1&&(d=d*a%c),b=Math.floor(b/2),a=a*a%c;return d}encrypt(a){return this.modPow(a,this.publicKey,this.modulus)}decrypt(a){return this.modPow(a,this.privateKey,this.modulus)}encryptBytes(a){return Array.from(a).map(a=>this.encrypt(a))}decryptBytes(a){return new Uint8Array(a.map(a=>this.decrypt(a)))}getPublicKey(){return{e:this.publicKey,n:this.modulus}}sign(a){return Array.from(f(i(a))).map(a=>this.modPow(a,this.privateKey,this.modulus)).join(",")}verify(a,b){var c;let d=i(a);return c=new Uint8Array(b.split(",").map(Number).map(a=>this.modPow(a,this.publicKey,this.modulus))),new TextDecoder().decode(c)===d}}a.s(["SimpleAsymmetric",()=>l,"SimpleCipher",()=>k,"base64Decode",()=>h,"base64Encode",()=>g,"bytesToHex",()=>d,"generateKey",()=>c,"generateKeyId",()=>j,"hexToBytes",()=>e,"simpleHash",()=>i,"stringToBytes",()=>f,"xorBytes",()=>b])},73893,a=>{"use strict";let b=(0,a.i(58691).default)("server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]);a.s(["Server",()=>b],73893)},28470,a=>{"use strict";let b=(0,a.i(58691).default)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);a.s(["User",()=>b],28470)},1916,a=>{"use strict";var b=a.i(21350),c=a.i(25126),d=a.i(11878),e=a.i(50920),f=a.i(12056),g=a.i(24817),h=a.i(89344),i=a.i(25626),j=a.i(93502),k=a.i(7378);let l=(0,a.i(58691).default)("arrow-left-right",[["path",{d:"M8 3 4 7l4 4",key:"9rb6wj"}],["path",{d:"M4 7h16",key:"6tx8e3"}],["path",{d:"m16 21 4-4-4-4",key:"siv7j2"}],["path",{d:"M20 17H4",key:"h6l3hr"}]]);var m=a.i(29946),n=a.i(28470),o=a.i(73893),p=a.i(40779),q=a.i(66305),r=a.i(85165);function s(){let[a,s]=(0,c.useState)([]),[t,u]=(0,c.useState)(!1),[v,w]=(0,c.useState)("dh"),x=a=>new Promise(b=>setTimeout(b,a)),y=async()=>{u(!0),s([]),s([{id:"1",actor:"shared",title:"Agree on Parameters",description:"Both parties agree on prime p=23 and generator g=5",value:"p=23, g=5",status:"complete"}]),await x(800);let a=Math.floor(10*Math.random())+1,b=Math.pow(5,a)%23;s(b=>[...b,{id:"2",actor:"client",title:"Client Private Key",description:`Client chooses secret a=${a}`,value:`a = ${a} (secret)`,status:"complete"}]),await x(600),s(c=>[...c,{id:"3",actor:"client",title:"Client Public Key",description:`Client computes A = g^a mod p = 5^${a} mod 23`,value:`A = ${b}`,status:"complete"}]),await x(600);let c=Math.floor(10*Math.random())+1,d=Math.pow(5,c)%23;s(a=>[...a,{id:"4",actor:"server",title:"Server Private Key",description:`Server chooses secret b=${c}`,value:`b = ${c} (secret)`,status:"complete"}]),await x(600),s(a=>[...a,{id:"5",actor:"server",title:"Server Public Key",description:`Server computes B = g^b mod p = 5^${c} mod 23`,value:`B = ${d}`,status:"complete"}]),await x(600),s(a=>[...a,{id:"6",actor:"shared",title:"Exchange Public Keys",description:"Client sends A to server, server sends B to client",value:`Client→Server: ${b}, Server→Client: ${d}`,status:"complete"}]),await x(800);let e=Math.pow(d,a)%23,f=Math.pow(b,c)%23;s(b=>[...b,{id:"7",actor:"client",title:"Client Computes Shared Secret",description:`s = B^a mod p = ${d}^${a} mod 23`,value:`s = ${e}`,status:"complete"}]),await x(600),s(a=>[...a,{id:"8",actor:"server",title:"Server Computes Shared Secret",description:`s = A^b mod p = ${b}^${c} mod 23`,value:`s = ${f}`,status:"complete"}]),await x(600),s(a=>[...a,{id:"9",actor:"shared",title:"Shared Secret Established!",description:`Both parties now share secret ${e} for encryption`,value:e===f?"Secrets Match!":"Error!",status:"complete"}]),u(!1)},z=async()=>{u(!0),s([]),s([{id:"1",actor:"server",title:"Generate RSA Key Pair",description:"Server generates public/private key pair",value:"n=3233, e=17, d=2753",status:"complete"}]),await x(800),s(a=>[...a,{id:"2",actor:"server",title:"Share Public Key",description:"Server sends public key (n, e) to client",value:"Public: (n=3233, e=17)",status:"complete"}]),await x(600);let a=(0,r.bytesToHex)((0,r.generateKey)(16));s(b=>[...b,{id:"3",actor:"client",title:"Generate Session Key",description:"Client generates random AES session key",value:a.substring(0,32)+"...",status:"complete"}]),await x(600),s(a=>[...a,{id:"4",actor:"client",title:"Encrypt Session Key",description:"Client encrypts session key with server public key",value:(0,r.bytesToHex)((0,r.generateKey)(32)).substring(0,32)+"...",status:"complete"}]),await x(600),s(a=>[...a,{id:"5",actor:"shared",title:"Send Encrypted Key",description:"Client sends encrypted session key to server",status:"complete"}]),await x(600),s(b=>[...b,{id:"6",actor:"server",title:"Decrypt Session Key",description:"Server decrypts using private key d",value:a.substring(0,32)+"...",status:"complete"}]),await x(600),s(a=>[...a,{id:"7",actor:"shared",title:"Secure Channel Established!",description:"Both parties share the AES session key",value:"Keys Match!",status:"complete"}]),u(!1)};return(0,b.jsxs)("div",{className:"container max-w-6xl py-8",children:[(0,b.jsxs)("div",{className:"mb-8",children:[(0,b.jsxs)("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[(0,b.jsx)(j.Key,{className:"w-6 h-6 text-primary"}),"Key Exchange Lab"]}),(0,b.jsx)("p",{className:"text-muted-foreground mt-1",children:"Visualize Diffie-Hellman and RSA key exchange protocols"})]}),(0,b.jsxs)(g.Alert,{className:"mb-6",children:[(0,b.jsx)(m.Shield,{className:"h-4 w-4"}),(0,b.jsx)(g.AlertTitle,{children:"How DRM Uses Key Exchange"}),(0,b.jsx)(g.AlertDescription,{children:"DRM systems use key exchange protocols to securely transfer content decryption keys from the license server to the client. This ensures only authorized devices can decrypt content."})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsx)(d.CardTitle,{className:"text-lg",children:"Exchange Protocol"}),(0,b.jsx)(d.CardDescription,{children:"Select key exchange method"})]}),(0,b.jsxs)(d.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(e.Button,{variant:"dh"===v?"default":"outline",className:"w-full justify-start",onClick:()=>w("dh"),disabled:t,children:[(0,b.jsx)(l,{className:"w-4 h-4 mr-2"}),"Diffie-Hellman"]}),(0,b.jsxs)(e.Button,{variant:"rsa"===v?"default":"outline",className:"w-full justify-start",onClick:()=>w("rsa"),disabled:t,children:[(0,b.jsx)(k.Lock,{className:"w-4 h-4 mr-2"}),"RSA Key Transport"]})]}),(0,b.jsx)(i.Separator,{}),(0,b.jsxs)(e.Button,{onClick:()=>{"dh"===v?y():z()},disabled:t,className:"w-full gap-2",children:[t?(0,b.jsx)(p.RefreshCw,{className:"w-4 h-4 animate-spin"}):(0,b.jsx)(j.Key,{className:"w-4 h-4"}),t?"Running...":"Run Exchange"]}),(0,b.jsxs)("div",{className:"text-xs text-muted-foreground space-y-2",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(n.User,{className:"w-3 h-3 text-blue-400"})," Client"]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(o.Server,{className:"w-3 h-3 text-purple-400"})," Server"]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(l,{className:"w-3 h-3 text-green-400"})," Shared"]})]})]})]}),(0,b.jsxs)(d.Card,{className:"lg:col-span-2",children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsx)(d.CardTitle,{className:"text-lg",children:"Exchange Process"}),(0,b.jsx)(d.CardDescription,{children:"Step-by-step key exchange visualization"})]}),(0,b.jsx)(d.CardContent,{children:(0,b.jsx)(h.ScrollArea,{className:"h-[400px] pr-4",children:0===a.length?(0,b.jsxs)("div",{className:"text-center py-12 text-muted-foreground",children:[(0,b.jsx)(j.Key,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),(0,b.jsx)("p",{children:"Select a protocol and run the exchange"})]}):(0,b.jsx)("div",{className:"space-y-3",children:a.map((a,c)=>(0,b.jsxs)("div",{className:`p-4 rounded-lg border ${(a=>{switch(a){case"client":return"bg-blue-500/10 border-blue-500/30 text-blue-400";case"server":return"bg-purple-500/10 border-purple-500/30 text-purple-400";case"shared":return"bg-green-500/10 border-green-500/30 text-green-400";default:return""}})(a.actor)}`,children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,b.jsxs)(f.Badge,{variant:"outline",className:"text-xs",children:["Step ",c+1]}),(0,b.jsx)(f.Badge,{variant:"outline",className:"text-xs capitalize",children:a.actor}),"complete"===a.status&&(0,b.jsx)(q.CheckCircle2,{className:"w-4 h-4 text-green-500 ml-auto"})]}),(0,b.jsx)("h4",{className:"font-medium",children:a.title}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:a.description}),a.value&&(0,b.jsx)("code",{className:"text-xs bg-background/50 px-2 py-1 rounded mt-2 inline-block",children:a.value})]},a.id))})})})]})]})]})}a.s(["default",()=>s],1916)}];

//# sourceMappingURL=Projects_Git_drm-security-lab_a0526c59._.js.map