module.exports=[63330,a=>{"use strict";var b=a.i(21350),c=a.i(25126),d=a.i(11878),e=a.i(50920),f=a.i(12056),g=a.i(24817),h=a.i(7208),i=a.i(89344),j=a.i(25626),k=a.i(71758),l=a.i(29946),m=a.i(4966),n=a.i(93502),o=a.i(32977);let p=(0,a.i(58691).default)("share-2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);var q=a.i(61569),r=a.i(94887),s=a.i(88014),t=a.i(87917),u=a.i(85165);function v(){let{perspective:a}=(0,t.usePerspective)(),[v,w]=(0,c.useState)([]),[x,y]=(0,c.useState)([{id:"1",name:"Alice",type:"legitimate",hasLicense:!0,usingSharedKey:!1},{id:"2",name:"Bob",type:"pirate",hasLicense:!1,usingSharedKey:!1},{id:"3",name:"Charlie",type:"pirate",hasLicense:!1,usingSharedKey:!1},{id:"4",name:"Diana",type:"legitimate",hasLicense:!0,usingSharedKey:!1}]),[z,A]=(0,c.useState)([]),[B,C]=(0,c.useState)("none"),[D,E]=(0,c.useState)(!1),[F,G]=(0,c.useState)(new Set),H=(0,c.useCallback)(a=>{A(b=>[...b,`[${new Date().toLocaleTimeString()}] ${a}`])},[]);return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[(0,b.jsx)(p,{className:"w-6 h-6 text-red-500"}),"Key Sharing Attack"]}),(0,b.jsx)("p",{className:"text-muted-foreground mt-1",children:"Simulate content key sharing and redistribution attacks"})]}),(0,b.jsx)(f.Badge,{variant:"red-team"===a?"destructive":"default",children:"red-team"===a?"Attack Mode":"Defense Analysis"})]}),(0,b.jsxs)(g.Alert,{variant:"destructive",children:[(0,b.jsx)(k.AlertTriangle,{className:"h-4 w-4"}),(0,b.jsx)(g.AlertTitle,{children:"Educational Simulation Only"}),(0,b.jsx)(g.AlertDescription,{children:"This simulates key sharing for educational purposes. Sharing copyrighted content keys is illegal."})]}),(0,b.jsxs)(h.Tabs,{defaultValue:"simulation",className:"space-y-4",children:[(0,b.jsxs)(h.TabsList,{children:[(0,b.jsxs)(h.TabsTrigger,{value:"simulation",className:"gap-2",children:[(0,b.jsx)(o.Users,{className:"w-4 h-4"}),"Simulation"]}),(0,b.jsxs)(h.TabsTrigger,{value:"defense",className:"gap-2",children:[(0,b.jsx)(l.Shield,{className:"w-4 h-4"}),"Defense"]}),(0,b.jsxs)(h.TabsTrigger,{value:"technical",className:"gap-2",children:[(0,b.jsx)(n.Key,{className:"w-4 h-4"}),"Technical"]})]}),(0,b.jsxs)(h.TabsContent,{value:"simulation",className:"space-y-4",children:[(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsx)(d.CardTitle,{className:"text-lg",children:"Scenario Controls"}),(0,b.jsx)(d.CardDescription,{children:"Run key sharing attack simulation"})]}),(0,b.jsx)(d.CardContent,{children:(0,b.jsxs)("div",{className:"flex gap-3 flex-wrap",children:[(0,b.jsxs)(e.Button,{onClick:()=>{C("sharing"),H("Alice (legitimate user) extracts key from her L3 device...");let a=(0,u.bytesToHex)((0,u.generateKey)(8)),b=(0,u.bytesToHex)((0,u.generateKey)(16));setTimeout(()=>{let c={keyId:a,key:b,contentId:"premium-movie-2024",sharedBy:"Alice",timestamp:Date.now(),downloads:0};w(a=>[...a,c]),H(`Key extracted: ${a.substring(0,8)}...`),H("Alice shares key on underground forum...")},1e3)},variant:"destructive",disabled:v.length>0,className:"gap-2",children:[(0,b.jsx)(m.Sword,{className:"w-4 h-4"}),"Extract & Share Key"]}),(0,b.jsxs)(e.Button,{onClick:()=>{C("detection"),E(!0),H("Enabling anomaly detection system..."),H("Monitoring: License-to-playback correlation"),H("Monitoring: Geographic impossibility checks"),H("Monitoring: Device fingerprint analysis"),x.forEach(a=>{a.usingSharedKey&&setTimeout(()=>{H(`DETECTED: ${a.name} - No license but decrypting content`),H(`ACTION: Revoking access for ${a.name}`),G(b=>new Set([...b,a.id])),y(b=>b.map(b=>b.id===a.id?{...b,usingSharedKey:!1}:b))},1e3)})},variant:"default",disabled:D,className:"gap-2",children:[(0,b.jsx)(l.Shield,{className:"w-4 h-4"}),"Enable Detection"]}),(0,b.jsx)(e.Button,{onClick:()=>{w([]),y([{id:"1",name:"Alice",type:"legitimate",hasLicense:!0,usingSharedKey:!1},{id:"2",name:"Bob",type:"pirate",hasLicense:!1,usingSharedKey:!1},{id:"3",name:"Charlie",type:"pirate",hasLicense:!1,usingSharedKey:!1},{id:"4",name:"Diana",type:"legitimate",hasLicense:!0,usingSharedKey:!1}]),A([]),C("none"),E(!1),G(new Set)},variant:"outline",className:"gap-2",children:"Reset"})]})})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsxs)(d.CardTitle,{className:"text-lg flex items-center gap-2",children:[(0,b.jsx)(q.Globe,{className:"w-5 h-5 text-red-500"}),"Underground Forum"]}),(0,b.jsx)(d.CardDescription,{children:"Shared decryption keys"})]}),(0,b.jsx)(d.CardContent,{children:0===v.length?(0,b.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,b.jsx)(n.Key,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),(0,b.jsx)("p",{className:"text-sm",children:"No keys shared yet"})]}):(0,b.jsx)("div",{className:"space-y-3",children:v.map((a,c)=>(0,b.jsxs)("div",{className:"rounded-lg border border-red-500/30 bg-red-500/10 p-3",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsx)("span",{className:"text-sm font-medium text-red-400",children:a.contentId}),(0,b.jsxs)(f.Badge,{variant:"outline",className:"text-xs",children:[a.downloads," downloads"]})]}),(0,b.jsxs)("div",{className:"text-xs space-y-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Key ID:"}),(0,b.jsxs)("code",{className:"bg-background px-1 rounded",children:[a.keyId.substring(0,16),"..."]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Key:"}),(0,b.jsxs)("code",{className:"bg-background px-1 rounded",children:[a.key.substring(0,16),"..."]}),(0,b.jsx)(e.Button,{variant:"ghost",size:"icon",className:"h-5 w-5",children:(0,b.jsx)(r.Copy,{className:"w-3 h-3"})})]}),(0,b.jsxs)("div",{className:"text-muted-foreground",children:["Shared by: ",a.sharedBy]})]})]},c))})})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsxs)(d.CardTitle,{className:"text-lg flex items-center gap-2",children:[(0,b.jsx)(o.Users,{className:"w-5 h-5"}),"Users"]}),(0,b.jsx)(d.CardDescription,{children:"Simulated user behavior"})]}),(0,b.jsx)(d.CardContent,{children:(0,b.jsx)("div",{className:"space-y-3",children:x.map(a=>(0,b.jsxs)("div",{className:`rounded-lg border p-3 ${F.has(a.id)?"border-red-500 bg-red-500/10":a.usingSharedKey?"border-yellow-500 bg-yellow-500/10":a.hasLicense?"border-green-500/30 bg-green-500/5":"border-border"}`,children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsx)("span",{className:"font-medium",children:a.name}),(0,b.jsxs)("div",{className:"flex gap-1",children:[a.hasLicense&&(0,b.jsx)(f.Badge,{variant:"outline",className:"text-xs text-green-500 border-green-500",children:"Licensed"}),a.usingSharedKey&&(0,b.jsx)(f.Badge,{variant:"outline",className:"text-xs text-yellow-500 border-yellow-500",children:"Pirating"}),F.has(a.id)&&(0,b.jsx)(f.Badge,{variant:"destructive",className:"text-xs",children:"Blocked"})]})]}),!a.hasLicense&&v.length>0&&!F.has(a.id)&&(0,b.jsxs)(e.Button,{size:"sm",variant:"outline",onClick:()=>(a=>{let b=x.find(b=>b.id===a);if(b&&!b.hasLicense){if(F.has(a))return void H(`${b.name} is blocked from the service!`);H(`${b.name} downloads shared key...`),y(b=>b.map(b=>b.id===a?{...b,usingSharedKey:!0}:b)),w(a=>a.map(a=>({...a,downloads:a.downloads+1}))),D?setTimeout(()=>{H(`ANOMALY DETECTED: ${b.name} using key without valid license!`),H(`Blocking user ${b.name}...`),G(b=>new Set([...b,a])),y(b=>b.map(b=>b.id===a?{...b,usingSharedKey:!1}:b))},1500):H(`${b.name} is now watching content for free!`)}})(a.id),disabled:a.usingSharedKey,className:"w-full gap-2 mt-2",children:[(0,b.jsx)(s.Download,{className:"w-3 h-3"}),a.usingSharedKey?"Already Using Key":"Download Shared Key"]})]},a.id))})})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsx)(d.CardTitle,{className:"text-lg",children:"Event Log"}),(0,b.jsx)(d.CardDescription,{children:"Real-time activity"})]}),(0,b.jsx)(d.CardContent,{children:(0,b.jsx)(i.ScrollArea,{className:"h-[300px] rounded-lg border bg-zinc-950 p-3",children:0===z.length?(0,b.jsx)("div",{className:"text-center text-muted-foreground text-sm py-8",children:"Start simulation to see events..."}):(0,b.jsx)("div",{className:"space-y-1 font-mono text-xs",children:z.map((a,c)=>(0,b.jsx)("div",{className:a.includes("DETECTED")||a.includes("ANOMALY")?"text-red-400":a.includes("ACTION")||a.includes("Blocking")?"text-yellow-400":a.includes("Enabling")?"text-blue-400":a.includes("free")||a.includes("shares")?"text-orange-400":"text-muted-foreground",children:a},c))})})})]})]})]}),(0,b.jsx)(h.TabsContent,{value:"defense",className:"space-y-4",children:(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsxs)(d.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(l.Shield,{className:"w-5 h-5 text-blue-500"}),"Prevention Strategies"]})}),(0,b.jsx)(d.CardContent,{className:"space-y-4",children:(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"p-3 rounded-lg border bg-green-500/10 border-green-500/30",children:[(0,b.jsx)("h4",{className:"font-medium text-green-400 mb-1",children:"Device Binding"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Bind licenses to specific device fingerprints. Keys won't work on different devices even if extracted."})]}),(0,b.jsxs)("div",{className:"p-3 rounded-lg border bg-blue-500/10 border-blue-500/30",children:[(0,b.jsx)("h4",{className:"font-medium text-blue-400 mb-1",children:"Session-Based Keys"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Generate unique keys per session with short validity periods. Shared keys expire quickly."})]}),(0,b.jsxs)("div",{className:"p-3 rounded-lg border bg-purple-500/10 border-purple-500/30",children:[(0,b.jsx)("h4",{className:"font-medium text-purple-400 mb-1",children:"Forensic Watermarking"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Embed unique identifiers per user/session in the content. Trace leaked content back to source."})]})]})})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsxs)(d.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(k.AlertTriangle,{className:"w-5 h-5 text-yellow-500"}),"Detection Methods"]})}),(0,b.jsx)(d.CardContent,{className:"space-y-4",children:(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"p-3 rounded-lg border",children:[(0,b.jsx)("h4",{className:"font-medium mb-1",children:"License Correlation"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Monitor for playback without corresponding license acquisition. Detect decryption using keys from other devices."})]}),(0,b.jsxs)("div",{className:"p-3 rounded-lg border",children:[(0,b.jsx)("h4",{className:"font-medium mb-1",children:"Geographic Analysis"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Detect impossible scenarios like the same key being used in different countries simultaneously."})]}),(0,b.jsxs)("div",{className:"p-3 rounded-lg border",children:[(0,b.jsx)("h4",{className:"font-medium mb-1",children:"Key Usage Monitoring"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Track how many unique devices use each key. Unusual spikes indicate key sharing."})]})]})})]})]})}),(0,b.jsx)(h.TabsContent,{value:"technical",className:"space-y-4",children:(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsx)(d.CardTitle,{children:"Key Sharing Ecosystem"}),(0,b.jsx)(d.CardDescription,{children:"How key sharing networks operate"})]}),(0,b.jsx)(d.CardContent,{className:"prose prose-invert max-w-none",children:(0,b.jsxs)("div",{className:"space-y-4 text-sm",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"font-medium mb-2",children:"The Key Sharing Process"}),(0,b.jsxs)("ol",{className:"list-decimal pl-4 text-muted-foreground space-y-2",children:[(0,b.jsxs)("li",{children:[(0,b.jsx)("strong",{children:"Key Extraction:"})," A user with a legitimate license extracts the decryption key from their L3 device using memory dump techniques"]}),(0,b.jsxs)("li",{children:[(0,b.jsx)("strong",{children:"Distribution:"})," The extracted key (and Key ID) are shared on underground forums, private groups, or automated key servers"]}),(0,b.jsxs)("li",{children:[(0,b.jsx)("strong",{children:"Consumption:"})," Pirates download the shared key and use it in modified players to decrypt content without paying"]}),(0,b.jsxs)("li",{children:[(0,b.jsx)("strong",{children:"Scaling:"})," Automated systems can request licenses, extract keys, and share them in near real-time"]})]})]}),(0,b.jsx)(j.Separator,{}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"font-medium mb-2",children:"Key Server Infrastructure"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:'Sophisticated piracy operations run "key servers" that automatically:'}),(0,b.jsxs)("ul",{className:"list-disc pl-4 text-muted-foreground space-y-1 mt-2",children:[(0,b.jsx)("li",{children:"Request licenses from content providers using legitimate accounts"}),(0,b.jsx)("li",{children:"Extract keys using automated CDM exploitation tools"}),(0,b.jsx)("li",{children:"Store and index keys by content ID for quick lookup"}),(0,b.jsx)("li",{children:"Serve keys to pirate player applications on demand"})]})]}),(0,b.jsx)(j.Separator,{}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"font-medium mb-2",children:"Impact and Scale"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Key sharing is one of the most damaging forms of DRM circumvention because:"}),(0,b.jsxs)("ul",{className:"list-disc pl-4 text-muted-foreground space-y-1 mt-2",children:[(0,b.jsx)("li",{children:"A single extracted key can enable unlimited piracy"}),(0,b.jsx)("li",{children:"Keys can be shared instantly worldwide"}),(0,b.jsx)("li",{children:"Content remains in original quality (no re-encoding losses)"}),(0,b.jsx)("li",{children:"Harder to trace than screen recording"})]})]})]})})]})})]})]})}a.s(["KeySharingLab",()=>v],63330)}];

//# sourceMappingURL=7e210_Git_drm-security-lab_src_components_labs_attacks_KeySharingLab_tsx_f113d48e._.js.map