module.exports=[77995,a=>{"use strict";var b=a.i(21350),c=a.i(25126),d=a.i(11878),e=a.i(50920),f=a.i(12056),g=a.i(24817),h=a.i(7208),i=a.i(89344),j=a.i(25626),k=a.i(95514),l=a.i(29946),m=a.i(71758),n=a.i(58691);let o=(0,n.default)("activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);var p=a.i(32977),q=a.i(61569);let r=(0,n.default)("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]]),s=(0,n.default)("ban",[["path",{d:"M4.929 4.929 19.07 19.071",key:"196cmz"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);var t=a.i(66305),u=a.i(47061),v=a.i(31165),w=a.i(72061);let x=(0,n.default)("chart-column",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),y=(0,n.default)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);var z=a.i(87917),A=a.i(85165);let B=["US-NY","US-CA","UK-LN","DE-BE","JP-TK","AU-SY","BR-SP","IN-MU"];function C(){let{perspective:a}=(0,z.usePerspective)(),[n,C]=(0,c.useState)([]),[D,E]=(0,c.useState)([]),[F,G]=(0,c.useState)(!1),[H,I]=(0,c.useState)({totalRequests:0,blockedRequests:0,activeAlerts:0,riskScore:0}),J=(0,c.useCallback)((a=!1)=>{let b={id:(0,A.bytesToHex)((0,A.generateKey)(4)),userId:"user_"+(0,A.bytesToHex)((0,A.generateKey)(3)),deviceId:"dev_"+(0,A.bytesToHex)((0,A.generateKey)(3)),location:B[Math.floor(Math.random()*B.length)],startTime:Date.now(),requestCount:a?Math.floor(500*Math.random())+100:Math.floor(20*Math.random())+1,uniqueContentCount:a?Math.floor(50*Math.random())+20:Math.floor(5*Math.random())+1,hasLicense:!a||Math.random()>.7,riskScore:a?Math.floor(50*Math.random())+50:Math.floor(30*Math.random()),flags:[]};return b.requestCount>100&&b.flags.push("high_velocity"),b.uniqueContentCount>20&&b.flags.push("content_harvesting"),b.hasLicense||b.flags.push("no_license"),b.riskScore>70&&b.flags.push("high_risk"),b},[]),K=(0,c.useCallback)(a=>{let b=[];return a.requestCount>50&&b.push({id:(0,A.bytesToHex)((0,A.generateKey)(4)),type:"velocity",severity:a.requestCount>200?"critical":a.requestCount>100?"high":"medium",message:`High request velocity: ${a.requestCount} requests in session`,sessionId:a.id,timestamp:Date.now(),action:a.requestCount>200?"block":"challenge"}),a.uniqueContentCount>15&&b.push({id:(0,A.bytesToHex)((0,A.generateKey)(4)),type:"content",severity:a.uniqueContentCount>30?"high":"medium",message:`Content harvesting detected: ${a.uniqueContentCount} unique items`,sessionId:a.id,timestamp:Date.now(),action:"challenge"}),!a.hasLicense&&a.requestCount>5&&b.push({id:(0,A.bytesToHex)((0,A.generateKey)(4)),type:"pattern",severity:"high",message:"Decryption attempts without valid license",sessionId:a.id,timestamp:Date.now(),action:"block"}),b},[]),L=(0,c.useCallback)(()=>{let a=J(Math.random()>.7);C(b=>[...b,a].slice(-20));let b=K(a);b.length>0&&E(a=>[...b,...a].slice(0,50)),I(c=>({totalRequests:c.totalRequests+a.requestCount,blockedRequests:c.blockedRequests+(b.some(a=>"block"===a.action)?a.requestCount:0),activeAlerts:D.filter(a=>Date.now()-a.timestamp<6e4).length+b.length,riskScore:Math.min(100,Math.max(0,a.riskScore))}))},[J,K,D]);(0,c.useEffect)(()=>{if(!F)return;let a=setInterval(L,2e3);return()=>clearInterval(a)},[F,L]);let M=a=>{let b;switch(a){case"velocity":b={...J(!1),requestCount:500+Math.floor(500*Math.random()),riskScore:90,flags:["high_velocity","automated"]};break;case"geographic":b={...J(!1),location:"RU-MW",riskScore:75,flags:["geo_anomaly","vpn_detected"]};break;case"harvesting":b={...J(!1),uniqueContentCount:100,hasLicense:!1,riskScore:95,flags:["content_harvesting","no_license","key_sharing"]}}C(a=>[b,...a].slice(0,20));let c=K(b);E(a=>[...c,...a].slice(0,50))};return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[(0,b.jsx)(o,{className:"w-6 h-6 text-blue-500"}),"Anomaly Detection"]}),(0,b.jsx)("p",{className:"text-muted-foreground mt-1",children:"Monitor and detect suspicious DRM license usage patterns"})]}),(0,b.jsx)(f.Badge,{variant:"blue-team"===a?"default":"secondary",children:"blue-team"===a?"Defense Mode":"Analysis Mode"})]}),(0,b.jsxs)(g.Alert,{children:[(0,b.jsx)(l.Shield,{className:"h-4 w-4"}),(0,b.jsx)(g.AlertTitle,{children:"Blue Team Defense"}),(0,b.jsx)(g.AlertDescription,{children:"Anomaly detection identifies unusual patterns like high-velocity requests, geographic impossibilities, and key sharing indicators."})]}),(0,b.jsxs)(h.Tabs,{defaultValue:"monitoring",className:"space-y-4",children:[(0,b.jsxs)(h.TabsList,{children:[(0,b.jsxs)(h.TabsTrigger,{value:"monitoring",className:"gap-2",children:[(0,b.jsx)(o,{className:"w-4 h-4"}),"Live Monitoring"]}),(0,b.jsxs)(h.TabsTrigger,{value:"rules",className:"gap-2",children:[(0,b.jsx)(m.AlertTriangle,{className:"w-4 h-4"}),"Detection Rules"]}),(0,b.jsxs)(h.TabsTrigger,{value:"response",className:"gap-2",children:[(0,b.jsx)(l.Shield,{className:"w-4 h-4"}),"Response Actions"]})]}),(0,b.jsxs)(h.TabsContent,{value:"monitoring",className:"space-y-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,b.jsx)(d.Card,{children:(0,b.jsxs)(d.CardContent,{className:"pt-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(r,{className:"w-4 h-4 text-muted-foreground"}),(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"Total Requests"})]}),(0,b.jsx)("div",{className:"text-2xl font-bold mt-1",children:H.totalRequests.toLocaleString()})]})}),(0,b.jsx)(d.Card,{children:(0,b.jsxs)(d.CardContent,{className:"pt-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(s,{className:"w-4 h-4 text-red-500"}),(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"Blocked"})]}),(0,b.jsx)("div",{className:"text-2xl font-bold mt-1 text-red-400",children:H.blockedRequests.toLocaleString()})]})}),(0,b.jsx)(d.Card,{children:(0,b.jsxs)(d.CardContent,{className:"pt-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(y,{className:"w-4 h-4 text-yellow-500"}),(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"Active Alerts"})]}),(0,b.jsx)("div",{className:"text-2xl font-bold mt-1 text-yellow-400",children:H.activeAlerts})]})}),(0,b.jsx)(d.Card,{children:(0,b.jsxs)(d.CardContent,{className:"pt-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(x,{className:"w-4 h-4 text-muted-foreground"}),(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"Risk Score"})]}),(0,b.jsxs)("div",{className:"mt-1",children:[(0,b.jsx)(k.Progress,{value:H.riskScore,className:"h-2"}),(0,b.jsxs)("span",{className:"text-xs text-muted-foreground",children:[H.riskScore,"%"]})]})]})})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{className:"pb-3",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)(d.CardTitle,{className:"text-lg",children:"Monitoring Controls"}),(0,b.jsx)(f.Badge,{variant:F?"default":"outline",children:F?"Active":"Stopped"})]})}),(0,b.jsx)(d.CardContent,{children:(0,b.jsxs)("div",{className:"flex gap-3 flex-wrap",children:[(0,b.jsxs)(e.Button,{onClick:()=>{G(!F),F||(C([]),E([]),I({totalRequests:0,blockedRequests:0,activeAlerts:0,riskScore:0}))},variant:F?"destructive":"default",className:"gap-2",children:[F?(0,b.jsx)(u.XCircle,{className:"w-4 h-4"}):(0,b.jsx)(o,{className:"w-4 h-4"}),F?"Stop Monitoring":"Start Monitoring"]}),(0,b.jsx)(j.Separator,{orientation:"vertical",className:"h-9"}),(0,b.jsxs)(e.Button,{onClick:()=>M("velocity"),variant:"outline",size:"sm",className:"gap-2",children:[(0,b.jsx)(w.Zap,{className:"w-4 h-4 text-yellow-500"}),"Inject Velocity Attack"]}),(0,b.jsxs)(e.Button,{onClick:()=>M("geographic"),variant:"outline",size:"sm",className:"gap-2",children:[(0,b.jsx)(q.Globe,{className:"w-4 h-4 text-blue-500"}),"Inject Geo Anomaly"]}),(0,b.jsxs)(e.Button,{onClick:()=>M("harvesting"),variant:"outline",size:"sm",className:"gap-2",children:[(0,b.jsx)(p.Users,{className:"w-4 h-4 text-red-500"}),"Inject Key Sharing"]})]})})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsxs)(d.CardTitle,{className:"text-lg flex items-center gap-2",children:[(0,b.jsx)(p.Users,{className:"w-5 h-5"}),"Active Sessions"]}),(0,b.jsx)(d.CardDescription,{children:"Recent license request sessions"})]}),(0,b.jsx)(d.CardContent,{children:(0,b.jsx)(i.ScrollArea,{className:"h-[300px]",children:0===n.length?(0,b.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,b.jsx)(p.Users,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),(0,b.jsx)("p",{className:"text-sm",children:"No sessions yet"}),(0,b.jsx)("p",{className:"text-xs",children:"Start monitoring to see traffic"})]}):(0,b.jsx)("div",{className:"space-y-2",children:n.map(a=>(0,b.jsxs)("div",{className:`p-2 rounded border text-xs ${a.riskScore>70?"border-red-500/50 bg-red-500/10":a.riskScore>40?"border-yellow-500/50 bg-yellow-500/10":"border-border"}`,children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,b.jsx)("span",{className:"font-medium",children:a.userId}),(0,b.jsxs)(f.Badge,{variant:"outline",className:"text-[10px]",children:["Risk: ",a.riskScore,"%"]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3 text-muted-foreground",children:[(0,b.jsxs)("span",{className:"flex items-center gap-1",children:[(0,b.jsx)(q.Globe,{className:"w-3 h-3"}),a.location]}),(0,b.jsxs)("span",{className:"flex items-center gap-1",children:[(0,b.jsx)(r,{className:"w-3 h-3"}),a.requestCount," req"]}),(0,b.jsxs)("span",{className:"flex items-center gap-1",children:[(0,b.jsx)(v.Eye,{className:"w-3 h-3"}),a.uniqueContentCount," items"]})]}),a.flags.length>0&&(0,b.jsx)("div",{className:"flex gap-1 mt-1 flex-wrap",children:a.flags.map((a,c)=>(0,b.jsx)(f.Badge,{variant:"outline",className:"text-[10px] text-red-400",children:a},c))})]},a.id))})})})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsxs)(d.CardTitle,{className:"text-lg flex items-center gap-2",children:[(0,b.jsx)(m.AlertTriangle,{className:"w-5 h-5 text-yellow-500"}),"Anomaly Alerts"]}),(0,b.jsx)(d.CardDescription,{children:"Detected suspicious patterns"})]}),(0,b.jsx)(d.CardContent,{children:(0,b.jsx)(i.ScrollArea,{className:"h-[300px]",children:0===D.length?(0,b.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,b.jsx)(t.CheckCircle2,{className:"w-8 h-8 mx-auto mb-2 opacity-50 text-green-500"}),(0,b.jsx)("p",{className:"text-sm",children:"No alerts"}),(0,b.jsx)("p",{className:"text-xs",children:"All traffic appears normal"})]}):(0,b.jsx)("div",{className:"space-y-2",children:D.map(a=>(0,b.jsxs)("div",{className:`p-2 rounded border ${(a=>{switch(a){case"low":return"text-blue-400 bg-blue-500/10 border-blue-500/30";case"medium":return"text-yellow-400 bg-yellow-500/10 border-yellow-500/30";case"high":return"text-orange-400 bg-orange-500/10 border-orange-500/30";case"critical":return"text-red-400 bg-red-500/10 border-red-500/30"}})(a.severity)}`,children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,b.jsx)(f.Badge,{variant:"outline",className:"text-[10px]",children:a.type.toUpperCase()}),(0,b.jsx)("span",{className:"text-[10px] text-muted-foreground",children:new Date(a.timestamp).toLocaleTimeString()})]}),(0,b.jsx)("p",{className:"text-xs",children:a.message}),(0,b.jsxs)("div",{className:"flex items-center justify-between mt-1",children:[(0,b.jsxs)("span",{className:"text-[10px] text-muted-foreground",children:["Session: ",a.sessionId]}),(0,b.jsx)(f.Badge,{variant:"block"===a.action?"destructive":"secondary",className:"text-[10px]",children:a.action})]})]},a.id))})})})]})]})]}),(0,b.jsx)(h.TabsContent,{value:"rules",className:"space-y-4",children:(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsx)(d.CardTitle,{children:"Velocity Rules"})}),(0,b.jsxs)(d.CardContent,{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"p-3 rounded-lg border",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsx)("span",{className:"font-medium",children:"High Request Rate"}),(0,b.jsx)(f.Badge,{variant:"destructive",children:"Block"})]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"More than 200 requests per session triggers immediate blocking."})]}),(0,b.jsxs)("div",{className:"p-3 rounded-lg border",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsx)("span",{className:"font-medium",children:"Moderate Request Rate"}),(0,b.jsx)(f.Badge,{variant:"secondary",children:"Challenge"})]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"50-200 requests triggers CAPTCHA or re-authentication challenge."})]})]})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsx)(d.CardTitle,{children:"Geographic Rules"})}),(0,b.jsxs)(d.CardContent,{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"p-3 rounded-lg border",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsx)("span",{className:"font-medium",children:"Impossible Travel"}),(0,b.jsx)(f.Badge,{variant:"destructive",children:"Block"})]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Same account active in distant locations within impossible timeframes."})]}),(0,b.jsxs)("div",{className:"p-3 rounded-lg border",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsx)("span",{className:"font-medium",children:"VPN/Proxy Detected"}),(0,b.jsx)(f.Badge,{variant:"secondary",children:"Challenge"})]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Known VPN or proxy IP addresses trigger additional verification."})]})]})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsx)(d.CardTitle,{children:"Pattern Rules"})}),(0,b.jsxs)(d.CardContent,{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"p-3 rounded-lg border",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsx)("span",{className:"font-medium",children:"License Mismatch"}),(0,b.jsx)(f.Badge,{variant:"destructive",children:"Block"})]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Decryption attempts without corresponding license acquisition."})]}),(0,b.jsxs)("div",{className:"p-3 rounded-lg border",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsx)("span",{className:"font-medium",children:"Content Harvesting"}),(0,b.jsx)(f.Badge,{variant:"secondary",children:"Challenge"})]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Requesting licenses for unusually large number of unique content items."})]})]})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsx)(d.CardTitle,{children:"Device Rules"})}),(0,b.jsxs)(d.CardContent,{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"p-3 rounded-lg border",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsx)("span",{className:"font-medium",children:"Device Sharing"}),(0,b.jsx)(f.Badge,{variant:"secondary",children:"Monitor"})]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Same device ID used by multiple accounts in short timeframe."})]}),(0,b.jsxs)("div",{className:"p-3 rounded-lg border",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsx)("span",{className:"font-medium",children:"Spoofed Device"}),(0,b.jsx)(f.Badge,{variant:"destructive",children:"Block"})]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Device fingerprint inconsistencies indicating spoofing attempts."})]})]})]})]})}),(0,b.jsx)(h.TabsContent,{value:"response",className:"space-y-4",children:(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsx)(d.CardTitle,{children:"Response Actions"}),(0,b.jsx)(d.CardDescription,{children:"Automated responses to detected anomalies"})]}),(0,b.jsx)(d.CardContent,{children:(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,b.jsxs)("div",{className:"p-4 rounded-lg border bg-blue-500/10 border-blue-500/30",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,b.jsx)(v.Eye,{className:"w-5 h-5 text-blue-500"}),(0,b.jsx)("span",{className:"font-medium text-blue-400",children:"Monitor"})]}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Log suspicious activity for later analysis. Allow request to proceed but flag session for review."})]}),(0,b.jsxs)("div",{className:"p-4 rounded-lg border bg-yellow-500/10 border-yellow-500/30",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,b.jsx)(m.AlertTriangle,{className:"w-5 h-5 text-yellow-500"}),(0,b.jsx)("span",{className:"font-medium text-yellow-400",children:"Challenge"})]}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Require additional verification: CAPTCHA, re-authentication, or device attestation before proceeding."})]}),(0,b.jsxs)("div",{className:"p-4 rounded-lg border bg-red-500/10 border-red-500/30",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,b.jsx)(s,{className:"w-5 h-5 text-red-500"}),(0,b.jsx)("span",{className:"font-medium text-red-400",children:"Block"})]}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Immediately deny the request. Optionally revoke existing licenses and flag account for review."})]})]})})]})})]})]})}a.s(["AnomalyDetectionLab",()=>C],77995)}];

//# sourceMappingURL=fa162_drm-security-lab_src_components_labs_defense_AnomalyDetectionLab_tsx_e6958008._.js.map